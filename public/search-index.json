[{"content":"üëã Hi, I\u0026rsquo;m Prashant ‚Äî The CAD Coder\nI\u0026rsquo;m a Lead Software Developer in the IT department of a mechanical‚Äëengineering company.\nBefore that, I spent 8 years as a SolidWorks design engineer, so I know exactly where real‚Äëworld CAD workflows bog down.\nSince‚ÄØ2019 I‚Äôve been automating those bottlenecks with C#, VBA, WPF, and the SolidWorks API (and lately the Autodesk‚ÄØInventor API).\nThe‚ÄØCAD‚ÄØCoder exists so other engineers can skip the trial‚Äëand‚Äëerror I went through.\nüí° Why I Started The‚ÄØCAD‚ÄØCoder Most CAD‚Äëautomation tutorials are outdated, incomplete, or ignore production realities.\nThis site fixes that by:\nTeaching macros that solve actual engineering problems Sharing production‚Äëready code I use at work Bridging the gap between CAD users and developer‚Äëgrade automation üß∞ What You‚Äôll Find Here SolidWorks C# tutorials (WPF‚ÄØ+‚ÄØMVVM) Reusable code snippets and full walkthrough videos Legacy VBA scripts where they still make sense Practical tips to cut hours of repetitive CAD work üöÄ Start Here üëâ Browse SolidWorks‚ÄØC# Tutorials üëâ Check out my YouTube channel Cut hours of repetitive work with real macros I use daily ‚Äî\nfor drawing export, renaming files, and updating properties.\nIf you‚Äôre tired of exporting, renaming, or updating properties by hand, you‚Äôre in the right place.\nLet‚Äôs automate that work away together ‚Äî and if you build something cool from what you learn here, tell me about it.\n‚Äî Prashant\nLead Software Developer \u0026amp; Founder of The‚ÄØCAD‚ÄØCoder\nConnect with me on LinkedIn\n","date":"2025-07-09","id":0,"permalink":"/aboutMe/","summary":"\u003cp\u003eüëã Hi, I\u0026rsquo;m Prashant ‚Äî The CAD Coder\u003c/p\u003e\n\u003cp\u003eI\u0026rsquo;m a \u003cstrong\u003eLead Software Developer\u003c/strong\u003e in the IT department of a mechanical‚Äëengineering company.\u003cbr\u003e\nBefore that, I spent \u003cstrong\u003e8 years as a SolidWorks design engineer\u003c/strong\u003e, so I know exactly where real‚Äëworld CAD workflows bog down.\u003c/p\u003e","tags":[],"title":"About"},{"content":"üöÄ Tools \u0026amp; Resources I Use (and Recommend)\nThis is a curated list of the resources that have helped me learn programming and SolidWorks API automation ‚Äî including books, tutorials, tools, and frameworks.\nIf you\u0026rsquo;re just getting started or looking to go deeper, this page can guide your learning path.\nüëâ Want to know how I learn programming? Check out my About Me page.\nüìò Learning VBA for Excel \u0026amp; SolidWorks Book: Excel Macros for Dummies Great for learning VBA from scratch. It helped me understand the core syntax and build confidence with macros.\nüõí Buy on Amazon\nüéì Prefer not to buy? No worries! You can also check out my VBA tutorials here.\nüõ† SolidWorks VBA Macro Tutorials YouTube: üöÄ Automate SolidWorks with VBA macros A practical, beginner-friendly channel to get started with SolidWorks macros.\nüìö Want more? I write detailed tutorials on SolidWorks VBA Macros on this blog.\nBook: Automating SolidWorks 2025 Using Macros While I haven‚Äôt personally read this, it‚Äôs one of the few books on macro automation that‚Äôs up-to-date.\nüõí Buy on Amazon\nüì• You can also download free books by AngelSix.\nüíª C# Programming for SolidWorks Automation YouTube: AngelSix C# Tutorials These are gold. Professional, clean, and beginner-friendly ‚Äî taught by a CAD engineer.\nLuke (AngelSix) has deep experience with SolidWorks and Inventor automation.\nüßë‚Äçüíª About AngelSix\nBook: C# 7.0 in a Nutshell I regularly use this as a reference ‚Äî great for understanding C# features in detail.\nüõí Buy on Amazon\nüß© SolidWorks C# Add-in Development YouTube: SolidDNA Add-in Framework A great intro to creating SolidWorks Add-ins using C# and WPF.\nI\u0026rsquo;m covering this in detail on the blog soon ‚Äî stay tuned.\n‚öôÔ∏è Learning C++ (for SolidWorks API) Books by Bjarne Stroustrup Programming: Principles and Practice Using C++ ‚Äî best for beginners. The C++ Programming Language ‚Äî more advanced. I suggest starting with Programming: Principles and Practice ‚Äî it teaches how to think like a programmer.\nüìå There\u0026rsquo;s very little SolidWorks C++ API material online. But I‚Äôve created some small apps and may share those soon.\nüéÅ Bonus: My Debugging Toolkit Here‚Äôs what I do when I get stuck:\nüîç SolidWorks Offline Help Still my most-used reference. If web help doesn‚Äôt open, go to:\nHelp ‚Üí uncheck Use SOLIDWORKS Web Help Go to API Help Use the Index tab to search topics (e.g., hole wizard) Tip: Look at the built-in sample code. It often solves 80% of your problem.\nüåê Google Like a Pro Search like this:\n\u0026ldquo;How to open Excel in SolidWorks VBA\u0026rdquo;\nThis usually leads me to forum answers, even without logging in.\nüí¨ SolidWorks Forum Search before asking. If your question is unique, post it ‚Äî the community is helpful (especially for macros).\nüí° StackOverflow Perfect for language-specific issues in C#, VBA, or WPF. Even without an account, I often find solutions here.\nüôå Final Note If you found this page helpful and plan to buy a book, consider using my Amazon links ‚Äî they support this blog at no extra cost to you.\nAnd if you liked the content, share this site with your friends or colleagues in CAD automation.\nStay curious. Stay building. üöÄ\n","date":"2025-07-09","id":1,"permalink":"/resources/","summary":"\u003cp\u003eüöÄ Tools \u0026amp; Resources I Use (and Recommend)\u003c/p\u003e\n\u003cp\u003eThis is a curated list of the \u003cstrong\u003eresources\u003c/strong\u003e that have helped me learn \u003cstrong\u003eprogramming\u003c/strong\u003e and \u003cstrong\u003eSolidWorks API automation\u003c/strong\u003e ‚Äî including books, tutorials, tools, and frameworks.\u003c/p\u003e","tags":[],"title":"Resources"},{"content":"","date":"2023-09-07","id":2,"permalink":"/solidworks-macros/01-general---solidworks-functions/","summary":"","tags":[],"title":"General - Functions"},{"content":"","date":"2023-09-07","id":3,"permalink":"/vba/getting-started/","summary":"","tags":[],"title":"Getting Started"},{"content":"","date":"2023-09-07","id":4,"permalink":"/wix-tutorials/getting-started/","summary":"","tags":[],"title":"Getting Started"},{"content":"","date":"2023-09-07","id":5,"permalink":"/wpf-tutorials/getting-started/","summary":"","tags":[],"title":"Getting Started"},{"content":"Objective I want to:\nSign Up Syncfusion Account. Download Syncfusion Community Version Control. Sign Up Syncfusion Account Sign Up Page: üöÄ Sign Up Page Please see below image for reference.\nDownload Syncfusion Community Version Control After Sign up, Sign-in to your account. You will see \u0026ldquo;DASHBOARD\u0026rdquo; as shown below. Select \u0026ldquo;Download and Key\u0026rdquo; option as shown below. This will show \u0026ldquo;Download Page\u0026rdquo; as shown below. From this page, Download and Run \u0026ldquo;Essential Studio Enterprise Edition\u0026rdquo;.\nSelect WPF from \u0026ldquo;Essential Studio Enterprise Edition\u0026rdquo; Installer.\nThis will take time to install.\nFinal Result After WPF successfully installed from \u0026ldquo;Essential Studio Enterprise Edition\u0026rdquo; Installer.\nWe see following option in Visual Studio.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Syncfusion Account Sign Up and Download Community Version.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":6,"permalink":"/wpf-tutorials/syncfusion-account-signup/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eI want to:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSign Up Syncfusion Account.\u003c/li\u003e\n\u003cli\u003eDownload Syncfusion Community Version Control.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"sign-up-syncfusion-account\"\u003eSign Up Syncfusion Account\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cem\u003eSign Up Page\u003c/em\u003e: üöÄ \u003cstrong\u003e\u003ca href=\"https://www.syncfusion.com/account/register\" target=\"_blank\"\u003eSign Up Page\u003c/a\u003e\u003c/strong\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003ePlease see below image for reference.\u003c/p\u003e","tags":[],"title":"Syncfusion Account Sign Up and Community Version"},{"content":"Solidworks provides us two methods for open Visual Basic for Application.\nMenu based method Toolbar method Please see below video for visual details.\nMenu Base Method To open VBA window, go Tools in menu bar. Then go to Macro. When you click Macro you found 5 options or button. (Menu bar -\u0026gt; Tool -\u0026gt; Macro)\nUse below images for better help.\nClick Tools as show below.\nClick Macro as show below.\nAfter clicking Macro below options appears\nDescription and working of each button will be given after next method.\nToolbar method To open VBA window, click Right Mouse Button anywhere in screen.\nBy doing this a list of all available Toolbar option appears. In this list, we need to select Macro toolbar to show macro toolbar.\nUse below images for better help.\nAfter clicking of Right Mouse Button below Toolbar list appears.\nFrom this list we need to select Macro option as show below.\nAfter clicking \u0026ldquo;Macro\u0026rdquo; option below toolbar appears.\nThis option includes same buttons as described in Menu based method.\nDescription and Functions of each button is given below.\nNew Macro Button You can create a new macro by this button and then program the macro in VBA.\nCreating a macro is different from recording a macro. When you create a new macro, you program the macro directly from a editing application such as Visual Basic Editor.\nWhen you record a macro, you create the macro within the Solidworks software.\nTo create a new macro:\nClick New Macro (Macro toolbar), or click Tools -\u0026gt; Macro -\u0026gt; New.\nType a file name.\nClick Save\nYour macro editing application opens ready for you to program the new macro.\nRecord/Pause Macro Button You can record operations performed with the Solidworks user interface and replay them with Solidworks macros.\nA macro contains equivalent API functions. These API functions were made when the operation were performed with the user interface.\nA macro can record your mouse clicks, menu choices and keystrokes to play back later.\nTo record a macro:\nClick Record/Pause Macro Button (Macro toolbar), or click Tools -\u0026gt; Macro -\u0026gt; Record.\nPerform the steps you want to record.\nWhen you are done, click Stop Macro Button (Macro toolbar), or click Tools -\u0026gt; Macro -\u0026gt; Stop.\nIn the dialog box, type a name for File name and click Save. (The .swp extension is automatically added to the filename.)\nRun Macro Button You can run macro from the Macro toolbar or Tools menu.\nTo run a macro:\nClick Run Macro Button (Macro toolbar), or click Tools -\u0026gt; Macro -\u0026gt; Run.\nIn the dialog box, locate a macro file (.swp, .swb) and click Open.\nEdit Macro Button You can edit macro from the Macro toolbar or Tools menu.\nTo run a macro:\nClick Edit Macro Button (Macro toolbar), or click Tools -\u0026gt; Macro -\u0026gt; Edit.\nIn the dialog box, locate a macro file (.swp, .swb) and click Open.\nEdit the macro.\nNext post will be about Open new Part document using Solidworks macros.\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":7,"permalink":"/Solidworks-macro-guide/","summary":"\u003cp\u003e\u003cem\u003eSolidworks\u003c/em\u003e provides us two methods for open Visual Basic for Application.\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eMenu based method\u003c/li\u003e\n\u003cli\u003eToolbar method\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003ePlease see below video for visual details.\u003c/p\u003e","tags":[],"title":"VBA In Solidworks"},{"content":"To understand Visual Basic for Application, lets look at the following questions.\nWhat is Visual Basic for Application? Visual Basic for Applications also known as VBA, is a programming language developed by Microsoft.\nSOLIDWORKS, along with Excel and other software of Office Suit, includes VBA language (at no extra cost).\nIn a nutshell, VBA is a tool that people use to develop program that control SOLIDWORKS.\nThink about a robot that knows everything about SOLIDWORKS. This robot can read instruction, and it can also operate SOLIDWORKS very fast and accurate.\nWhen you want the robot to do something in SOLIDWORKS, you write up a set of robotic instruction by using special codes.\nTell the robot to follow your instruction, while you sit back and take some rest. That‚Äôs kind of what VBA is all about.\nWhat can you do with VBA? You know that people use different CAD softwares, not just SOLIDWORKS, for different tasks.\nBelow is a list of some common tasks:\nCreating sketches\nCreating 3D models\nCreating Simple to Complex assemblies of 3D models\nLinking files with external softwares mostly excel and many more tasks\nThis list could go on and on, but you get the idea.\nMy point is simply that a CAD Software like SOLIDWORKS used for wide variety of things.\nEveryone visiting this blog has different needs and expectations.\nOne thing virtually every visitor has common is the need to automate some aspect of their work. That is what VBA is all about.\nWhat are the advantages and disadvantages of VBA? In this section, I briefly describe the good things about VBA ‚Äì and I also explore its darker side.\nVBA Advantages You can automate almost anything you do in SOLIDWORKS.\nTo do so, you write instructions that SOLIDWORKS carries out.\nAutomating a task by using VBA offers several advantages:\nSOLIDWORKS always executes the tasks in exactly the same way. (In most cases consistency is good.)\nSOLIDWORKS performs the task much faster than you do it manually.\nIf you are a good macro programmer, SOLIDWORKS always performs the task without error.\nIf you set things properly, someone who don‚Äôt know anything about SOLIDWORKS can perform task.\nFor long, time-consuming tasks, you don‚Äôt have to sit in front of your computer and get board. SOLIDWORKS does work, while you drink water.\nVBA disadvantages It‚Äôs only fair that I give equal time to listing the disadvantages (or potential disadvantages) of VBA:\nYou have to know how to write programs in VBA (but that‚Äôs why you are here, right?). Fortunately, it‚Äôs not as difficult as you might expect.\nSometimes, things go wrong. In other words, you can‚Äôt blindly assume that your VBA program will always work correctly under all circumstances. Welcome to world of debugging and, if others are using your macros, be prepared for technical support.\nVBA in nutshell Just to let you know what you are in for, I‚Äôve prepared a quick summary of what VBA is all about.\nYou perform actions in VBA by writing (or recording) code in a VBA module. You view and edit VBA modules by using the Visual Basic Editor (VBE).\nA VBA module consists of Sub procedures. A sub procedure is a chunk of computer code that performs some action on or with objects. The following example shows a simple Sub procedure called AddThem.\nThis amazing program displays the result of 1 plus 1.\nvba\r1Sub AddThem() 2 Sum = 1 + 1 3 MsgBox (\u0026#34;The answer is \u0026#34; \u0026amp; Sum) 4End Sub\rNext post will be about Visual Basic Editor or VBE.\n","date":"0001-01-01","id":8,"permalink":"/vba/vba-Introduction/","summary":"\u003cp\u003eTo understand \u003ccode\u003eVisual Basic for Application\u003c/code\u003e, lets look at the following \u003cem\u003equestions\u003c/em\u003e.\u003c/p\u003e\n\u003ch2 id=\"what-is-visual-basic-for-application\"\u003eWhat is Visual Basic for Application?\u003c/h2\u003e\n\u003cp\u003e\u003ccode\u003eVisual Basic for Applications\u003c/code\u003e also known as \u003ccode\u003eVBA\u003c/code\u003e, is a \u003cem\u003eprogramming language\u003c/em\u003e developed by \u003cstrong\u003eMicrosoft\u003c/strong\u003e.\u003c/p\u003e","tags":[],"title":"Visual Basic for Application Introduction"},{"content":"Hello all,\nAs mentioned in previous article, I need to learn some topics for my work.\nOne of those topics is Wix4 Toolset.\nIn this article we understand\nWhy Wix? What is Wix? How to install Wix4 Toolset? Why Wix Wix is used for creating MSI packages.\nAs you know, MSI packages are reponsible for installing software into our Windows machine.\nWe already had Visual Studio Installer package.\nBut for some of our requirements I need to learn about it.\nIf you browse internet for Wix4 tutorials, there are very few.\nSo for my future purpose, I want to write what I have learnt from various place into my website.\nWhat is Wix Please see below üëáüèª information about Wix4 Toolset.\nOfficial Website: Wix Toolset\nDescription: Wix Toolset is a set of tools, developers use to create Windows Installation Experience.\nOfficial Doc: Getting Started\nHow To Install Wix4 IDE: Visual Studio 2022 Community\nClick above link to download üöÄ Visual Studio 2022 Community\nOpen Visual Studio 2022 Community\nIn \u0026ldquo;Home\u0026rdquo; screen of Visual Studio, select \u0026ldquo;Continue without code\u0026rdquo; option as shown in below üëáüèª image.\nThis open Visual Studio without any project/solution as shown in below üëáüèª image. Select \u0026ldquo;View\u0026rdquo; ‚û°Ô∏è \u0026ldquo;Terminal\u0026rdquo; for opening Terminal as shown in below üëáüèª image. This will open \u0026ldquo;Terminal\u0026rdquo; window as shown in below üëáüèª image. Run below command to install \u0026ldquo;Wix.exe\u0026rdquo; .Net tool. wix\r1dotnet tool install --global wix\rPlease see below image for installing \u0026ldquo;Wix.exe\u0026rdquo;. For checking if Wix is install or not, check Wix version by run following command. wix\r1wix --version\rPlease see below image for checking version of \u0026ldquo;Wix.exe\u0026rdquo;. That\u0026rsquo;s it!!!\nIn next article we will install \u0026ldquo;Free Heatwave Wix4 Extension\u0026rdquo;.\nHope this post helps you.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":9,"permalink":"/knowledge-base/wix4-introduction/","summary":"\u003cp\u003eHello all,\u003c/p\u003e\n\u003cp\u003eAs mentioned in previous article, I need to learn some topics for my work.\u003c/p\u003e\n\u003cp\u003eOne of those topics is Wix4 Toolset.\u003c/p\u003e","tags":[],"title":"Wix4 Introduction"},{"content":"","date":"2023-09-07","id":10,"permalink":"/vba/programming-concepts/","summary":"","tags":[],"title":"Programming Concepts"},{"content":"","date":"2023-09-07","id":11,"permalink":"/solidworks-macros/02-sketch---lines/","summary":"","tags":[],"title":"Sketch - Lines"},{"content":"Objective I want to:\nInstall WPF Prism Template in Visual Studio 2022. Demo Video Below üé¨ video shows how to Install Prism Project Template in Visual Studio 2022.\nOpen Empty Project Open Visual Studio 2022 in your machine.\nYou will see a window as shown in below üëáüèª image.\nSelect \u0026ldquo;Continue without code\u0026rdquo; option as shown in below üëáüèª image. This will open an empty project as shown in below üëáüèª image. Download Prism Template In this section we will search and download \u0026ldquo;Prism Template Pack\u0026rdquo;.\nSelect \u0026ldquo;Manage Extensions\u0026rdquo; option from \u0026ldquo;Extensions\u0026rdquo; menu item in Menu bar as shown in below üëáüèª image. After selecting this \u0026ldquo;Manage Extensions\u0026rdquo; option, a new window will appears as shown in below üëáüèª image. In this \u0026ldquo;Manage Extensions\u0026rdquo; window, search for \u0026ldquo;Prism\u0026rdquo; for \u0026ldquo;Prism Template Pack\u0026rdquo; as shown in below üëáüèª image. Now select \u0026ldquo;Download\u0026rdquo; option after searching. This will show a message in buttom as shown in below üëáüèª image. Now we close all windows in Visual Studio and close Visual Studio also. Install Prism Template In this section we will install \u0026ldquo;Prism Template Pack\u0026rdquo;.\nWhen we close Visual Studio, after sometime a new window appears on screen as shown in below üëáüèª image. From above window, select \u0026ldquo;Modify\u0026rdquo; option as shown in below üëáüèª image. When you select this option, installation of template start automatically as shown in below üëáüèª image. This installation will take sometime. When installation complete you will see message as shown in below üëáüèª image. Now close this window. Final Result After \u0026ldquo;Prism Template Pack\u0026rdquo; successfully installed.\nOpen Visual Studio 2022.\nCreate a New Project.\nYou will see Prism Project template in new project screen as shown in below üëáüèª image.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Install Prism Project Template.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":12,"permalink":"/wpf-tutorials/install-prism-project-template/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eI want to:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eInstall \u003cstrong\u003eWPF Prism Template\u003c/strong\u003e in Visual Studio 2022.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"demo-video\"\u003eDemo Video\u003c/h2\u003e\n\u003cp\u003eBelow üé¨ video shows how to \u003cstrong\u003eInstall Prism Project Template\u003c/strong\u003e in \u003cem\u003eVisual Studio 2022\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Install Prism Project Template"},{"content":"As the title suggested, in this post, we open new document from Solidworks VBA macros.\nAlso we understand each and every line of written code. So that you can understand why we written those lines and get some knowledge about how to write macro properly.\nPlease see below video for visual details.\nTo do this, we first need to create a new empty macro. If you don\u0026rsquo;t know how to create an empty macro; then please go to this VBA in Solidworks post.\nAfter creating an empty macro, you need to copy paste below code into this empty macro.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) End Sub\rThis code opens a new default part template in Solidworks.\nNow let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nThis is very important because if you don\u0026rsquo;t declare above line, it is very difficult to caught typo errors in variable names.\nThis type of error comes, when you mistakenly type wrong spelling of your defined variable.\nIn this case, VBE thinks that you have defined a new variable and use this variable.\nThis causes issues because your program runs perfectly but you didn\u0026rsquo;t get the desired result.\nThis most of the time discourage people and ultimately they left the programming.\nSo be on safe side and use this Option Explicit line in your every module.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rAs the comments in above code sample shows, in these 2 lines we are creating variables of different type.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\nIf we omit 1 SldWorks, then our VBE show error if we try to run this macro.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nHere, if we omit SldWorks, the compiler won\u0026rsquo;t give error. I used it to know who is the parent object.\nModelDoc2 is the a object, which holds properties and methods related to this a document.\nThese methods and properties are common to part, assembly and drawing documents.\nYou can see more about ModelDoc2 in this help link.\nNext is our Sub procedure named main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable which we define earlier to Solidworks application.\nNow it important to know that when you defined a variable of different type, which is not a common type, then you need to set the variable also.\nThis is a standard way to set Solidworks application. This way is given in many Solidworks API VBA example.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue(). This method is a part of our main Solidworks variable swApp.\nTo access this method, we need to write swApp variable and then use a \u0026ldquo;.\u0026rdquo; to access the Public properties and Methods inside this variable.\nThis \u0026ldquo;.\u0026rdquo; is called Dot operator. This operator provides us the access to the Public properties and Methods inside an object.\nWhen you type after a \u0026ldquo;.\u0026rdquo; you will notice that Visual Basic Editor automatically provides a list of properties and methods inside this swApp object. This helps us to write correct name for these methods and properties.\nNow we get the function GetUserPreferenceStringValue(). But this function needs some input to work with. This inputs are generally called Parameters.\nIn programming voculabury, we need to pass the parameter to this function so that this function can worked.\nThis input parameter is a single value from a list of other values. This list is stored in swUserPreferenceStringValue_e object.\nIn Solidworks API, if anything has _e after it, it means that this object contains some type of lists. It is important to know because we frequently use these type of lists. They are called enum. The value they hold is called Constant.\nSo our function GetUserPreferenceStringValue() needs some constant value from swUserPreferenceStringValue_e enum list to work.\nSince we want Default part template, we use swDefaultTemplatePart constant value from the swUserPreferenceStringValue_e enum list.\nPlease note that there are lots of values inside this enum list. You can see these values from this link.\nNow we just need to set the value of our swDoc variable to new document. We set the value as shown in below code snippet.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rTo set the value of swDoc, we use NewDocument() method. This method is inside swApp, hence we first need to invoke swApp and then by using Dot operator we access the NewDocument() method.\nNow this method needs 4 parameters (or input values) to work. If we don\u0026rsquo;t provide any of these required value we get errors.\nThese 4 parameters are as follows:\nTemplateName\nThis can be a full path of the template, which we use to create New document. PaperSize\nSize of paper Width\nWidth of paper Height\nHeight of paper When successfully implemented, this method creates a new document.\nIf this method failes to create a new document in that case this return NULL value. We can use this NULL value to check if the operation is successfull or not.\nIn our example, we use defaultTemplate variable as TemplateName parameter and use 0 in all other 3 parameter.\nPlease note that PaperSize, Width and Height is used only if we want to create a new Drawing document.\nThis is all for now. This post is getting too long.\nIn next post I will tell you how to create a new Assembly document and new Drawing document.\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":13,"permalink":"/solidworks-macros/open-new-document/","summary":"\u003cp\u003eAs the title suggested, in this post, we open new document \u003cstrong\u003efrom\u003c/strong\u003e \u003cem\u003eSolidworks VBA macros\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003eAlso we \u003cem\u003eunderstand\u003c/em\u003e each and every line of written code. So that you can understand why we written those lines and get some knowledge about how to write macro properly.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Open new Part document"},{"content":"Visual Basic Editor or VBE is a separate application in your CAD application.\nIn this application you write and edit your Macro code.\nThis application works without a glitch with most of the CAD programs.\nBy without a glitch I mean that your CAD program take cares of opening of VBE when you need it.\nNote\nyou can‚Äôt run the VBE separately. You CAD program must be running in order to run VBE.\nVBE Environment Below figure shows the VBE program, with some of the key parts given.\nChances are that your VBE program window won‚Äôt look exactly like that below figure.\nThe VBE contains several windows, and it‚Äôs highly customizable. You can hide windows, rearrange windows, dock windows, and so on.\nMenu Bar The VBE Menu Bar works just like every menu bar of other applications.\nIt contains commands that you use to do things with the various components in the VBE.\nYou also find that many of the menu commands have shortcut keys associated with them.\nThe VBE also features shortcut menus. You can right-click virtually anything in the VBE and get a shortcut menu of common commands.\nTool Bar The Standard toolbar, which is directly under the menu bar by default (refer to above figure), is one of four VBE toolbars available. You can customize the toolbars.\nIf you‚Äôre so inclined, use the View Toolbars command to work with VBE toolbars.\nMost people just leave them as they are.\nProject Window The Project Window display a tree diagram that shows every file opened.\nIf the Project Window is not visible, press ‚ÄúCtrl+R‚Äù or use the View -\u0026gt; Project Explorer command.\nTo hide the Project Window, click the close button in its title bar.\nCode Window Code Window is place where we write our code. Therefore this window contains VBA code.\nEvery object in a project has association with Code Window. To view the code for any object‚Äôs, double click on the object in the Project Window.\nUnless you have added some VBA code, the Code window will be empty.\nImmediate Window The Immediate window may or may not visible. If it is not visible, press ‚ÄúCtrl+G‚Äù or use View -\u0026gt; Immediate window command.\nTo close The Immediate window, click the close button in its title bar.\nThe Immediate window is most useful for executing VBA statement directly and for debugging your code.\nIf you are just starting VBA, this window won‚Äôt be all that useful, so feel free to hide it and free up some screen space.\nNext post will be about VBE Windows.\n","date":"0001-01-01","id":14,"permalink":"/vba/vba-vbe-editor/","summary":"\u003cp\u003e\u003ccode\u003eVisual Basic Editor\u003c/code\u003e or \u003ccode\u003eVBE\u003c/code\u003e is a \u003cem\u003eseparate\u003c/em\u003e application in your \u003cem\u003eCAD application\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003eIn this \u003cem\u003eapplication\u003c/em\u003e you \u003ccode\u003ewrite\u003c/code\u003e and \u003ccode\u003eedit\u003c/code\u003e your \u003cem\u003eMacro code\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Visual Basic Editor (VBE)"},{"content":"In this article we\nInstall Wix4 Visual Studio Extension Note\nThis extension help us to create Wix4 project.\nDemo Video Please see below video on how to \u0026ldquo;Install Wix4 Visual Studio Extension\u0026rdquo;.\nNote\nPlease note that there are no explanation in the video. Explanation of each step and why we write code this way is given in this post.\nOpen Visual Studio IDE: Visual Studio 2022 Community\nClick above link to download üöÄ Visual Studio 2022 Community\nOpen Visual Studio 2022 Community\nIn \u0026ldquo;Home\u0026rdquo; screen of Visual Studio, select \u0026ldquo;Continue without code\u0026rdquo; option as shown in below üëáüèª image.\nThis open Visual Studio without any project/solution as shown in below üëáüèª image. Install Extension Extension Name: HeatWave for VS2022\nOpen Extension window in Visual Studio 2022 and search for HeatWave for VS2022 as shown in below üëáüèª image. Now select \u0026ldquo;Download\u0026rdquo; option as shown in below üëáüèª image. After download close Visual Studio.\nWhen we close Visual Studio, a pop-up of VSIX Installer will come as shown in below üëáüèª image.\nNow select \u0026ldquo;Modify\u0026rdquo; button, this will install extension as shown in below üëáüèª image. Check Wix Project Template Now open Visual Studio and select Create New Solution option as shown in below üëáüèª image. This will open a new screen which shows Wix options as shown in below üëáüèª image. In this screen, we select MSI Package (Wix v4) option for creating MSI package as shown in below üëáüèª image. Now select \u0026ldquo;Next\u0026rdquo; option as shown in below üëáüèª image. In next screen we define following screen. - Project Name - Location of Solution - Name of Solution\nPlease see below üëáüèª image for reference.\nNow select \u0026ldquo;Create\u0026rdquo; option as shown in below üëáüèª image. This will create new Solution with Wix V4 project as shown in below üëáüèª image. That\u0026rsquo;s it!!!\nIn next article we will understand \u0026ldquo;File Structure of Wix V4 project\u0026rdquo;.\nHope this post helps you.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":15,"permalink":"/knowledge-base/wix-vs-extension/","summary":"\u003cp\u003eIn this article we\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cem\u003eInstall Wix4 Visual Studio Extension\u003c/em\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cdiv class=\"callout callout-note d-flex flex-row mt-4 mb-4 pt-4 pe-4 pb-2 ps-3\"\u003e\r\n  \u003csvg\n  xmlns=\"http://www.w3.org/2000/svg\"\n  width=\"24\"\n  height=\"24\"\n  viewBox=\"0 0 24 24\"\n  fill=\"none\"\n  stroke=\"currentColor\"\n  stroke-width=\"2\"\n  stroke-linecap=\"round\"\n  stroke-linejoin=\"round\"\n \n class=\"outline/info-circle svg-inline callout-icon me-2 mb-3\" id=\"svg-info-circle\" role=\"img\"\u003e\n  \u003cpath stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/\u003e\n  \u003cpath d=\"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0\" /\u003e\n  \u003cpath d=\"M12 9h.01\" /\u003e\n  \u003cpath d=\"M11 12h1v4h1\" /\u003e\n\u003c/svg\u003e\r\n  \u003cdiv class=\"callout-content\"\u003e\r\n    \u003cdiv class=\"callout-title\"\u003e\r\n        \u003cp\u003eNote\u003c/p\u003e","tags":[],"title":"Wix4 Visual Studio Extension"},{"content":"","date":"2023-09-07","id":16,"permalink":"/vba/dialog-boxes/","summary":"","tags":[],"title":"Dialog Boxes"},{"content":"","date":"2023-09-07","id":17,"permalink":"/solidworks-macros/03-sketch---rectangles/","summary":"","tags":[],"title":"Sketch - Rectangles"},{"content":"","date":"2023-09-07","id":18,"permalink":"/vba/userforms/","summary":"","tags":[],"title":"UserForms"},{"content":"Objective I want to:\nCreate WPF Prism Application Project\nAdd Synchfusion Chromeless window\nDemo Video Below üé¨ video shows how to Open Syncfusion Chromeless Window in Visual Studio 2022.\nCreate Project Open Visual Studio 2022 in your machine.\nYou will see a window as shown in below üëáüèª image.\nSelect \u0026ldquo;Create a new project\u0026rdquo; option as shown in below üëáüèª image. This will open a new screen as shown in below üëáüèª image. In this screen, select \u0026ldquo;Prism Blank App (WPF)\u0026rdquo; project type then select \u0026ldquo;Next\u0026rdquo; button as shown in below üëáüèª image. Now you will have below screen, where we need to configure our project as shown in below üëáüèª image. In this screen I use following values shown in below üëáüèª image.\nProject Name: \u0026ldquo;BrowseSolidworksDocument\u0026rdquo; Location: \u0026ldquo;D:\\Dev\u0026rdquo; Solution Name: \u0026ldquo;BrowseSolidworksDocument\u0026rdquo; When select \u0026ldquo;Next\u0026rdquo;, a new screen shows, selecting dependency injection container for project to use.\nSelected Option: \u0026ldquo;Unity\u0026rdquo; A new project open in visual studio 2022 as shown in below üëáüèª image. Add Syncfusion Chromeless Window In this section we add Syncfusion Chromeless Window.\nBuild the project as shown in below üëáüèª image. Open \u0026ldquo;NuGet Package\u0026rdquo; window as shown in below üëáüèª image. \u0026ldquo;NuGet Package\u0026rdquo; window will appear as shown in below üëáüèª image. In \u0026ldquo;NuGet Package\u0026rdquo; window, go to \u0026ldquo;Browse\u0026rdquo; tab and search for Syncfusion.Shared.WPF then install it as shown in below üëáüèª image. Now open \u0026ldquo;MainWindow.xaml\u0026rdquo; file as shown in below üëáüèª image. In \u0026ldquo;MainWindow.xaml\u0026rdquo; file add namespace as shown in below üëáüèª image. Change \u0026ldquo;Window\u0026rdquo; with \u0026ldquo;ChromelessWindow\u0026rdquo; as shown in below üëáüèª image. Final Result Now we run the application as shown in below üëáüèª image.\nWe get a message related to Syncfusion License, just do as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Open Syncfusion Chromeless Window.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":19,"permalink":"/wpf-tutorials/open-syncfusion-chromeless-window/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eI want to:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eCreate WPF Prism Application Project\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eAdd Synchfusion Chromeless window\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"demo-video\"\u003eDemo Video\u003c/h2\u003e\n\u003cp\u003eBelow üé¨ video shows how to \u003cstrong\u003eOpen Syncfusion Chromeless Window\u003c/strong\u003e in \u003cem\u003eVisual Studio 2022\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Open Syncfusion Chromeless Window"},{"content":"In this post, we see how to open following documents with Solidworks VBA macro:\nSolidworks Assembly document\nSolidworks Drawing document\nWithout Pre-defined Sheet size\nWith Pre-defined Sheet size\nWith Custom Sheet size\nSolidworks Assembly Document The code for opening default Assembly document is identical to the default Part template with only one change.\nFirst, let us see the code to open default Assembly document.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default Assembly location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default Assembly template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateAssembly) \u0026#39; Setting Solidworks document to new Assembly document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) End Sub\rAs you can see in the above code and the code is given in the previous post is almost identically.\nIn case you have not read my previous post (Solidworks Macros - Open new Part document), I recommend you to read that post first.\nI have already explained each and every line in this code there. So I will not explain them in this post.\nTo open default assembly template, you just need to change defaultTemplate variable and use swDefaultTemplateAssembly in place of swDefaultTemplatePart.\nWith this you can open a new assembly document.\nSolidworks Drawing Document without Defining Paper size To open new Default drawing document we use same code as used above but with slight modification.\nIf we make similar change as we have done for Assembly document then we open Default drawing document without specifying sheet size.\nThe code sample shows how to do it.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default drawing location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default drawing template\u0026#34; without define paper size defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateDrawing) \u0026#39; Setting Solidworks document to new drawing document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) End Sub\rSolidworks Drawing Document with Default Paper size To open a new Drawing with pre-define sheet size we use following code sample:\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default drawing location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default drawing template\u0026#34; with pre-define paper size defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateDrawing) \u0026#39; Setting Solidworks document to new drawing document Set swDoc = swApp.NewDocument(defaultTemplate, swDwgPaperSizes_e.swDwgPaperA4sizeVertical, 0, 0) End Sub\rThis code is similar to what we have used in the previous section but has a one modification.\nThat is while setting the document (at Set Doc) we define Paper size or Sheet size.\nI used A4 Sheet with vertical orientation by using swDwgPaperSizes_e.swDwgPaperA4sizeVertical enumarator.\nYou can use other values from this list.\nSolidworks Drawing Document with Custom Paper size To open a new Drawing with Custom sheet size we use following code sample:\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default drawing location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default drawing template\u0026#34; with custom paper size defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateDrawing) \u0026#39; Setting Solidworks document to new drawing document Set swDoc = swApp.NewDocument(defaultTemplate, swDwgPaperSizes_e.swDwgPapersUserDefined, 2, 3) End Sub\rFor custom paper size, we need to use swDwgPaperSizes_e.swDwgPapersUserDefined value of paper size.\nSince we are using custom value, we need to define paper width and paper height also.\nIt important to remember that API use Metric system only. So you need to use the converted value in defining paper width and paper height.\nThis is all for now. In the next post I will tell you how select a plane in a part document and if possible how to create a skecth segment.\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":20,"permalink":"/solidworks-macros/open-assembly-and-drawing/","summary":"\u003cp\u003eIn this post, we see how to open following documents with \u003cem\u003eSolidworks VBA macro\u003c/em\u003e:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003eSolidworks Assembly document\u003c/em\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003eSolidworks Drawing document\u003c/em\u003e\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Open Assembly and Drawing document"},{"content":"In this article we\nUnderstand Wix V4 Files and Project Structure\nDifferent types of files in Project Purpose of those files Wix Project In previous üöÄ Wix4 Visual Studio Extension article, we created a new Wix V4 project.\nPlease see below üëáüèª image of Visual Studio for reference.\n]\nWiX v4 MSI Package template gives us four files.\nIn order of importance, they are:\nPackage.wxs Folders.wxs ExampleComponents.wxs Package.en-us.wxl File Extensions The files have two extensions:\n.wxs .wxl Note\nwxs: WiX Source file wxl: WiX Localization file\nUnderstand [Package.wxs] Below image show content of Package.wxs\nwix\r1\u0026lt;Wix xmlns=\u0026#34;http://wixtoolset.org/schemas/v4/wxs\u0026#34;\u0026gt; 2 \u0026lt;Package Name=\u0026#34;TestApplication.MSI\u0026#34; 3 Manufacturer=\u0026#34;TODO Manufacturer\u0026#34; 4 Version=\u0026#34;1.0.0.0\u0026#34; 5 UpgradeCode=\u0026#34;f3873438-14af-4dcb-9ba2-4b474e155f08\u0026#34;\u0026gt; 6 \u0026lt;MajorUpgrade DowngradeErrorMessage=\u0026#34;!(loc.DowngradeError)\u0026#34; /\u0026gt; 7 8 \u0026lt;Feature Id=\u0026#34;Main\u0026#34;\u0026gt; 9 \u0026lt;ComponentGroupRef Id=\u0026#34;ExampleComponents\u0026#34; /\u0026gt; 10 \u0026lt;/Feature\u0026gt; 11 \u0026lt;/Package\u0026gt; 12\u0026lt;/Wix\u0026gt;\r[Wix] Element In this section, we understand [Wix] Element.\nwix\r1\u0026lt;Wix xmlns=\u0026#34;http://wixtoolset.org/schemas/v4/wxs\u0026#34;\u0026gt; 2 3\u0026lt;/Wix\u0026gt;\rXML Root Element:\nSource code we write for Wix project is xml.\nEvery XML file has a root element.\nWiX source files, that root element is Wix.\nIn above code sample, \u0026lt;Wix\u0026gt; \u0026lt;/Wix\u0026gt; is root element. Every XML element has a namespace. For WiX element,\nnamespace = http://wixtoolset.org/schemas/v4/wxs. [Package] Element In this section, we understand [Package] element.\nwix\r1\u0026lt;Package Name=\u0026#34;TestApplication.MSI\u0026#34; 2 Manufacturer=\u0026#34;TODO Manufacturer\u0026#34; 3 Version=\u0026#34;1.0.0.0\u0026#34; 4 UpgradeCode=\u0026#34;f3873438-14af-4dcb-9ba2-4b474e155f08\u0026#34;\u0026gt; 5 6\u0026lt;/Package\u0026gt;\r[Package] element describes about MSI package. [Package] element has attributes and child elements that define everything about an MSI package. Note\nName=\u0026ldquo;TestApplication.MSI\u0026rdquo; Manufacturer=\u0026ldquo;TODO Manufacturer\u0026rdquo; Version=\u0026ldquo;1.0.0.0\u0026rdquo; UpgradeCode=\u0026ldquo;f3873438-14af-4dcb-9ba2-4b474e155f08\u0026rdquo;\nNote\nAbove attributes are REQUIRED.\nWithout them Wix will not work.\nName:\nThe Name attribute sets the name of the package. This name is shown in the Installed apps list. Manufacturer:\nThe Manufacturer attribute sets the name of the company that created the software included in the installer. This string is shown in Add/Remove Programs. Version\nThe Version attribute sets the version of the package. The package version is shown in Add/Remove Programs. Package versions are an important part of managing upgrades between packages. Versions typically have four parts \u0026ndash; major.minor.build.patch UpgradeCode\nThe UpgradeCode attribute is important to recognize a package. This UpgradeCode attribute is a GUID [Globally Unique Identifier] [MajorUpgrade] Element In this section, we understand [MajorUpgrade] element.\nwix\r1\u0026lt;MajorUpgrade DowngradeErrorMessage=\u0026#34;!(loc.DowngradeError)\u0026#34; /\u0026gt;\rMajorUpgrade\nThe MajorUpgrade Element is important to recognize a package. It link with UpgradeCode code we discuss previously. When we try to install a lower version than the version that\u0026rsquo;s already installed. The DowngradeErrorMessage attribute let us specify a message to be shown. The !(loc.DowngradeError) syntax is a reference to a localization string i.e. string message to shown. [Feature] Element In this section, we understand [Feature] element.\nwix\r1\u0026lt;Feature Id=\u0026#34;Main\u0026#34;\u0026gt; 2 3\u0026lt;/Feature\u0026gt;\rMSI lets you have a hierarchy of features in a package to control what gets installed.\nCurrently features aren\u0026rsquo;t shown, but MSI still requires at least one feature.\n[ComponentGroupRef] Element In this section, we understand [ComponentGroupRef] element.\nwix\r1\u0026lt;ComponentGroupRef Id=\u0026#34;ExampleComponents\u0026#34; /\u0026gt;\rWe have our first XML parent/child relationship. The ComponentGroupRef element is a child of the Feature element. The ComponentGroupRef element is used to \u0026ldquo;fill\u0026rdquo; the feature described by the Feature element. The ComponentGroupRef element \u0026ldquo;fill\u0026rdquo; the feature by components, references, and groups. Understand [Folders.wxs] Below image show content of Folders.wxs\nwix\r1\u0026lt;Wix xmlns=\u0026#34;http://wixtoolset.org/schemas/v4/wxs\u0026#34;\u0026gt; 2 \u0026lt;Fragment\u0026gt; 3 \u0026lt;StandardDirectory Id=\u0026#34;ProgramFiles6432Folder\u0026#34;\u0026gt; 4 \u0026lt;Directory Id=\u0026#34;INSTALLFOLDER\u0026#34; 5 Name=\u0026#34;!(bind.Property.Manufacturer) !(bind.Property.ProductName)\u0026#34; /\u0026gt; 6 \u0026lt;/StandardDirectory\u0026gt; 7 \u0026lt;/Fragment\u0026gt; 8\u0026lt;/Wix\u0026gt;\r[Wix] Element In this section, we understand [Wix] Element.\nwix\r1\u0026lt;Wix xmlns=\u0026#34;http://wixtoolset.org/schemas/v4/wxs\u0026#34;\u0026gt; 2 3\u0026lt;/Wix\u0026gt;\r[Folders.wxs] has the same root element and namespace as for [Package.wxs].\nThe same is true of every WiX source file.\nXML Root Element:\nSource code we write for Wix project is xml.\nEvery XML file has a root element.\nWiX source files, that root element is Wix.\nIn above code sample, \u0026lt;Wix\u0026gt; \u0026lt;/Wix\u0026gt; is root element. Every XML element has a namespace. For WiX element,\nnamespace = http://wixtoolset.org/schemas/v4/wxs. [Fragment] Element In this section, we understand [Fragment] element.\nwix\r1\u0026lt;Fragment\u0026gt; 2 3\u0026lt;/Fragment\u0026gt;\rIn [Folders.wxs] file, [Fragment] is main element.\n[Fragment] is a way to organize authoring.\nIn [Folders.wxs], there is one [Fragment] that contains authoring that\u0026rsquo;s referenced from [Package.wxs].\nYou can have multiple [Fragments] in a single [.wxs] file.\n[StandardDirectory] Element In this section, we understand [StandardDirectory] element.\nwix\r1\u0026lt;StandardDirectory Id=\u0026#34;ProgramFiles6432Folder\u0026#34;\u0026gt; 2 3\u0026lt;/StandardDirectory\u0026gt;\rThe [StandardDirectory] element lets you use one of the standard directories as the parent directory of our package\u0026rsquo;s directories.\nThere are large amount of possible parent directories.\nNote\nPlease visit üöÄStandardDirectoryType Types page to get a list of all possible parent directories.\nBelow are the WiX standard directories:\nCommonFiles6432Folder ProgramFiles6432Folder System6432Folder Note\nAbove ids are special.\nWiX picks the appropriate directory based on the bitness of the package.\nWith a 32-bit package, ProgramFiles6432Folder resolves as ProgramFilesFolder, which is typically C:\\Program Files (x86).\nWith a 64-bit package, ProgramFiles6432Folder resolves as ProgramFiles64Folder, which is typically C:\\Program Files.\n[Directory] Element In this section, we understand [Directory] element.\nwix\r1\u0026lt;Directory Id=\u0026#34;INSTALLFOLDER\u0026#34; 2 Name=\u0026#34;!(bind.Property.Manufacturer) !(bind.Property.ProductName)\u0026#34; /\u0026gt;\rThe [Directory] element creates a new directory as a child directory of the directory identified in its parent directory.\n[Id] : The Id attribute specify an id that we\u0026rsquo;ll use when referencing this directory.\n[Name] : The Name attribute is the name of the directory on disk.\nAs we defined various attributes in [Package.wxs] element.\nWe can indirectly reference those attributes in our Name attribute.\n!(bind.Property.Manufacturer) takes the value of the [Package/Manufacturer] attribute\n!(bind.Property.ProductName) takes the value of the [Package/Name] attribute.\nSo\nwix\r1\u0026lt;Directory Id=\u0026#34;INSTALLFOLDER\u0026#34; 2 Name=\u0026#34;TODO Manufacturer !(bind.Property.ProductName)\u0026#34; /\u0026gt;\ris equivalent to\nwix\r1\u0026lt;Directory Id=\u0026#34;INSTALLFOLDER\u0026#34; 2 Name=\u0026#34;TODO Manufacturer TestApplication.MSI\u0026#34; /\u0026gt;\rUnderstand [ExampleComponents.wxs] Below image show content of ExampleComponents.wxs\nwix\r1\u0026lt;Wix xmlns=\u0026#34;http://wixtoolset.org/schemas/v4/wxs\u0026#34;\u0026gt; 2 \u0026lt;Fragment\u0026gt; 3 \u0026lt;ComponentGroup Id=\u0026#34;ExampleComponents\u0026#34; Directory=\u0026#34;INSTALLFOLDER\u0026#34;\u0026gt; 4 \u0026lt;Component\u0026gt; 5 \u0026lt;File Source=\u0026#34;ExampleComponents.wxs\u0026#34; /\u0026gt; 6 \u0026lt;/Component\u0026gt; 7 \u0026lt;/ComponentGroup\u0026gt; 8 \u0026lt;/Fragment\u0026gt; 9\u0026lt;/Wix\u0026gt;\r[Wix] Element wix\r1\u0026lt;Wix xmlns=\u0026#34;http://wixtoolset.org/schemas/v4/wxs\u0026#34;\u0026gt; 2 3\u0026lt;/Wix\u0026gt;\r[ExampleComponents.wxs] has the same root element and namespace as for [Package.wxs].\nThe same is true of every WiX source file.\n[Fragment] Element [Fragment] element is same as we discussed üöÄ previously.\nwix\r1\u0026lt;Fragment\u0026gt; 2 3\u0026lt;/Fragment\u0026gt;\r[ComponentGroup] Element In this section, we understand [ComponentGroup] element.\nwix\r1\u0026lt;ComponentGroup Id=\u0026#34;ExampleComponents\u0026#34; Directory=\u0026#34;INSTALLFOLDER\u0026#34;\u0026gt; 2 3\u0026lt;/ComponentGroup\u0026gt;\rThis is the very same component group that we referenced with a [ComponentGroupRef] element, back in [Package.wxs], under the [Feature] element.\nAll the components are grouped together and brought in as one piece under the parent feature i.e. [ComponentGroup] element.\n[Id] : The Id attribute specify an id that we\u0026rsquo;ll use when referencing this [ComponentGroup] element.\nName of [ComponentGroup] element is ExampleComponents. [Directory] : The Directory attribute is the name of the directory on disk under which all files get installed.\n[Component] Element In this section, we understand [Component] element.\nwix\r1\u0026lt;Component\u0026gt; 2 \u0026lt;File Source=\u0026#34;ExampleComponents.wxs\u0026#34; /\u0026gt; 3\u0026lt;/Component\u0026gt;\rThere is ONLY one [component] in our [ComponentGroup] element.\nThis [component] has a single file in it.\nThe name of that file is [ExampleComponents.wxs].\nUnderstand [Package.en-us.wxl] Below image show content of Package.en-us.wxl\nwix\r1\u0026lt;!-- 2This file contains the declaration of all the localizable strings. 3--\u0026gt; 4\u0026lt;WixLocalization xmlns=\u0026#34;http://wixtoolset.org/schemas/v4/wxl\u0026#34; Culture=\u0026#34;en-US\u0026#34;\u0026gt; 5 6 \u0026lt;String Id=\u0026#34;DowngradeError\u0026#34; 7 Value=\u0026#34;A newer version of [ProductName] is already installed.\u0026#34; /\u0026gt; 8 9\u0026lt;/WixLocalization\u0026gt;\r\u0026lt;!-- This file contains the declaration of all the localizable strings. --\u0026gt;\rThis is an xml comment we write as a Note for us. \u0026lt;WixLocalization xmlns=\u0026#34;http://wixtoolset.org/schemas/v4/wxl\u0026#34; Culture=\u0026#34;en-US\u0026#34;\u0026gt;\rAs localization files are not [WiX] source files, they use a different root element and namespace.\n[Culture] : The Culture attribute identifies the culture (language and region) used in the localization.\nNote\n[Culture] is the name of a culture following the rules of the üöÄ .NET [CultureInfo] üöÄ class which itself follows the Internet standard.\n\u0026lt;String Id=\u0026#34;DowngradeError\u0026#34; Value=\u0026#34;A newer version of [ProductName] is already installed.\u0026#34; /\u0026gt;\rLocalization files usually contain a number of strings.\nEach string has an [id] and a [value].\n[DowngradeError] string is used back in [Package.wxs] to provide an error message for the [MajorUpgrade] element:\n\u0026lt;MajorUpgrade DowngradeErrorMessage=\u0026#34;!(loc.DowngradeError)\u0026#34; /\u0026gt;\rThe [!(loc.DowngradeError)] syntax is how you refer to a localization string by its [id]. That\u0026rsquo;s it!!!\nHope this post helps you.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":21,"permalink":"/knowledge-base/wix-understand-project/","summary":"\u003cp\u003eIn this article we\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003eUnderstand \u003cstrong\u003eWix V4 Files\u003c/strong\u003e and \u003cstrong\u003eProject Structure\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cem\u003eDifferent types of files in Project\u003c/em\u003e\u003c/li\u003e\n\u003cli\u003e\u003cem\u003ePurpose of those files\u003c/em\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"wix-project\"\u003eWix Project\u003c/h2\u003e\n\u003cp\u003eIn previous üöÄ \u003cstrong\u003e\u003ca href=\"/knowledge-base/wix-vs-extension\" target=\"_blank\"\u003eWix4 Visual Studio Extension\u003c/a\u003e\u003c/strong\u003e article, we created a new Wix V4 project.\u003c/p\u003e","tags":[],"title":"Understand Wix V4 Project"},{"content":"In this post we look at the following windows in Visual Basic Editor:\nProject Window Code Window Project Window When you are working in VBE, each file open is called a Project.\nYou can think of a project as a collection of objects.\nYou can expand a project by clicking the plus sign (+) at the left of the project‚Äôs name in the Project window.\nContract a project by clicking the minus sign (-) to the left of the project‚Äôs name in the Project window. Or you can simply double-click the items to expand or contract them.\nEvery project expands to show at least one node. In our previous image we have SOLIDWORKS Objects. This node expands to show an item for Solidworks application.\nIf the project has any VBA module, the project listing also shows a Module node.\nA project can also contain a node called Forms, which contains UserForm objects (which hold custom dialog boxes).\nThe concept of Object may not be clear to you at this moment. However, things become much clearer in subsequent topics.\nDon‚Äôt be too concerned if you don‚Äôt understand what‚Äôs going on at this point.\nAdding a New VBA Module Follow the steps below to add a new VBA module to a project:\nSelect the project\u0026rsquo;s name in the Project Window. Select Insert ‚Üí Module. or\nRight-click the project‚Äôs name. Select Insert ‚Üí Module from the shortcut menu. When you record a macro or create a blank macro, Solidworks automatically adds a module to hold the code.\nRemoving a VBA Module If you want to remove a module from the Project window, follow the steps below:\nSelect the module\u0026rsquo;s name in the Project Window. Select File ‚Üí Remove. Or\nRight-click the module‚Äôs name. Select Remove from the shortcut menu. VBE always tries to keep you from doing something that you will regret, hence it will ask if you want to export the code in the module before deleting the code.\nAnd in most cases, you don‚Äôt want to export. If you do want to export the code, please see the next section.\nExporting and Importing Objects Every object in a VBA project can be saved to a separate file. Saving an individual object in a project is known as exporting.\nThe reason for exporting a file is that you can also import objects into a project.\nExporting and importing objects might be useful if you want to use a particular object (such as a VBA module or a UserForm) in a different project.\nBelow are the steps to export an object:\nSelect an object in the Project window. Select File ‚Üí Export File or press Ctrl + E. You get a dialog box that asks for a filename. Note that the object remains in the original project; only a copy of the object is exported.\nImporting an object is also a similar process, which is shown below:\nSelect the project‚Äôs name in the Explorer window. Select File ‚Üí Import File or press Ctrl + M. You get a dialog box that asks for a file. Locate the file and click open.\nYou should only import a file if it was exported by using the File ‚Üí Export File command.\nCode Window As you become proficient with VBA, you spend a lot of time working in the Code window.\nMacros that you record are stored in a module, and you can type VBA code directly into a VBA module.\nMinimize and Maximize Code Windows If you have several projects open, the VBE may have lots of Code windows at any given time. Below is an example of this.\nCode windows are much like your files opened in Solidworks. You can minimize them, maximize them, resize them, hide them, and so on.\nMost people find it much easier to maximize the code window that they are working on. Doing so lets you see more code and keeps you from getting distracted.\nTo maximize the Code window, click the maximize button in its title bar or just double-click the title bar of the Code window to maximize it.\nTo restore a window to its original size, click the restore button. When the Code window is maximized, its title bar is not visible, so you will find the restore below the VBE title bar.\nSometimes you want to have two or more Code windows visible.\nFor example, you may want to compare the code in two modules or copy code from one module to another.\nYou can arrange the windows manually, or use the Window ‚Üí Tile Horizontally or Window ‚Üí Tile Vertically command to arrange them automatically.\nYou can quickly switch among code windows by pressing Ctrl + Tab. If you repeat that key combination, you keep cycling through all the open code windows.\nPressing Ctrl + Shift + Tab cycles through the windows in reverse order.\nMinimizing a window gets it out of the way. You can also click the window close button in a Code window‚Äôs title bar to close the window completely. (Closing a window just hides it; you won‚Äôt lose anything.)\nTo open it again, just double-click the appropriate object in the Project window. Working with these Code windows sounds more difficult than it really is.\nCreating a Module In general, a VBA module can hold three types of code:\nDeclaration: One or more information statements that you provide to VBA. For example, you can declare the data type for variables you plan to use, or set some other module-wide options. Sub procedures: A set of programming instructions that perform some actions. Function procedures: A set of programming instructions that return a single value. A single VBA module can store any number of Sub procedures, Function procedures, and declarations.\nWell, there is a limit ‚Äì about 64,000 characters per module. It is very rare that anybody reaches that limit, but if someone does, the solution is simply to insert a new module.\nHow you organize a VBA module is totally up to you. Some people prefer to keep all their VBA code in a single module; others (like me) like to split up the code into several different modules or even classes. It is a personal choice, like arranging furniture.\nInserting VBA Code into a Module An empty VBA module is like the fake food you see in advertisements. It looks good but it does not really do much.\nBefore you can do anything meaningful, you must have some VBA code in the VBA module. You can insert VBA code into a VBA module in three ways:\nInsert code directly into the code window. Use the macro recorder to record your actions and convert them into VBA code. Copy the code from one module and paste it into another module. Entering Code Directly into a Module Sometimes the best route is the most direct one. Entering the code directly involves typing the code via your keyboard.\nEntering and editing text in a VBA module works as you might expect. You can select, copy, cut, paste, and do other things as you do in other word processing software.\nUse the Tab key to indent some of the lines to make your code easier to read. This is not necessary, but it is a good habit to acquire.\nAs you go through, you will understand why indenting code lines is helpful.\nA single line of VBA code can be as long as you like.\nHowever, you may want to use the line-continuation character to break up a lengthy line of code.\nTo continue a single line of code (also known as a statement) from one line to the next, end the first line with a space followed by an underscore (_). Then continue the statement on the next line.\nBelow is an example of a single statement split into two lines:\nvba\r1set swPart = swApp.NewDocument(swApp.GetUserPreferenceStringValue _ 2 (swUserPreferenceStringValue_e.swDefaultTemplatePart),0,0,0)\rThis statement would perform the same way if it were entered in a single line (with no continuation characters).\nNotice that I indented the second line of the statement. Indenting is optional but it clarifies the fact that these lines are not separate statements.\nNote\nIf you are wondering what the above statement does, then the answer is: it opens a new part with the default part template in SolidWorks. This code is not inserted using the macro recorder; instead, I wrote it manually to find a default part template and use that template to open a new part.\nThe engineers who designed VBE knew that people like us would be making mistakes. Therefore, the VBE has multiple levels of Undo and Redo.\nIf you deleted a statement that you should not have, use the Undo button on the toolbar (or press Ctrl+Z) until the statement shows up.\nAfter undoing, you can use the Redo button to perform the changes you have undone. This redo/undo stuff is much like you use in other software. Until you use it, you cannot understand.\nReady to enter some live code? Try the following steps:\nGo to your VBE. Double-click your module if it is not open. Go to the Code Window. Type the following code into the Code window: vba\r1Sub GuessName() 2 Msg = \u0026#34;Is this a CAD Software?\u0026#34; 3 Ans = MsgBox(Msg, vbYesNo) 4 If Ans = vbNo Then MsgBox \u0026#34;Oh, that‚Äôs fine.\u0026#34; 5 If Ans = vbYes Then MsgBox \u0026#34;You must be joking!\u0026#34; 6End Sub\rMake sure the cursor is located anywhere within the text you typed, and then press F5 to execute the procedure. F5 is a shortcut for the Run ‚Üí Run Sub/UserForm command.\nIf you entered the code correctly, VBE will execute the procedure, and you can respond to the simple dialog box as shown in the figure below.\nWhen you enter the code listed in step 4, you might notice that the VBE makes some adjustments to the text you enter.\nFor example, after you type the Sub statement, the VBE automatically inserts the End Sub statement, and if you omit the space before or after an equal sign, the VBE inserts the space for you.\nAlso, the VBE changes the color and capitalization of some text. This is all perfectly normal. It is just VBE‚Äôs way of keeping things neat and readable.\nIf you followed the previous steps, you just wrote a VBA Sub procedure, also known as a macro.\nWhen you press F5, VBE executes the code and follows the instructions.\nIn other words, VBE evaluates each statement and does what you told it to do.\nThis simple macro uses the following concepts:\nDefining a Sub procedure (the first line). Assigning values to variables (Msg and Ans). Using a built-in VBA function (MsgBox). Using built-in VBA constants (vbYesNo, vbNo, and vbYes). Using an If-Then construct (twice). Ending a Sub procedure (the last line). Using the Macro Recorder Another way you can get code into a VBA module is by recording your actions, using the in-built macro recorder.\nBy the way, there is absolutely no way you can record the GuessName procedure shown in the preceding section.\nYou can record only things that you can do directly in Solidworks.\nDisplaying a message box is not in the application\u0026rsquo;s normal repertoire. The macro recorder is useful, but in many cases, you‚Äôll probably need to enter at least some code manually.\nWe have already seen how macros are recorded. So there is no need for us to go over the same thing twice. If you want to see how it is done, go to VBA in Solidworks topic.\nCopying VBA Code The final method for getting code into a VBA module is to copy it from another module or from some other place (such as a website, e.g., Solidworks forum).\nFor example, a Sub or Function procedure that you write for one project might also be useful in another project.\nInstead of wasting time re-entering the code, you can activate the module and use the normal Clipboard copy-and-paste procedures.\nAfter pasting it into a VBA module, you can modify the code if necessary.\nYou‚Äôll also find lots of VBA code examples on the web.\nIf you‚Äôd like to try them, select the code in your browser and press Ctrl+C to copy it. Then, activate a module and press Ctrl+V to paste it.\nNext post will be about Sub and Function Procedures.\n","date":"0001-01-01","id":22,"permalink":"/vba/vba-windows/","summary":"\u003cp\u003eIn this post we look at the following windows in \u003ccode\u003eVisual Basic Editor\u003c/code\u003e:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eProject Window\u003c/li\u003e\n\u003cli\u003eCode Window\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"project-window\"\u003eProject Window\u003c/h2\u003e\n\u003cp\u003eWhen you are working in \u003ccode\u003eVBE\u003c/code\u003e, each file open is called a Project.\u003cbr\u003e\nYou can think of a \u003ccode\u003eproject\u003c/code\u003e as a \u003ccode\u003ecollection\u003c/code\u003e of objects.\u003c/p\u003e","tags":[],"title":"VBE Windows"},{"content":"","date":"2023-09-07","id":23,"permalink":"/solidworks-macros/04-sketch---circles/","summary":"","tags":[],"title":"Sketch - Circles"},{"content":"Objective I want to:\nAdd Syncfusion Busy Indicator\nUse Syncfusion Busy Indicator, for Long operation\nWe will continue from previous article üöÄ Open Syncfusion Chromeless Window.\nAdd new controls to previous code.\nDemo Video Below üé¨ video shows how to Add Syncfusion Busy Indicator in Visual Studio 2022.\nAdd Syncfusion Busy Indicator In this section we add Busy Indicator Window.\nBuild the project as shown in below üëáüèª image. Open \u0026ldquo;NuGet Package\u0026rdquo; window as shown in below üëáüèª image. \u0026ldquo;NuGet Package\u0026rdquo; window will appear as shown in below üëáüèª image. In \u0026ldquo;NuGet Package\u0026rdquo; window, go to \u0026ldquo;Browse\u0026rdquo; tab and search for Syncfusion.SfBusyIndicator.WPF then install it as shown in below üëáüèª image. Now open \u0026ldquo;MainWindow.xaml\u0026rdquo; file as shown in below üëáüèª image. Change \u0026ldquo;MainWindow.xaml\u0026rdquo; file as shown in below üëáüèª image. Please see below üëáüèª code.\nwix\r1\u0026lt;syncfusion:SfBusyIndicator IsBusy=\u0026#34;{Binding IsBusy,Mode=TwoWay}\u0026#34; AnimationType=\u0026#34;Gear\u0026#34;\u0026gt; 2 \u0026lt;ContentControl prism:RegionManager.RegionName=\u0026#34;ContentRegion\u0026#34; /\u0026gt; 3\u0026lt;/syncfusion:SfBusyIndicator\u0026gt;\rAdd Button element with binding command and properties as shown in below üëáüèª image. wix\r\u0026lt;Button Content=\u0026#34;{Binding ButtonContent}\u0026#34; Height=\u0026#34;50\u0026#34; Width=\u0026#34;300\u0026#34; Command=\u0026#34;{Binding ClickCommand}\u0026#34; /\u0026gt;\rAdd Binding Properties And Command Open \u0026ldquo;MainWindowViewModel.cs\u0026rdquo; file as shown in below üëáüèª image. Add IsBusy Property as shown in below üëáüèª image. C#\r1private bool _isBusy; 2public bool IsBusy 3{ 4 get { return _isBusy; } 5 set { SetProperty(ref _isBusy, value); } 6}\rAdd ButtonContent Property as shown in below üëáüèª image. C#\rprivate string _buttonContent; public string ButtonContent { get { return _buttonContent; } set { SetProperty(ref _buttonContent, value); } }\rSet value of _buttonContent field as shown in below üëáüèª image. C#\rprivate string _buttonContent = \u0026#34;Click me for long task!\u0026#34;; public string ButtonContent { get { return _buttonContent; } set { SetProperty(ref _buttonContent, value); } }\rAdd ClickCommand Prism Command as shown in below üëáüèª image. C#\rprivate DelegateCommand _clickCommand; public DelegateCommand ClickCommand =\u0026gt; _clickCommand ?? (_clickCommand = new DelegateCommand(ExecuteClickCommand)); void ExecuteClickCommand() { }\rClick Command Statements Now we add following statements to click command.\nFirst we set the value of IsBusy property to true.\nThis means we want to show Busy Indicator.\nPlease add below code as shown below üëáüèª.\nC#\rvoid ExecuteClickCommand() { // Show busy indicator IsBusy = true; }\rNext we run a new Thread.\nThis Thread, imitate a long task.\nAdd new Thread as shown in below üëáüèª image.\nPlease add below code as shown below üëáüèª. C#\rasync void ExecuteClickCommand() { // Show busy indicator IsBusy = true; await Task.Run(() =\u0026gt; { }); }\rIn above code, we use async and await keywords.\nThese keywords, help us to do asynchronous programming.\nThis Task.Run() method, run a new Thread and free UI thread.\nThis await keyword, watch if this Task is completed or not.\nNow we add statement to make new Thread sleep for 5 sec.\nTo sleep new Thread, add code as shown in below üëáüèª image.\nC#\rasync void ExecuteClickCommand() { // Show busy indicator IsBusy = true; await Task.Run(() =\u0026gt; { // Sleeping with 5 sec Thread.Sleep(5000); }); }\rLastly, we set the value of IsBusy property to false as shown in below üëáüèª image. This means we want to hide Busy Indicator.\nPlease add below code as shown below üëáüèª.\nC#\rasync void ExecuteClickCommand() { // Show busy indicator IsBusy = true; await Task.Run(() =\u0026gt; { // Sleeping with 5 sec Thread.Sleep(5000); }); // Hide busy indicator IsBusy = false; }\rFinal Result Now we run the application as shown in below üëáüèª image.\nUntil the Thread is sleeping we able to see Busy indicator to show user that some operation is running.\nUntil the operation complete, we see this Busy indicator.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Add Syncfusion Busy Indicator.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":24,"permalink":"/wpf-tutorials/add-syncfusion-busy-indicator/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eI want to:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eAdd Syncfusion Busy Indicator\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eUse Syncfusion Busy Indicator, for Long operation\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eWe will continue from previous article üöÄ \u003cstrong\u003e\u003ca href=\"/wpf-tutorials/open-syncfusion-chromeless-window/\" target=\"_blank\"\u003eOpen Syncfusion Chromeless Window\u003c/a\u003e\u003c/strong\u003e.\u003c/p\u003e","tags":[],"title":"Add Syncfusion Busy Indicator"},{"content":"In this post, we select Default planes with following methods:\nBy SelectByID method From ModelDoc2 Interface\nBy SelectByID2 method From IModelDocExtension Interface\nBy SelectByID method From ModelDoc2 Interface SelectByID method From ModelDoc2 Interface is the easiest method for selecting Default plane.\nI will explain the use of this method in 2 different scenerio as follows:\nUsing this method in the previous example of creating a new document and then select a Plane.\nUsing this method in an open document.\nUsing SelectByID method in previous example In the previous 2 posts, we learned how to create a new part document, an assembly document, and a drawing document.\nNow we use the same code and extended it for using selecting planes.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.SelectByID(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0) End Sub\rAbove code, 1st create a new part document and then select \u0026ldquo;Front Plane\u0026rdquo; in VBA macro.\nTo select the plane, I have to add 2 lines. 1st I create a boolean varible above main function as shown in below code:\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rThen I use this BoolStatus variable to selecting Front Plane as shown in below code:\n\u0026#39; Selecting Front Plane BoolStatus = swDoc.SelectByID(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0)\rSelectByID takes following parameters:\nName : Name of the object or an empty string\nType : Type of object in uppercase or an empty string\nX : X selection location\nY : Y selection location\nZ : Z selection location\nReturn Value -\nIf the item is select then this method returns True and otherwise False.\nSince this method returns True or False, hence we use a boolean variable to perfom this method.\nIf we want to select Right Plane then we just need to replace \u0026quot;Front Plane\u0026quot; -\u0026gt; \u0026quot;Right Plane\u0026quot; in previous code sample.\nSimilar for selecting Top Plane, we need to replace \u0026quot;Front Plane\u0026quot; -\u0026gt; \u0026quot;Top Plane\u0026quot; in previous code sample.\nUsing SelectByID method in an Open document For using SelectByID method in an open document we use differnet code sample.\nThe code sample is given below:\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Setting Solidworks document to active open document Set swDoc = swApp.ActiveDoc \u0026#39; Selecting Front Plane BoolStatus = swDoc.SelectByID(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0) End Sub\rMost of the things in this code sample is already explained previous post and in previous section of this very post.\nIn this code I have set the Solidworks document variable swDoc to active open document.\nAnd then we use similar method to select \u0026ldquo;Front Plane\u0026rdquo;.\nAs explained in previous section we can select Right Plane and Top Plane.\nBy SelectByID2 method From IModelDocExtension Interface This method is similar to SelectByID from previous section infact it is the updated version of previous method.\nSince it is updated and has additional functionality, I will explain it I frequently use this method. Previous method is easiest method, by far, for selecting objects.\nSince SelectByID2 is updated version of SelectByID it has similar syntax and usage.\nI will explain the use of SelectByID2 method in 2 different scenerio as done in previous method:\nUsing this method in the previous example of creating a new document and then select a Plane.\nUsing this method in an open document.\nUsing SelectByID2 method in previous example Now we use the same code and extended it for using selecting planes by SelectByID2 method.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) End Sub\rThis method is doing the same thing which I already explained in the previous method.\nThe difference is in the syntax and input parameters.\n\u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rAs you can see from the above code sample, this method is a method of Extension interface/object.\nThis Extension interface/object is part of swDoc variable. This variable is the type of ModelDoc2 interface/object.\nApart from that, we need to give additional input parameters also.\nBelow I have explained about the input parameters of SelectByID2 method:\nName : Name of the object or an empty string\nType : Type of object in uppercase or an empty string\nX : X selection location\nY : Y selection location\nZ : Z selection location\nAppend : True or False. It is used the adding the selection into selection list.\nMark : Value you want to use as a Mark; this value is used by other functions that require ordered selection.\nCallout : Pointer to the Callout interface/object. (Default value most of the time is nothing.)\nSelectOption : Selection option. You can use either swSelectOptionDefault or swSelectOptionExtensive value.\nReturn Value -\nIf the item is select then this method returns True and otherwise False.\nThere is a lot more about this method in the Remark section. For more information visit here.\nSince this method returns True or False, here also we use a boolean variable to perfom this method.\nIf we want to select Right Plane then we just need to replace \u0026quot;Front Plane\u0026quot; -\u0026gt; \u0026quot;Right Plane\u0026quot; in previous code sample.\nSimilar for selecting Top Plane, we need to replace \u0026quot;Front Plane\u0026quot; -\u0026gt; \u0026quot;Top Plane\u0026quot; in previous code sample.\nUsing SelectByID2 method in an Open document For using SelectByID2 method in an open document we use same code sample as used in previous method.\nThe code sample is given below:\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Setting Solidworks document to active open document Set swDoc = swApp.ActiveDoc \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) End Sub\rMost of the things in this code sample is already explained previous post and in previous section of this very post.\nIn this code I have set the Solidworks document variable swDoc to active open document.\nAnd then we use similar method to select \u0026ldquo;Front Plane\u0026rdquo;.\nAs explained in previous section we can select Right Plane and Top Plane.\nThis is all for now. This post is getting too long.\nIn next post we learn about Open Saved Documents.\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":25,"permalink":"/solidworks-macros/select-plane-from-tree/","summary":"\u003cp\u003eIn this post, we select \u003cstrong\u003eDefault planes\u003c/strong\u003e with following methods:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eBy \u003ccode\u003eSelectByID\u003c/code\u003e method From \u003ccode\u003eModelDoc2\u003c/code\u003e Interface\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eBy \u003ccode\u003eSelectByID2\u003c/code\u003e method From \u003ccode\u003eIModelDocExtension\u003c/code\u003e Interface\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Selection Methods"},{"content":"The VBA code that you write in the Visual Basic Editor is known as a procedure.\nThe two most common types of procedures are Sub and Function.\nA Sub procedure is a group of VBA statements that performs an action (or actions). A Function procedure is a group of VBA statements that performs a calculation and returns a single value. Most of the macros you write in VBA are Sub procedures.\nYou can think of a Sub procedure as being like a command: \u0026ldquo;Execute the Sub procedure and something happens\u0026rdquo;.\nExactly what happens depends on the Sub procedure‚Äôs VBA code.\nA Function is also a procedure, but it‚Äôs quite different from a Sub.\nFor understanding a Function let‚Äôs take an example from MS Excel.\nExcel includes many worksheet functions that you use every day. Examples include SUM. This SUM function takes input in form of values and then it does calculation behind the scene, and then returns a single value.\nThe same goes for Function procedure that you develop with VBA.\nSub procedures Every Sub procedure starts with the keyword Sub and ends with an End Sub statement. Here‚Äôs an example:\nvba\r1Sub Message() 2 MsgBox \u0026#34;That‚Äôs all folks!\u0026#34; 3End Sub\rThis example shows a procedure named Message. A set of parentheses follows the procedure‚Äôs name.\nIn most cases, these parentheses are empty. However, you may pass arguments to Sub procedures from other procedures.\nIf your Sub uses arguments, list them between the parentheses.\nNote\nPlease remember when you record a macro with the macro recorder; the result is always a Sub procedure.\nFunction procedures Every Function procedure starts with the keyword Function and ends with an End Function statement.\nHere‚Äôs an example:\nvba\r1Function CubeRoot(number) 2 CubeRoot = number ^ (1/3) 3End Function\rThis function, named CubeRoot, takes one argument (named number), which is enclosed in parentheses.\nFunctions can have any number of arguments or none at all.\nWhen you execute the function, it returns a single value ‚Äî the cube root of the argument passed to the function.\nVBA allows you to specify what type of information (also known as data type) is returned by a Function procedure.\nYou can execute a Function procedure from another procedure (a Sub or another Function procedure).\nNote\nPlease note that no matter how hard you try, you can‚Äôt use the macro recorder to record a Function procedure. You must manually enter every Function procedure that you create.\nNaming Subs and Functions Like humans \u0026amp; pets, every Sub and Function procedure must have a name.\nAlthough it is perfectly acceptable to name anything what you want, it‚Äôs usually not a good idea to use such a freewheeling attitude when naming procedures.\nWhen naming procedures, you must follow a few rules:\nYou can use letters, numbers, and some punctuation characters, but the first character must be a letter. You can‚Äôt use any spaces or periods in the name. VBA does not distinguish between uppercase and lowercase letters. You can‚Äôt embed any of the following characters in a procedure name: *#, $, %, \u0026amp;, @, ^, , or ! Procedure names can be no longer than 255 characters. (Of course, you would never make a procedure name this long.) Ideally, a procedure‚Äôs name describes the routine‚Äôs purpose.\nSome programmers prefer using sentence-like names that provide a complete description of the procedure.\nSome examples include WriteReportToTextFile and Get_Print_Options_and_Print_Report.\nThe use of such lengthy names has pros and cons.\nOn the one hand, such names are descriptive and usually unambiguous. On the other hand, they take longer to type.\nEveryone develops a naming style, but the main objectives are to make the names descriptive and to avoid meaningless names such as Update, Fix, and Macro1.\nNext post will be about Executing Sub \u0026amp; Function procedures\n","date":"0001-01-01","id":26,"permalink":"/vba/sub-and-function-procedure/","summary":"\u003cp\u003eThe \u003ccode\u003eVBA\u003c/code\u003e code that you write in the \u003ccode\u003eVisual Basic Editor\u003c/code\u003e is known as a \u003ccode\u003eprocedure\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eThe two most common types of procedures are \u003ccode\u003eSub\u003c/code\u003e and \u003ccode\u003eFunction\u003c/code\u003e.\u003c/p\u003e","tags":[],"title":"Sub and Function Procedures"},{"content":"In this article we create MSI Details for Add/Remove Program details.\nPlease see below üëáüèª image of Visual Studio for reference.\nAdd [WPF Project] For this demo, I added a sample WPF Project.\nPlease see below üëáüèª image of [sample WPF Project] for reference.\nApplication Logo In my sample WPF Project, application logo file is placed at below location.\nLogo File Location: [Images/logo.ico]\nPlease see below üëáüèª image for reference.\nReference WPF Project In our [TestApplication.MSI] project, we need to reference our WPF Application.\nFor this select [Dependencies] node as shown in below üëáüèª image.\nRight Click on [Dependencies] node and select [Add Project Reference] as shown in below üëáüèª image.\nThis will show [Reference Manager] window as shown in below üëáüèª image.\nThen select [CheckBox] in front of project you want to add as a [Primary Project] as shown in below üëáüèª image.\nBy this we complete the process of referencing WPF Project into our Wix MSI Project for further use.\nUpdate [Package.en-us.wxl] In Wix MSI Project we need to add required variables into [Package.en-us.wxl] file.\nFirst open [Package.en-us.wxl] file then add required variables.\nBelow variables are required.\nPackageName PackageManufacturer PackageUpgradeCode PackageProductCode Please see below üëáüèª image of [Package.en-us.wxl] file for reference.\nPlease see below code sample for example.\nwix\r1\u0026lt;!-- 2This file contains the declaration of all the localizable strings. 3--\u0026gt; 4\u0026lt;WixLocalization xmlns=\u0026#34;http://wixtoolset.org/schemas/v4/wxl\u0026#34; Culture=\u0026#34;en-US\u0026#34;\u0026gt; 5 6 \u0026lt;String Id=\u0026#34;DowngradeError\u0026#34; 7 Value=\u0026#34;A newer version of [ProductName] is already installed.\u0026#34; /\u0026gt; 8 9 \u0026lt;String Id=\u0026#34;PackageName\u0026#34; Value=\u0026#34;AA Application\u0026#34; /\u0026gt; 10 \u0026lt;String Id=\u0026#34;PackageManufacturer\u0026#34; Value=\u0026#34;The CAD Coder\u0026#34; /\u0026gt; 11 \u0026lt;String Id=\u0026#34;PackageUpgradeCode\u0026#34; Value=\u0026#34;{58D55889-FFE4-4EA1-93FD-B8BA7F97EF22}\u0026#34; /\u0026gt; 12 \u0026lt;String Id=\u0026#34;PackageProductCode\u0026#34; Value=\u0026#34;{9D0FA41D-30B6-4A5B-A3E2-E3FCB697E0C2}\u0026#34; /\u0026gt; 13 14\u0026lt;/WixLocalization\u0026gt;\rPackageName: This is Name of MSI Package. PackageManufacturer: This is Name of Package Manufacturer. PackageUpgradeCode: This is Package UpgradeCode. This is very important field. For one MSI package this is always unique and never changes. PackageProductCode: This is Package Product Code. This is also very important. For each MSI Version this always change otherwise while installing MSI will give error of same version already installed. Update [Package.wxs] Below image show default content of Package.wxs\nwix\r1\u0026lt;Wix xmlns=\u0026#34;http://wixtoolset.org/schemas/v4/wxs\u0026#34;\u0026gt; 2 \u0026lt;Package Name=\u0026#34;TestApplication.MSI\u0026#34; 3 Manufacturer=\u0026#34;TODO Manufacturer\u0026#34; 4 Version=\u0026#34;1.0.0.0\u0026#34; 5 UpgradeCode=\u0026#34;f3873438-14af-4dcb-9ba2-4b474e155f08\u0026#34;\u0026gt; 6 \u0026lt;MajorUpgrade DowngradeErrorMessage=\u0026#34;!(loc.DowngradeError)\u0026#34; /\u0026gt; 7 8 \u0026lt;Feature Id=\u0026#34;Main\u0026#34;\u0026gt; 9 \u0026lt;ComponentGroupRef Id=\u0026#34;ExampleComponents\u0026#34; /\u0026gt; 10 \u0026lt;/Feature\u0026gt; 11 \u0026lt;/Package\u0026gt; 12\u0026lt;/Wix\u0026gt;\rBelow image show updated content of Package.wxs\nwix\r1\u0026lt;Wix xmlns=\u0026#34;http://wixtoolset.org/schemas/v4/wxs\u0026#34;\u0026gt; 2 3 \u0026lt;?define BuildVersion= 1.0.0.0 ?\u0026gt; 4 5 \u0026lt;Package Name=\u0026#34;!(loc.PackageName)\u0026#34; 6 Manufacturer=\u0026#34;!(loc.PackageManufacturer)\u0026#34; 7 Version=\u0026#34;$(var.BuildVersion)\u0026#34; 8 Compressed=\u0026#34;yes\u0026#34; 9 Scope=\u0026#34;perMachine\u0026#34; 10 UpgradeCode=\u0026#34;!(loc.PackageUpgradeCode)\u0026#34; 11 ProductCode=\u0026#34;!(loc.PackageProductCode)\u0026#34;\u0026gt; 12 13 \u0026lt;MajorUpgrade DowngradeErrorMessage=\u0026#34;!(loc.DowngradeError)\u0026#34; /\u0026gt; 14 15 \u0026lt;MediaTemplate EmbedCab=\u0026#34;yes\u0026#34;/\u0026gt; 16 17 \u0026lt;Icon Id=\u0026#34;icon.exe\u0026#34; SourceFile=\u0026#34;$(WPF_Application.ProjectDir)\\Images\\logo.ico\u0026#34;/\u0026gt; 18 \u0026lt;Property Id=\u0026#34;ARPPRODUCTICON\u0026#34; Value=\u0026#34;icon.exe\u0026#34; /\u0026gt; 19 20 \u0026lt;Feature Id=\u0026#34;Main\u0026#34;\u0026gt; 21 \u0026lt;ComponentGroupRef Id=\u0026#34;ApplicationComponents\u0026#34; /\u0026gt; 22 \u0026lt;/Feature\u0026gt; 23 \u0026lt;/Package\u0026gt; 24\u0026lt;/Wix\u0026gt;\rLocal Variable Below line represent a variable in Wix.\nwix\r1\u0026lt;?define BuildVersion= 1.0.0.0 ?\u0026gt;\rWe create variable by \u0026lt;?define ?\u0026gt; tag.\nAbove we created a variable with:\nName: BuildVersion Value of Variable: 1.0.0.0 For accessing value of variable BuildVersion we use $(var.BuildVersion).\nPlease see below üëáüèª image of for reference.\n[Package] Element In this section, we understand updated [Package] element.\nwix\r1\u0026lt;Package Name=\u0026#34;!(loc.PackageName)\u0026#34; 2 Manufacturer=\u0026#34;!(loc.PackageManufacturer)\u0026#34; 3 Version=\u0026#34;$(var.BuildVersion)\u0026#34; 4 Compressed=\u0026#34;yes\u0026#34; 5 Scope=\u0026#34;perMachine\u0026#34; 6 UpgradeCode=\u0026#34;!(loc.PackageUpgradeCode)\u0026#34; 7 ProductCode=\u0026#34;!(loc.PackageProductCode)\u0026#34;\u0026gt; 8 9\u0026lt;/Package\u0026gt;\rName:\nSets the name of the package. Value: !(loc.PackageName) !(loc.PackageName) means, search for variable in Wix Localization file (in our case [Package.en-us.wxl] file), whose name is PackageName, and set its value here. Note\n[!(loc.VariableName)] is how you call the value of variable define in Wix Localization file.\nPlease see below üëáüèª image of for reference.\nManufacturer:\nSets the name of the company that created the software included in the installer. Value: !(loc.PackageManufacturer) !(loc.PackageManufacturer) means, search for variable in Wix Localization file (in our case [Package.en-us.wxl] file), whose name is PackageManufacturer, and set its value here. Please see below üëáüèª image of for reference.\nVersion\nSets the version of the package. Value: $(var.BuildVersion) $(var.BuildVersion) means, search for variable in Wix Source file (in our case [Package.wxs] file), whose name is BuildVersion, and set its value here. Note\n[$(var.BuildVersion)] is how you call the value of variable define in Wix Source file. They are also Local variables as we defined previously.\nPlease see below üëáüèª image of for reference.\nCompressed\nCompressed files. Value accepted: \u0026quot;Yes/true\u0026quot; OR \u0026quot;No/false\u0026quot; Current Value: Yes Please see below üëáüèª image of for reference.\nScope\nTo define the installation scope of package: Per-machine Per-user Value accepted: \u0026quot;perMachine\u0026quot; OR \u0026quot;perUser\u0026quot; OR perUserOrMachine Current Value: perMachine Please see below üëáüèª image of for reference.\nUpgradeCode\nThe UpgradeCode attribute is important to recognize a package. This property will is fix for every package. This means once you define, we don‚Äôt need to change it when we release a new version of this package. Value: !(loc.PackageUpgradeCode) !(loc.PackageUpgradeCode) means, search for variable in Wix Localization file (in our case [Package.en-us.wxl] file), whose name is PackageUpgradeCode, and set its value here. Please see below üëáüèª image of for reference.\nProductCode\nThe ProductCode attribute is important to recognize a package. This property will is always change for every package. This means we need to change it when we release a new version of this package. Value: !(loc.PackageProductCode) !(loc.PackageProductCode) means, search for variable in Wix Localization file (in our case [Package.en-us.wxl] file), whose name is PackageProductCode, and set its value here. Please see below üëáüèª image of for reference.\n[MajorUpgrade] Element In this section, we understand [MajorUpgrade] element.\nwix\r1\u0026lt;MajorUpgrade DowngradeErrorMessage=\u0026#34;!(loc.DowngradeError)\u0026#34; /\u0026gt;\rMajorUpgrade\nThe MajorUpgrade Element is important to recognize a package. It link with UpgradeCode code we discuss previously. When we try to install a lower version than the version that\u0026rsquo;s already installed. The DowngradeErrorMessage attribute let us specify a message to be shown. The !(loc.DowngradeError) syntax is a reference to a localization string i.e. string message to shown. Please see below üëáüèª image of for reference.\n[MediaTemplate] Element wix\r1\u0026lt;MediaTemplate EmbedCab=\u0026#34;yes\u0026#34;/\u0026gt;\r[MediaTemplate] describe information to automatically assign files to cabinets. Maximum numbers of Cabinet files = 999 [Cabinet] Files They are files created with MSI. We need to ship them with MSI for deployment. Please see below üëáüèª image of for reference.\nPersonally I don\u0026rsquo;t like to ship extra files for deployment. For this we embed cabinet files into MSI. We do this by specifying \u0026ldquo;[EmbedCab]\u0026rdquo; property. Set its value to \u0026ldquo;[yes]\u0026rdquo;. [Icon] Element Now we define [Icon] for MSI in Add Remove Program.\nPlease see below üëáüèª code for reference.\nwix\r1\u0026lt;Icon Id=\u0026#34;icon.exe\u0026#34; SourceFile=\u0026#34;$(WPF_Application.ProjectDir)\\Images\\logo.ico\u0026#34;/\u0026gt;\rWe define 2 properties for [Icon] element.\nId SourceFile [Id] : Id of Icon file. [SourceFile] : Path to Icon file.\nValues we used.\n[Id] : icon.exe\nIt is important to write extension of file, on which we want to show icon. Not the file which we are referencing. In our case, we want to show icon for exe file. [SourceFile] : $(WPF_Application.ProjectDir)\\Images\\logo.ico\nIn above line, we are giving path to our icon file. Icon file is present inside \u0026ldquo;Images\u0026rdquo; folder of our Application project. To access reference project we use [$(WPF_Application.ProjectDir)] [Property] Element Now we define [Property] for application icon of MSI in Add Remove Program.\nPlease see below üëáüèª image for reference.\nFor this we need to use [Property] element and define its special ID and assign value of that special ID.\nPlease see below üëáüèª code for reference.\nwix\r1\u0026lt;Property Id=\u0026#34;ARPPRODUCTICON\u0026#34; Value=\u0026#34;icon.exe\u0026#34; /\u0026gt;\rAs shown in above code sample:\nTag = Property Id = \u0026ldquo;ARPPRODUCTICON\u0026rdquo; Value = \u0026ldquo;icon.exe\u0026rdquo; [Feature] Element Already explained in previous üöÄ Understand Wix V4 Project article.\n[ComponentGroupRef] Element Already explained in previous üöÄ Understand Wix V4 Project article.\nwix\r1\u0026lt;ComponentGroupRef Id=\u0026#34;ApplicationComponents\u0026#34; /\u0026gt;\rI have renamed the [Id] from \u0026ldquo;[ExampleComponents]\u0026rdquo; to \u0026ldquo;[ApplicationComponents]\u0026rdquo;.\n[Build] Solution Now we need to build solution as shown below.\nAfter building solution we need to go to folder where MSI is created.\nPlease see below üëáüèª image for reference.\nFinal Result Run the MSI to install application.\nBelow image show final result after running installation.\nThat\u0026rsquo;s it!!!\nHope this post helps you.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":27,"permalink":"/knowledge-base/wix-add-remove-program-details/","summary":"\u003cp\u003eIn this article we create MSI Details for Add/Remove Program details.\u003c/p\u003e\n\u003cp\u003ePlease see below üëáüèª image of \u003cstrong\u003eVisual Studio\u003c/strong\u003e for reference.\u003c/p\u003e","tags":[],"title":"Wix Add Remove Program Details"},{"content":"","date":"2023-09-07","id":28,"permalink":"/solidworks-macros/05-sketch---arcs/","summary":"","tags":[],"title":"Sketch - Arcs"},{"content":"Objective I want to:\nAdd Syncfusion License Key\nWe will continue from previous article üöÄ Add Syncfusion Busy Indicator.\nWill not add new controls to previous code.\nDemo Video Below üé¨ video shows how to Add Syncfusion License Key in Visual Studio 2022.\nGet License Key Go to Syncfusion Dashboard page.\nI have a link in article üöÄ Syncfusion Account Sign Up and Community Version.\nThis link will directly open Syncfusion Dashboard page.\nPlease see below üëáüèª image for reference.\nNow go to \u0026ldquo;Claim License Key\u0026rdquo; as shown in below üëáüèª image. A new page open and select \u0026ldquo;COPY TO CLIPBOARD\u0026rdquo; as shown in below üëáüèª image. Add Syncfusion Key In this section we add Syncfusion Key Window.\nOpen \u0026ldquo;App.xaml.cs\u0026rdquo; file as shown in below üëáüèª image. Create a Constructor for this \u0026ldquo;App.xaml.cs\u0026rdquo; file as shown in below üëáüèª image. Register Syncfusion license shown in below üëáüèª image. C#\r1public App() 2{ 3 SyncfusionLicenseProvider.RegisterLicense(\u0026#34;YOUR LICENSE KEY\u0026#34;); 4}\rFinal Result Now we run the application as shown in below üëáüèª image.\nNow we did not see License message since we add our License Key.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Add Syncfusion License Key.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":29,"permalink":"/wpf-tutorials/add-syncfusion-license-key/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eI want to:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eAdd Syncfusion License Key\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eWe will continue from previous article üöÄ \u003ca href=\"/wpf-tutorials/add-syncfusion-busy-indicator/\" target=\"_blank\"\u003eAdd Syncfusion Busy Indicator\u003c/a\u003e.\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eWill not add new controls to previous code.\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e","tags":[],"title":"Add Syncfusion License Key"},{"content":"Although you may not know much about developing procedures at this point, I‚Äôm going to jump ahead a bit and discuss how to execute these procedures.\nThis is important because these procedures are worthless unless you know how to execute it.\nExecuting Sub procedure Executing a Sub procedure means the same thing as running or calling a Sub procedure.\nYou can use whatever terminology you like.\nYou can execute a VBA Sub in many ways - that‚Äôs one reason you can do so many useful things with Sub procedures.\nHere‚Äôs a list of the ways to execute a Sub procedure:\nWith the Run -\u0026gt; Run Sub/UserForm command (in the VBE). VBE executes the Sub procedure in which the cursor is located. This menu command has two alternatives: the F5 key and the Run Sub/UserForm button on the Standard toolbar in the VBE. These methods don‚Äôt work if the procedure requires one or more arguments. From another Sub procedure that you write. From a custom item on the ribbon you develop. From the Immediate window in the VBE. Just type the name of the Sub procedure and press Enter. From Run Macro -\u0026gt; Select Macro you want to run. By this, your macro runs the Sub procedure without opening VBE. I demonstrate some of these techniques in the following sections.\nBefore I can do that, you need to enter a Sub procedure into a VBA module as suggested below:\nOpen the VBE in Solidworks.\nEnter the following code into your module\nvba\r1 Sub CubeRoot() 2 Number = InputBox(\u0026#34;Enter a positive number.\u0026#34;) 3 MsgBox number ^ (1/3) \u0026amp; \u0026#34;is the cube root.\u0026#34; 4 End Sub\rThis procedure asks the user for a number and then displays that number‚Äôs cube root in a message box.\nBelow Figures shows what happens when you execute this procedure.\nI entered 4 as input value. And get result as shown in below image.\nBy the way, CubeRoot is not an example of a good macro. It doesn‚Äôt check for errors, so it fails easily.\nTo see what I mean, try clicking the Cancel button in the input box or entering a negative number.\nExecuting the Sub procedure directly The quickest way to execute this procedure is by doing so directly from the VBA module in which you defined it.\nFollow these steps:\nActivate the VBE and select the VBA module that contains the procedure. Move the cursor anywhere in the procedure‚Äôs code. Press F5 (or choose Run -\u0026gt; Run Sub/UserForm). Respond to the input box and click OK. The procedure displays the cube root of the number you entered. You can‚Äôt use the Run -\u0026gt; Run Sub/UserForm command to execute a Sub procedure that uses arguments, because you have no way to pass the arguments to the procedure.\nIf the procedure contains one or more arguments, the only way to execute it is to call it from another procedure ‚Äî which must supply the argument(s).\nExecuting the Sub procedure from another procedure You can also execute a Sub procedure from another procedure.\nFollow these steps if you want to give this a try:\nActivate the VBA module that holds the CubeRoot routine.\nEnter this new procedure (either above or below CubeRoot code ‚Äî it makes no difference):\nvba\r1 Sub NewSub() 2 Call CubeRoot 3 End Sub\rExecute the NewSub macro.\nThe easiest way to do this is to move the cursor anywhere within the NewSub code and press F5. Notice that this NewSub procedure simply executes the CubeRoot procedure.\nNote\nPlease note that the keyword Call is optional. The statement can consist of only the Sub procedure‚Äôs name. I find that using the Call keyword makes it perfectly clear that a procedure is being called.\nExecuting Function procedure Function procedures, unlike Sub procedures, can be only executed in only one way:\nBy calling the function from another Sub procedure or Function procedure. Try this simple function. Enter it into a VBA module:\nvba\r1Function CubeRoot() 2 CubeRoot = number ^ (1/3) 3End Function\rThis function is pretty bored ‚Äî it merely calculates the cube root of the number passed to it as its argument.\nIt does provide a starting point for understanding functions.\nIt also presents an important concept about functions: how to return the value.\n(You do remember that a function returns a value, right?)\nNotice that the single line of code that makes up this Function procedure performs a calculation.\nThe result of the math (number to the power of 1‚ÅÑ3) is assigned to the variable CubeRoot.\nNot coincidentally, CubeRoot is also the name of the function.\nTo tell the function what value to return, you assign that value to the name of the function.\nExecuting the Function procedure from a Sub procedure Because you can‚Äôt execute a function directly, you must call it from another procedure.\nEnter the following simple procedure in the same VBA module that contains the CubeRoot function:\nvba\r1Sub CubeRoot() 2 Ans = CubeRoot(125) 3 MsgBox Ans 4End Sub\rWhen you execute the CubeRoot procedure (using any of the methods described earlier), your software displays a message box that contains the value of the Ans variable, which is 5.\nHere‚Äôs what‚Äôs going on:\nCubeRoot(125) means it CubeRoot receive argument of 125. Then Function CubeRoot(number) is executed. As described previously, number is an argument. And here the value of this is 125. Then by number ^ (1/3) we get the cube of 125. (why? Because 125 is argument passed by the sub function and this 125 is the value of number.) After that cube value of 125, i.e. 5, is assigned to or given to or equal to CubeRoot. This CubeRoot assigned to or given to or equal to Ans. After that message boxes show the value of 5 in your screen. Note\nPlease read again if you don‚Äôt understand what is going on here.\nNext post will be about Programming Concepts, Comments and Data-types.\n","date":"0001-01-01","id":30,"permalink":"/vba/executing-procedures/","summary":"\u003cp\u003eAlthough you may not know much about developing procedures at this point, I‚Äôm going to jump ahead a bit and discuss how to execute these procedures.\u003c/p\u003e","tags":[],"title":"Executing Sub and Function Procedures"},{"content":"In this post, I tell you how to open a saved document in Solidworks using VBA Macro.\nWe open document with 2 different methods.\nBy OpenDoc method\nBy OpenDoc6 method\nVideo of Code on YouTube Please see below video on how to Open Saved Documents from Visual Studio.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nBy OpenDoc method This is the simplest method to open a saved part from your computer.\nIn this method we just need two information.\nLocation of document to open\nType of document which we want to open\nBelow is the example code for opening a saved document using OpenDoc method.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Open a saved document Set swDoc = swApp.OpenDoc(\u0026#34;H:\\Solidworks studies\\API Studies\\Chapter 1 - The Basics\\1st example part.SLDPRT\u0026#34;, swDocumentTypes_e.swDocPART) \u0026#39; Selecting Front Plane BoolStatus = swDoc.SelectByID(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0) End Sub\rI have already explained every line except middle line in above code sample in previous posts.\nTo open a saved document we used following lline.\n\u0026#39; Open a saved document Set swDoc = swApp.OpenDoc(\u0026#34;H:\\Solidworks studies\\API Studies\\Chapter 1 - The Basics\\1st example part.SLDPRT\u0026#34;, swDocumentTypes_e.swDocPART)\rHere, we set the ModelDoc2 variable swDoc to a value.\nThis value is return or provided by OpenDoc method.\nThis method is part of Solidworks document.\nSince we define swApp variable as Solidworks document hence we 1st call swApp and then using Dot operator we access the OpenDoc method.\nOpenDoc method takes 2 arguments or parameter.\nFileName : Document name or full path if not in current directory, including extension.\nType : Document type as define in swDocumentTypes_e as follows.\nswDocASSEMBLY\nswDocDRAWING\nswDocLAYOUT\nswDocNONE\nswDocPART\nswDocSDM\nIf you want to open a Library feature part then we use swDocPART as document type.\nReturn Value - If the document opens then this method returns True and otherwise False.\nIf you just want to open a saved document then this method is what you are looking for.\nFor most of the part, OpenDoc method works well.\nIf you want more option while opening a document, then next method is for you.\nBy OpenDoc6 method OpenDoc6 method is extension to OpenDoc with some additional parameters.\nHow OpenDoc6 works is shown in below code sample:\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Open an saved document Set swDoc = swApp.OpenDoc6(\u0026#34;H:\\Solidworks studies\\API Studies\\Chapter 1 - The Basics\\1st example part.SLDPRT\u0026#34;, swDocumentTypes_e.swDocPART, swOpenDocOptions_e.swOpenDocOptions_Silent, \u0026#34;\u0026#34;, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.SelectByID(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0) End Sub\rThis code sample is similar is to previous example code except for OpenDoc6 method takes extra 4 parameters.\nOpenDoc6 method takes 6 arguments or parameter.\nFileName : Document name or full path if not in current directory, including extension.\nType : Document type as define in swDocumentTypes_e as follows.\nswDocASSEMBLY\nswDocDRAWING\nswDocLAYOUT\nswDocNONE\nswDocPART\nswDocSDM\nIf you want to open a Library feature part then we use swDocPART as document type.\nOptions : Mode in which to open the document as defined in swOpenDocOptions_e.\nFor more details about Options parameters, please visit this page of Solidworks API Help.\nConfiguration : Configuration in which you want to open this document.\nApplies to Part and Assemblies, not drawings.\nIf this argument is empty or the specified configuration is not present in the model, the model is opened in the last-used configuration.\nI used an \u0026quot;\u0026quot; in the above code sample, because I want to open part file in last saved configuration.\nIf you don\u0026rsquo;t know about \u0026quot;\u0026quot;, then this symbol represent an empty string.\nWhen we don\u0026rsquo;t want to pass any value as string, at that time I use \u0026quot;\u0026quot;.\nYou can also use \u0026quot;\u0026quot; when you want to pass an empty string in VBA.\nErrors : Load errors as defined in swFileLoadError_e.\nFor more details about Errors parameters, please visit this page of Solidworks API Help.\nSince this parameter is long type, and I don\u0026rsquo;t want to enter any value from the provided list; I used 0 as value.\nIf you want to use options from option link then you can use values from there.\nIt is just I don\u0026rsquo;t want to load any error information about the part.\nWarnings : Warnings or extra information generated during the open operation as defined in swFileLoadWarning_e.\nFor more details about Warnings parameters, please visit this page of Solidworks API Help.\nAs in the previous parameter, I use 0 as value.\nReturn Value - If the document opens then this method returns True and otherwise False.\nAs you can see, in OpenDoc6 method, we need to defined the extra parameters compared to OpenDoc method.\nIt is worth noted that, OpenDoc6 method is the most updated method for opening a saved document.\nHence if did not use any of the above method, I would recommend you to use OpenDoc6 method.\nHope this post helps you to understand opening methods with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":31,"permalink":"/solidworks-macros/open-saved-document/","summary":"\u003cp\u003eIn this post, I tell you how to \u003cem\u003eopen a saved document\u003c/em\u003e in Solidworks using \u003cem\u003eVBA Macro\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003eWe open document with 2 different methods.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Open Saved Documents"},{"content":"In this article we create Desktop Icon when MSI install application.\nPlease see below üëáüèª image of Desktop Icon for reference.\nUpdate [ExampleComponents.wxs] Below image show content of ExampleComponents.wxs\nwix\r1\u0026lt;Wix xmlns=\u0026#34;http://wixtoolset.org/schemas/v4/wxs\u0026#34;\u0026gt; 2 \u0026lt;Fragment\u0026gt; 3 \u0026lt;ComponentGroup Id=\u0026#34;ApplicationComponents\u0026#34; Directory=\u0026#34;INSTALLFOLDER\u0026#34;\u0026gt; 4 \u0026lt;Component Directory=\u0026#34;INSTALLFOLDER\u0026#34;\u0026gt; 5 \u0026lt;File Id=\u0026#34;ApplicationFile\u0026#34; Source=\u0026#34;WPF_Application.exe\u0026#34; /\u0026gt; 6 \u0026lt;/Component\u0026gt; 7 \u0026lt;/ComponentGroup\u0026gt; 8 \u0026lt;/Fragment\u0026gt; 9\u0026lt;/Wix\u0026gt;\rAdd Output File First, we need to add file for which we want to share icon.\nwix\r1\u0026lt;Component Directory=\u0026#34;INSTALLFOLDER\u0026#34;\u0026gt; 2 \u0026lt;File Id=\u0026#34;ApplicationFile\u0026#34; Source=\u0026#34;WPF_Application.exe\u0026#34; /\u0026gt; 3\u0026lt;/Component\u0026gt;\rIn above code we add output exe file.\nThis output file is WPF_Application.exe.\nFor this output file WPF_Application.exe, we want to show Desktop icon.\nAdd Desktop Icon wix\r1\u0026lt;Wix xmlns=\u0026#34;http://wixtoolset.org/schemas/v4/wxs\u0026#34;\u0026gt; 2 \u0026lt;Fragment\u0026gt; 3 \u0026lt;ComponentGroup Id=\u0026#34;ApplicationComponents\u0026#34; Directory=\u0026#34;INSTALLFOLDER\u0026#34;\u0026gt; 4 \u0026lt;Component Directory=\u0026#34;INSTALLFOLDER\u0026#34;\u0026gt; 5 \u0026lt;!--Add output file--\u0026gt; 6 \u0026lt;File Id=\u0026#34;ApplicationFile\u0026#34; Source=\u0026#34;WPF_Application.exe\u0026#34;\u0026gt; 7 \u0026lt;!--Add Desktop Shortcut--\u0026gt; 8 \u0026lt;Shortcut Id=\u0026#34;DesktopShortCut\u0026#34; 9 Directory=\u0026#34;DesktopFolder\u0026#34; 10 Advertise=\u0026#34;yes\u0026#34; Icon=\u0026#34;icon.exe\u0026#34; 11 Name=\u0026#34;!(bind.Property.ProductName)\u0026#34; /\u0026gt; 12 \u0026lt;/File\u0026gt; 13 \u0026lt;/Component\u0026gt; 14 \u0026lt;/ComponentGroup\u0026gt; 15 \u0026lt;/Fragment\u0026gt; 16\u0026lt;/Wix\u0026gt;\rIn above code sample, we \u0026ldquo;Add Desktop Shortcut\u0026rdquo;.\nFor this we use \u0026lt;Shortcut\u0026gt; tag.\nPlease see below üëáüèª code for reference.\nAfter adding \u0026lt;Shortcut\u0026gt; tag, we define some properties of \u0026lt;Shortcut\u0026gt; tag.\nPlease see below list of properties for \u0026lt;Shortcut\u0026gt; tag.\nProperty Name Property Description Id Identifier for this tag, by which we can refer to this tag. Directory Special Id, which define Directory where we want to show our shortcut. Advertise Boolean variable which decide we want to advertise this shortcut or not. Icon Id of Icon image. Please note that this is Id \u0026ldquo;NOT source of icon image\u0026rdquo;. Name Name of Icon which we want to show with Icon image. Values we used in our code.\nProperty Name Value Used Value Comment Id DesktopShortCut Id which I give. Directory DesktopFolder Special Id for Desktop Folder. Since we want to create Desktop Shortcut. Advertise yes Always \u0026lsquo;Yes\u0026rsquo; since this is the easy way. Icon icon.exe Reference to Id of image in Package.wxs file. Name !(bind.Property.ProductName) Bind of Shortcut name to Product Name.s [Build] Solution Now we need to build solution as shown below.\nAfter building solution we need to go to folder where MSI is created.\nPlease see below üëáüèª image for reference.\nFinal Result Run the MSI to install application.\nBelow image show final result after running installation.\nThat\u0026rsquo;s it!!!\nHope this post helps you.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":32,"permalink":"/knowledge-base/wix-add-desktop-icon/","summary":"\u003cp\u003eIn this article we \u003cstrong\u003ecreate Desktop Icon\u003c/strong\u003e when MSI install application.\u003c/p\u003e\n\u003cp\u003ePlease see below üëáüèª image of \u003cstrong\u003eDesktop Icon\u003c/strong\u003e for reference.\u003c/p\u003e","tags":[],"title":"Wix Add Desktop Icon"},{"content":"","date":"2023-09-07","id":33,"permalink":"/solidworks-macros/06-sketch---slots/","summary":"","tags":[],"title":"Sketch - Slots"},{"content":"Objective I want to:\nCreate Browse Solidworks Document User Interface\nWe will continue from previous article üöÄ Add Syncfusion Busy Indicator.\nextend article by adding new controls to previous code.\nDemo Video Below üé¨ video shows how to Browse Solidworks Document UI in Visual Studio 2022.\nUpdate XAML File for UI Add WindowStartupLocation property to \u0026lt;syncfusion:ChromelessWindow\u0026gt; tag.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. xaml\r1\u0026lt;syncfusion:ChromelessWindow x:Class=\u0026#34;BrowseSolidworksDocument.Views.MainWindow\u0026#34; 2 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 3 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 4 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 5 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 6 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 7 Title=\u0026#34;{Binding Title}\u0026#34; Height=\u0026#34;350\u0026#34; Width=\u0026#34;525\u0026#34; WindowStartupLocation=\u0026#34;CenterScreen\u0026#34; \u0026gt;\rNow we add \u0026lt;Grid\u0026gt; tag inside \u0026lt;syncfusion:SfBusyIndicator\u0026gt; tag.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. xaml\r1\u0026lt;syncfusion:ChromelessWindow x:Class=\u0026#34;BrowseSolidworksDocument.Views.MainWindow\u0026#34; 2 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 3 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 4 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 5 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 6 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 7 Title=\u0026#34;{Binding Title}\u0026#34; Height=\u0026#34;350\u0026#34; Width=\u0026#34;525\u0026#34; WindowStartupLocation=\u0026#34;CenterScreen\u0026#34;\u0026gt; 8 \u0026lt;syncfusion:SfBusyIndicator IsBusy=\u0026#34;{Binding IsBusy, Mode=TwoWay}\u0026#34; AnimationType=\u0026#34;Gear\u0026#34;\u0026gt; 9 \u0026lt;Grid\u0026gt; 10 \u0026lt;Grid.RowDefinitions\u0026gt; 11 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 12 \u0026lt;RowDefinition Height=\u0026#34;Auto\u0026#34; /\u0026gt; 13 \u0026lt;RowDefinition Height=\u0026#34;50\u0026#34; /\u0026gt; 14 \u0026lt;RowDefinition Height=\u0026#34;Auto\u0026#34; /\u0026gt; 15 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 16 \u0026lt;/Grid.RowDefinitions\u0026gt; 17 18 \u0026lt;Grid.ColumnDefinitions\u0026gt; 19 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 20 \u0026lt;ColumnDefinition Width=\u0026#34;Auto\u0026#34; /\u0026gt; 21 \u0026lt;ColumnDefinition Width=\u0026#34;50\u0026#34; /\u0026gt; 22 \u0026lt;ColumnDefinition Width=\u0026#34;Auto\u0026#34; /\u0026gt; 23 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 24 \u0026lt;/Grid.ColumnDefinitions\u0026gt; 25 26 \u0026lt;/Grid\u0026gt; 27 \u0026lt;/syncfusion:SfBusyIndicator\u0026gt; 28\u0026lt;/syncfusion:ChromelessWindow\u0026gt;\rAdd Browse File file button.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. xaml\r1\u0026lt;syncfusion:ChromelessWindow x:Class=\u0026#34;BrowseSolidworksDocument.Views.MainWindow\u0026#34; 2 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 3 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 4 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 5 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 6 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 7 Title=\u0026#34;{Binding Title}\u0026#34; Height=\u0026#34;350\u0026#34; Width=\u0026#34;525\u0026#34; WindowStartupLocation=\u0026#34;CenterScreen\u0026#34;\u0026gt; 8 \u0026lt;syncfusion:SfBusyIndicator IsBusy=\u0026#34;{Binding IsBusy, Mode=TwoWay}\u0026#34; AnimationType=\u0026#34;Gear\u0026#34;\u0026gt; 9 \u0026lt;Grid\u0026gt; 10 \u0026lt;Grid.RowDefinitions\u0026gt; 11 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 12 \u0026lt;RowDefinition Height=\u0026#34;Auto\u0026#34; /\u0026gt; 13 \u0026lt;RowDefinition Height=\u0026#34;50\u0026#34; /\u0026gt; 14 \u0026lt;RowDefinition Height=\u0026#34;Auto\u0026#34; /\u0026gt; 15 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 16 \u0026lt;/Grid.RowDefinitions\u0026gt; 17 18 \u0026lt;Grid.ColumnDefinitions\u0026gt; 19 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 20 \u0026lt;ColumnDefinition Width=\u0026#34;Auto\u0026#34; /\u0026gt; 21 \u0026lt;ColumnDefinition Width=\u0026#34;50\u0026#34; /\u0026gt; 22 \u0026lt;ColumnDefinition Width=\u0026#34;Auto\u0026#34; /\u0026gt; 23 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 24 \u0026lt;/Grid.ColumnDefinitions\u0026gt; 25 26 \u0026lt;syncfusion:ButtonAdv Grid.Column=\u0026#34;1\u0026#34; 27 Grid.Row=\u0026#34;1\u0026#34; 28 Height=\u0026#34;30\u0026#34; Width=\u0026#34;200\u0026#34; Command=\u0026#34;{Binding BrowseFileCommand}\u0026#34; 29 Label=\u0026#34;Browse File\u0026#34; IconHeight=\u0026#34;0\u0026#34; IconWidth=\u0026#34;0\u0026#34; /\u0026gt; 30 31 \u0026lt;/Grid\u0026gt; 32 \u0026lt;/syncfusion:SfBusyIndicator\u0026gt; 33\u0026lt;/syncfusion:ChromelessWindow\u0026gt;\rIn above code, we add BrowseFileCommand command. Now, we add \u0026lt;TextBox\u0026gt;, which shows browsed file path.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. xaml\r1\u0026lt;syncfusion:ChromelessWindow x:Class=\u0026#34;BrowseSolidworksDocument.Views.MainWindow\u0026#34; 2 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 3 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 4 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 5 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 6 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 7 Title=\u0026#34;{Binding Title}\u0026#34; Height=\u0026#34;350\u0026#34; Width=\u0026#34;525\u0026#34; WindowStartupLocation=\u0026#34;CenterScreen\u0026#34;\u0026gt; 8 \u0026lt;syncfusion:SfBusyIndicator IsBusy=\u0026#34;{Binding IsBusy, Mode=TwoWay}\u0026#34; AnimationType=\u0026#34;Gear\u0026#34;\u0026gt; 9 \u0026lt;Grid\u0026gt; 10 \u0026lt;Grid.RowDefinitions\u0026gt; 11 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 12 \u0026lt;RowDefinition Height=\u0026#34;Auto\u0026#34; /\u0026gt; 13 \u0026lt;RowDefinition Height=\u0026#34;50\u0026#34; /\u0026gt; 14 \u0026lt;RowDefinition Height=\u0026#34;Auto\u0026#34; /\u0026gt; 15 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 16 \u0026lt;/Grid.RowDefinitions\u0026gt; 17 18 \u0026lt;Grid.ColumnDefinitions\u0026gt; 19 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 20 \u0026lt;ColumnDefinition Width=\u0026#34;Auto\u0026#34; /\u0026gt; 21 \u0026lt;ColumnDefinition Width=\u0026#34;50\u0026#34; /\u0026gt; 22 \u0026lt;ColumnDefinition Width=\u0026#34;Auto\u0026#34; /\u0026gt; 23 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 24 \u0026lt;/Grid.ColumnDefinitions\u0026gt; 25 26 \u0026lt;syncfusion:ButtonAdv Grid.Column=\u0026#34;1\u0026#34; 27 Grid.Row=\u0026#34;1\u0026#34; 28 Height=\u0026#34;30\u0026#34; Width=\u0026#34;200\u0026#34; Command=\u0026#34;{Binding BrowseFileCommand}\u0026#34; 29 Label=\u0026#34;Browse File\u0026#34; IconHeight=\u0026#34;0\u0026#34; IconWidth=\u0026#34;0\u0026#34; /\u0026gt; 30 31 \u0026lt;TextBox Grid.Row=\u0026#34;1\u0026#34; 32 Grid.Column=\u0026#34;3\u0026#34; 33 Height=\u0026#34;30\u0026#34; Width=\u0026#34;200\u0026#34; 34 IsEnabled=\u0026#34;False\u0026#34; 35 Text=\u0026#34;{Binding FilePath, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\u0026#34; 36 VerticalContentAlignment=\u0026#34;Center\u0026#34; 37 /\u0026gt; 38 39 \u0026lt;/Grid\u0026gt; 40 \u0026lt;/syncfusion:SfBusyIndicator\u0026gt; 41\u0026lt;/syncfusion:ChromelessWindow\u0026gt;\rIn above code, we add Text property and bind with FilePath property in view model. Now, we add Open File button, which open browsed file path.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. xaml\r1\u0026lt;syncfusion:ChromelessWindow x:Class=\u0026#34;BrowseSolidworksDocument.Views.MainWindow\u0026#34; 2 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 3 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 4 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 5 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 6 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 7 Title=\u0026#34;{Binding Title}\u0026#34; Height=\u0026#34;350\u0026#34; Width=\u0026#34;525\u0026#34; WindowStartupLocation=\u0026#34;CenterScreen\u0026#34;\u0026gt; 8 \u0026lt;syncfusion:SfBusyIndicator IsBusy=\u0026#34;{Binding IsBusy, Mode=TwoWay}\u0026#34; AnimationType=\u0026#34;Gear\u0026#34;\u0026gt; 9 \u0026lt;Grid\u0026gt; 10 \u0026lt;Grid.RowDefinitions\u0026gt; 11 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 12 \u0026lt;RowDefinition Height=\u0026#34;Auto\u0026#34; /\u0026gt; 13 \u0026lt;RowDefinition Height=\u0026#34;50\u0026#34; /\u0026gt; 14 \u0026lt;RowDefinition Height=\u0026#34;Auto\u0026#34; /\u0026gt; 15 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 16 \u0026lt;/Grid.RowDefinitions\u0026gt; 17 18 \u0026lt;Grid.ColumnDefinitions\u0026gt; 19 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 20 \u0026lt;ColumnDefinition Width=\u0026#34;Auto\u0026#34; /\u0026gt; 21 \u0026lt;ColumnDefinition Width=\u0026#34;50\u0026#34; /\u0026gt; 22 \u0026lt;ColumnDefinition Width=\u0026#34;Auto\u0026#34; /\u0026gt; 23 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 24 \u0026lt;/Grid.ColumnDefinitions\u0026gt; 25 26 \u0026lt;syncfusion:ButtonAdv Grid.Column=\u0026#34;1\u0026#34; 27 Grid.Row=\u0026#34;1\u0026#34; 28 Height=\u0026#34;30\u0026#34; Width=\u0026#34;200\u0026#34; Command=\u0026#34;{Binding BrowseFileCommand}\u0026#34; 29 Label=\u0026#34;Browse File\u0026#34; IconHeight=\u0026#34;0\u0026#34; IconWidth=\u0026#34;0\u0026#34; /\u0026gt; 30 31 \u0026lt;TextBox Grid.Row=\u0026#34;1\u0026#34; 32 Grid.Column=\u0026#34;3\u0026#34; 33 Height=\u0026#34;30\u0026#34; Width=\u0026#34;200\u0026#34; 34 IsEnabled=\u0026#34;False\u0026#34; 35 Text=\u0026#34;{Binding FilePath, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\u0026#34; 36 VerticalContentAlignment=\u0026#34;Center\u0026#34; 37 /\u0026gt; 38 39 \u0026lt;syncfusion:ButtonAdv Grid.Column=\u0026#34;1\u0026#34; 40 Grid.Row=\u0026#34;3\u0026#34; Grid.ColumnSpan=\u0026#34;3\u0026#34; 41 Height=\u0026#34;30\u0026#34; Width=\u0026#34;200\u0026#34; 42 Label=\u0026#34;Open File\u0026#34; IconHeight=\u0026#34;0\u0026#34; IconWidth=\u0026#34;0\u0026#34; Command=\u0026#34;{Binding ClickCommand}\u0026#34; /\u0026gt; 43 44 \u0026lt;/Grid\u0026gt; 45 \u0026lt;/syncfusion:SfBusyIndicator\u0026gt; 46\u0026lt;/syncfusion:ChromelessWindow\u0026gt;\rIn above code, we add ClickCommand command. Open MainWindowViewModel class.\nAdd FilePath property.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. C#\r1private string _FilePath; 2public string FilePath 3{ 4 get { return _FilePath; } 5 set { SetProperty(ref _FilePath, value); } 6}\rAdd Service for Browsing File Dialog In our project, we add new folder.\nPlease see below üëáüèª image for reference.\nNow we add BrowseFileDialogService class to \u0026ldquo;Service\u0026rdquo; folder.\nPlease see below üëáüèª image for reference.\nNow, we inherit this BrowseFileDialogService class from PubSubEvent class from Prism.Events namespace.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. C#\r1using System; 2using System.Collections.Generic; 3using System.Linq; 4using System.Text; 5using System.Threading.Tasks; 6using Prism.Events; 7 8namespace BrowseSolidworksDocument.Services 9{ 10 public class BrowseFileDialogService : PubSubEvent 11 { 12 13 } 14}\rRegister Service Open MainWindow.xaml.cs file.\nPass IEventAggregator to constructor, and assigned it to private field.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. C#\r1using BrowseSolidworksDocument.Services; 2using BrowseSolidworksDocument.ViewModels; 3using Microsoft.Win32; 4using Prism.Events; 5using Syncfusion.Windows.Shared; 6using System; 7using System.Windows; 8 9namespace BrowseSolidworksDocument.Views 10{ 11 /// \u0026lt;summary\u0026gt; 12 /// Interaction logic for MainWindow.xaml 13 /// \u0026lt;/summary\u0026gt; 14 public partial class MainWindow : ChromelessWindow 15 { 16 private readonly IEventAggregator eventAggregator; 17 18 public MainWindow(IEventAggregator eventAggregator) 19 { 20 InitializeComponent(); 21 this.eventAggregator = eventAggregator; 22 } 23 } 24}\rNow, we register our service.\nWhen this service is called, a function is executed.\nThis registration and execution is handle by eventAggregator field.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. C#\r1using BrowseSolidworksDocument.Services; 2using BrowseSolidworksDocument.ViewModels; 3using Microsoft.Win32; 4using Prism.Events; 5using Syncfusion.Windows.Shared; 6using System; 7using System.Windows; 8 9namespace BrowseSolidworksDocument.Views 10{ 11 /// \u0026lt;summary\u0026gt; 12 /// Interaction logic for MainWindow.xaml 13 /// \u0026lt;/summary\u0026gt; 14 public partial class MainWindow : ChromelessWindow 15 { 16 private readonly IEventAggregator eventAggregator; 17 18 public MainWindow(IEventAggregator eventAggregator) 19 { 20 InitializeComponent(); 21 this.eventAggregator = eventAggregator; 22 this.eventAggregator.GetEvent\u0026lt;BrowseFileDialogService\u0026gt;().Subscribe(BrowseFile); 23 } 24 25 private void BrowseFile() 26 { 27 OpenFileDialog openFileDialog = new OpenFileDialog(); 28 openFileDialog.Filter = \u0026#34;Solidworks Part|*.sldprt|Solidworks Assembly|*.sldasm|Solidworks Drawing|*.slddrw\u0026#34;; 29 openFileDialog.DefaultExt = \u0026#34;*.sldprt\u0026#34;; 30 31 bool? result = openFileDialog.ShowDialog(); 32 33 if (result == false || string.IsNullOrEmpty(openFileDialog.FileName)) 34 return; 35 36 var viewModel = DataContext as MainWindowViewModel; 37 viewModel.FilePath = openFileDialog.FileName; 38 } 39 } 40}\rUnderstand Service Call Execute Function In this section, let us understand BrowseFile() function.\nC#\r1OpenFileDialog openFileDialog = new OpenFileDialog();\rIn above line, we create a variable of:\nType: OpenFileDialog Variable name: openFileDialog We use this variable for browsing Solidworks Files.\nC#\r1openFileDialog.Filter = \u0026#34;Solidworks Part|*.sldprt|Solidworks Assembly|*.sldasm|Solidworks Drawing|*.slddrw\u0026#34;;\rIn above line, we set the Filter property of openFileDialog variable.\nFilter property value is Solidworks Part, Assembly and Drawing files.\nOnly these file shown, when we browse for file.\nC#\r1openFileDialog.DefaultExt = \u0026#34;*.sldprt\u0026#34;;\rIn above line, we set the Default file extension for file browsing window.\nDefault option is Solidworks Part file.\nWe set default option by setting value of DefaultExt property.\nThis DefaultExt property is part of openFileDialog variable.\nWe set the value of DefaultExt property to \u0026ldquo;*.sldprt\u0026rdquo;.\nC#\r1bool? result = openFileDialog.ShowDialog();\rIn above line, we are doing followings:\nWe show the file browsing window by ShowDialog() method.\nThis ShowDialog() method is part of openFileDialog variable.\nWe create a nullable variable.\nThis new variable is bool? type variable.\nName of this new variable is result.\nWe store the result of ShowDialog() method in result variable.\nC#\r1if (result == false || string.IsNullOrEmpty(openFileDialog.FileName)) 2 return;\rIn above we are checking 2 conditions.\nCondition: result == false\nIf this condition is True, then user cancel the function.\nIn this condition, we exit the function.\nCondition: string.IsNullOrEmpty(openFileDialog.FileName)\nIf this condition is True, then user did not select any file also.\nIn this condition also, we exit the function.\nIf user select a file, and the value of result variable is true, then we continue to next line of code.\nC#\r1var viewModel = DataContext as MainWindowViewModel;\rIn above line, we create a new variable.\nVariable Name: viewModel\nVariable Type: MainWindowViewModel\nValue of Variable: DataContext\nThis DataContext property gives us, view model of current view.\nWe store this view model value into viewModel variable.\nC#\r1viewModel.FilePath = openFileDialog.FileName;\rIn above line, we set the value of FilePath property.\nThis FilePath property is part of viewModel variable.\nIn our view model, we created this FilePath property.\nValue of FilePath property is set to full path of browsed file.\nWe set the value of FilePath property to FileName property.\nThis FileName property is part of openFileDialog variable.\nUse Browsing File Service Open MainWindowViewModel class.\nIn constructor of MainWindowViewModel class, pass IEventAggregator interface.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. C#\r1/// \u0026lt;summary\u0026gt; 2/// Default Constructor 3/// \u0026lt;/summary\u0026gt; 4/// \u0026lt;param name=\u0026#34;eventAggregator\u0026#34;\u0026gt;\u0026lt;/param\u0026gt; 5public MainWindowViewModel(IEventAggregator eventAggregator) 6{ 7 8}\rThis passing value to constructor is resolved during Runtime, by Prism WPF framework.\nWe pass IEventAggregator type variable, named as eventAggregator.\nC#\r1private readonly IEventAggregator eventAggregator;\rIn above line, we create a private, read-only field (variable).\nField Name: eventAggregator\nField Type: IEventAggregator\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. C#\r1/// \u0026lt;summary\u0026gt; 2/// Default Constructor 3/// \u0026lt;/summary\u0026gt; 4/// \u0026lt;param name=\u0026#34;eventAggregator\u0026#34;\u0026gt;\u0026lt;/param\u0026gt; 5public MainWindowViewModel(IEventAggregator eventAggregator) 6{ 7 8} 9 10private readonly IEventAggregator eventAggregator;\rNow we assign the constructor eventAggregator variable to this private, read-only field (variable).\nPlease see below üëáüèª code sample for reference.\nC#\r1/// \u0026lt;summary\u0026gt; 2/// Default Constructor 3/// \u0026lt;/summary\u0026gt; 4/// \u0026lt;param name=\u0026#34;eventAggregator\u0026#34;\u0026gt;\u0026lt;/param\u0026gt; 5public MainWindowViewModel(IEventAggregator eventAggregator) 6{ 7 this.eventAggregator = eventAggregator; 8} 9 10private readonly IEventAggregator eventAggregator;\rNow, we create BrowseFileCommand command, which we bind to Browse button.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. C#\r1private DelegateCommand _BrowseFileCommand; 2public DelegateCommand BrowseFileCommand =\u0026gt; 3 _BrowseFileCommand ?? (_BrowseFileCommand = new DelegateCommand(ExecuteBrowseFileCommand)); 4 5void ExecuteBrowseFileCommand() 6{ 7 8}\rIn above code, we create a Prism Command.\nType of this command is DelegateCommand.\nName of command: BrowseFileCommand\nWhen this command is asked to run, we execute ExecuteBrowseFileCommand method.\nNow, in this ExecuteBrowseFileCommand method, we publish the service.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. C#\r1private DelegateCommand _BrowseFileCommand; 2public DelegateCommand BrowseFileCommand =\u0026gt; 3 _BrowseFileCommand ?? (_BrowseFileCommand = new DelegateCommand(ExecuteBrowseFileCommand)); 4 5void ExecuteBrowseFileCommand() 6{ 7 eventAggregator.GetEvent\u0026lt;BrowseFileDialogService\u0026gt;().Publish(); 8}\rC#\r1eventAggregator.GetEvent\u0026lt;BrowseFileDialogService\u0026gt;().Publish();\rIn above code line, we publish the BrowseFileDialogService service.\nBy publish, we mean, we are calling a method, which we want to execute whenever this BrowseFileDialogService service called for publish.\nIn our case, in MainWindow.xaml.cs file has BrowseFile() method.\nThis BrowseFile() method will run when we publish the BrowseFileDialogService.\nFinal Result Now we run the application as shown in below üëáüèª image.\nNow we are able to browse file in MVVM pattern successfully.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Browse Solidworks Document UI.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":34,"permalink":"/wpf-tutorials/browse-solidworks-document-ui/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eI want to:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eCreate Browse Solidworks Document User Interface\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eWe will continue from previous article üöÄ \u003ca href=\"/wpf-tutorials/browse-solidworks-document-ui/\" target=\"_blank\"\u003eAdd Syncfusion Busy Indicator\u003c/a\u003e.\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e","tags":[],"title":"Browse Solidworks Document UI"},{"content":"Visual Basic for application (VBA) is a real, live programming language, it uses many elements common to all programming languages.\nIn subsequent topics, we go through several of these elements:\nComments Variables Constants Data types Arrays and few other concepts If you‚Äôve programmed with other languages, some of this topics will be familiar or if you‚Äôre a programming newbie, it‚Äôs time to roll up your sleeves and get busy.\nComments in VBA Code A comment is the simplest type of VBA statement because VBA ignores these statements, they can consist of anything you want.\nYou can insert a comment to remind yourself why you did something or to clarify some particularly code you wrote.\nUse comments liberally and extensively to describe what the code does (which isn‚Äôt always obvious by reading the code itself).\nOften, code that makes perfect sense today mystifies you tomorrow.\nYou begin a comment with an apostrophe (\u0026rsquo;). VBA ignores any text that follows an apostrophe in a line of code.\nYou can use a complete line for your comment or insert your comment at the end of a line of code.\nThe following example shows a VBA procedure with three comments, although they‚Äôre not necessarily good comments:\nvba\r1Sub CommentDemo() 2\u0026#39; This procedure does nothing of value 3 x = 0 \u0026#39;x represents nothing 4 \u0026#39;Display the result 5 MsgBox x 6End Sub\rThe apostrophe indicates a comment rule has one exception.\nVBA doesn‚Äôt interpret an apostrophe inside a set of quotation marks as a comment indicator.\nFor example, the following statement doesn‚Äôt contain a comment, even though it has an apostrophe:\nvba\r1MsgBox = \u0026#34;Can\u0026#39;t continue.\u0026#34;\rWhen you‚Äôre writing code, you may want to test a procedure by excluding a particular statement or group of statements.\nYou could delete the statements and then retype them later but that‚Äôs a waste of time.\nA better solution is to simply turn those statements into comments by inserting apostrophes.\nVBA ignores statements beginning with apostrophes when executing a routine.\nTo reactivate those commented statements, just remove the apostrophes.\nHere‚Äôs a quick way to convert a block of statements to comments.\nIn the VBE, choose View -\u0026gt; Toolbars -\u0026gt; Edit to display the Edit toolbar.\nTo convert a block of statements to comments, select the statements and click the Comment Block button.\nTo remove the apostrophes, select the statements and click the Uncomment Block button.\nAlthough comments can be helpful, not all comments are created equal.\nFor example, the following procedure uses lots of comments, but they add nothing of value.\nIn this case, the code is clear enough without the comments.\nvba\r1Sub BadComments() 2\u0026#39; Declare variables 3 Dim x As Integer 4 Dim y As Integer 5 Dim z As Integer 6\u0026#39; Start the routine 7 x = 100 \u0026#39;Assign 100 to x 8 y = 100 \u0026#39;Assign 100 to y 9\u0026#39; Add x and y and store in z 10 z = x + y 11\u0026#39; Show the result 12 MsgBox z 13End Sub\rEveryone develops his or her own style of commenting.\nTo be useful, however, comments should convey information that‚Äôs not immediately obvious from reading the code.\nOtherwise, comments just chew up bytes and make files larger than necessary.\nThe following tips can help you make effective use of comments:\nBriefly describe the purpose of each Sub or Function procedure you write.\nUse comments to keep track of changes you make to a procedure.\nUse a comment to indicate that you‚Äôre using a function or a construct in an unusual or nonstandard manner.\nUse comments to describe the variables you use, especially if you don‚Äôt use meaningful variable names.\nUse a comment to describe any workarounds you develop to overcome bugs in your code.\nWrite comments as you develop code, instead of saving the task for a final step.\nDepending on your work environment, consider adding a joke or two as a comment. The person who takes over your job when you get promoted might appreciate the humour.\nData types in VBA When I talk about data type, I‚Äôm referring to the manner in which a program stores data in memory - for example, as integers, real numbers, or strings.\nAlthough VBA can take care of these details automatically, it does so at a cost (There‚Äôs no free lunch).\nLetting VBA handle your data typing results in slower execution and inefficient memory use.\nFor small applications, this usually doesn‚Äôt present much of a problem.\nBut for large or complex applications, which may be slow or need to conserve every last byte of memory, you need to be on familiar terms with data types.\nVBA automatically handles all the data details, which makes life easier for programmers.\nNot all programming languages provide this luxury.\nFor example, some languages are strictly typed, which means the programmer must explicitly define the data type for every variable used.\nVBA does not require that you declare the variables that you use, but it‚Äôs definitely a good practice.\nVBA has a variety of built-in data types. Below table lists the most common types of data that VBA can handle.\nData Type Byte used Range of values Boolean 2 True or False Integer 2 ‚Äì32,768 to 32,767 Long 4 ‚Äì2,147,483,648 to 2,147,483,647 Single 4 ‚Äì3.402823E38 to 1.401298E45 Double (negative) 8 ‚Äì1.79769313486232E308 to ‚Äì4.94065645841247E-324 Double (positive) 8 4.94065645841247E‚Äì324 to 1.79769313486232E308 Currency 8 ‚Äì922,337,203,685,477.5808 to 922,337,203,685,477.5807 Date 8 1/1/100 to 12/31/9999 String 1 per char varies Object 4 Any defined object Variant Varies Any data type User defined Varies Varies Next post will be about VBA Variables.\n","date":"0001-01-01","id":35,"permalink":"/vba/programming-concepts/","summary":"\u003cp\u003eVisual Basic for application (VBA) is a real, live programming language, it uses many elements common to all programming languages.\u003c/p\u003e","tags":[],"title":"Programming Concepts, Comments and Data-types"},{"content":"In this post, I tell you about how to Fix Unit Issue in Solidworks API from VBA Macros in a Sketch.\nWhat is the Issue? Before going to solution let us see what is the issue we are trying to address.\nIn my all previous posts, you can see a NOTE (shown below) about Solidworks API.\nNOTE\nIt is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nPlease see below for detail:\nLength: Meter\nAngle: Radian\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means inches for distance. But when I used Solidworks API through VBA macros or C#, I need to converted numeric values.\nBecause Solidworks API output the distance in Meter which is not my requirement.\nSo in this post we address this issue and use this solution in future posts.\nFor this we take following steps:\nGet Unit currently in use in Solidworks.\nApply Select Case on the length of active unit.\nWe define values of factors i.e. LengthConversionFactor and AngleConversionFactor, these values depends upon the selected Length unit.\nAfter assigning the values, we use them when we need to define any length or angle value.\nCode Sample In below sample VBA macro program, we fix the issue.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Create Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39;-----------------------BELOW IS THE SOLUTION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;---------------------------------------------------------------- \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Set Sketch Segment value and Create a Circle Set swSketchSegment = swSketchManager.CreateCircleByRadius(0, 0, 0, 0.2 * LengthConversionFactor) \u0026#39; De-select the Sketch Segment after Circular Sketch Pattern swDoc.ClearSelection2 True \u0026#39; Show Front View after Circular Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page\n\u0026#39; Create variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment\rIn this line, we Create a variable which we named as swSketchSegment and the type of this swSketchSegment variable is SldWorks.SketchSegment.\nWe create variable swSketchSegment for Solidworks Sketch Segments.\nTo see methods and properties related to swSketchSegment object, please visit this page\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis GetUserPreferenceStringValue() method is a part of our main Solidworks variable swApp.\n\u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout that post if you want to understand above code in more detail.\n\u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double\rIn above line we define our local variable we use as Conversion Factors.\nSince this VBA program is small, we declare them in our Sub function.\nIf we have multiple functions, then we will create them with other Global variables.\n\u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select\rAbove we use a Select Case statement and apply GetUnits(0) method on swDoc variable to get the active unit of current document.\nIf you want to know more about Select Case statment then please visit If-Then and Select Case structure post.\nCase swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1\rAs shown in above code, when the is swMETER then we define the value of these factors.\nIn this case, it is:\nLengthConversionFactor = 1 AngleConversionFactor = 1 Since, I use IPS, I got the below case.\nCase swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329\rIn this case, it is:\nLengthConversionFactor = 0.0254\nI write the value in (1 * 0.0254) format to show a relation of values with \u0026ldquo;METER\u0026rdquo;.\nAngleConversionFactor = 0.01745329\nI write the value in (1 * 0.01745329) format to show a relation of values with \u0026ldquo;RADIAN\u0026rdquo;.\nSimilar is for all other CASES.\n\u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Set Sketch Segment value and Create a Circle Set swSketchSegment = swSketchManager.CreateCircleByRadius(0, 0, 0, 0.2 * LengthConversionFactor)\rIn above line, we set the value of Solidworks Sketch Segment variable swSketchSegment by CreateCircleByRadius method from Solidworks Sketch Manager.\nThis CreateCircleByRadius method creates a Circle at given point with radius.\nFor more information about CreateCircleByRadius method, you can read my Solidworks Macro - Create Circle By Radius From VBA Macro post.\nThat post describe all the parameters we need for this CreateCircleByRadius method in details.\nIn above line, we create a Circle with:\nCircle Centerpoint : At origin i.e. (0, 0, 0)\nCircle Radius : 0.2 * LengthConversionFactor\nAs you can notice, I have multiple the LengthConversionFactor in 0.2.\nThis will make sure that I get a circle of 0.4 Inch diameter. not a converted diameter in Meter.\nImage of created circle is shown below with diameter dimension.\n\u0026#39; De-select the Sketch after creation swDoc.ClearSelection2 True\rIn the above line of code, we deselect the Sketch after the Circular Sketch Pattern operation.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Show Front View after Circular Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView\rIn the above line of code, we update the view orientation to Front View.\nIn my machine, after inserting a sketch view orientation does not changed.\nBecause of this I have to update the view to Front view.\nFor showing Front View we used ShowNamedView2 method from our Solidworks document name swDoc.\nThis method takes 2 parameter described as follows:\nVName : Name of the view to display or an empty string to use ViewId instead\nViewId : ID of the view to display as defined by swStandardViews_e or -1 to use the VName argument instead.\nNOTE: If you specify both VName and ViewId, then ViewId takes precedence if the two arguments do not resolve to the same view.\nswStandardViews_e has following Standard View Types:\nswBackView\nswBottomView\nswDimetricView\nswFrontView\nswIsometricView\nswLeftView\nswRightView\nswTopView\nswExtendetricView\nIn our code, we did not use VName instead I used empty string in form of \u0026quot;\u0026quot; symbol.\nI used ViewId value to specify view and used swStandardViews_e.swFrontView value to use Standard Front View.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nThis is it !!!\nIf you found anything to add or update, please let me know on my e-mail.\nVBA Language feature used in this post In this post used some features of VBA programming language.\nThis section of post, has some brief information about the VBA programming language specific features.\nWe use Option Explicit for capturing un-declared variables. If you want to read more about Option Explicit then please visit Declaring and Scoping of Variables.\nThen we create variable for different data types. If you know in detail about the Variables, then please visit Variables and Data-types posts of this blog.\nIt will help you to understand what Variables are and how to use them.\nThen we create main Sub procedure for our macro. If you know in detail about the Sub procedure, then I suggest you to visit VBA Sub and Function Procedures and Executing Sub and Function Procedures posts of this blog.\nIt will help you to understand what Procedures are and how to use them.\nIn most part we create some variables and set their values. We set those values by using some functions provided from objects. If you don\u0026rsquo;t know about the functions, then you should visit VBA Functions and VBA Functions that do more posts of this blog.\nIt will help you to understand what functions are and how to use them.\nWe use Select Case for checking Length of active unit. If you want to read more about Select Case then please visit If-Then and Select Case structure.\nSolidworks API Objects In this post of Circular Sketch Pattern, we use Solidworks API objects and their methods.\nThis section contains the list of all Solidworks Objects used in this post.\nI have also attached links of these Solidworks API Objects in API Help website.\nIf you want to explore those objects, you can use these links.\nThese Solidworks API Objects are listed below:\nSolidworks Application Object\nIf you want explore Properties and Methods/Functions of Solidworks Application Object object you can visit this link.\nSolidworks Document Object\nIf you want explore Properties and Methods/Functions of Solidworks Document Object object you can visit this link.\nSolidworks Sketch Manager Object\nIf you want explore Properties and Methods/Functions of Solidworks Sketch Manager Object you can visit this link.\nSolidworks Sketch Segment Object\nIf you want explore Properties and Methods/Functions of Solidworks Sketch Segment Object you can visit this link.\nThis is it !!!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Fix Unit Issue in Solidworks API from VBA Macros.\nFor more such tutorials on Solidworks VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":36,"permalink":"/solidworks-macros/unit-correction/","summary":"\u003cp\u003eIn this post, I tell you about \u003cstrong\u003ehow to Fix \u003cem\u003eUnit Issue\u003c/em\u003e in Solidworks API from VBA Macros\u003c/strong\u003e in a Sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Fix Unit Issue"},{"content":"In this article we create Menu Folder Icon when MSI install application.\nPlease see below üëáüèª image of Menu Folder Icon for reference.\nUpdate [ExampleComponents.wxs] Below image show content of ExampleComponents.wxs\nwix\r1\u0026lt;Wix xmlns=\u0026#34;http://wixtoolset.org/schemas/v4/wxs\u0026#34;\u0026gt; 2 \u0026lt;Fragment\u0026gt; 3 \u0026lt;ComponentGroup Id=\u0026#34;ApplicationComponents\u0026#34; Directory=\u0026#34;INSTALLFOLDER\u0026#34;\u0026gt; 4 \u0026lt;Component Guid=\u0026#34;{68655BE8-9EF3-432E-B13B-9F7F08555AAE}\u0026#34; Directory=\u0026#34;INSTALLFOLDER\u0026#34;\u0026gt; 5 \u0026lt;File Id=\u0026#34;ApplicationFile\u0026#34; Source=\u0026#34;WPF_Application.exe\u0026#34;\u0026gt; 6 \u0026lt;Shortcut Id=\u0026#34;DesktopShortCut\u0026#34; 7 Directory=\u0026#34;DesktopFolder\u0026#34; 8 Advertise=\u0026#34;yes\u0026#34; Icon=\u0026#34;icon.exe\u0026#34; 9 Name=\u0026#34;!(bind.Property.ProductName)\u0026#34; /\u0026gt; 10 \u0026lt;/File\u0026gt; 11 \u0026lt;/Component\u0026gt; 12 \u0026lt;/ComponentGroup\u0026gt; 13 \u0026lt;/Fragment\u0026gt; 14\u0026lt;/Wix\u0026gt;\rAdd Menu Folder Icon wix\r1\u0026lt;Wix xmlns=\u0026#34;http://wixtoolset.org/schemas/v4/wxs\u0026#34;\u0026gt; 2 \u0026lt;Fragment\u0026gt; 3 \u0026lt;ComponentGroup Id=\u0026#34;ApplicationComponents\u0026#34; Directory=\u0026#34;INSTALLFOLDER\u0026#34;\u0026gt; 4 \u0026lt;Component Directory=\u0026#34;INSTALLFOLDER\u0026#34;\u0026gt; 5 \u0026lt;!--Add output file--\u0026gt; 6 \u0026lt;File Id=\u0026#34;ApplicationFile\u0026#34; Source=\u0026#34;WPF_Application.exe\u0026#34;\u0026gt; 7 \u0026lt;!--Add Desktop Shortcut--\u0026gt; 8 \u0026lt;Shortcut Id=\u0026#34;DesktopShortCut\u0026#34; 9 Directory=\u0026#34;DesktopFolder\u0026#34; 10 Advertise=\u0026#34;yes\u0026#34; Icon=\u0026#34;icon.exe\u0026#34; 11 Name=\u0026#34;!(bind.Property.ProductName)\u0026#34; /\u0026gt; 12 \u0026lt;!--Add Menu Folder Shortcut--\u0026gt; 13 \u0026lt;Shortcut Id=\u0026#34;ProgramMenuIcon\u0026#34; Advertise=\u0026#34;yes\u0026#34; 14 Directory=\u0026#34;APPFOLDER\u0026#34; Icon=\u0026#34;icon.exe\u0026#34; 15 Name=\u0026#34;!(bind.Property.ProductName)\u0026#34;\u0026gt; 16 \u0026lt;/Shortcut\u0026gt; 17 \u0026lt;/File\u0026gt; 18 \u0026lt;/Component\u0026gt; 19 \u0026lt;/ComponentGroup\u0026gt; 20 \u0026lt;/Fragment\u0026gt; 21\u0026lt;/Wix\u0026gt;\rIn above code sample, we \u0026ldquo;Add Menu Folder Shortcut\u0026rdquo;.\nFor this we use \u0026lt;Shortcut\u0026gt; tag.\nPlease see below üëáüèª code for reference.\nAfter adding \u0026lt;Shortcut\u0026gt; tag, we define some properties of \u0026lt;Shortcut\u0026gt; tag.\nPlease see below list of properties for \u0026lt;Shortcut\u0026gt; tag.\nProperty Name Property Description Id Identifier for this tag, by which we can refer to this tag. Directory Special Id, which define Directory where we want to show our shortcut. Advertise Boolean variable which decide we want to advertise this shortcut or not. Icon Id of Icon image. Please note that this is Id \u0026ldquo;NOT source of icon image\u0026rdquo;. Name Name of Icon which we want to show with Icon image. Values we used in our code.\nProperty Name Value Used Value Comment Id ProgramMenuIcon Id which I give. Directory APPFOLDER Special Id for Application Folder. Since we want to create Program Menu Folder Shortcut. Advertise yes Always \u0026lsquo;Yes\u0026rsquo; since this is the easy way. Icon icon.exe Reference to Id of image in Package.wxs file. Name !(bind.Property.ProductName) Bind of Shortcut name to Product Name.s [Build] Solution Now we need to build solution as shown below.\nAfter building solution we need to go to folder where MSI is created.\nPlease see below üëáüèª image for reference.\nFinal Result Run the MSI to install application.\nBelow üëáüèª image show final result after running installation.\nThat\u0026rsquo;s it!!!\nHope this post helps you.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":37,"permalink":"/knowledge-base/wix-add-menu-folder-icon/","summary":"\u003cp\u003eIn this article we \u003cstrong\u003ecreate Menu Folder Icon\u003c/strong\u003e when MSI install application.\u003c/p\u003e\n\u003cp\u003ePlease see below üëáüèª image of \u003cstrong\u003eMenu Folder Icon\u003c/strong\u003e for reference.\u003c/p\u003e","tags":[],"title":"Wix Add Menu Folder Icon"},{"content":"","date":"2023-09-07","id":38,"permalink":"/solidworks-macros/07-sketch---point-and-spline/","summary":"","tags":[],"title":"Sketch - Point and Spline"},{"content":"Objective I want to:\nBrowse Solidworks Document File.\nDelete selected browsed file.\nWe will continue from previous article üöÄ Browse Solidworks Document UI.\nDemo Video Below üé¨ video shows how to Delete Browse Solidworks Document File in Visual Studio 2022.\nUpdate XAML File for UI In this article, we will update button text only.\nOpen \u0026ldquo;MainWindow.xaml\u0026rdquo; as shown in below üëáüèª image.\nUpdate \u0026ldquo;MainWindow.xaml\u0026rdquo; as shown in below üëáüèª image. Please see below üëáüèª code sample for reference. xaml\r\u0026lt;syncfusion:ButtonAdv Grid.Row=\u0026#34;3\u0026#34; Grid.Column=\u0026#34;1\u0026#34; Grid.ColumnSpan=\u0026#34;3\u0026#34; Width=\u0026#34;200\u0026#34; Height=\u0026#34;30\u0026#34; Command=\u0026#34;{Binding ClickCommand}\u0026#34; IconHeight=\u0026#34;0\u0026#34; IconWidth=\u0026#34;0\u0026#34; Label=\u0026#34;Delete Browsed File\u0026#34; /\u0026gt;\rPlease see below üëáüèª image for update UI. Update MainWindowViewModel In this section, we will update MainWindowViewModel.cs {lineNos=true} file.\nOpen \u0026ldquo;MainWindowViewModel.xaml\u0026rdquo; as shown in below üëáüèª image.\nGo to \u0026ldquo;ExecuteClickCommand()\u0026rdquo; method.\nAdd below üëáüèª code.\nC#\r1async void ExecuteClickCommand() 2{ 3 // Show busy indicator 4 IsBusy = true; 5 6 // Check if we browsed a file 7 if (string.IsNullOrEmpty(FilePath)) 8 return; 9 10 // Check if browsed file exist or not 11 if (File.Exists(FilePath) == false) 12 return; 13 14 await Task.Run(() =\u0026gt; 15 { 16 // Delete selected file. 17 File.Delete(FilePath); 18 }); 19 20 // Hide busy indicator 21 IsBusy = false; 22}\rPlease see below üëáüèª image for update UI. Final Result Now we run the application as shown in below üëáüèª image.\nNow we are able to browse file in MVVM pattern successfully.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Browse Solidworks Document UI.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":39,"permalink":"/wpf-tutorials/delete-browse-file/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eI want to:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eBrowse Solidworks Document File.\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eDelete selected browsed file.\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eWe will continue from previous article üöÄ \u003ca href=\"/wpf-tutorials/browse-solidworks-document-ui/\" target=\"_blank\"\u003eBrowse Solidworks Document UI\u003c/a\u003e.\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e","tags":[],"title":"Delete Browse Solidworks Document File"},{"content":"In this post, I tell you about how to create 2D Line through Solidworks VBA Macros in a sketch.\nFor this, I take the example from previous Solidworks Macros - Open Assembly and Drawing document post.\nIn this post, I tell you about CreateLine method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new line.\nVideo of Code on YouTube Please see below video on how to create 2D Line from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating lines.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Creating Variable for Solidworks Sketch segment Dim mySketchSegment As SketchSegment \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating an horizontal line Set mySketchSegment = swSketchManager.CreateLine(0, 0, 0, 2, 0, 0) \u0026#39; De-select the line after creation swDoc.ClearSelection2 True End Sub\rUnderstanding Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable which we define earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue(). This method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating Variable for Solidworks Sketch segment Dim mySketchSegment As SketchSegment \u0026#39; Creating an horizontal line Set mySketchSegment = swSketchManager.CreateLine(0, 0, 0, 2, 0, 0)\rIn above sample code, we 1st create a variable named mySketchSegment of type SketchSegment.\nA SketchSegment represent a line, ellipse, parabola or spline.\nA SketchSegment provides functions that are generic to every type of sketch segment.\nFor example, every sketch segment has an ID and can be selected programmatically.\nTherefore, the SketchSegment interface provides functions to obtain the ID and to select the item.\nFor detailed information about the SketchSegment please visit this page of Solidworks API Help\nIn 2nd line, we set the value of sketch segment variable mySketchSegment.\nWe get this value from CreateLine method which is inside the swSketchManager variable.\nswSketchManager variable is a type of SketchManager, hence we used CreateLine method from SketchManager.\nThis CreateLine method takes following parameters as explained:\nX1 : X coordinate of the line start point\nY1 : Y coordinate of the line start point\nZ1 : Z coordinate of the line start point\nX2 : X coordinate of the line end point\nY2 : Y coordinate of the line end point\nZ2 : Z coordinate of the line end point\nIn the above code sample I have used (0, 0, 0) for start point.\nThis is origin of sketch hence I start line from origin.\nFor End point I used (2, 0, 0) which is 2 point distance in X-direction or horizontal direction.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means inches for distance. But when I used Solidworks API through VBA macros or C#, I need to use converted numeric values.\nBecause Solidworks API output the distance in Meter which is not my requirement.\n\u0026#39; De-select the line after creation swDoc.ClearSelection2 True\rIn the last line of code, we de-select the created line.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\nHope this post helps you to create lines in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":40,"permalink":"/solidworks-macros/sketch-create-line/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create 2D Line through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e\n\u003cp\u003eFor this, I take the example from previous \u003cstrong\u003e\u003ca href=\"/solidworks-macros/select-plane-from-tree\"\u003eSolidworks Macros - Open Assembly and Drawing document\u003c/a\u003e\u003c/strong\u003e post.\u003c/p\u003e","tags":[],"title":"Solidworks Sketch Macro - Create Line"},{"content":"VBA‚Äôs main purpose is to manipulate data. VBA stores the data in your computer‚Äôs memory; it may or may not end up on disk.\nSome data, such as sketch, resides in objects.\nOther data is stored in variables that you create.\nA variable is simply a named storage location in your computer‚Äôs memory.\nYou have lots of flexibility in naming your variables, so make the variable names as descriptive as possible.\nYou assign a value to a variable by using the equal sign operator.\nThe variable names in these examples appear on both the left and right sides of the equal signs.\nNote that the last example uses two variables.\nvba\r1x = 1 2InterestRate = 0.075 3LoanPayoffAmount = 243089 4DataEntered = False 5x = x + 1 6UserName = \u0026#34;Bill Gates\u0026#34; 7DateStarted = #3/14/2010# 8MyNum = YourNum * 1.25\rVBA enforces a few rules regarding variable names:\nYou can use letters, numbers, and some punctuation characters, but the first character must be a letter. You cannot use any spaces or periods in a variable name. VBA does not distinguish between uppercase and lowercase letters. You cannot use the following characters in a variable name: #, $, %, \u0026amp;, or !. Variable names can be no longer than 255 characters. Of course, you‚Äôre only asking for trouble if you use variable names 255 characters long. To make variable names more readable, programmers often use mixed case (for example, PartDimension) or the underscore character (part_dimension).\nVBA has many reserved words that you can‚Äôt use for variable names or procedure names.\nThese include words such as Sub, Dim, With, End, Next, and For.\nIf you attempt to use one of these words as a variable, you may get a compile error which means your code won‚Äôt run.\nSo, if an assignment statement produces an error message, double-check and make sure that the variable name isn‚Äôt a reserved word.\nVBA does allow you to create variables with names that match names in your CAD's object model, such as sketch and part.\nBut, obviously, using names like that just increases the possibility of getting confused.\nSo resist the urge to use a variable named sketch, and use something like swSketch, mySketch or any meaning full name instead.\n","date":"0001-01-01","id":41,"permalink":"/vba/variables/","summary":"\u003cp\u003e\u003ccode\u003eVBA‚Äôs\u003c/code\u003e main purpose is to manipulate data. \u003ccode\u003eVBA\u003c/code\u003e stores the \u003cem\u003edata\u003c/em\u003e in your computer‚Äôs \u003cem\u003ememory\u003c/em\u003e; it may or may not end up on disk.\u003c/p\u003e","tags":[],"title":"VBA Variables"},{"content":"","date":"2023-09-07","id":42,"permalink":"/solidworks-macros/08-sketch---fillet-and-chamfer/","summary":"","tags":[],"title":"Sketch - Fillet and Chamfer"},{"content":"Objective I want to:\nShow Confirmation message to user before deleting browsed file.\nAfter deleting file, show information message to user.\nWe will continue from previous article üöÄ Delete Browse Solidworks Document File.\nDemo Video Below üé¨ video shows how to Add Message Service in Visual Studio 2022.\nAdd Service for Messaging in application Now we add MessagesService class to \u0026ldquo;Service\u0026rdquo; folder.\nPlease see below üëáüèª image for reference.\nFor reference, how to add Service class, please visit üöÄ Add Service for Browsing File Dialog article.\nNow we will add following services to this newly created MessagesService class.\nConfirmationMessagesService\nInformationMessagesService\nErrorMessagesService\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. C#\r1using Prism.Events; 2using System; 3using System.Collections.Generic; 4using System.Linq; 5using System.Text; 6using System.Threading.Tasks; 7 8namespace WPF_Application.Services 9{ 10 internal class ConfirmationMessagesService : PubSubEvent\u0026lt;string\u0026gt; { } 11 internal class InformationMessagesService : PubSubEvent\u0026lt;string\u0026gt; { } 12 internal class ErrorMessagesService : PubSubEvent\u0026lt;string\u0026gt; { } 13}\rFor more details on how to add Services, please visit üöÄ Add Service for Browsing File Dialog article.\nIn above line, we add \u0026lt;string\u0026gt; to all PubSubEvent class.\nThis indicate that, when we Publish our service, we need to give a string as passing parameter to Publish service.\nFor example, we will pass a question as string when we Publish ConfirmationMessagesService service.\nRegister Services Open MainWindow.xaml.cs file.\nPass IEventAggregator to constructor, and assigned it to private field.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. C#\r1using Microsoft.Win32; 2using Prism.Events; 3using Syncfusion.Windows.Shared; 4using System; 5using System.Windows; 6using WPF_Application.Services; 7using WPF_Application.ViewModels; 8 9namespace WPF_Application.Views 10{ 11 /// \u0026lt;summary\u0026gt; 12 /// Interaction logic for MainWindow.xaml 13 /// \u0026lt;/summary\u0026gt; 14 public partial class MainWindow : ChromelessWindow 15 { 16 private readonly IEventAggregator eventAggregator; 17 18 public MainWindow(IEventAggregator eventAggregator) 19 { 20 InitializeComponent(); 21 this.eventAggregator = eventAggregator; 22 } 23 } 24}\rNow, we register our services.\nWhen these service is called, some functions will gets executed.\nThese registration and execution is handle by eventAggregator field.\nPlease see below üëáüèª code sample for reference.\nC#\r1using Microsoft.Win32; 2using Prism.Events; 3using Syncfusion.Windows.Shared; 4using System; 5using System.Windows; 6using WPF_Application.Services; 7using WPF_Application.ViewModels; 8 9namespace WPF_Application.Views 10{ 11 /// \u0026lt;summary\u0026gt; 12 /// Interaction logic for MainWindow.xaml 13 /// \u0026lt;/summary\u0026gt; 14 public partial class MainWindow : ChromelessWindow 15 { 16 private readonly IEventAggregator eventAggregator; 17 18 public MainWindow(IEventAggregator eventAggregator) 19 { 20 InitializeComponent(); 21 this.eventAggregator = eventAggregator; 22 this.eventAggregator.GetEvent\u0026lt;BrowseFileDialogService\u0026gt;().Subscribe(BrowseFile); 23 this.eventAggregator.GetEvent\u0026lt;ConfirmationMessagesService\u0026gt;().Subscribe(ConfirmationMessages); 24 this.eventAggregator.GetEvent\u0026lt;InformationMessagesService\u0026gt;().Subscribe(InformationMessages); 25 this.eventAggregator.GetEvent\u0026lt;ErrorMessagesService\u0026gt;().Subscribe(ErrorMessages); 26 } 27 28 private void BrowseFile() 29 { 30 OpenFileDialog openFileDialog = new OpenFileDialog(); 31 openFileDialog.Filter = \u0026#34;Solidworks Part|*.sldprt|Solidworks Assembly|*.sldasm|Solidworks Drawing|*.slddrw\u0026#34;; 32 openFileDialog.DefaultExt = \u0026#34;*.sldprt\u0026#34;; 33 34 bool? result = openFileDialog.ShowDialog(); 35 36 if (result == false || string.IsNullOrEmpty(openFileDialog.FileName)) 37 return; 38 39 var viewModel = DataContext as MainWindowViewModel; 40 viewModel.FilePath = openFileDialog.FileName; 41 } 42 43 private void ConfirmationMessages(string messageToShow) 44 { 45 var result = MessageBox.Show(messageToShow, \u0026#34;Confirmation\u0026#34;, MessageBoxButton.YesNo, MessageBoxImage.Question); 46 var viewModel = DataContext as MainWindowViewModel; 47 viewModel.DeleteFile = (result == MessageBoxResult.Yes) ? true : false; 48 } 49 50 private void InformationMessages(string messageToShow) 51 { 52 MessageBox.Show(messageToShow, \u0026#34;Information\u0026#34;, MessageBoxButton.OK, MessageBoxImage.Information); 53 } 54 55 private void ErrorMessages(string messageToShow) 56 { 57 MessageBox.Show(messageToShow, \u0026#34;Error\u0026#34;, MessageBoxButton.OK, MessageBoxImage.Error); 58 } 59 } 60}\rUnderstand Service Methods In above code, we register 4 services. They are as follows:\nBrowseFileDialogService ConfirmationMessagesService InformationMessagesService ErrorMessagesService BrowseFileDialogService is already explained in üöÄ Understand Service Call Execute Function article.\nPlease visit üöÄ Understand Service Call Execute Function article for more details.\nIn this section, we will understand remaining 3 service and their respective execution methods.\nUnderstand ConfirmationMessages method In MainWindow.xaml.cs contructor, we register ConfirmationMessagesService service.\nWhen we call for ConfirmationMessagesService service, we execute ConfirmationMessages method.\nNow let us understand ConfirmationMessages method as follows.\nC#\r1private void ConfirmationMessages(string messageToShow) 2{ 3 var result = MessageBox.Show(messageToShow, \u0026#34;Confirmation\u0026#34;, MessageBoxButton.YesNo, MessageBoxImage.Question); 4 var viewModel = DataContext as MainWindowViewModel; 5 viewModel.DeleteFile = (result == MessageBoxResult.Yes) ? true : false; 6}\rIn ConfirmationMessages method, we pass a string as parameter.\nParameter Name: messageToShow Variable Type: string Return Type: Void C#\r1var result = MessageBox.Show(messageToShow, \u0026#34;Confirmation\u0026#34;, MessageBoxButton.YesNo, MessageBoxImage.Question);\rIn above line, we create a variable as follows:\nVariable Name: result Variable Type: var In above line, we store result of MessageBox.Show method into result variable.\nThis MessageBox.Show method takes following parameters.\nmessageBoxText: A String that specifies the text to display.\ncaption: A String that specifies the title bar caption to display.\nbutton: A MessageBoxButtons values that specifies which buttons to display in the message box. These buttons are as follows.\nMember Description AbortRetryIgnore 2: The message box contains Abort, Retry, and Ignore buttons. CancelTryContinue 6: Specifies that the message box contains Cancel, Try Again, and Continue buttons. OK 0: The message box contains an OK button. OKCancel 1: The message box contains OK and Cancel buttons. RetryCancel 5: The message box contains Retry and Cancel buttons. YesNo 4: The message box contains Yes and No buttons. YesNoCancel 3: The message box contains Yes, No, and Cancel buttons. icon: A MessageBoxImage value that specifies the icon to display. These buttons are as follows.\nMember Description Asterisk 64: The message box contains a symbol consisting of a lowercase letter i in a circle. Error 16: The message box contains a symbol consisting of white X in a circle with a red background. Exclamation 48: The message box contains a symbol consisting of an exclamation point in a triangle with a yellow background. Hand 16: The message box contains a symbol consisting of white X in a circle with a red background. Information 64: The message box contains a symbol consisting of a lowercase letter i in a circle. None 0: The message box contains no symbols. Stop 16: The message box contains a symbol consisting of white X in a circle with a red background. Warning 48: The message box contains a symbol consisting of an exclamation point in a triangle with a yellow background. Result Value: This MessageBox.Show method return MessageBoxResult value that specifies which message box button is clicked by the user as follows.\nMember Description Cancel 2: The result value of the message box is Cancel. No 7: The result value of the message box is No. None 0: The message box returns no result. OK 1: The result value of the message box is OK. Yes 6: The result value of the message box is Yes. Parameter values we used in our code are as follows:\nParameter Name Value Used messageBoxText messageToShow caption \u0026quot;Confirmation\u0026quot; button MessageBoxButton.YesNo icon MessageBoxImage.Question Please visit üöÄ MessageBox.Show Method article for more details.\nC#\r1var viewModel = DataContext as MainWindowViewModel;\rIn above line of code, we create a variable as follows:\nVariable Name: viewModel Variable Type: MainWindowViewModel Value: DataContext property of MainWindow. C#\r1viewModel.DeleteFile = (result == MessageBoxResult.Yes) ? true : false;\rIn above line, we set the value of DeleteFile property.\nThis property is part of viewModel variable.\nWarning\nPlease note that we still not created this propery, so Visual studio will show error.\nWe set the value of DeleteFile property to true or false, based on condition. Condition: (result == MessageBoxResult.Yes) If above condition is true, then final value is true. If above condition is false, then final value is false. Understand InformationMessages method Now let us understand InformationMessages method as follows. C#\r1private void InformationMessages(string messageToShow) 2{ 3 MessageBox.Show(messageToShow, \u0026#34;Information\u0026#34;, MessageBoxButton.OK, MessageBoxImage.Information); 4}\rIn above line of code, we show a MessageBox to user.\nFor this, we use MessageBox.Show method.\nFor more details on MessageBox.Show method please read previous section of this article.\nParameter values we used in our code are as follows:\nParameter Name Value Used messageBoxText messageToShow caption \u0026quot;Information\u0026quot; button MessageBoxButton.OK icon MessageBoxImage.Information Understand ErrorMessages method Now let us understand ErrorMessages method as follows. C#\r1private void ErrorMessages(string messageToShow) 2{ 3 MessageBox.Show(messageToShow, \u0026#34;Error\u0026#34;, MessageBoxButton.OK, MessageBoxImage.Error); 4}\rIn above line of code, we show a MessageBox to user.\nFor this, we use MessageBox.Show method.\nFor more details on MessageBox.Show method please read previous section of this article.\nParameter values we used in our code are as follows:\nParameter Name Value Used messageBoxText messageToShow caption \u0026quot;Error\u0026quot; button MessageBoxButton.OK icon MessageBoxImage.Error Update MainWindowViewModel For Message Service Open MainWindowViewModel.cs file.\nAdd DeleteFile property as shown below.\nPlease see below code for adding DeleteFile property. C#\r1private bool _DeleteFile; 2public bool DeleteFile 3{ 4 get { return _DeleteFile; } 5 set { SetProperty(ref _DeleteFile, value); } 6}\rShow message for Empty FilePath property Show error message to user if we browsed a file or not.\nPlease see below üëáüèª image for how to add code for showing error message.\nPlease see below code for showing error message on empty browsed file. C#\r1// Check if we browsed a file 2if (string.IsNullOrEmpty(FilePath)) 3{ 4 // Show information that file is deleted. 5 this.eventAggregator.GetEvent\u0026lt;ErrorMessagesService\u0026gt;().Publish(\u0026#34;Empty File Path.\u0026#34;); 6 return; 7}\rShow message if browsed file exist or not Show error message to user if browsed file exist or not.\nPlease see below üëáüèª image for how to add code for showing error message.\nPlease see below code for showing error message on empty browsed file. C#\r1// Check if browsed file exist or not 2if (File.Exists(FilePath) == false) 3{ 4 // Show information that file is deleted. 5 this.eventAggregator.GetEvent\u0026lt;ErrorMessagesService\u0026gt;().Publish($\u0026#34;[{FilePath}] did not exist.\u0026#34;); 6 return; 7}\rGet Confirmation From User Please see below code for Get confirmation from user. C#\r1// Get confirmation from user 2this.eventAggregator.GetEvent\u0026lt;ConfirmationMessagesService\u0026gt;().Publish($\u0026#34;Do you want to delete [{FilePath}]?\u0026#34;);\rWhen User Declined Confirmation In this section, we check, if user not give confirmation for deleting file. C#\r1// Not confirmed then clear data and exit function. 2if (!DeleteFile) 3{ 4 ClearData(); 5 return; 6} 7 8/// \u0026lt;summary\u0026gt; 9/// Method for clearing \u0026lt;see cref=\u0026#34;FilePath\u0026#34;/\u0026gt; property. 10/// \u0026lt;/summary\u0026gt; 11void ClearData() =\u0026gt; FilePath = string.Empty;\rWhen User Give Confirmation for Deleting File C#\r1// Show busy indicator 2IsBusy = true; 3 4await Task.Run(() =\u0026gt; 5{ 6 // Delete Selected File 7 File.Delete(FilePath); 8 9}); 10 11// Hide busy indicator 12IsBusy = false;\rShow Success Message To User Please see below code for Show information that file is deleted. C#\r1// Show information that file is deleted. 2this.eventAggregator.GetEvent\u0026lt;InformationMessagesService\u0026gt;().Publish(\u0026#34;File sucessfully deleted.\u0026#34;);\rFinal Result Now we run the application as shown in below üëáüèª image.\nNow we are able to delete browsed file in MVVM pattern successfully.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to show message services to users in WPF Prism application.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":43,"permalink":"/wpf-tutorials/add-messages-service/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eI want to:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eShow Confirmation message to user before deleting browsed file.\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eAfter deleting file, show information message to user.\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e","tags":[],"title":"Add Message Service"},{"content":"If you read the previous topics, you now know a bit about üöÄVariables and Data-types.\nIn this topic, you discover how to declare a variable as a certain data type.\nIf you don‚Äôt declare the data type for a variable you use in a VBA routine, VBA uses the default data type: Variant.\nData stored as a Variant acts like a chameleon; it changes type depending on what you do with it.\nFor example, if a variable is a Variant data type and contains a text string that looks like a number (such as ‚Äú123‚Äù), you can use this variable for string manipulations as well as numeric calculations.\nVBA automatically handles the conversion. Letting VBA handle data types may seem like an easy way out ‚Äî but remember that you sacrifice speed and memory.\nBefore you use variables in a procedure, it‚Äôs an excellent practice to declare your variables ‚Äî that is, tell VBA each variable‚Äôs data type.\nDeclaring your variables makes your program run faster and use memory more efficiently.\nThe default data type, Variant, causes VBA to repeatedly perform time consuming checks and reserve more memory than necessary.\nIf VBA knows a variable‚Äôs data type, it doesn‚Äôt have to investigate and can reserve just enough memory to store the data.\nTo force yourself to declare all the variables you use, include the following as the first statement in your VBA module:\nvba\r1Option Explicit\rWhen this statement is present, you won‚Äôt be able to run your code if it contains any undeclared variables.\nYou need to use Option Explicit only once: at the beginning of your module, prior to the declaration of any procedures in the module.\nKeep in mind that the Option Explicit statement applies only to the module in which it resides.\nIf you have more than one VBA module in a project, you need an Option Explicit statement for each module.\nSuppose that you use an undeclared variable (that is, a Variant) named myDimension.\nAt some point in your routine, you insert the following statement:\nvba\r1myDimnsion = 11\rThis misspelled variable, which is difficult to spot, will probably cause your routine to give incorrect results.\nIf you use Option Explicit at the beginning of your module (forcing you to declare the myDimension variable), VBE generates an error if it encounters a misspelled variation of that variable.\nTo ensure that the Option Explicit statement is inserted automatically whenever you insert a new VBA module; turn on the Require Variable Definition option.\nYou find it in the Editor tab of the Options dialog box (in the VBE, choose Tools -\u0026gt; Options).\nNote\nI highly recommend doing so.\nDeclaring your variables also lets you take advantage of a shortcut that can save some typing.\nJust type the first two or three characters of the variable name, and then press Ctrl + Space.\nThe VBE will either complete the entry for you or ‚Äî if the choice is ambiguous ‚Äî show you a list of matching words to select from.\nIn fact, this slick trick works with reserved words and functions, too.\nYou now know the advantages of declaring variables, but how do you do this?\nThe most common way is to use a Dim statement.\nHere are some examples of variables being declared:\nvba\r1Dim YourName as String 2Dim PartLength as Long 3Dim bRet as Boolean 4Dim X\rThe first three variables are declared as a specific data type.\nThe last variable, X, is not declared as a specific data type, so it‚Äôs treated as a Variant (it can be anything).\nBesides Dim, VBA has three other keywords that are used to declare variables:\nStatic Public Private I explain more about the Dim, Static, Public, and Private keywords later on, but first I must cover two other topics that are relevant here: a variable‚Äôs scope and a variable‚Äôs life.\nRecall that your code can have any number of VBA modules and a VBA module can have any number of Sub and Function procedures.\nA variable‚Äôs scope determines which modules and procedures can use the variable.\nBelow Table describes the scopes:\nVBA‚Äôs Variable‚Äôs Scope Scope How the Variable is Declared Procedure only By using a Dim or a Static statement in the procedure that uses the variable. Module only By using a Dim or a Private statement before the first Sub or Function statement in the module. All procedures in all modules By using a Public statement before the first Sub or Function statement in the module. If you get confused keep reading next post on these topics.\nNext post will be about Variable Scope.\n","date":"0001-01-01","id":44,"permalink":"/vba/declaring-and-scoping-of-variables/","summary":"\u003cp\u003eIf you read the previous topics, you now know a bit about üöÄ\u003cstrong\u003e\u003ca href=\"/vba/variables\"\u003eVariables\u003c/a\u003e and \u003ca href=\"/vba/programming-concepts#data-types-in-vba\"\u003eData-types\u003c/a\u003e\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003eIn this topic, you discover how to \u003cstrong\u003edeclare\u003c/strong\u003e a \u003ccode\u003evariable\u003c/code\u003e as a certain \u003cem\u003edata type\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Declaring and Scoping of Variables"},{"content":"In this post, I tell you about how to create 2D CenterLine through Solidworks VBA Macros in a sketch.\nThe process is almost identical with previous Solidworks Sketch Macros - Create Line post.\nIn this post, I tell you about CreateCenterLine method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new Centerline.\nVideo of Code on YouTube Please see below video on how to create 2D Center Line from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating lines.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Creating Variable for Solidworks Sketch segment Dim mySketchSegment As SketchSegment \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating an horizontal line Set mySketchSegment = swSketchManager.CreateCenterLine(0, 0, 0, 0, 2, 0) \u0026#39; De-select the line after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable which we define earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue(). This method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating Variable for Solidworks Sketch segment Dim mySketchSegment As SketchSegment \u0026#39; Creating an horizontal line Set mySketchSegment = swSketchManager.CreateCenterLine(0, 0, 0, 0, 2, 0)\rIn above sample code, we 1st create a variable named mySketchSegment of type SketchSegment.\nA SketchSegment represent a line, ellipse, parabola or spline.\nA SketchSegment provides functions that are generic to every type of sketch segment.\nFor example, every sketch segment has an ID and can be selected programmatically.\nTherefore, the SketchSegment interface provides functions to obtain the ID and to select the item.\nFor detailed information about the SketchSegment please visit this page of Solidworks API Help\nIn 2nd line, we set the value of sketch segment variable mySketchSegment.\nWe get this value from CreateCenterLine method which is inside the swSketchManager variable.\nswSketchManager variable is a type of SketchManager, hence we used CreateCenterLine method from SketchManager.\nThis CreateCenterLine method takes following parameters as explained:\nX1 : X coordinate of the line start point\nY1 : Y coordinate of the line start point\nZ1 : Z coordinate of the line start point\nX2 : X coordinate of the line end point\nY2 : Y coordinate of the line end point\nZ2 : Z coordinate of the line end point\nIn the above code sample I have used (0, 0, 0) for start point.\nThis is origin of sketch hence I start line from origin.\nFor End point I used (0, 2, 0) which is 2 point distance in Y-direction or vertical direction.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means \u0026ldquo;inches\u0026rdquo; for distance.\nBut when I used Solidworks API through VBA macros or C#, I have to use converted numeric values.\nBecause Solidworks API output the distance in Meter only; which is not my requirement.\n\u0026#39; De-select the line after creation swDoc.ClearSelection2 True\rIn the this line of code, we de-select the created line.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document variable swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nHope this post helps you to create lines in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":45,"permalink":"/solidworks-macros/sketch-create-centerline/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create 2D CenterLine through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e\n\u003cp\u003eThe process is almost identical with previous \u003cstrong\u003e\u003ca href=\"/solidworks-macros/sketch-create-line\"\u003eSolidworks Sketch Macros - Create Line\u003c/a\u003e\u003c/strong\u003e post.\u003c/p\u003e","tags":[],"title":"Solidworks Sketch Macro - Create CenterLine"},{"content":"At The CAD Coder, your privacy is important. This policy explains what personal data we collect and how we use it.\nüë• Personal Information We do not collect personal information unless you voluntarily provide it.\nThis website:\nDoes not require registration Does not request sensitive information May log visitor data anonymously for usage tracking and improvement If you submit your email through a form (e.g., newsletter signup), it will only be used for that purpose and never sold or shared.\nüç™ Cookies Like most websites, we use cookies to:\nImprove site speed and performance Understand visitor behavior Offer content supported by advertising (including affiliate links) We do not use cookies to:\nCollect personal data without consent Sell data to third parties üìä Analytics \u0026amp; Tracking We use third-party analytics tools to help us understand how users interact with the site:\nGoogle Analytics\nSee Google‚Äôs Privacy Policy Analytics data may include:\nBrowser/device type Pages visited Time on site Referring sites (e.g., search engines) üõçÔ∏è Affiliate Links Some pages may contain affiliate links (e.g., to Amazon).\nIf you make a purchase through these links, we may earn a small commission ‚Äî at no extra cost to you.\nüåç GDPR \u0026amp; CCPA Compliance If you are a resident of the EU or California, you have the right to:\nAccess the data we have about you Request correction or deletion Withdraw consent at any time To request your data or exercise these rights, please thecadcoder at gmail dot com\r.\n‚öôÔ∏è Turning Off Cookies Most web browsers allow you to disable cookies in settings. Doing so may impact how this website functions.\nCheck your browser‚Äôs help section for instructions.\nüì¨ Contact If you have any questions about this Privacy Policy, contact:\nüìß thecadcoder [at] gmail [dot] com\nclick üëâ thecadcoder at gmail dot com\r.\n","date":"2025-07-09","id":46,"permalink":"/privacy/","summary":"How The CAD Coder collects, stores, and protects your data.","tags":[],"title":"Privacy Policy"},{"content":"","date":"2023-09-07","id":47,"permalink":"/solidworks-macros/09-sketch---trim-and-extend/","summary":"","tags":[],"title":"Sketch - Trim and Extend"},{"content":"Objective I want to:\nCreate User Interface for Inserting Solidworks Sketch into Sketch Document.\nShare method which allowed us to use \u0026lsquo;Properties and methods\u0026rsquo; of \u0026lsquo;ViewModel\u0026rsquo; as \u0026lsquo;IntelliSense\u0026rsquo; in \u0026lsquo;XAML UI\u0026rsquo;.\nImportant Note:\nWe will reference previous articles for adding controls and services.\nHence reading previous WPF artices is highly suggested.\nDemo Video Below üé¨ video shows how to Insert Solidworks Sketch into Solidworks Document UI in Visual Studio 2022.\nSetting Project We need to add some required UI changes as part of Project Setup.\nPlease follow below sections for this.\nAdd [Prism Project] First, we add Prism Project for our requirement.\nWe already have an article where we add Prism Project.\nPlease see üöÄ Create Project section of üöÄ Open Syncfusion Chromeless Window article for creating New Prism project.\nPlease see below image for folder structure.\nAdd [Syncfusion Chromeless Window] Now, we need to add ‚ÄúSyncfusion Chromeless Window‚Äù into our View.\nWe already have an article where we add ‚ÄúSyncfusion Chromeless Window‚Äù into our View.\nPlease see üöÄ Add Syncfusion Chromeless Window section of üöÄ Open Syncfusion Chromeless Window article for creating New Prism project.\nAdd [Design Time DataContext] Now, we need to enable ‚ÄúIntelliSense‚Äù for our ViewModel.\nThis will enable us to see Public Properties and Methods of ViewModel class into our xaml file.\nFor that, first open ‚ÄúMainWindow.xaml‚Äù file.\nNow we need to add below namespace into ‚ÄúMainWindow.xaml‚Äù file.\nxaml\r1xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 2xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34;\rPlease see below üëáüèª image for reference. After adding namespace, we need define Design Time DataContext.\nFor our ‚ÄúMainWindow‚Äù view, DataContext is ‚ÄúMainWindowViewModel‚Äù class.\nHence, we also need to define ‚ÄúMainWindowViewModel‚Äù as Design Time DataContext.\nFor this we need to add below line.\nxaml\r1d:DataContext=\u0026#34;{d:DesignInstance viewModel:MainWindowViewModel}\u0026#34;\rPlease see below üëáüèª image for reference. After setting Design Time DataContext, we need to ignore Design time values while executing.\nFor this we need to add below line.\nxaml\r1mc:Ignorable=\u0026#34;d\u0026#34;\rPlease see below üëáüèª image for reference. Full code same is give below. xaml\r1\u0026lt;syncfusion:ChromelessWindow 2 x:Class=\u0026#34;InsertSketch.Views.MainWindow\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 7 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 8 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 9 xmlns:viewModel=\u0026#34;clr-namespace:InsertSketch.ViewModels\u0026#34; 10 Title=\u0026#34;{Binding Title}\u0026#34; 11 Width=\u0026#34;500\u0026#34; 12 Height=\u0026#34;250\u0026#34; 13 d:DataContext=\u0026#34;{d:DesignInstance viewModel:MainWindowViewModel}\u0026#34; 14 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 15 ResizeMode=\u0026#34;NoResize\u0026#34; 16 WindowStartupLocation=\u0026#34;CenterScreen\u0026#34; 17 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt;\rAs an example to show, how IntelliSense work, just remove any existing Binding properties.\nWe remove Title property and re-add it.\nWhile adding, you will notice Title property of ‚ÄúMainWindowViewModel‚Äù in Blue color.\nPlease see below üëáüèª image for reference.\nAdd [Syncfusion Busy Indicator] Now, we need to add ‚ÄúSyncfusion Busy Indicator‚Äù into our View.\nWe already have an article where we add ‚ÄúSyncfusion Busy Indicator‚Äù into our View.\nPlease see üöÄ Add Syncfusion Busy Indicator article for adding ‚ÄúSyncfusion Busy Indicator‚Äù.\nAdd Controls For UI We will some Controls to arrange and show them in UI.\nPlease follow below section to add them.\nAdd [Grid] First, we add \u0026lt;Grid\u0026gt; tag inside \u0026lt;syncfusion:SfBusyIndicator\u0026gt; tag.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. xaml\r1\u0026lt;syncfusion:ChromelessWindow 2 x:Class=\u0026#34;InsertSketch.Views.MainWindow\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 7 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 8 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 9 xmlns:viewModel=\u0026#34;clr-namespace:InsertSketch.ViewModels\u0026#34; 10 Title=\u0026#34;{Binding Title}\u0026#34; 11 Width=\u0026#34;500\u0026#34; 12 Height=\u0026#34;250\u0026#34; 13 d:DataContext=\u0026#34;{d:DesignInstance viewModel:MainWindowViewModel}\u0026#34; 14 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 15 ResizeMode=\u0026#34;NoResize\u0026#34; 16 WindowStartupLocation=\u0026#34;CenterScreen\u0026#34; 17 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 18 \u0026lt;syncfusion:SfBusyIndicator AnimationType=\u0026#34;Gear\u0026#34; IsBusy=\u0026#34;{Binding IsBusy, Mode=TwoWay}\u0026#34;\u0026gt; 19 \u0026lt;Grid\u0026gt; 20 \u0026lt;Grid.RowDefinitions\u0026gt; 21 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 22 \u0026lt;RowDefinition Height=\u0026#34;50\u0026#34; /\u0026gt; 23 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 24 \u0026lt;RowDefinition Height=\u0026#34;50\u0026#34; /\u0026gt; 25 \u0026lt;RowDefinition Height=\u0026#34;*\u0026#34; /\u0026gt; 26 \u0026lt;/Grid.RowDefinitions\u0026gt; 27 28 \u0026lt;Grid.ColumnDefinitions\u0026gt; 29 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 30 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 31 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 32 \u0026lt;/Grid.ColumnDefinitions\u0026gt; 33 \u0026lt;/Grid\u0026gt; 34 \u0026lt;/syncfusion:SfBusyIndicator\u0026gt; 35\u0026lt;/syncfusion:ChromelessWindow\u0026gt;\rAdd [TextBlock] Now add a Label for \u0026ldquo;Select Plane\u0026rdquo; as shown below. xaml\r1\u0026lt;TextBlock 2 Grid.Row=\u0026#34;1\u0026#34; 3 Grid.Column=\u0026#34;0\u0026#34; 4 HorizontalAlignment=\u0026#34;Right\u0026#34; 5 VerticalAlignment=\u0026#34;Center\u0026#34; 6 FontSize=\u0026#34;24\u0026#34; 7 Foreground=\u0026#34;Black\u0026#34; 8 Text=\u0026#34;Select Plane :\u0026#34; /\u0026gt;\rPlease see below üëáüèª image for reference. Please see below üëáüèª full code sample for reference. xaml\r1\u0026lt;syncfusion:ChromelessWindow 2 x:Class=\u0026#34;InsertSketch.Views.MainWindow\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 7 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 8 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 9 xmlns:viewModel=\u0026#34;clr-namespace:InsertSketch.ViewModels\u0026#34; 10 Title=\u0026#34;{Binding Title}\u0026#34; 11 Width=\u0026#34;500\u0026#34; 12 Height=\u0026#34;250\u0026#34; 13 d:DataContext=\u0026#34;{d:DesignInstance viewModel:MainWindowViewModel}\u0026#34; 14 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 15 ResizeMode=\u0026#34;NoResize\u0026#34; 16 WindowStartupLocation=\u0026#34;CenterScreen\u0026#34; 17 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 18 \u0026lt;syncfusion:SfBusyIndicator AnimationType=\u0026#34;Gear\u0026#34; IsBusy=\u0026#34;{Binding IsBusy, Mode=TwoWay}\u0026#34;\u0026gt; 19 \u0026lt;Grid\u0026gt; 20 \u0026lt;Grid.RowDefinitions\u0026gt; 21 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 22 \u0026lt;RowDefinition Height=\u0026#34;50\u0026#34; /\u0026gt; 23 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 24 \u0026lt;RowDefinition Height=\u0026#34;50\u0026#34; /\u0026gt; 25 \u0026lt;RowDefinition Height=\u0026#34;*\u0026#34; /\u0026gt; 26 \u0026lt;/Grid.RowDefinitions\u0026gt; 27 28 \u0026lt;Grid.ColumnDefinitions\u0026gt; 29 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 30 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 31 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 32 \u0026lt;/Grid.ColumnDefinitions\u0026gt; 33 34 \u0026lt;TextBlock 35 Grid.Row=\u0026#34;1\u0026#34; 36 Grid.Column=\u0026#34;0\u0026#34; 37 HorizontalAlignment=\u0026#34;Right\u0026#34; 38 VerticalAlignment=\u0026#34;Center\u0026#34; 39 FontSize=\u0026#34;24\u0026#34; 40 Foreground=\u0026#34;Black\u0026#34; 41 Text=\u0026#34;Select Plane :\u0026#34; /\u0026gt; 42 43 \u0026lt;/Grid\u0026gt; 44 \u0026lt;/syncfusion:SfBusyIndicator\u0026gt; 45\u0026lt;/syncfusion:ChromelessWindow\u0026gt;\rPlease see below üëáüèª image as how does this label look in application. Add [syncfusion:ComboBoxAdv] Now we add syncfusion:ComboBoxAdv for showing list of Planes.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. xaml\r1\u0026lt;syncfusion:ChromelessWindow 2 x:Class=\u0026#34;InsertSketch.Views.MainWindow\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 7 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 8 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 9 xmlns:viewModel=\u0026#34;clr-namespace:InsertSketch.ViewModels\u0026#34; 10 Title=\u0026#34;{Binding Title}\u0026#34; 11 Width=\u0026#34;500\u0026#34; 12 Height=\u0026#34;250\u0026#34; 13 d:DataContext=\u0026#34;{d:DesignInstance viewModel:MainWindowViewModel}\u0026#34; 14 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 15 ResizeMode=\u0026#34;NoResize\u0026#34; 16 WindowStartupLocation=\u0026#34;CenterScreen\u0026#34; 17 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 18 \u0026lt;syncfusion:SfBusyIndicator AnimationType=\u0026#34;Gear\u0026#34; IsBusy=\u0026#34;{Binding IsBusy, Mode=TwoWay}\u0026#34;\u0026gt; 19 \u0026lt;Grid\u0026gt; 20 \u0026lt;Grid.RowDefinitions\u0026gt; 21 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 22 \u0026lt;RowDefinition Height=\u0026#34;50\u0026#34; /\u0026gt; 23 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 24 \u0026lt;RowDefinition Height=\u0026#34;50\u0026#34; /\u0026gt; 25 \u0026lt;RowDefinition Height=\u0026#34;*\u0026#34; /\u0026gt; 26 \u0026lt;/Grid.RowDefinitions\u0026gt; 27 28 \u0026lt;Grid.ColumnDefinitions\u0026gt; 29 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 30 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 31 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 32 \u0026lt;/Grid.ColumnDefinitions\u0026gt; 33 34 \u0026lt;TextBlock 35 Grid.Row=\u0026#34;1\u0026#34; 36 Grid.Column=\u0026#34;0\u0026#34; 37 HorizontalAlignment=\u0026#34;Right\u0026#34; 38 VerticalAlignment=\u0026#34;Center\u0026#34; 39 FontSize=\u0026#34;24\u0026#34; 40 Foreground=\u0026#34;Black\u0026#34; 41 Text=\u0026#34;Select Plane :\u0026#34; /\u0026gt; 42 43 \u0026lt;syncfusion:ComboBoxAdv 44 Grid.Row=\u0026#34;1\u0026#34; 45 Grid.Column=\u0026#34;2\u0026#34; 46 Height=\u0026#34;50\u0026#34; 47 MinWidth=\u0026#34;200\u0026#34; 48 HorizontalAlignment=\u0026#34;Left\u0026#34; /\u0026gt; 49 50 \u0026lt;/Grid\u0026gt; 51 \u0026lt;/syncfusion:SfBusyIndicator\u0026gt; 52\u0026lt;/syncfusion:ChromelessWindow\u0026gt;\rPlease see below üëáüèª image as how Plane list look in application. Add [syncfusion:ButtonAdv] Now we add syncfusion:ButtonAdv button.\nThis button execute function for Inserting Sketch into Solidworks Part Document.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. xaml\r1\u0026lt;syncfusion:ChromelessWindow 2 x:Class=\u0026#34;InsertSketch.Views.MainWindow\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 7 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 8 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 9 xmlns:viewModel=\u0026#34;clr-namespace:InsertSketch.ViewModels\u0026#34; 10 Title=\u0026#34;{Binding Title}\u0026#34; 11 Width=\u0026#34;500\u0026#34; 12 Height=\u0026#34;250\u0026#34; 13 d:DataContext=\u0026#34;{d:DesignInstance viewModel:MainWindowViewModel}\u0026#34; 14 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 15 ResizeMode=\u0026#34;NoResize\u0026#34; 16 WindowStartupLocation=\u0026#34;CenterScreen\u0026#34; 17 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 18 \u0026lt;syncfusion:SfBusyIndicator AnimationType=\u0026#34;Gear\u0026#34; IsBusy=\u0026#34;{Binding IsBusy, Mode=TwoWay}\u0026#34;\u0026gt; 19 \u0026lt;Grid\u0026gt; 20 \u0026lt;Grid.RowDefinitions\u0026gt; 21 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 22 \u0026lt;RowDefinition Height=\u0026#34;50\u0026#34; /\u0026gt; 23 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 24 \u0026lt;RowDefinition Height=\u0026#34;50\u0026#34; /\u0026gt; 25 \u0026lt;RowDefinition Height=\u0026#34;*\u0026#34; /\u0026gt; 26 \u0026lt;/Grid.RowDefinitions\u0026gt; 27 28 \u0026lt;Grid.ColumnDefinitions\u0026gt; 29 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 30 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 31 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 32 \u0026lt;/Grid.ColumnDefinitions\u0026gt; 33 34 \u0026lt;TextBlock 35 Grid.Row=\u0026#34;1\u0026#34; 36 Grid.Column=\u0026#34;0\u0026#34; 37 HorizontalAlignment=\u0026#34;Right\u0026#34; 38 VerticalAlignment=\u0026#34;Center\u0026#34; 39 FontSize=\u0026#34;24\u0026#34; 40 Foreground=\u0026#34;Black\u0026#34; 41 Text=\u0026#34;Select Plane :\u0026#34; /\u0026gt; 42 43 \u0026lt;syncfusion:ComboBoxAdv 44 Grid.Row=\u0026#34;1\u0026#34; 45 Grid.Column=\u0026#34;2\u0026#34; 46 Height=\u0026#34;50\u0026#34; 47 MinWidth=\u0026#34;200\u0026#34; 48 HorizontalAlignment=\u0026#34;Left\u0026#34; /\u0026gt; 49 50 \u0026lt;syncfusion:ButtonAdv 51 Grid.Row=\u0026#34;3\u0026#34; 52 Grid.Column=\u0026#34;0\u0026#34; 53 Grid.ColumnSpan=\u0026#34;3\u0026#34; 54 Width=\u0026#34;200\u0026#34; 55 Height=\u0026#34;50\u0026#34; 56 FontSize=\u0026#34;24\u0026#34; 57 Foreground=\u0026#34;Black\u0026#34; 58 IconHeight=\u0026#34;0\u0026#34; 59 IconWidth=\u0026#34;0\u0026#34; 60 Label=\u0026#34;Insert Sketch\u0026#34; /\u0026gt; 61 62 \u0026lt;/Grid\u0026gt; 63 \u0026lt;/syncfusion:SfBusyIndicator\u0026gt; 64\u0026lt;/syncfusion:ChromelessWindow\u0026gt;\rPlease see below üëáüèª image as how Insert Sketch looks in application. Set Message Services In this section, we setup Message Services to communicate in our application.\nFor this please follow below üëáüèª sections.\nAdd Message Services Now, we need to ‚ÄúAdd Message Services‚Äù into our application.\nWe already have an article where we ‚ÄúAdd Message Services‚Äù into our application.\nPlease see üöÄ Add Service for Messaging in application section of üöÄ Add Message Service article for adding Message Services.\nFollowing Services added:\nConfirmationMessagesService InformationMessagesService ErrorMessagesService Please see below üëáüèª code sample for reference.\nC#\r1using Prism.Events; 2 3namespace InsertSketch.Services 4{ 5 internal class ConfirmationMessagesService : PubSubEvent\u0026lt;string\u0026gt; { } 6 internal class InformationMessagesService : PubSubEvent\u0026lt;string\u0026gt; { } 7 internal class ErrorMessagesService : PubSubEvent\u0026lt;string\u0026gt; { } 8}\rRegister Message Services Now, we need to ‚ÄúRegister Message Services‚Äù into our application.\nWe already have an article where we ‚ÄúRegister Message Services‚Äù into our application.\nPlease see üöÄ Register Services section of üöÄ Add Message Service article for adding Message Services.\nPlease see below üëáüèª code sample for reference.\nC#\r1using InsertSketch.Services; 2using InsertSketch.ViewModels; 3using Prism.Events; 4using Syncfusion.Windows.Shared; 5using System.Windows; 6 7namespace InsertSketch.Views 8{ 9 /// \u0026lt;summary\u0026gt; 10 /// Interaction logic for MainWindow.xaml 11 /// \u0026lt;/summary\u0026gt; 12 public partial class MainWindow : ChromelessWindow 13 { 14 private readonly IEventAggregator eventAggregator; 15 16 public MainWindow(IEventAggregator eventAggregator) 17 { 18 InitializeComponent(); 19 this.eventAggregator = eventAggregator; 20 this.eventAggregator.GetEvent\u0026lt;ConfirmationMessagesService\u0026gt;().Subscribe(ConfirmationMessages); 21 this.eventAggregator.GetEvent\u0026lt;InformationMessagesService\u0026gt;().Subscribe(InformationMessages); 22 this.eventAggregator.GetEvent\u0026lt;ErrorMessagesService\u0026gt;().Subscribe(ErrorMessages); 23 } 24 25 private void ConfirmationMessages(string messageToShow) 26 { 27 var result = MessageBox.Show(messageToShow, \u0026#34;Confirmation\u0026#34;, MessageBoxButton.YesNo, MessageBoxImage.Question); 28 } 29 30 private void InformationMessages(string messageToShow) 31 { 32 MessageBox.Show(messageToShow, \u0026#34;Information\u0026#34;, MessageBoxButton.OK, MessageBoxImage.Information); 33 } 34 35 private void ErrorMessages(string messageToShow) 36 { 37 MessageBox.Show(messageToShow, \u0026#34;Error\u0026#34;, MessageBoxButton.OK, MessageBoxImage.Error); 38 } 39 } 40}\rUnderstand Message Services If you want to ‚Äúunderstand Message Services‚Äù, then please visit below article.\nReference Article: üöÄ Add Message Service\nUpdate ViewModel Now we need to ‚Äúadd Properties and Methods‚Äù for ‚ÄúBinding‚Äù with our view.\nView: MainWindow ViewModel: MainWindowViewModel Please see below üëáüèª image for ‚ÄúProperties and Methods‚Äù required.\nAdd [Properties] We need to 2 ‚ÄúProperties‚Äù for ‚ÄúSyncfusion ComboBox‚Äù.\nFor List of Planes to show in drop down. For Selected Item in drop down. Please see below üëáüèª code sample for ‚ÄúProperties‚Äù in MainWindowViewModel.\nC#\r1private List\u0026lt;string\u0026gt; _planeNames; 2public List\u0026lt;string\u0026gt; PlaneNames 3{ 4 get { return _planeNames; } 5 set { SetProperty(ref _planeNames, value); } 6} 7 8private string _selectedPlane; 9public string SelectedPlane 10{ 11 get { return _selectedPlane; } 12 set { SetProperty(ref _selectedPlane, value); } 13}\rPlease see below üëáüèª image for ‚ÄúProperties and Methods‚Äù required. Now we need to fill, \u0026ldquo;Plane Names\u0026rdquo; in SelectedPlane variable.\nWe add \u0026ldquo;Plane Names\u0026rdquo; in Constructor.\nPlease see below üëáüèª code sample for adding \u0026ldquo;Plane Names\u0026rdquo; in Constructor.\nC#\r1public MainWindowViewModel(IEventAggregator eventAggregator) 2{ 3 PlaneNames = new List\u0026lt;string\u0026gt; { \u0026#34;Front Plane\u0026#34;, \u0026#34;Right Plane\u0026#34;, \u0026#34;Top Plane\u0026#34; }; 4 this.eventAggregator = eventAggregator; 5}\rPlease see below üëáüèª image for adding \u0026ldquo;Plane Names\u0026rdquo; in Constructor. Add [Prism Command] We need 1 Prism Command for syncfusion Button.\nThis command will be responsible for Inserting Sketch in Solidworks Part Document.\nPlease see below üëáüèª code sample for adding ‚ÄúPrism Command‚Äù in MainWindowViewModel.\nC#\r1private DelegateCommand _insertSketchCommand; 2 3public DelegateCommand InsertSketchCommand =\u0026gt; 4 _insertSketchCommand ?? (_insertSketchCommand = new DelegateCommand(ExecuteInsertSketchCommand)); 5 6void ExecuteInsertSketchCommand() 7{ 8 9}\rPlease see below üëáüèª image for adding ‚ÄúPrism Command‚Äù in MainWindowViewModel. Add Code To Function Now we will add some code ExecuteInsertSketchCommand function.\nWe already used this code for in various articles.\nPlease see below üëáüèª code sample for waiting code to add.\nC#\r1private DelegateCommand _insertSketchCommand; 2 3public DelegateCommand InsertSketchCommand =\u0026gt; 4 _insertSketchCommand ?? (_insertSketchCommand = new DelegateCommand(ExecuteInsertSketchCommand)); 5 6async void ExecuteInsertSketchCommand() 7{ 8 // Show busy indicator 9 IsBusy = true; 10 11 await Task.Run(() =\u0026gt; 12 { 13 // Sleeping with 5 sec 14 Thread.Sleep(5000); 15 }); 16 17 // Hide busy indicator 18 IsBusy = false; 19}\rPlease see below üëáüèª image for waiting code to add. xaml\r1\u0026lt;syncfusion:ComboBoxAdv 2 Grid.Row=\u0026#34;1\u0026#34; 3 Grid.Column=\u0026#34;2\u0026#34; 4 Height=\u0026#34;50\u0026#34; 5 MinWidth=\u0026#34;200\u0026#34; 6 HorizontalAlignment=\u0026#34;Left\u0026#34; /\u0026gt;\rAdd [Bindings] In this section we will add Bindings to Syncfusion Combo Box and Syncfusion Button.\nAdd [Property Binding] We need to Bind previously created ‚ÄúProperties‚Äù with ‚ÄúSyncfusion ComboBox‚Äù.\nPlease see below üëáüèª image for adding ‚ÄúBinding Properties‚Äù.\nPlease see below üëáüèª code for adding ‚ÄúBinding Properties‚Äù. xaml\r1\u0026lt;syncfusion:ComboBoxAdv 2 Grid.Row=\u0026#34;1\u0026#34; 3 Grid.Column=\u0026#34;2\u0026#34; 4 Height=\u0026#34;50\u0026#34; 5 MinWidth=\u0026#34;200\u0026#34; 6 HorizontalAlignment=\u0026#34;Left\u0026#34; 7 ItemsSource=\u0026#34;{Binding PlaneNames}\u0026#34; 8 SelectedItem=\u0026#34;{Binding SelectedPlane, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\u0026#34; /\u0026gt;\rAdd [Command Binding] We need to Bind previously created ‚ÄúCommand‚Äù with ‚ÄúSyncfusion Button‚Äù.\nPlease see below üëáüèª image for adding ‚ÄúCommand‚Äù.\nPlease see below üëáüèª code for adding ‚ÄúCommand‚Äù. xaml\r1\u0026lt;syncfusion:ButtonAdv 2 Grid.Row=\u0026#34;3\u0026#34; 3 Grid.Column=\u0026#34;0\u0026#34; 4 Grid.ColumnSpan=\u0026#34;3\u0026#34; 5 Width=\u0026#34;200\u0026#34; 6 Height=\u0026#34;50\u0026#34; 7 Command=\u0026#34;{Binding InsertSketchCommand}\u0026#34; 8 FontSize=\u0026#34;24\u0026#34; 9 Foreground=\u0026#34;Black\u0026#34; 10 IconHeight=\u0026#34;0\u0026#34; 11 IconWidth=\u0026#34;0\u0026#34; 12 Label=\u0026#34;Insert Sketch\u0026#34; /\u0026gt;\rUpdate [Syncfusion ComboBox] We need to update Syncfusion ComboBox for following reasons.\nThere is no Default value selected in Syncfusion ComboBox.\nFont Size of Text in Dropdown in very small.\nPlease see below üëáüèª image for reference.\nLet us handle them 1 by 1.\nAdd Default Value For adding Default Value, we need to define SelectedIndex property of syncfusion:ComboBoxAdv.\nPlease see below üëáüèª image for adding Default Value.\nPlease see below üëáüèª code for adding Default Value. xaml\r1\u0026lt;syncfusion:ComboBoxAdv 2 Grid.Row=\u0026#34;1\u0026#34; 3 Grid.Column=\u0026#34;2\u0026#34; 4 Height=\u0026#34;50\u0026#34; 5 MinWidth=\u0026#34;200\u0026#34; 6 HorizontalAlignment=\u0026#34;Left\u0026#34; 7 ItemsSource=\u0026#34;{Binding PlaneNames}\u0026#34; 8 SelectedIndex=\u0026#34;0\u0026#34; 9 SelectedItem=\u0026#34;{Binding SelectedPlane, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\u0026#34; /\u0026gt;\rUpdate Font Size For update Font Size of Text in Dropdown, we need to define ItemTemplate of syncfusion:ComboBoxAdv.\nPlease see below üëáüèª image for adding Default Value.\nPlease see below üëáüèª code for adding Default Value. xaml\r1\u0026lt;syncfusion:ComboBoxAdv 2 Grid.Row=\u0026#34;1\u0026#34; 3 Grid.Column=\u0026#34;2\u0026#34; 4 Height=\u0026#34;50\u0026#34; 5 MinWidth=\u0026#34;200\u0026#34; 6 HorizontalAlignment=\u0026#34;Left\u0026#34; 7 ItemsSource=\u0026#34;{Binding PlaneNames}\u0026#34; 8 SelectedIndex=\u0026#34;0\u0026#34; 9 SelectedItem=\u0026#34;{Binding SelectedPlane, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\u0026#34; /\u0026gt;\rFinal Result Now we run the application as shown in below üëáüèª image.\nNow UI part is completed for Inserting Sketch in Solidworks Document in WPF Prism Application.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Inserting Sketch in Solidworks Document UI.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":48,"permalink":"/wpf-tutorials/insert-solidworks-sketch-ui/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eI want to:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eCreate User Interface for Inserting Solidworks Sketch into Sketch Document.\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eShare method which allowed us to use \u0026lsquo;Properties and methods\u0026rsquo; of \u0026lsquo;ViewModel\u0026rsquo; as \u0026lsquo;IntelliSense\u0026rsquo; in \u0026lsquo;XAML UI\u0026rsquo;.\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e","tags":[],"title":"Insert Solidworks Sketch UI"},{"content":"In this post, I tell you about how to create Corner Rectangle through Solidworks VBA Macros in a sketch.\nFor this, I take the example from previous Sketch - Create Lines post.\nIn this post, I tell you about CreateCornerRectangle method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new Corner Rectangle.\nVideo of Code on YouTube Please see below video on how to create Corner Rectangle from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating Corner Rectangle.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Creating a \u0026#34;Variant\u0026#34; Variable which holds the values return by \u0026#34;CreateCornerRectangle\u0026#34; method Dim vSketchLines As Variant \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating a Corner Rectangle vSketchLines = swSketchManager.CreateCornerRectangle(0, 1, 0, 1, 0, 0) \u0026#39; De-select the lines after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable which we define earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue(). This method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API help\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating a \u0026#34;Variant\u0026#34; Variable which holds the values return by \u0026#34;CreateCornerRectangle\u0026#34; method Dim vSketchLines As Variant \u0026#39; Creating a Corner Rectangle vSketchLines = swSketchManager.CreateCornerRectangle(0, 1, 0, 1, 0, 0)\rIn above sample code, we 1st create a variable named vSketchLines of type Variant.\nA Variant type variable can hold any type of value depends upon the use of variable.\nIn 2nd line, we set the value of variable vSketchLines.\nValue of vSketchLinesis an array of lines. This array is send as return value when we use CreateCornerRectangle method.\nThis CreateCornerRectangle method is part of swSketchManager and it is the latest method to create a corner rectangle.\nThis CreateCornerRectangle method takes following parameters as explained:\nX1 : X coordinate of the Upper-left point\nY1 : Y coordinate of the Upper-left point\nZ1 : Z coordinate of the Upper-left point\nX2 : X coordinate of the Lower-right point\nY2 : Y coordinate of the Lower-right point\nZ2 : Z coordinate of the Lower-right point\nBelow image shows more clearly about these parameters.\nIn the above code sample I have used (0, 1, 0) Upper-left point in Y-direction.\nFor Lower-right point I used (1, 0, 0) which is 1 point distance in X-direction.\nThis CreateCornerRectangle method returns an array of sketch segments that represent the edges created for this corner rectangle.\nA Sketch Segment can represent a sketch arc, line, ellipse, parabola or spline.\nSketch Segment has ISketchSegment Interface, which provides functions that are generic to every type of sketch segment.\nFor example, every sketch segment has an ID and can be programmatically selected.\nTherefore, the ISketchSegment interface provides functions to obtain the ID and to select the item.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means inches for distance. But when I used Solidworks API through VBA macros or C#, I need to use converted numeric values.\nBecause Solidworks API output the distance in Meter which is not my requirement.\n\u0026#39; De-select the lines after creation swDoc.ClearSelection2 True\rIn the this line of code, we deselect the Corner rectangle we have created.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nHope this post helps you to create Corner rectangle in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":49,"permalink":"/solidworks-macros/create-corner-rectangle/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create Corner Rectangle through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e\n\u003cp\u003eFor this, I take the example from previous \u003cstrong\u003e\u003ca href=\"/solidworks-macros/sketch-create-line\"\u003eSketch - Create Lines\u003c/a\u003e\u003c/strong\u003e post.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create Corner Rectangle"},{"content":"A variable‚Äôs scope determines which modules and procedures can use the variable.\nProcedure-only Variables The lowest level of scope for a variable is at the procedure level.\nA procedure is either a Sub or a Function procedure.\nVariables declared with this scope can be used only in the procedure in which they are declared.\nWhen the procedure ends, the variable no longer exists (it goes to the great big bucket in the sky), and your CAD application frees up its memory.\nIf you execute the procedure again, the variable comes back to life, but its previous value is lost.\nThe most common way to declare a procedure-only variable is with a Dim statement.\nDim doesn‚Äôt refer to the mental capacity of the VBA designers.\nRather, it‚Äôs an old programming term that‚Äôs short for dimension, which simply means you are setting aside memory for a particular variable.\nYou usually place Dim statements immediately after the Sub or Function statement and before the procedure‚Äôs code.\nThe following example shows some procedure-only variables declared by using Dim statements:\nvba\r1Sub MySub() 2 Dim x As Integer 3 Dim First As Long 4 Dim PartDimension As Single 5 Dim myValue 6\u0026#39; ...[The procedure‚Äôs code goes here]... 7End Sub Notice that the last Dim statement in the preceding example doesn‚Äôt declare a data type; it declares only the variable itself. The effect is that the variable MyValue is a Variant.\nBy the way, you can also declare several variables with a single Dim statement, as in the following example:\nvba\r1Dim x As Integer, y As Integer, z As Integer 2Dim First As Long, Last As Double\rUnlike some languages, VBA doesn‚Äôt allow you to declare a group of variables to be a particular data type by separating the variables with commas.\nFor example, though valid, the following statement does not declare all the variables as Integers:\nvba\r1Dim i, j, k As Integer\rIn this example, only k is declared to be an Integer; the other variables are declared to be Variants.\nIf you declare a variable with procedure-only scope, other procedures in the same module can use the same variable name, but each instance of the variable is unique to its own procedure.\nIn general, variables declared at the procedure level are the most efficient because VBA frees up the memory they use when the procedure ends.\nModule-only Variables Sometimes, you want a variable to be available to all procedures in a module.\nIf so, just declare the variable (using Dim or Private) before the module‚Äôs first Sub or Function statement ‚Äî outside any procedures.\nThis is done in the Declarations section, at the beginning of your module.\nThis is also where the Option Explicit statement is located.\nBelow figure shows how you know when you‚Äôre working with the Declarations section.\nAs shown in above image, I want a variable named swApp, so that it can available to all procedures in this module.\nHence I declare this variable in Declaration section of VBE.\nNext post wil be about Public, Static and Variable\u0026rsquo;s Life.\n","date":"0001-01-01","id":50,"permalink":"/vba/variable-scope/","summary":"\u003cp\u003eA \u003cem\u003evariable‚Äôs\u003c/em\u003e scope determines which modules and procedures can use the variable.\u003c/p\u003e\n\u003ch2 id=\"procedure-only-variables\"\u003eProcedure-only Variables\u003c/h2\u003e\n\u003cp\u003eThe \u003cem\u003elowest\u003c/em\u003e level of scope for a variable is at the \u003cstrong\u003eprocedure\u003c/strong\u003e level.\u003c/p\u003e","tags":[],"title":"Variable Scope"},{"content":"","date":"2023-09-07","id":51,"permalink":"/solidworks-macros/10-sketch---offset-and-mirror/","summary":"","tags":[],"title":"Sketch - Offset and Mirror"},{"content":"Objective I want to:\nCreate User Interface for Invoking Edit Solidworks Sketch. Important Note:\nWe will use same setup as done in üöÄInsert Solidworks Sketch UI.\nHence reading previous üöÄInsert Solidworks Sketch UI artice is highly recommended.\nDemo Video Below üé¨ video shows how to Invoking Edit Solidworks Sketch in Visual Studio 2022.\nSetting Project We need to add some required UI changes as part of Project Setup.\nPlease follow below sections for this.\nAdd [Prism Project] First, we add Prism Project for our requirement.\nWe already have an article where we add Prism Project.\nPlease see üöÄ Create Project section of üöÄ Open Syncfusion Chromeless Window article for creating New Prism project.\nPlease see below image for folder structure.\nAdd [Syncfusion Chromeless Window] Now, we need to add ‚ÄúSyncfusion Chromeless Window‚Äù into our View.\nWe already have an article where we add ‚ÄúSyncfusion Chromeless Window‚Äù into our View.\nPlease see üöÄ Add Syncfusion Chromeless Window section of üöÄ Open Syncfusion Chromeless Window article for creating New Prism project.\nAdd [Design Time DataContext] In previous üöÄAdd [Design Time DataContext] section of üöÄInsert Solidworks Sketch UI article, this section is already explained.\nPlease visit üöÄAdd [Design Time DataContext] section of üöÄInsert Solidworks Sketch UI article for more detail on this section.\nAdd [Syncfusion Busy Indicator] Now, we need to add ‚ÄúSyncfusion Busy Indicator‚Äù into our View.\nWe already have an article where we add ‚ÄúSyncfusion Busy Indicator‚Äù into our View.\nPlease see üöÄ Add Syncfusion Busy Indicator article for adding ‚ÄúSyncfusion Busy Indicator‚Äù.\nAdd Controls For UI We will some Controls to arrange and show them in UI.\nPlease follow below section to add them.\nAdd [StackPanel] First, we add \u0026lt;StackPanel\u0026gt; tag inside \u0026lt;syncfusion:SfBusyIndicator\u0026gt; tag.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. xaml\r1\u0026lt;syncfusion:ChromelessWindow 2 x:Class=\u0026#34;EditSketchMethods.MainWindow\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:local=\u0026#34;clr-namespace:EditSketchMethods\u0026#34; 7 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 8 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 9 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 10 xmlns:viewModel=\u0026#34;clr-namespace:InsertSketch.ViewModels\u0026#34; 11 Title=\u0026#34;MainWindow\u0026#34; 12 Width=\u0026#34;500\u0026#34; 13 Height=\u0026#34;300\u0026#34; 14 d:DataContext=\u0026#34;{d:DesignInstance Type=viewModel:MainWindowViewModel}\u0026#34; 15 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 16 WindowStartupLocation=\u0026#34;CenterScreen\u0026#34; 17 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 18 \u0026lt;syncfusion:SfBusyIndicator AnimationType=\u0026#34;Gear\u0026#34; IsBusy=\u0026#34;{Binding IsBusy, Mode=TwoWay}\u0026#34;\u0026gt; 19 \u0026lt;StackPanel\u0026gt; 20 21 \u0026lt;/StackPanel\u0026gt; 22 \u0026lt;/syncfusion:SfBusyIndicator\u0026gt; 23\u0026lt;/syncfusion:ChromelessWindow\u0026gt;\rAdd [Button] Now add 2 [Button] as shown below. xaml\r1\u0026lt;StackPanel\u0026gt; 2 \u0026lt;Button Content=\u0026#34;EditSketch Method\u0026#34; /\u0026gt; 3 \u0026lt;Button Content=\u0026#34;EditSketchOrSingleSketchFeature Method\u0026#34; /\u0026gt; 4\u0026lt;/StackPanel\u0026gt;\rPlease see below üëáüèª image for reference. Please see below üëáüèª full code sample for reference. xaml\r1\u0026lt;syncfusion:ChromelessWindow 2 x:Class=\u0026#34;EditSketchMethods.MainWindow\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:local=\u0026#34;clr-namespace:EditSketchMethods\u0026#34; 7 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 8 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 9 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 10 xmlns:viewModel=\u0026#34;clr-namespace:InsertSketch.ViewModels\u0026#34; 11 Title=\u0026#34;MainWindow\u0026#34; 12 Width=\u0026#34;500\u0026#34; 13 Height=\u0026#34;300\u0026#34; 14 d:DataContext=\u0026#34;{d:DesignInstance Type=viewModel:MainWindowViewModel}\u0026#34; 15 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 16 WindowStartupLocation=\u0026#34;CenterScreen\u0026#34; 17 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 18 \u0026lt;syncfusion:SfBusyIndicator AnimationType=\u0026#34;Gear\u0026#34; IsBusy=\u0026#34;{Binding IsBusy, Mode=TwoWay}\u0026#34;\u0026gt; 19 \u0026lt;StackPanel\u0026gt; 20 \u0026lt;Button Content=\u0026#34;EditSketch Method\u0026#34; /\u0026gt; 21 \u0026lt;Button Content=\u0026#34;EditSketchOrSingleSketchFeature Method\u0026#34; /\u0026gt; 22 \u0026lt;/StackPanel\u0026gt; 23 \u0026lt;/syncfusion:SfBusyIndicator\u0026gt; 24\u0026lt;/syncfusion:ChromelessWindow\u0026gt;\rPlease see below üëáüèª image as how does these buttons look in application. Add [Window.Resources] In this section, we apply some styles to our buttons.\nFor this we add Window.Resources.\nThis Window.Resources tag contains styles for buttons globally.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. xaml\r1\u0026lt;syncfusion:ChromelessWindow 2 x:Class=\u0026#34;EditSketchMethods.MainWindow\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:local=\u0026#34;clr-namespace:EditSketchMethods\u0026#34; 7 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 8 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 9 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 10 xmlns:viewModel=\u0026#34;clr-namespace:InsertSketch.ViewModels\u0026#34; 11 Title=\u0026#34;MainWindow\u0026#34; 12 Width=\u0026#34;500\u0026#34; 13 Height=\u0026#34;300\u0026#34; 14 d:DataContext=\u0026#34;{d:DesignInstance Type=viewModel:MainWindowViewModel}\u0026#34; 15 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 16 WindowStartupLocation=\u0026#34;CenterScreen\u0026#34; 17 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 18 \u0026lt;Window.Resources\u0026gt; 19 20 \u0026lt;/Window.Resources\u0026gt; 21 \u0026lt;syncfusion:SfBusyIndicator AnimationType=\u0026#34;Gear\u0026#34; IsBusy=\u0026#34;{Binding IsBusy, Mode=TwoWay}\u0026#34;\u0026gt; 22 \u0026lt;StackPanel\u0026gt; 23 \u0026lt;Button Content=\u0026#34;EditSketch Method\u0026#34; /\u0026gt; 24 \u0026lt;Button Content=\u0026#34;EditSketchOrSingleSketchFeature Method\u0026#34; /\u0026gt; 25 \u0026lt;/StackPanel\u0026gt; 26 \u0026lt;/syncfusion:SfBusyIndicator\u0026gt; 27\u0026lt;/syncfusion:ChromelessWindow\u0026gt;\rAdd [Style] Now we add Style tag.\nThis tag contains styles for buttons.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. xaml\r1\u0026lt;syncfusion:ChromelessWindow 2 x:Class=\u0026#34;EditSketchMethods.MainWindow\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:local=\u0026#34;clr-namespace:EditSketchMethods\u0026#34; 7 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 8 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 9 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 10 xmlns:viewModel=\u0026#34;clr-namespace:InsertSketch.ViewModels\u0026#34; 11 Title=\u0026#34;MainWindow\u0026#34; 12 Width=\u0026#34;500\u0026#34; 13 Height=\u0026#34;300\u0026#34; 14 d:DataContext=\u0026#34;{d:DesignInstance Type=viewModel:MainWindowViewModel}\u0026#34; 15 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 16 WindowStartupLocation=\u0026#34;CenterScreen\u0026#34; 17 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 18 \u0026lt;Window.Resources\u0026gt; 19 \u0026lt;Style TargetType=\u0026#34;Button\u0026#34;\u0026gt; 20 \u0026lt;Setter Property=\u0026#34;FontSize\u0026#34; Value=\u0026#34;24\u0026#34; /\u0026gt; 21 \u0026lt;Setter Property=\u0026#34;Margin\u0026#34; Value=\u0026#34;20\u0026#34; /\u0026gt; 22 \u0026lt;Setter Property=\u0026#34;Height\u0026#34; Value=\u0026#34;50\u0026#34; /\u0026gt; 23 \u0026lt;/Style\u0026gt; 24 \u0026lt;/Window.Resources\u0026gt; 25 \u0026lt;syncfusion:SfBusyIndicator AnimationType=\u0026#34;Gear\u0026#34; IsBusy=\u0026#34;{Binding IsBusy, Mode=TwoWay}\u0026#34;\u0026gt; 26 \u0026lt;StackPanel\u0026gt; 27 \u0026lt;Button Content=\u0026#34;EditSketch Method\u0026#34; /\u0026gt; 28 \u0026lt;Button Content=\u0026#34;EditSketchOrSingleSketchFeature Method\u0026#34; /\u0026gt; 29 \u0026lt;/StackPanel\u0026gt; 30 \u0026lt;/syncfusion:SfBusyIndicator\u0026gt; 31\u0026lt;/syncfusion:ChromelessWindow\u0026gt;\rPlease see below üëáüèª image as how Insert Sketch looks in application. Set Message Services In previous üöÄSet Message Services section of üöÄInsert Solidworks Sketch UI article, this section is already explained.\nPlease visit üöÄSet Message Services section of üöÄInsert Solidworks Sketch UI article for more detail on this section.\nUpdate ViewModel Now we need to ‚Äúadd Methods‚Äù for ‚ÄúBinding‚Äù with our view.\nView: MainWindow ViewModel: MainWindowViewModel Add [Prism Command] We need 2 Prism Commands for Buttons.\nThese commands will be responsible for Editing Sketch in Solidworks Part Document.\nPlease see below üëáüèª code sample for adding ‚ÄúPrism Command‚Äù in MainWindowViewModel.\nC#\r1private DelegateCommand _editSketchMethod; 2public DelegateCommand EditSketchMethod =\u0026gt; 3 _editSketchMethod ?? (_editSketchMethod = new DelegateCommand(ExecuteEditSketchMethod)); 4 5void ExecuteEditSketchMethod() 6{ 7 8} 9 10private DelegateCommand _editSketchOrSingleSketchFeatureMethod; 11public DelegateCommand EditSketchOrSingleSketchFeatureMethod =\u0026gt; 12 _editSketchOrSingleSketchFeatureMethod ?? (_editSketchOrSingleSketchFeatureMethod = new DelegateCommand(ExecuteEditSketchOrSingleSketchFeatureMethod)); 13 14void ExecuteEditSketchOrSingleSketchFeatureMethod() 15{ 16 17}\rPlease see below üëáüèª image for adding ‚ÄúPrism Command‚Äù in MainWindowViewModel. Add Code To Function Now we will add some code to ExecuteEditSketchMethod \u0026amp; ExecuteEditSketchOrSingleSketchFeatureMethod methods.\nPlease see below üëáüèª code sample for waiting code to add.\nC#\r1async void ExecuteEditSketchMethod() 2{ 3 // Show busy indicator 4 IsBusy = true; 5 6 await Task.Run(() =\u0026gt; 7 { 8 // Sleeping with 5 sec 9 Thread.Sleep(5000); 10 }); 11 12 // Hide busy indicator 13 IsBusy = false; 14} 15 16async void ExecuteEditSketchOrSingleSketchFeatureMethod() 17{ 18 // Show busy indicator 19 IsBusy = true; 20 21 await Task.Run(() =\u0026gt; 22 { 23 // Sleeping with 5 sec 24 Thread.Sleep(5000); 25 }); 26 27 // Hide busy indicator 28 IsBusy = false; 29}\rPlease see below üëáüèª image for waiting code to add. Add [Bindings] In this section we will add Bindings to Buttons.\nAdd [Command Binding] We need to Bind previously created ‚ÄúCommand‚Äù with ‚ÄúButtons‚Äù.\nPlease see below üëáüèª image for adding ‚ÄúCommand‚Äù.\nPlease see below üëáüèª code for adding ‚ÄúCommand‚Äù. xaml\r1\u0026lt;StackPanel\u0026gt; 2 \u0026lt;Button Command=\u0026#34;{Binding EditSketchMethod}\u0026#34; Content=\u0026#34;EditSketch Method\u0026#34; /\u0026gt; 3 \u0026lt;Button Command=\u0026#34;{Binding EditSketchOrSingleSketchFeatureMethod}\u0026#34; Content=\u0026#34;EditSketchOrSingleSketchFeature Method\u0026#34; /\u0026gt; 4\u0026lt;/StackPanel\u0026gt;\rFinal Result Now we run the application as shown in below üëáüèª image.\nNow UI part is completed for Editing Sketch in Solidworks Document in WPF Prism Application.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Edit Sketch in Solidworks Document UI.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":52,"permalink":"/wpf-tutorials/edit-solidworks-sketch-ui/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eI want to:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eCreate User Interface for Invoking Edit Solidworks Sketch.\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eImportant Note:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eWe will use same setup as done in üöÄ\u003ca href=\"/wpf-tutorials/insert-solidworks-sketch-ui/\" target=\"_blank\"\u003eInsert Solidworks Sketch UI\u003c/a\u003e.\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e","tags":[],"title":"Edit Solidworks Sketch UI"},{"content":"In the following sections we will discussed about following topics:\nPublic Variables\nStatic Variables\nLife of Variables\nLet\u0026rsquo;s look at them one by one.\nPublic Variables If you need to make a variable available to all the procedures in all your VBA modules, declare the variable at the module level (in the Declarations section) by using the Public keyword.\nFor example, in previous figure, if I use Public in place of Dim in declaration section of VBE, then you can use those variables in other procedures of same modules, and for other modules also.\nIf you would like a variable to be available to other modules, you must declare the variable as Public.\nIn practice, sharing a variable across modules is hardly ever done.\nBut I guess it‚Äôs nice to know that it can be done.\nvba\r1Public swApp As Object\rStatic Variables Normally, when a procedure ends, all the procedure‚Äôs variables are reset.\nStatic variables are a special case because they retain their value even when the procedure ends.\nYou declare a static variable at the procedure level.\nA static variable may be useful if you need to track the number of times you execute a procedure.\nvba\r1Sub CountCalls() 2 Static callCount As Integer 3 callCount = callCount + 1 4 MsgBox \u0026#34;This procedure has been called \u0026#34; \u0026amp; callCount \u0026amp; \u0026#34; times.\u0026#34; 5End Sub\rLife of Variables Nothing lives forever, including variables.\nThe scope of a variable not only determines where that variable may be used, it also affects under which circumstances the variable is removed from memory.\nYou can purge (remove) all variables from memory by using three methods:\nClick the Reset toolbar button (the little blue square button on the Standard toolbar in previous figure).\nClick End when a runtime error message dialog box shows up.\nInclude an End statement anywhere in your code. This is not the same as an End Sub or End Function statement. Generally it is an Exit statement.\nvba\r1End\rOtherwise, only procedure-level variables will be removed from memory when the macro code has completed running.\nStatic variables, module level variables, and global (public) variables all retain their values in between runs of your code.\nNote\nIf you use module-level or global-level variables, make sure they have the value you expect them to have. You never know whether one of the situations I just mentioned may have caused your variables to lose their content!\nNext post will be about VBA Constants.\n","date":"0001-01-01","id":53,"permalink":"/vba/public-static-and-variables-life/","summary":"\u003cp\u003eIn the following sections we will discussed about following topics:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003ePublic Variables\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eStatic Variables\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eLife of Variables\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eLet\u0026rsquo;s look at them one by one.\u003c/p\u003e","tags":[],"title":"Public, Static and Variable's Life"},{"content":"In this post, I tell you about how to create Center Rectangle through Solidworks VBA Macros in a sketch.\nThe process is almost identical with previous Solidworks Macros - Create Corner Rectangle From VBA Macro post.\nIn this post, I tell you about CreateCenterRectangle method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a Center Rectangle.\nVideo of Code on YouTube Please see below video on how to create Center Rectangle from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating a Center Rectangle.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Creating a \u0026#34;Variant\u0026#34; Variable which holds the values return by \u0026#34;CreateCenterRectangle\u0026#34; method Dim vSketchLines As Variant \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating a Center Rectangle vSketchLines = swSketchManager.CreateCenterRectangle(0, 0, 0, 1, 1, 0) \u0026#39; De-select the corner rectangle after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable which we define earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue(). This method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating a \u0026#34;Variant\u0026#34; Variable which holds the values return by \u0026#34;CreateCenterRectangle\u0026#34; method Dim vSketchLines As Variant \u0026#39; Creating a Center rectangle vSketchLines = swSketchManager.CreateCenterRectangle (0, 0, 0, 1, 1, 0)\rIn above sample code, we 1st create a variable named vSketchLines of type Variant.\nA Variant type variable can hold any type of value depends upon the use of variable.\nIn 2nd line, we set the value of variable vSketchLines.\nValue of vSketchLinesis an array of lines. This array is send as return value when we use CreateCenterRectangle method.\nThis CreateCenterRectangle method is part of swSketchManager and it is the latest method to create a Center rectangle.\nThis CreateCenterRectangle method takes following parameters as explained:\nX1 : X coordinate of the center point of rectangle\nY1 : Y coordinate of the center point of rectangle\nZ1 : Z coordinate of the center point of rectangle\nX2 : X coordinate of the point 2\nY2 : Y coordinate of the point 2\nZ2 : Z coordinate of the point 2\nPoint 2 is one of the corners of rectangle we want to create.\nBelow image shows more clearly about these parameters.\nIn the above code sample I have used (0, 0, 0) point which is origin of sketch.\nFor point 2, I used (1, 1, 0) which is 1 point distance in X-direction and 1 point distance in Y-direction.\nThis CreateCenterRectangle method returns an array of sketch segments that represent the edges created for this Center rectangle.\nA Sketch Segment can represent a sketch arc, line, ellipse, parabola or spline.\nSketch Segment has ISketchSegment Interface, which provides functions that are generic to every type of sketch segment.\nFor example, every sketch segment has an ID and can be programmatically selected.\nTherefore, the ISketchSegment interface provides functions to obtain the ID and to select the item.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means inches for distance. But when I used Solidworks API through VBA macros or C#, I need to use converted numeric values.\nBecause Solidworks API output the distance in Meter which is not my requirement.\n\u0026#39; De-select the lines after creation swDoc.ClearSelection2 True\rIn the this line of code, we deselect the Center rectangle we have created.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nHope this post helps you to create Center rectangle in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":54,"permalink":"/solidworks-macros/create-center-rectangle/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create Center Rectangle through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e\n\u003cp\u003eThe process is almost identical with previous \u003cstrong\u003e\u003ca href=\"/solidworks-macros/create-corner-rectangle\"\u003eSolidworks Macros - Create Corner Rectangle From VBA Macro\u003c/a\u003e\u003c/strong\u003e post.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create Center Rectangle"},{"content":"","date":"2023-09-07","id":55,"permalink":"/solidworks-macros/11-sketch---patterns/","summary":"","tags":[],"title":"Sketch - Patterns"},{"content":"Objective I want to:\nChange Selected Sketch Name in Solidworks Part Document. Important Note:\nWe will use same setup as done in üöÄInsert Solidworks Sketch UI.\nHence reading previous üöÄInsert Solidworks Sketch UI artice is highly recommended.\nDemo Video Below üé¨ video shows how to Change Sketch Name UI in Visual Studio 2022.\nSetting Project We need to add some required UI changes as part of Project Setup.\nPlease follow below sections for this.\nAdd [Prism Project] First, we add Prism Project for our requirement.\nWe already have an article where we add Prism Project.\nPlease see üöÄ Create Project section of üöÄ Open Syncfusion Chromeless Window article for creating New Prism project.\nPlease see below image for folder structure.\nAdd [Syncfusion Chromeless Window] Now, we need to add ‚ÄúSyncfusion Chromeless Window‚Äù into our View.\nWe already have an article where we add ‚ÄúSyncfusion Chromeless Window‚Äù into our View.\nPlease see üöÄ Add Syncfusion Chromeless Window section of üöÄ Open Syncfusion Chromeless Window article for creating New Prism project.\nAdd [Design Time DataContext] In previous üöÄAdd [Design Time DataContext] section of üöÄInsert Solidworks Sketch UI article, this section is already explained.\nPlease visit üöÄAdd [Design Time DataContext] section of üöÄInsert Solidworks Sketch UI article for more detail on this section.\nAdd [Syncfusion Busy Indicator] Now, we need to add ‚ÄúSyncfusion Busy Indicator‚Äù into our View.\nWe already have an article where we add ‚ÄúSyncfusion Busy Indicator‚Äù into our View.\nPlease see üöÄ Add Syncfusion Busy Indicator article for adding ‚ÄúSyncfusion Busy Indicator‚Äù.\nAdd Controls For UI We will some Controls to arrange and show them in UI.\nPlease follow below section to add them.\nAdd [Grid] First, we add \u0026lt;Grid\u0026gt; tag inside \u0026lt;syncfusion:SfBusyIndicator\u0026gt; tag.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. XAML\r1\u0026lt;syncfusion:ChromelessWindow 2 x:Class=\u0026#34;ChangeSketchName.Views.MainWindow\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 7 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 8 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 9 xmlns:viewModel=\u0026#34;clr-namespace:ChangeSketchName.ViewModels\u0026#34; 10 Title=\u0026#34;{Binding Title}\u0026#34; 11 Width=\u0026#34;525\u0026#34; 12 Height=\u0026#34;350\u0026#34; 13 d:DataContext=\u0026#34;{d:DesignInstance viewModel:MainWindowViewModel}\u0026#34; 14 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 15 WindowStartupLocation=\u0026#34;CenterScreen\u0026#34; 16 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 17 \u0026lt;syncfusion:SfBusyIndicator AnimationType=\u0026#34;Gear\u0026#34; IsBusy=\u0026#34;{Binding IsBusy, Mode=TwoWay}\u0026#34;\u0026gt; 18 \u0026lt;Grid\u0026gt; 19 \u0026lt;Grid.ColumnDefinitions\u0026gt; 20 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 21 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 22 \u0026lt;ColumnDefinition Width=\u0026#34;15\u0026#34; /\u0026gt; 23 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 24 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 25 \u0026lt;/Grid.ColumnDefinitions\u0026gt; 26 27 \u0026lt;Grid.RowDefinitions\u0026gt; 28 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 29 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 30 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 31 \u0026lt;RowDefinition Height=\u0026#34;*\u0026#34; /\u0026gt; 32 \u0026lt;/Grid.RowDefinitions\u0026gt; 33 34 \u0026lt;/Grid\u0026gt; 35 \u0026lt;/syncfusion:SfBusyIndicator\u0026gt; 36\u0026lt;/syncfusion:ChromelessWindow\u0026gt;\rAdd [TextBlock] Now add a Label for \u0026ldquo;New Sketch Name\u0026rdquo; as shown below. XAML\r1\u0026lt;TextBlock 2 Grid.Row=\u0026#34;1\u0026#34; 3 Grid.Column=\u0026#34;1\u0026#34; 4 HorizontalAlignment=\u0026#34;Right\u0026#34; 5 VerticalAlignment=\u0026#34;Center\u0026#34; 6 Foreground=\u0026#34;Black\u0026#34; 7 Text=\u0026#34;Please give new Name:\u0026#34; /\u0026gt;\rPlease see below üëáüèª image for reference. Please see below üëáüèª full code sample for reference. XAML\r1\u0026lt;syncfusion:ChromelessWindow 2 x:Class=\u0026#34;ChangeSketchName.Views.MainWindow\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 7 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 8 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 9 xmlns:viewModel=\u0026#34;clr-namespace:ChangeSketchName.ViewModels\u0026#34; 10 Title=\u0026#34;{Binding Title}\u0026#34; 11 Width=\u0026#34;525\u0026#34; 12 Height=\u0026#34;350\u0026#34; 13 d:DataContext=\u0026#34;{d:DesignInstance viewModel:MainWindowViewModel}\u0026#34; 14 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 15 WindowStartupLocation=\u0026#34;CenterScreen\u0026#34; 16 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 17 \u0026lt;syncfusion:SfBusyIndicator AnimationType=\u0026#34;Gear\u0026#34; IsBusy=\u0026#34;{Binding IsBusy, Mode=TwoWay}\u0026#34;\u0026gt; 18 \u0026lt;Grid\u0026gt; 19 \u0026lt;Grid.ColumnDefinitions\u0026gt; 20 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 21 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 22 \u0026lt;ColumnDefinition Width=\u0026#34;15\u0026#34; /\u0026gt; 23 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 24 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 25 \u0026lt;/Grid.ColumnDefinitions\u0026gt; 26 27 \u0026lt;Grid.RowDefinitions\u0026gt; 28 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 29 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 30 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 31 \u0026lt;RowDefinition Height=\u0026#34;*\u0026#34; /\u0026gt; 32 \u0026lt;/Grid.RowDefinitions\u0026gt; 33 34 \u0026lt;TextBlock 35 Grid.Row=\u0026#34;1\u0026#34; 36 Grid.Column=\u0026#34;1\u0026#34; 37 HorizontalAlignment=\u0026#34;Right\u0026#34; 38 VerticalAlignment=\u0026#34;Center\u0026#34; 39 Foreground=\u0026#34;Black\u0026#34; 40 Text=\u0026#34;Please give new Name:\u0026#34; /\u0026gt; 41 42 \u0026lt;/Grid\u0026gt; 43 \u0026lt;/syncfusion:SfBusyIndicator\u0026gt; 44\u0026lt;/syncfusion:ChromelessWindow\u0026gt;\rPlease see below üëáüèª image as how does this label look in application. Add [TextBox] Now we add TextBox for showing list of Planes.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. XAML\r1\u0026lt;syncfusion:ChromelessWindow 2 x:Class=\u0026#34;InsertSketch.Views.MainWindow\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 7 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 8 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 9 xmlns:viewModel=\u0026#34;clr-namespace:InsertSketch.ViewModels\u0026#34; 10 Title=\u0026#34;{Binding Title}\u0026#34; 11 Width=\u0026#34;500\u0026#34; 12 Height=\u0026#34;250\u0026#34; 13 d:DataContext=\u0026#34;{d:DesignInstance viewModel:MainWindowViewModel}\u0026#34; 14 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 15 ResizeMode=\u0026#34;NoResize\u0026#34; 16 WindowStartupLocation=\u0026#34;CenterScreen\u0026#34; 17 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 18 \u0026lt;syncfusion:SfBusyIndicator AnimationType=\u0026#34;Gear\u0026#34; IsBusy=\u0026#34;{Binding IsBusy, Mode=TwoWay}\u0026#34;\u0026gt; 19 \u0026lt;Grid\u0026gt; 20 \u0026lt;Grid.RowDefinitions\u0026gt; 21 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 22 \u0026lt;RowDefinition Height=\u0026#34;50\u0026#34; /\u0026gt; 23 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 24 \u0026lt;RowDefinition Height=\u0026#34;50\u0026#34; /\u0026gt; 25 \u0026lt;RowDefinition Height=\u0026#34;*\u0026#34; /\u0026gt; 26 \u0026lt;/Grid.RowDefinitions\u0026gt; 27 28 \u0026lt;Grid.ColumnDefinitions\u0026gt; 29 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 30 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 31 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 32 \u0026lt;/Grid.ColumnDefinitions\u0026gt; 33 34 \u0026lt;TextBlock 35 Grid.Row=\u0026#34;1\u0026#34; 36 Grid.Column=\u0026#34;0\u0026#34; 37 HorizontalAlignment=\u0026#34;Right\u0026#34; 38 VerticalAlignment=\u0026#34;Center\u0026#34; 39 FontSize=\u0026#34;24\u0026#34; 40 Foreground=\u0026#34;Black\u0026#34; 41 Text=\u0026#34;Select Plane :\u0026#34; /\u0026gt; 42 43 \u0026lt;syncfusion:ComboBoxAdv 44 Grid.Row=\u0026#34;1\u0026#34; 45 Grid.Column=\u0026#34;2\u0026#34; 46 Height=\u0026#34;50\u0026#34; 47 MinWidth=\u0026#34;200\u0026#34; 48 HorizontalAlignment=\u0026#34;Left\u0026#34; /\u0026gt; 49 50 \u0026lt;/Grid\u0026gt; 51 \u0026lt;/syncfusion:SfBusyIndicator\u0026gt; 52\u0026lt;/syncfusion:ChromelessWindow\u0026gt;\rPlease see below üëáüèª image as how Plane list look in application. Add [Button] Now we add Button button.\nThis button execute function for Change Name of Solidworks Sketch.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. XAML\r1\u0026lt;syncfusion:ChromelessWindow 2 x:Class=\u0026#34;ChangeSketchName.Views.MainWindow\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 7 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 8 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 9 xmlns:viewModel=\u0026#34;clr-namespace:ChangeSketchName.ViewModels\u0026#34; 10 Title=\u0026#34;{Binding Title}\u0026#34; 11 Width=\u0026#34;525\u0026#34; 12 Height=\u0026#34;350\u0026#34; 13 d:DataContext=\u0026#34;{d:DesignInstance viewModel:MainWindowViewModel}\u0026#34; 14 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 15 WindowStartupLocation=\u0026#34;CenterScreen\u0026#34; 16 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 17 \u0026lt;syncfusion:SfBusyIndicator AnimationType=\u0026#34;Gear\u0026#34; IsBusy=\u0026#34;{Binding IsBusy, Mode=TwoWay}\u0026#34;\u0026gt; 18 \u0026lt;Grid\u0026gt; 19 \u0026lt;Grid.ColumnDefinitions\u0026gt; 20 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 21 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 22 \u0026lt;ColumnDefinition Width=\u0026#34;15\u0026#34; /\u0026gt; 23 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 24 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 25 \u0026lt;/Grid.ColumnDefinitions\u0026gt; 26 27 \u0026lt;Grid.RowDefinitions\u0026gt; 28 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 29 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 30 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 31 \u0026lt;RowDefinition Height=\u0026#34;*\u0026#34; /\u0026gt; 32 \u0026lt;/Grid.RowDefinitions\u0026gt; 33 34 \u0026lt;TextBlock 35 Grid.Row=\u0026#34;1\u0026#34; 36 Grid.Column=\u0026#34;1\u0026#34; 37 HorizontalAlignment=\u0026#34;Right\u0026#34; 38 VerticalAlignment=\u0026#34;Center\u0026#34; 39 Foreground=\u0026#34;Black\u0026#34; 40 Text=\u0026#34;Please give new Name:\u0026#34; /\u0026gt; 41 42 \u0026lt;TextBox 43 Grid.Row=\u0026#34;1\u0026#34; 44 Grid.Column=\u0026#34;3\u0026#34; 45 HorizontalAlignment=\u0026#34;Stretch\u0026#34; 46 VerticalContentAlignment=\u0026#34;Center\u0026#34; 47 Text=\u0026#34;{Binding SelectedName, Mode=TwoWay}\u0026#34; /\u0026gt; 48 49 \u0026lt;Button 50 Grid.Row=\u0026#34;3\u0026#34; 51 Grid.Column=\u0026#34;1\u0026#34; 52 Grid.ColumnSpan=\u0026#34;3\u0026#34; 53 Width=\u0026#34;200\u0026#34; 54 Height=\u0026#34;50\u0026#34; 55 VerticalAlignment=\u0026#34;Top\u0026#34; 56 Command=\u0026#34;{Binding ChangeNameCommand}\u0026#34; 57 Content=\u0026#34;Change Name\u0026#34; /\u0026gt; 58 59 \u0026lt;/Grid\u0026gt; 60 \u0026lt;/syncfusion:SfBusyIndicator\u0026gt; 61\u0026lt;/syncfusion:ChromelessWindow\u0026gt;\rPlease see below üëáüèª image as how Insert Sketch looks in application. Set Message Services In this section, we setup Message Services to communicate in our application.\nFor this please follow below üëáüèª sections.\nAdd Message Services Now, we need to ‚ÄúAdd Message Services‚Äù into our application.\nWe already have an article where we ‚ÄúAdd Message Services‚Äù into our application.\nPlease see üöÄ Add Service for Messaging in application section of üöÄ Add Message Service article for adding Message Services.\nFollowing Services added:\nConfirmationMessagesService InformationMessagesService ErrorMessagesService Please see below üëáüèª code sample for reference.\nC#\r1using Prism.Events; 2 3namespace InsertSketch.Services 4{ 5 internal class ConfirmationMessagesService : PubSubEvent\u0026lt;string\u0026gt; { } 6 internal class InformationMessagesService : PubSubEvent\u0026lt;string\u0026gt; { } 7 internal class ErrorMessagesService : PubSubEvent\u0026lt;string\u0026gt; { } 8}\rRegister Message Services Now, we need to ‚ÄúRegister Message Services‚Äù into our application.\nWe already have an article where we ‚ÄúRegister Message Services‚Äù into our application.\nPlease see üöÄ Register Services section of üöÄ Add Message Service article for adding Message Services.\nPlease see below üëáüèª code sample for reference.\nC#\r1using InsertSketch.Services; 2using InsertSketch.ViewModels; 3using Prism.Events; 4using Syncfusion.Windows.Shared; 5using System.Windows; 6 7namespace InsertSketch.Views 8{ 9 /// \u0026lt;summary\u0026gt; 10 /// Interaction logic for MainWindow.xaml 11 /// \u0026lt;/summary\u0026gt; 12 public partial class MainWindow : ChromelessWindow 13 { 14 private readonly IEventAggregator eventAggregator; 15 16 public MainWindow(IEventAggregator eventAggregator) 17 { 18 InitializeComponent(); 19 this.eventAggregator = eventAggregator; 20 this.eventAggregator.GetEvent\u0026lt;InformationMessagesService\u0026gt;().Subscribe(InformationMessages); 21 this.eventAggregator.GetEvent\u0026lt;ErrorMessagesService\u0026gt;().Subscribe(ErrorMessages); 22 } 23 24 private void InformationMessages(string messageToShow) 25 { 26 MessageBox.Show(messageToShow, \u0026#34;Information\u0026#34;, MessageBoxButton.OK, MessageBoxImage.Information); 27 } 28 29 private void ErrorMessages(string messageToShow) 30 { 31 MessageBox.Show(messageToShow, \u0026#34;Error\u0026#34;, MessageBoxButton.OK, MessageBoxImage.Error); 32 } 33 } 34}\rUnderstand Message Services If you want to ‚Äúunderstand Message Services‚Äù, then please visit below article.\nReference Article: üöÄ Add Message Service\nUpdate ViewModel Now we need to ‚Äúadd Properties and Methods‚Äù for ‚ÄúBinding‚Äù with our view.\nView: MainWindow ViewModel: MainWindowViewModel Please see below üëáüèª image for ‚ÄúProperties and Methods‚Äù required.\nAdd [Property] We need to 1 Property for TextBox.\nPlease see below üëáüèª code sample for ‚ÄúProperties‚Äù in MainWindowViewModel.\nC#\r1private string _selectedName; 2 3public string SelectedName 4{ 5 get { return _selectedName; } 6 set { SetProperty(ref _selectedName, value); } 7}\rPlease see below üëáüèª image for Property required. Now we need to fill, \u0026ldquo;Sketch Name\u0026rdquo; in SelectedName variable. Add [Prism Command] We need 1 Prism Command for Change Sketch Button.\nThis command will be responsible for Changing Sketch in Solidworks Part Document.\nPlease see below üëáüèª code sample for adding ‚ÄúPrism Command‚Äù in MainWindowViewModel.\nC#\r1private DelegateCommand _changeNameCommand; 2 3public DelegateCommand ChangeNameCommand =\u0026gt; 4 _changeNameCommand ?? (_changeNameCommand = new DelegateCommand(ExecuteChangeNameCommand)); 5 6void ExecuteChangeNameCommand() 7{ 8 9}\rPlease see below üëáüèª image for adding ‚ÄúPrism Command‚Äù in MainWindowViewModel. Add Code To Function Now we will add some code ExecuteChangeNameCommand function.\nWe already used this code for in various articles.\nPlease see below üëáüèª code sample for waiting code to add.\nC#\r1private DelegateCommand _changeNameCommand; 2 3public DelegateCommand ChangeNameCommand =\u0026gt; 4 _changeNameCommand ?? (_changeNameCommand = new DelegateCommand(ExecuteChangeNameCommand)); 5 6async void ExecuteChangeNameCommand() 7{ 8 // Show busy indicator 9 IsBusy = true; 10 11 await Task.Run(() =\u0026gt; 12 { 13 // Sleeping with 5 sec 14 Thread.Sleep(5000); 15 }); 16 17 // Hide busy indicator 18 IsBusy = false; 19}\rPlease see below üëáüèª image for waiting code to add. Add [Bindings] In this section we will add Bindings to WPF TextBox and WPF Button.\nPlease see below üëáüèª image for adding ‚ÄúBinding Property‚Äù. Please see below üëáüèª code for adding ‚ÄúBinding Property‚Äù. XAML\r1\u0026lt;TextBox 2 Grid.Row=\u0026#34;1\u0026#34; 3 Grid.Column=\u0026#34;3\u0026#34; 4 HorizontalAlignment=\u0026#34;Stretch\u0026#34; 5 VerticalContentAlignment=\u0026#34;Center\u0026#34; 6 Text=\u0026#34;{Binding SelectedName, Mode=TwoWay}\u0026#34; /\u0026gt;\rAdd [Command Binding] We need to Bind previously created ‚ÄúCommand‚Äù with ‚ÄúWPF Button‚Äù.\nPlease see below üëáüèª image for adding ‚ÄúCommand‚Äù.\nPlease see below üëáüèª code for adding ‚ÄúCommand‚Äù. XAML\r1\u0026lt;Button 2 Grid.Row=\u0026#34;3\u0026#34; 3 Grid.Column=\u0026#34;1\u0026#34; 4 Grid.ColumnSpan=\u0026#34;3\u0026#34; 5 Width=\u0026#34;200\u0026#34; 6 Height=\u0026#34;50\u0026#34; 7 VerticalAlignment=\u0026#34;Top\u0026#34; 8 Command=\u0026#34;{Binding ChangeNameCommand}\u0026#34; 9 Content=\u0026#34;Change Name\u0026#34; /\u0026gt;\rFinal Result Now we run the application as shown in below üëáüèª image.\nNow we are able to Change Sketch Name in MVVM pattern successfully.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Change Sketch Name in WPF application.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":56,"permalink":"/wpf-tutorials/change-sketch-name-ui/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eI want to:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eChange Selected Sketch Name in Solidworks Part Document.\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eImportant Note:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eWe will use same setup as done in üöÄ\u003ca href=\"/wpf-tutorials/insert-solidworks-sketch-ui/\" target=\"_blank\"\u003eInsert Solidworks Sketch UI\u003c/a\u003e.\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e","tags":[],"title":"Change Sketch Name UI"},{"content":"In this post, I tell you about how to create 3-Point Corner Rectangle through Solidworks VBA Macros in a sketch.\nThe process is almost identical with previou Solidworks Macros - Create Corner Rectangle post.\nIn this post, I tell you about Create3PointCornerRectangle method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a 3 Point Corner Rectangle.\nVideo of Code on YouTube Please see below video on how to create 3-Point Corner Rectangle from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating a 3 Point Corner Rectangle.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Creating a \u0026#34;Variant\u0026#34; Variable which holds the values return by \u0026#34;Create3PointCornerRectangle\u0026#34; method Dim vSketchLines As Variant \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating a 3 Point Corner Rectangle vSketchLines = swSketchManager.Create3PointCornerRectangle (0, 0, 0, 1, 0, 0, 0, 1, 0) \u0026#39; De-select the line after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable which we define earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue(). This method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating a \u0026#34;Variant\u0026#34; Variable which holds the values return by \u0026#34;Create3PointCornerRectangle\u0026#34; method Dim vSketchLines As Variant \u0026#39; Creating an 3 Point Corner Rectangle vSketchLines = swSketchManager.Create3PointCornerRectangle(0, 0, 0, 1, 0, 0, 0, 1, 0)\rIn above sample code, we 1st create a variable named vSketchLines of type Variant.\nA Variant type variable can hold any type of value depends upon the use of variable.\nIn 2nd line, we set the value of variable vSketchLines.\nValue of vSketchLinesis an array of lines. This array is send as return value when we use Create3PointCornerRectangle method.\nThis Create3PointCornerRectangle method is part of swSketchManager and it is the latest method to create a 3 Point Corner Rectangle.\nThis Create3PointCornerRectangle method takes following parameters as explained:\nX1 : X coordinate of the point 1\nY1 : Y coordinate of the point 1\nZ1 : Z coordinate of the point 1\nX2 : X coordinate of the point 2\nY2 : Y coordinate of the point 2\nZ2 : Z coordinate of the point 2\nX3 : X coordinate of the point 3\nY3 : Y coordinate of the point 3\nZ3 : Z coordinate of the point 3\nBelow image shows more clearly about these parameters.\nIn the above code sample I have used (0, 0, 0) point which is origin of sketch.\nFor point 2, I used (1, 0, 0) which is 1 point distance in X-direction.\nFor point 3, I used (0, 1, 0) which is 1 point distance in Y-direction.\nThis Create3PointCornerRectangle method returns an array of sketch segments that represent the edges created for this 3 Point Corner Rectangle.\nA Sketch Segment can represent a sketch arc, line, ellipse, parabola or spline.\nSketch Segment has ISketchSegment Interface, which provides functions that are generic to every type of sketch segment.\nFor example, every sketch segment has an ID and can be programmatically selected.\nTherefore, the ISketchSegment interface provides functions to obtain the ID and to select the item.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means inches for distance. But when I used Solidworks API through VBA macros or C#, I need to use converted numeric values.\nBecause Solidworks API output the distance in Meter which is not my requirement.\n\u0026#39; De-select the lines after creation swDoc.ClearSelection2 True\rIn the this line of code, we deselect the 3 Point Corner Rectangle we have created.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nHope this post helps you to create 3 Point Corner Rectangle in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":57,"permalink":"/solidworks-macros/create-3point-corner-rectangle/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create 3-Point Corner Rectangle through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create 3-Point Corner Rectangle"},{"content":"A variable‚Äôs value may (and usually does) change while your procedure is executing.\nThat‚Äôs why they call it a variable.\nSometimes you need to refer to a value or string that never changes.\nIn such a case, you need a constant ‚Äî a named element whose value doesn‚Äôt change.\nAs shown in the following examples, you declare constants by using the Const statement.\nThe declaration statement also gives the constant its value:\nvba\r1Const BlockLength As Integer = 4. 2Const BlockThickness = .5 3Const PartName As String = \u0026#34;Part Name:\u0026#34; 4Public Const AppName As String = \u0026#34;Part Calculation\u0026#34;\rUsing constants in place of hard-coded values or strings is an excellent programming practice.\nFor example, if your procedure needs to refer to a specific value (such as sheet thickness) several times.\nIt is better to declare the value as a constant and refer to its name rather than the value.\nThis makes your code more readable and easier to change.\nWhen sheet thickness changes, you have to change only one statement rather than several.\nLike variables, constants have a scope. Keep these points in mind:\nTo make a constant available within only a single procedure, declare the constant after the procedure‚Äôs Sub or Function statement. To make a constant available to all procedures in a module, declare the constant in the Declarations section for the module. To make a constant available to all modules, use the Public keyword and declare the constant in the Declarations section of any module. If you attempt to change the value of a constant in a VBA routine, you get an error.\nThis isn‚Äôt too surprising because a Constant is constant.\nUnlike a variable, the value of a constant does not vary.\nIf you need to change the value of a constant while your code is running, what you really need is a variable.\nPre-made constants Your CAD Application and VBA contain many predefined constants, which you can use without the need to declare them yourself.\nThe macro recorder (in Solidworks) usually uses constants rather than actual values.\nIn general, you don‚Äôt need to know the value of these constants to use them.\nThe following simple procedure uses a built-in constant swDefaultTemplatePart to select the default part template while opening a new file.\nvba\r1set swPart = swApp.NewDocument(swApp.GetUserPreferenceStringValue _ 2 (swUserPreferenceStringValue_e.swDefaultTemplatePart),0,0,0)\rIn above example, Solidworks did not record these constants.\nIt simply generates the direct path to open part document.\nTo find the actual value of a built-in constant, use the \u0026ldquo;Immediate window\u0026rdquo; in the VBE, and execute a VBA statement such as the following:\nvba\r1?swDefaultTemplatePart\rNote\nIf the Immediate window isn‚Äôt visible, press Ctrl+G. The question mark is a shortcut for typing Print.\nNext post will be about VBA Strings Basics.\n","date":"0001-01-01","id":58,"permalink":"/vba/constants/","summary":"\u003cp\u003eA variable‚Äôs value may (and usually does) change while your procedure is executing.\u003c/p\u003e\n\u003cp\u003eThat‚Äôs why they call it a \u003cstrong\u003evariable\u003c/strong\u003e.\u003c/p\u003e","tags":[],"title":"VBA Constants"},{"content":"","date":"2023-09-07","id":59,"permalink":"/solidworks-macros/12-sketch---move-and-rotate/","summary":"","tags":[],"title":"Sketch - Move and Rotate"},{"content":"Objective I want to:\nDelete Selected Sketch in Solidworks Part Document. Important Note:\nWe will use same setup as done in üöÄInsert Solidworks Sketch UI.\nHence reading previous üöÄInsert Solidworks Sketch UI artice is highly recommended.\nDemo Video Below üé¨ video shows how to Delete Sketch UI in Visual Studio 2022.\nSetting Project We need to add some required UI changes as part of Project Setup.\nPlease follow below sections for this.\nAdd [Prism Project] First, we add Prism Project for our requirement.\nWe already have an article where we add Prism Project.\nPlease see üöÄ Create Project section of üöÄ Open Syncfusion Chromeless Window article for creating New Prism project.\nPlease see below image for folder structure.\nAdd [Syncfusion Chromeless Window] Now, we need to add ‚ÄúSyncfusion Chromeless Window‚Äù into our View.\nWe already have an article where we add ‚ÄúSyncfusion Chromeless Window‚Äù into our View.\nPlease see üöÄ Add Syncfusion Chromeless Window section of üöÄ Open Syncfusion Chromeless Window article for creating New Prism project.\nAdd [Design Time DataContext] In previous üöÄAdd [Design Time DataContext] section of üöÄInsert Solidworks Sketch UI article, this section is already explained.\nPlease visit üöÄAdd [Design Time DataContext] section of üöÄInsert Solidworks Sketch UI article for more detail on this section.\nAdd [Syncfusion Busy Indicator] Now, we need to add ‚ÄúSyncfusion Busy Indicator‚Äù into our View.\nWe already have an article where we add ‚ÄúSyncfusion Busy Indicator‚Äù into our View.\nPlease see üöÄ Add Syncfusion Busy Indicator article for adding ‚ÄúSyncfusion Busy Indicator‚Äù.\nAdd Message Services Now, we need to ‚ÄúAdd Message Services‚Äù into our application.\nWe already have an article where we ‚ÄúAdd Message Services‚Äù into our application.\nPlease see üöÄ Add Service for Messaging in application section of üöÄ Add Message Service article for adding Message Services.\nRegister Message Services Now, we need to ‚ÄúRegister Message Services‚Äù into our application.\nWe already have an article where we ‚ÄúRegister Message Services‚Äù into our application.\nPlease see üöÄ Register Services section of üöÄ Add Message Service article for adding Message Services.\nUnderstand Message Services If you want to ‚Äúunderstand Message Services‚Äù, then please visit below article.\nReference Article: üöÄ Add Message Service\nAdd [Solidworks References] Now, we need to ‚ÄúAdd [Solidworks References]‚Äù into our application.\nWe already have an article where we ‚ÄúAdd [Solidworks References]‚Äù into our application.\nPlease see üöÄ Add [Solidworks References] section of üöÄ SOLIDWORKS C# API - Edit Solidworks Sketch article for Adding [Solidworks References].\nAdd Constructor Now, we need to Add Constructor into our application.\nWe already have an article where we Add Constructor into our application.\nPlease see üöÄ Add Constructor section of üöÄ SOLIDWORKS C# API - Change Sketch Name article for Adding Constructor.\nAdd Private Fields Now, we need to Add Private Fields into our application.\nWe already have an article where we Add Private Fields into our application.\nPlease see üöÄ Add Private Fields section of üöÄ SOLIDWORKS C# API - Change Sketch Name article for Adding Constructor.\nAdd Controls For UI We will some Controls to arrange and show them in UI.\nPlease follow below section to add them.\nAdd [Button] Now we add \u0026lt;Button\u0026gt; tag inside \u0026lt;syncfusion:SfBusyIndicator\u0026gt; tag..\nThis button execute function for Delete selected Solidworks Sketch.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. XAML\r1\u0026lt;syncfusion:ChromelessWindow 2 x:Class=\u0026#34;DeleteSketch.Views.MainWindow\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 7 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 8 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 9 xmlns:viewmodel=\u0026#34;clr-namespace:DeleteSketch.ViewModels\u0026#34; 10 Title=\u0026#34;{Binding Title}\u0026#34; 11 Width=\u0026#34;525\u0026#34; 12 Height=\u0026#34;350\u0026#34; 13 d:DataContext=\u0026#34;{d:DesignInstance viewmodel:MainWindowViewModel}\u0026#34; 14 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 15 WindowStartupLocation=\u0026#34;CenterScreen\u0026#34; 16 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 17 \u0026lt;syncfusion:SfBusyIndicator AnimationType=\u0026#34;Gear\u0026#34; IsBusy=\u0026#34;{Binding IsBusy, Mode=TwoWay}\u0026#34;\u0026gt; 18 \u0026lt;Button 19 Width=\u0026#34;250\u0026#34; 20 Height=\u0026#34;50\u0026#34; 21 Content=\u0026#34;Delete Selected Sketch\u0026#34; /\u0026gt; 22 \u0026lt;/syncfusion:SfBusyIndicator\u0026gt; 23\u0026lt;/syncfusion:ChromelessWindow\u0026gt;\rPlease see below üëáüèª image as how Insert Sketch looks in application. Update ViewModel Now we need to ‚Äúadd Properties and Methods‚Äù for ‚ÄúBinding‚Äù with our view.\nView: MainWindow ViewModel: MainWindowViewModel Please see below üëáüèª image for ‚ÄúProperties and Methods‚Äù required.\nAdd [Prism Command] We need 1 Prism Command for Delete Sketch Button.\nThis command will be responsible for Deleting Sketch in Solidworks Part Document.\nPlease see below üëáüèª code sample for adding ‚ÄúPrism Command‚Äù in MainWindowViewModel.\nC#\r1private DelegateCommand _DeleteCommand; 2 3public DelegateCommand DeleteCommand =\u0026gt; 4 _DeleteCommand ?? (_DeleteCommand = new DelegateCommand(ExecuteDeleteCommand)); 5 6void ExecuteDeleteCommand() 7{ 8 9}\rPlease see below üëáüèª image for adding ‚ÄúPrism Command‚Äù in MainWindowViewModel. Add Code To Function Now we will add some code ExecuteDeleteCommand function.\nWe already used this code for in various articles.\nPlease see below üëáüèª code sample for waiting code to add.\nC#\r1private DelegateCommand _DeleteCommand; 2 3public DelegateCommand DeleteCommand =\u0026gt; 4 _DeleteCommand ?? (_DeleteCommand = new DelegateCommand(ExecuteDeleteCommand)); 5 6async void ExecuteDeleteCommand() 7{ 8 // Show busy indicator 9 IsBusy = true; 10 11 await Task.Run(() =\u0026gt; 12 { 13 // Sleeping with 5 sec 14 Thread.Sleep(5000); 15 }); 16 17 // Hide busy indicator 18 IsBusy = false; 19}\rPlease see below üëáüèª image for waiting code to add. Add [Command Binding] We need to Bind previously created ‚ÄúCommand‚Äù with ‚ÄúWPF Button‚Äù.\nPlease see below üëáüèª image for adding ‚ÄúCommand‚Äù.\nPlease see below üëáüèª code for adding ‚ÄúCommand‚Äù. XAML\r1\u0026lt;Button 2 Width=\u0026#34;250\u0026#34; 3 Height=\u0026#34;50\u0026#34; 4 Command=\u0026#34;{Binding DeleteCommand}\u0026#34; 5 Content=\u0026#34;Delete Selected Sketch\u0026#34; /\u0026gt;\rFinal Result Now we run the application as shown in below üëáüèª image.\nNow we are able to Delete Solidworks Sketch in MVVM pattern successfully.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Delete Solidworks Sketch in WPF application.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":60,"permalink":"/wpf-tutorials/delete-selected-sketch-ui/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eI want to:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cem\u003e\u003cstrong\u003eDelete Selected Sketch in Solidworks Part Document.\u003c/strong\u003e\u003c/em\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eImportant Note:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cem\u003e\u003cstrong\u003eWe will use same setup as done in üöÄ\u003ca href=\"/wpf-tutorials/insert-solidworks-sketch-ui/\" target=\"_blank\"\u003eInsert Solidworks Sketch UI\u003c/a\u003e.\u003c/strong\u003e\u003c/em\u003e\u003c/p\u003e","tags":[],"title":"Delete Selected Sketch UI"},{"content":"In this post, I tell you about how to create 3-Point Center Rectangle in a sketch.\nThe process is almost identical with previous Solidworks Macros - Create 3-Point Corner Rectangle post.\nIn this post, I tell you about Create3PointCenterRectangle method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a 3 Point Center Rectangle.\nVideo of Code on YouTube Please see below video on how to create 3-Point Center Rectangle from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating a 3 Point Center Rectangle.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Creating a \u0026#34;Variant\u0026#34; Variable which holds the values return by \u0026#34;Create3PointCenterRectangle\u0026#34; method Dim vSketchLines As Variant \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating a 3 Point Center Rectangle vSketchLines = swSketchManager.Create3PointCenterRectangle(0, 0, 0, 1, 0, 0, 0, 1, 0) \u0026#39; De-select the line after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable which we define earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue(). This method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating a \u0026#34;Variant\u0026#34; Variable which holds the values return by \u0026#34;Create3PointCenterRectangle\u0026#34; method Dim vSketchLines As Variant \u0026#39; Creating 3 Point Center Rectangle vSketchLines = swSketchManager.Create3PointCenterRectangle(0, 0, 0, 1, 0, 0, 0, 1, 0)\rIn above sample code, we 1st create a variable named vSketchLines of type Variant.\nA Variant type variable can hold any type of value depends upon the use of variable.\nIn 2nd line, we set the value of variable vSketchLines.\nValue of vSketchLinesis an array of lines. This array is send as return value when we use Create3PointCenterRectangle method.\nThis Create3PointCenterRectangle method is part of swSketchManager and it is the latest method to create a 3 Point Corner Rectangle.\nThis Create3PointCenterRectangle method takes following parameters as explained:\nX1 : X coordinate of the origin\nY1 : Y coordinate of the origin\nZ1 : Z coordinate of the origin\nX2 : X coordinate of the point 2 of one side\nY2 : Y coordinate of the point 2 of one side\nZ2 : Z coordinate of the point 2 of one side\nX3 : X coordinate of the point 3 of one side\nY3 : Y coordinate of the point 3 of one side\nZ3 : Z coordinate of the point 3 of one side\nBelow image shows more clearly about these parameters.\nIn the above code sample I have used (0, 0, 0) point at origin of sketch.\nFor point 2, which is midpoint of one side; I used (1, 0, 0) which is 1 point distance in X-direction.\nFor point 3, which is end point of one side; I used (0, 1, 0) which is 1 point distance in Y-direction.\nThis Create3PointCenterRectangle method returns an array of sketch segments that represent the edges created for this 3 Point Center Rectangle.\nA Sketch Segment can represent a sketch arc, line, ellipse, parabola or spline.\nSketch Segment has ISketchSegment Interface, which provides functions that are generic to every type of sketch segment.\nFor example, every sketch segment has an ID and can be programmatically selected.\nTherefore, the ISketchSegment interface provides functions to obtain the ID and to select the item.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means inches for distance. But when I used Solidworks API through VBA macros or C#, I need to use converted numeric values.\nBecause Solidworks API output the distance in Meter which is not my requirement.\n\u0026#39; De-select the lines after creation swDoc.ClearSelection2 True\rIn the this line of code, we deselect the 3 Point Corner Rectangle we have created.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nHope this post helps you to create 3 Point Center Rectangle in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":61,"permalink":"/solidworks-macros/create-3point-center-rectangle/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create 3-Point Center Rectangle\u003c/em\u003e in a sketch.\u003c/p\u003e\n\u003cp\u003eThe process is almost identical with previous \u003cstrong\u003e\u003ca href=\"/solidworks-macros/create-3point-corner-rectangle\"\u003eSolidworks Macros - Create 3-Point Corner Rectangle\u003c/a\u003e\u003c/strong\u003e post.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create 3-Point Center Rectangle"},{"content":"The String data type represents a series of characters. This topic introduces the basic concepts of strings in Visual Basic.\nString Variables An instance of a string can be assigned a value that represents a series of characters as shown in below example:\nvba\r1Dim MyString As String 2MyString = \u0026#34;This is an example of the String data type\u0026#34;\rA String variable can also accept any expression that evaluates to a string as shown in below example:\nvba\r1Dim OneString As String 2Dim TwoString As String 3OneString = \u0026#34;one, two, three, four, five\u0026#34; 4TwoString = OneString.Substring(5, 3) \u0026#39; Output -\u0026gt; \u0026#34;two\u0026#34;. 5 6OneString = \u0026#34;1\u0026#34; 7TwoString = OneString \u0026amp; \u0026#34;1\u0026#34; \u0026#39; Output -\u0026gt; \u0026#34;11\u0026#34;.\rAny literal that is assigned to a String variable must be enclosed in quotation marks (\u0026quot;\u0026quot;).\nThis means that a quotation mark (\u0026quot;\u0026quot;) within a string cannot be represented by a quotation mark.\nFor example, the following code causes a compiler error:\nvba\r1Dim myString As String 2 3\u0026#39; This line would cause an error. 4myString = \u0026#34;He said, \u0026#34;Look at this example!\u0026#34;\u0026#34;\rNote\nThis code causes an error because the compiler terminates the string after the second quotation mark, and the remainder of the string is interpreted as code.\nThis means compiler think He said, is a string and Look at this example! as a VB code.\nBut we want compiler to know that we want He said, \u0026quot;Look at this example!\u0026quot; as a string value.\nTo solve this problem, Visual Basic interprets two quotation marks in a string literal as one quotation mark in the string.\nThe following example shows the correct way to include a quotation mark in a string:\nvba\r1\u0026#39; The value of myString is: He said, \u0026#34;Look at this example!\u0026#34; 2myString = \u0026#34;He said, \u0026#34;\u0026#34;Look at this example!\u0026#34;\u0026#34; \u0026#34;\rNote\nIn the preceding example, the two quotation marks before and after the word Look become one quotation mark in the string.\nThe Immutability of Strings A string is immutable, which means its value cannot be changed once it has been created.\nHowever, this does not prevent us from assigning more than one value to a string variable as shown in below example:\nvba\r1Dim myString As String = \u0026#34;This string is immutable\u0026#34; 2myString = \u0026#34;Or is it?\u0026#34;\rHere, a string variable is created, given a value, and then its value is changed.\nIn the first line, an instance of type String is created and given the value This string is immutable.\nIn the second line of the example, a new instance is created and given the value Or is it?, and the string variable discards its reference to the first instance and stores a reference to the new instance.\nUnlike other intrinsic data types, String is a reference type.\nWhen a variable of reference type is passed as an argument to a function or subroutine, a reference to the memory address where the data is stored is passed instead of the actual value of the string.\nSo in the previous example, the name of the variable remains the same, but it points to a new and different instance of the String class, which holds the new value.\nNext post will be about VBA Assignment Statements And Operators.\n","date":"0001-01-01","id":62,"permalink":"/vba/string-basics/","summary":"\u003cp\u003eThe \u003ccode\u003eString\u003c/code\u003e data type represents a series of characters. This topic introduces the basic concepts of strings in Visual Basic.\u003c/p\u003e","tags":[],"title":"VBA String Basics"},{"content":"","date":"2023-09-07","id":63,"permalink":"/solidworks-macros/13-sketch---relations/","summary":"","tags":[],"title":"Sketch - Relations"},{"content":"Objective I want to\nCreate a UI for \u0026ldquo;Create Line UI\u0026rdquo; article. Since I want to make the UI in modular way, hence I will create the UI in parts.\nThis is part 1 of Create Line UI.\nDemo Video Below üé¨ video shows how to Create Line UI - Part 1 in Visual Studio 2022.\nSetting Project We need to add some required UI changes as part of Project Setup.\nPlease follow below sections for this.\nAdd [Prism Project] First, we add Prism Project for our requirement.\nWe already have an article where we add Prism Project.\nPlease see üöÄ Create Project section of üöÄ Open Syncfusion Chromeless Window article for creating New Prism project.\nName of our Project: SolidworksTest\nAdd [Syncfusion Chromeless Window] Now, we need to add ‚ÄúSyncfusion Chromeless Window‚Äù into our View.\nWe already have an article where we add ‚ÄúSyncfusion Chromeless Window‚Äù into our View.\nPlease see üöÄ Add Syncfusion Chromeless Window section of üöÄ Open Syncfusion Chromeless Window article for creating New Prism project.\nAdd [Design Time DataContext] In previous üöÄAdd [Design Time DataContext] section of üöÄInsert Solidworks Sketch UI article, this section is already explained.\nPlease visit üöÄAdd [Design Time DataContext] section of üöÄInsert Solidworks Sketch UI article for more detail on this section.\nAdd [Syncfusion Busy Indicator] Now, we need to add ‚ÄúSyncfusion Busy Indicator‚Äù into our View.\nWe already have an article where we add ‚ÄúSyncfusion Busy Indicator‚Äù into our View.\nPlease see üöÄ Add Syncfusion Busy Indicator article for adding ‚ÄúSyncfusion Busy Indicator‚Äù.\nAdd Message Services Now, we need to ‚ÄúAdd Message Services‚Äù into our application.\nWe already have an article where we ‚ÄúAdd Message Services‚Äù into our application.\nPlease see üöÄ Add Service for Messaging in application section of üöÄ Add Message Service article for adding Message Services.\nRegister Message Services Now, we need to ‚ÄúRegister Message Services‚Äù into our application.\nWe already have an article where we ‚ÄúRegister Message Services‚Äù into our application.\nPlease see üöÄ Register Services section of üöÄ Add Message Service article for adding Message Services.\nUnderstand Message Services If you want to ‚Äúunderstand Message Services‚Äù, then please visit below article.\nReference Article: üöÄ Add Message Service\nAdd [Solidworks References] Now, we need to ‚ÄúAdd [Solidworks References]‚Äù into our application.\nWe already have an article where we ‚ÄúAdd [Solidworks References]‚Äù into our application.\nPlease see üöÄ Add [Solidworks References] section of üöÄ SOLIDWORKS C# API - Edit Solidworks Sketch article for Adding [Solidworks References].\nAdd Constructor Now, we need to Add Constructor into our application.\nWe already have an article where we Add Constructor into our application.\nPlease see üöÄ Add Constructor section of üöÄ SOLIDWORKS C# API - Change Sketch Name article for Adding Constructor.\nAdd Private Fields Now, we need to Add Private Fields into our application.\nWe already have an article where we Add Private Fields into our application.\nPlease see üöÄ Add Private Fields section of üöÄ SOLIDWORKS C# API - Change Sketch Name article for Adding Constructor.\nAdd View [PointViewModel] Now we need to add a [ViewModel] for [PointView] control.\nViewModel Name - PointViewModel\nPlease see below üëáüèª image for reference. Add Properties Now in [PointViewModel], we need to add properties.\nWe need below properties.\nC#\r1private string _header; 2public string Header 3{ 4 get { return _header; } 5 set { SetProperty(ref _header, value); } 6} 7 8private double _xpoint; 9public double XPoint 10{ 11 get { return _xpoint; } 12 set { SetProperty(ref _xpoint, value); } 13} 14 15private double _ypoint; 16public double YPoint 17{ 18 get { return _ypoint; } 19 set { SetProperty(ref _ypoint, value); } 20} 21 22private double _zpoint; 23public double ZPoint 24{ 25 get { return _zpoint; } 26 set { SetProperty(ref _zpoint, value); } 27}\rBelow property we use for showing header of group box which we create in GroupBox.\nC#\r1private string _header; 2public string Header 3{ 4 get { return _header; } 5 set { SetProperty(ref _header, value); } 6}\rBelow properties we use for point co-ordinates.\nC#\r1private double _xpoint; 2public double XPoint 3{ 4 get { return _xpoint; } 5 set { SetProperty(ref _xpoint, value); } 6} 7 8private double _ypoint; 9public double YPoint 10{ 11 get { return _ypoint; } 12 set { SetProperty(ref _ypoint, value); } 13} 14 15private double _zpoint; 16public double ZPoint 17{ 18 get { return _zpoint; } 19 set { SetProperty(ref _zpoint, value); } 20}\rAdd Constructor Now in [PointViewModel], we need to add constructor.\nC#\r1#region Constructor 2 3public PointViewModel() 4{ 5 6} 7 8#endregion\rIn above code, first we create a region.\nC#\r1#region Constructor 2 3#endregion\rThen we add constuctor as shown below.\nC#\r1#region Constructor 2 3public PointViewModel() 4{ 5 6} 7 8#endregion\rAdd View [PointView] Now we need to add a [WPF UserControl].\nUserControl Name - PointView\nPlease see below üëáüèª image for reference. Add [Design Time DataContext] In previous üöÄAdd [Design Time DataContext] section of üöÄInsert Solidworks Sketch UI article, this section is already explained.\nPlease visit üöÄAdd [Design Time DataContext] section of üöÄInsert Solidworks Sketch UI article for more detail on this section.\nDesign time Data context = PointViewModel\nPlease see below üëáüèª image for reference.\nAdd [GroupBox] Now we add \u0026lt;GroupBox\u0026gt; tag inside \u0026lt;UserControl\u0026gt; tag.\nThis GroupBox will hold controls for Points Co-ordinates.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. XAML\r1\u0026lt;UserControl 2 x:Class=\u0026#34;SolidworksTest.Views.PointView\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:local=\u0026#34;clr-namespace:SolidworksTest.Views\u0026#34; 7 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 8 xmlns:viewModel=\u0026#34;clr-namespace:SolidworksTest.ViewModels\u0026#34; 9 d:DataContext=\u0026#34;{d:DesignInstance Type=viewModel:PointViewModel}\u0026#34; 10 d:DesignHeight=\u0026#34;450\u0026#34; 11 d:DesignWidth=\u0026#34;800\u0026#34; 12 Background=\u0026#34;White\u0026#34; 13 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 14 \u0026lt;GroupBox 15 Margin=\u0026#34;10\u0026#34; 16 Padding=\u0026#34;10\u0026#34; 17 BorderBrush=\u0026#34;Black\u0026#34; 18 FontSize=\u0026#34;18\u0026#34; 19 Foreground=\u0026#34;Black\u0026#34; 20 Header=\u0026#34;{Binding Header}\u0026#34; /\u0026gt; 21\u0026lt;/UserControl\u0026gt;\rIn above code, we set values of following properties.\nMargin=\u0026quot;10\u0026quot; Padding=\u0026quot;10\u0026quot; BorderBrush=\u0026quot;Black\u0026quot; FontSize=\u0026quot;18\u0026quot; Foreground=\u0026quot;Black\u0026quot; Header property of \u0026lt;GroupBox\u0026gt;, we bind it with Header property in our PointViewModel class. Add [Grid] Now we add \u0026lt;Grid\u0026gt; tag inside \u0026lt;GroupBox\u0026gt; tag.\nBelow are the definition for Grid Columns.\nXAML\r1\u0026lt;Grid.ColumnDefinitions\u0026gt; 2 \u0026lt;ColumnDefinition Width=\u0026#34;125\u0026#34; /\u0026gt; 3 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 4 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 5\u0026lt;/Grid.ColumnDefinitions\u0026gt;\rBelow are the definition for Grid Rows. XAML\r1\u0026lt;Grid.RowDefinitions\u0026gt; 2 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 3 \u0026lt;RowDefinition Height=\u0026#34;15\u0026#34; /\u0026gt; 4 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 5\u0026lt;/Grid.RowDefinitions\u0026gt;\rPlease see below üëáüèª image for reference. Please see below üëáüèª code sample for reference. XAML\r1\u0026lt;UserControl 2 x:Class=\u0026#34;SolidworksTest.Views.PointView\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:local=\u0026#34;clr-namespace:SolidworksTest.Views\u0026#34; 7 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 8 xmlns:viewModel=\u0026#34;clr-namespace:SolidworksTest.ViewModels\u0026#34; 9 d:DataContext=\u0026#34;{d:DesignInstance Type=viewModel:PointViewModel}\u0026#34; 10 d:DesignHeight=\u0026#34;450\u0026#34; 11 d:DesignWidth=\u0026#34;800\u0026#34; 12 Background=\u0026#34;White\u0026#34; 13 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 14 \u0026lt;GroupBox 15 Margin=\u0026#34;10\u0026#34; 16 Padding=\u0026#34;10\u0026#34; 17 BorderBrush=\u0026#34;Black\u0026#34; 18 FontSize=\u0026#34;18\u0026#34; 19 Foreground=\u0026#34;Black\u0026#34; 20 Header=\u0026#34;{Binding Header}\u0026#34;\u0026gt; 21 \u0026lt;Grid\u0026gt; 22 \u0026lt;Grid.ColumnDefinitions\u0026gt; 23 \u0026lt;ColumnDefinition Width=\u0026#34;125\u0026#34; /\u0026gt; 24 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 25 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 26 \u0026lt;/Grid.ColumnDefinitions\u0026gt; 27 28 \u0026lt;Grid.RowDefinitions\u0026gt; 29 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 30 \u0026lt;RowDefinition Height=\u0026#34;15\u0026#34; /\u0026gt; 31 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 32 \u0026lt;/Grid.RowDefinitions\u0026gt; 33 34 \u0026lt;/Grid\u0026gt; 35 \u0026lt;/GroupBox\u0026gt; 36\u0026lt;/UserControl\u0026gt;\rAdd [XPoint] Label Now we add \u0026lt;TextBlock\u0026gt; tag inside \u0026lt;Grid\u0026gt; tag.\n\u0026lt;TextBlock\u0026gt; tag shows label for XPoint.\nBelow üëáüèª is code for \u0026lt;TextBlock\u0026gt; tag.\nXAML\r1\u0026lt;TextBlock 2 Grid.Row=\u0026#34;0\u0026#34; 3 Grid.Column=\u0026#34;0\u0026#34; 4 HorizontalAlignment=\u0026#34;Right\u0026#34; 5 VerticalAlignment=\u0026#34;Center\u0026#34; 6 Text=\u0026#34;X Co-ordinate:\u0026#34; /\u0026gt;\rIn above code, we set values of following properties.\nGrid.Row=\u0026quot;0\u0026quot; Grid.Column=\u0026quot;0\u0026quot; HorizontalAlignment=\u0026quot;Right\u0026quot; VerticalAlignment=\u0026quot;Center\u0026quot; Text=\u0026quot;X Co-ordinate:\u0026quot; In above code, Grid.Row and Grid.Column are attached properties and they define the position of \u0026lt;TextBlock\u0026gt; inside \u0026lt;Grid\u0026gt; control.\nIn above code, HorizontalAlignment and VerticalAlignment define [Alignment] of control.\nIn above code, Text property define label of \u0026lt;TextBlock\u0026gt; control.\nLable of \u0026lt;TextBlock\u0026gt; control: [X Co-ordinate:]\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. XAML\r1\u0026lt;UserControl 2 x:Class=\u0026#34;SolidworksTest.Views.PointView\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:local=\u0026#34;clr-namespace:SolidworksTest.Views\u0026#34; 7 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 8 xmlns:viewModel=\u0026#34;clr-namespace:SolidworksTest.ViewModels\u0026#34; 9 d:DataContext=\u0026#34;{d:DesignInstance Type=viewModel:PointViewModel}\u0026#34; 10 d:DesignHeight=\u0026#34;450\u0026#34; 11 d:DesignWidth=\u0026#34;800\u0026#34; 12 Background=\u0026#34;White\u0026#34; 13 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 14 \u0026lt;GroupBox 15 Margin=\u0026#34;10\u0026#34; 16 Padding=\u0026#34;10\u0026#34; 17 BorderBrush=\u0026#34;Black\u0026#34; 18 FontSize=\u0026#34;18\u0026#34; 19 Foreground=\u0026#34;Black\u0026#34; 20 Header=\u0026#34;{Binding Header}\u0026#34;\u0026gt; 21 \u0026lt;Grid\u0026gt; 22 \u0026lt;Grid.ColumnDefinitions\u0026gt; 23 \u0026lt;ColumnDefinition Width=\u0026#34;125\u0026#34; /\u0026gt; 24 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 25 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 26 \u0026lt;/Grid.ColumnDefinitions\u0026gt; 27 28 \u0026lt;Grid.RowDefinitions\u0026gt; 29 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 30 \u0026lt;RowDefinition Height=\u0026#34;15\u0026#34; /\u0026gt; 31 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 32 \u0026lt;/Grid.RowDefinitions\u0026gt; 33 34 \u0026lt;TextBlock 35 Grid.Row=\u0026#34;0\u0026#34; 36 Grid.Column=\u0026#34;0\u0026#34; 37 HorizontalAlignment=\u0026#34;Right\u0026#34; 38 VerticalAlignment=\u0026#34;Center\u0026#34; 39 Text=\u0026#34;X Co-ordinate:\u0026#34; /\u0026gt; 40 41 \u0026lt;/Grid\u0026gt; 42 \u0026lt;/GroupBox\u0026gt; 43\u0026lt;/UserControl\u0026gt;\rAdd [XPoint] TextBox Now we add \u0026lt;TextBox\u0026gt; tag inside \u0026lt;Grid\u0026gt; tag.\n\u0026lt;TextBox\u0026gt; tag shows label for XPoint.\nBelow üëáüèª is code for \u0026lt;TextBox\u0026gt; tag.\nXAML\r1\u0026lt;TextBox 2 Grid.Row=\u0026#34;0\u0026#34; 3 Grid.Column=\u0026#34;2\u0026#34; 4 HorizontalAlignment=\u0026#34;Stretch\u0026#34; 5 VerticalAlignment=\u0026#34;Center\u0026#34; 6 PreviewTextInput=\u0026#34;InputTextBox_PreviewTextInput\u0026#34; 7 Text=\u0026#34;{Binding XPoint}\u0026#34; /\u0026gt;\rIn above code, we set values of following properties.\nGrid.Row=\u0026quot;0\u0026quot; Grid.Column=\u0026quot;2\u0026quot; HorizontalAlignment=\u0026quot;Stretch\u0026quot; VerticalAlignment=\u0026quot;Center\u0026quot; Text=\u0026quot;X Co-ordinate:\u0026quot; Text property of \u0026lt;TextBox\u0026gt;, we bind it with XPoint property in our PointViewModel class. Event method we define.\nIn above code we define a method for PreviewTextInput event. Name of method: InputTextBox_PreviewTextInput This InputTextBox_PreviewTextInput method will enforce the user to input only Numbers. So that we avoid errors. Implementation of InputTextBox_PreviewTextInput method will discuss later. Please see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. XAML\r1\u0026lt;UserControl 2 x:Class=\u0026#34;SolidworksTest.Views.PointView\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:local=\u0026#34;clr-namespace:SolidworksTest.Views\u0026#34; 7 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 8 xmlns:viewModel=\u0026#34;clr-namespace:SolidworksTest.ViewModels\u0026#34; 9 d:DataContext=\u0026#34;{d:DesignInstance Type=viewModel:PointViewModel}\u0026#34; 10 d:DesignHeight=\u0026#34;450\u0026#34; 11 d:DesignWidth=\u0026#34;800\u0026#34; 12 Background=\u0026#34;White\u0026#34; 13 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 14 \u0026lt;GroupBox 15 Margin=\u0026#34;10\u0026#34; 16 Padding=\u0026#34;10\u0026#34; 17 BorderBrush=\u0026#34;Black\u0026#34; 18 FontSize=\u0026#34;18\u0026#34; 19 Foreground=\u0026#34;Black\u0026#34; 20 Header=\u0026#34;{Binding Header}\u0026#34;\u0026gt; 21 \u0026lt;Grid\u0026gt; 22 \u0026lt;Grid.ColumnDefinitions\u0026gt; 23 \u0026lt;ColumnDefinition Width=\u0026#34;125\u0026#34; /\u0026gt; 24 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 25 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 26 \u0026lt;/Grid.ColumnDefinitions\u0026gt; 27 28 \u0026lt;Grid.RowDefinitions\u0026gt; 29 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 30 \u0026lt;RowDefinition Height=\u0026#34;15\u0026#34; /\u0026gt; 31 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 32 \u0026lt;/Grid.RowDefinitions\u0026gt; 33 34 \u0026lt;TextBlock 35 Grid.Row=\u0026#34;0\u0026#34; 36 Grid.Column=\u0026#34;0\u0026#34; 37 HorizontalAlignment=\u0026#34;Right\u0026#34; 38 VerticalAlignment=\u0026#34;Center\u0026#34; 39 Text=\u0026#34;X Co-ordinate:\u0026#34; /\u0026gt; 40 41 \u0026lt;TextBox 42 Grid.Row=\u0026#34;0\u0026#34; 43 Grid.Column=\u0026#34;2\u0026#34; 44 HorizontalAlignment=\u0026#34;Stretch\u0026#34; 45 VerticalAlignment=\u0026#34;Center\u0026#34; 46 PreviewTextInput=\u0026#34;InputTextBox_PreviewTextInput\u0026#34; 47 Text=\u0026#34;{Binding XPoint}\u0026#34; /\u0026gt; 48 49 \u0026lt;/Grid\u0026gt; 50 \u0026lt;/GroupBox\u0026gt; 51\u0026lt;/UserControl\u0026gt;\rAdd [YPoint] Label Now we add \u0026lt;TextBlock\u0026gt; tag inside \u0026lt;Grid\u0026gt; tag.\n\u0026lt;TextBlock\u0026gt; tag shows label for YPoint.\nBelow üëáüèª is code for \u0026lt;TextBlock\u0026gt; tag.\nXAML\r1\u0026lt;TextBlock 2 Grid.Row=\u0026#34;2\u0026#34; 3 Grid.Column=\u0026#34;0\u0026#34; 4 HorizontalAlignment=\u0026#34;Right\u0026#34; 5 VerticalAlignment=\u0026#34;Center\u0026#34; 6 Text=\u0026#34;Y Co-ordinate:\u0026#34; /\u0026gt;\rTo understand above code, please visit üöÄ Add [XPoint] Label section of this article.\nPlease see below üëáüèª image for reference. Please see below üëáüèª code sample for reference. XAML\r1\u0026lt;UserControl 2 x:Class=\u0026#34;SolidworksTest.Views.PointView\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:local=\u0026#34;clr-namespace:SolidworksTest.Views\u0026#34; 7 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 8 xmlns:viewModel=\u0026#34;clr-namespace:SolidworksTest.ViewModels\u0026#34; 9 d:DataContext=\u0026#34;{d:DesignInstance Type=viewModel:PointViewModel}\u0026#34; 10 d:DesignHeight=\u0026#34;450\u0026#34; 11 d:DesignWidth=\u0026#34;800\u0026#34; 12 Background=\u0026#34;White\u0026#34; 13 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 14 \u0026lt;GroupBox 15 Margin=\u0026#34;10\u0026#34; 16 Padding=\u0026#34;10\u0026#34; 17 BorderBrush=\u0026#34;Black\u0026#34; 18 FontSize=\u0026#34;18\u0026#34; 19 Foreground=\u0026#34;Black\u0026#34; 20 Header=\u0026#34;{Binding Header}\u0026#34;\u0026gt; 21 \u0026lt;Grid\u0026gt; 22 \u0026lt;Grid.ColumnDefinitions\u0026gt; 23 \u0026lt;ColumnDefinition Width=\u0026#34;125\u0026#34; /\u0026gt; 24 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 25 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 26 \u0026lt;/Grid.ColumnDefinitions\u0026gt; 27 28 \u0026lt;Grid.RowDefinitions\u0026gt; 29 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 30 \u0026lt;RowDefinition Height=\u0026#34;15\u0026#34; /\u0026gt; 31 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 32 \u0026lt;/Grid.RowDefinitions\u0026gt; 33 34 \u0026lt;TextBlock 35 Grid.Row=\u0026#34;0\u0026#34; 36 Grid.Column=\u0026#34;0\u0026#34; 37 HorizontalAlignment=\u0026#34;Right\u0026#34; 38 VerticalAlignment=\u0026#34;Center\u0026#34; 39 Text=\u0026#34;X Co-ordinate:\u0026#34; /\u0026gt; 40 41 \u0026lt;TextBox 42 Grid.Row=\u0026#34;0\u0026#34; 43 Grid.Column=\u0026#34;2\u0026#34; 44 HorizontalAlignment=\u0026#34;Stretch\u0026#34; 45 VerticalAlignment=\u0026#34;Center\u0026#34; 46 PreviewTextInput=\u0026#34;InputTextBox_PreviewTextInput\u0026#34; 47 Text=\u0026#34;{Binding XPoint}\u0026#34; /\u0026gt; 48 49 \u0026lt;TextBlock 50 Grid.Row=\u0026#34;2\u0026#34; 51 Grid.Column=\u0026#34;0\u0026#34; 52 HorizontalAlignment=\u0026#34;Right\u0026#34; 53 VerticalAlignment=\u0026#34;Center\u0026#34; 54 Text=\u0026#34;Y Co-ordinate:\u0026#34; /\u0026gt; 55 56 \u0026lt;/Grid\u0026gt; 57 \u0026lt;/GroupBox\u0026gt; 58\u0026lt;/UserControl\u0026gt;\rAdd [YPoint] TextBox Now we add another \u0026lt;TextBox\u0026gt; tag inside \u0026lt;Grid\u0026gt; tag.\n\u0026lt;TextBox\u0026gt; tag shows label for YPoint.\nBelow üëáüèª is code for \u0026lt;TextBox\u0026gt; tag.\nXAML\r1\u0026lt;TextBox 2 Grid.Row=\u0026#34;2\u0026#34; 3 Grid.Column=\u0026#34;2\u0026#34; 4 HorizontalAlignment=\u0026#34;Stretch\u0026#34; 5 VerticalAlignment=\u0026#34;Center\u0026#34; 6 PreviewTextInput=\u0026#34;InputTextBox_PreviewTextInput\u0026#34; 7 Text=\u0026#34;{Binding YPoint}\u0026#34; /\u0026gt;\rTo understand above code, please visit üöÄ Add [XPoint] TextBox section of this article.\nPlease see below üëáüèª image for reference. Please see below üëáüèª code sample for reference. XAML\r1\u0026lt;UserControl 2 x:Class=\u0026#34;SolidworksTest.Views.PointView\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:local=\u0026#34;clr-namespace:SolidworksTest.Views\u0026#34; 7 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 8 xmlns:viewModel=\u0026#34;clr-namespace:SolidworksTest.ViewModels\u0026#34; 9 d:DataContext=\u0026#34;{d:DesignInstance Type=viewModel:PointViewModel}\u0026#34; 10 d:DesignHeight=\u0026#34;450\u0026#34; 11 d:DesignWidth=\u0026#34;800\u0026#34; 12 Background=\u0026#34;White\u0026#34; 13 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt; 14 \u0026lt;GroupBox 15 Margin=\u0026#34;10\u0026#34; 16 Padding=\u0026#34;10\u0026#34; 17 BorderBrush=\u0026#34;Black\u0026#34; 18 FontSize=\u0026#34;18\u0026#34; 19 Foreground=\u0026#34;Black\u0026#34; 20 Header=\u0026#34;{Binding Header}\u0026#34;\u0026gt; 21 \u0026lt;Grid\u0026gt; 22 \u0026lt;Grid.ColumnDefinitions\u0026gt; 23 \u0026lt;ColumnDefinition Width=\u0026#34;125\u0026#34; /\u0026gt; 24 \u0026lt;ColumnDefinition Width=\u0026#34;25\u0026#34; /\u0026gt; 25 \u0026lt;ColumnDefinition Width=\u0026#34;*\u0026#34; /\u0026gt; 26 \u0026lt;/Grid.ColumnDefinitions\u0026gt; 27 28 \u0026lt;Grid.RowDefinitions\u0026gt; 29 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 30 \u0026lt;RowDefinition Height=\u0026#34;15\u0026#34; /\u0026gt; 31 \u0026lt;RowDefinition Height=\u0026#34;25\u0026#34; /\u0026gt; 32 \u0026lt;/Grid.RowDefinitions\u0026gt; 33 34 \u0026lt;TextBlock 35 Grid.Row=\u0026#34;0\u0026#34; 36 Grid.Column=\u0026#34;0\u0026#34; 37 HorizontalAlignment=\u0026#34;Right\u0026#34; 38 VerticalAlignment=\u0026#34;Center\u0026#34; 39 Text=\u0026#34;X Co-ordinate:\u0026#34; /\u0026gt; 40 41 \u0026lt;TextBox 42 Grid.Row=\u0026#34;0\u0026#34; 43 Grid.Column=\u0026#34;2\u0026#34; 44 HorizontalAlignment=\u0026#34;Stretch\u0026#34; 45 VerticalAlignment=\u0026#34;Center\u0026#34; 46 PreviewTextInput=\u0026#34;InputTextBox_PreviewTextInput\u0026#34; 47 Text=\u0026#34;{Binding XPoint}\u0026#34; /\u0026gt; 48 49 \u0026lt;TextBlock 50 Grid.Row=\u0026#34;2\u0026#34; 51 Grid.Column=\u0026#34;0\u0026#34; 52 HorizontalAlignment=\u0026#34;Right\u0026#34; 53 VerticalAlignment=\u0026#34;Center\u0026#34; 54 Text=\u0026#34;Y Co-ordinate:\u0026#34; /\u0026gt; 55 56 \u0026lt;TextBox 57 Grid.Row=\u0026#34;2\u0026#34; 58 Grid.Column=\u0026#34;2\u0026#34; 59 HorizontalAlignment=\u0026#34;Stretch\u0026#34; 60 VerticalAlignment=\u0026#34;Center\u0026#34; 61 PreviewTextInput=\u0026#34;InputTextBox_PreviewTextInput\u0026#34; 62 Text=\u0026#34;{Binding YPoint}\u0026#34; /\u0026gt; 63 64 \u0026lt;/Grid\u0026gt; 65 \u0026lt;/GroupBox\u0026gt; 66\u0026lt;/UserControl\u0026gt;\rAdd [InputTextBox_PreviewTextInput] Method Now we need to add InputTextBox_PreviewTextInput method.\nThis method will allow only Numbers to add into \u0026lt;TextBox\u0026gt;.\nFor adding this method, first open [PointView.cs] file.\nAdd below code into [PointView.cs] file.\nPlease see below üëáüèª image for reference. Please see below üëáüèª code sample for reference. C#\r1private void InputTextBox_PreviewTextInput(object sender, TextCompositionEventArgs e) 2{ 3 Regex _regex = new Regex(\u0026#34;[^0-9.-]+\u0026#34;); 4 e.Handled = _regex.IsMatch(e.Text); 5}\rIn above code we create a Regex type variable.\nName of variable: _regex.\nSequence we want to match: [^0-9.-]+\ne.Handled allow to enter the value.\n_regex.IsMatch(e.Text) means, if input text match the sequence then only it will allow otherwise it won\u0026rsquo;t.\nIf sequence match in _regex.IsMatch(e.Text) , then return true, otherwise return false.\nRegister [PointViewModel] Now we need to register our [PointViewModel] class into our DI container.\nOpen [App.xaml.cs] class.\nIn this class there is a function [RegisterTypes].\nWe will register our class in this function.\nPlease see below üëáüèª image for reference. Please see below üëáüèª code sample for reference. C#\r1protected override void RegisterTypes(IContainerRegistry containerRegistry) 2{ 3 containerRegistry.Register\u0026lt;PointViewModel\u0026gt;(); 4}\rIn above code, we register [PointViewModel] class in containerRegistry through Register() method. This is it for now!!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Create Line UI in WPF application.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":64,"permalink":"/wpf-tutorials/create-line-ui-part-1/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eI want to\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cem\u003eCreate a UI for \u0026ldquo;\u003cstrong\u003eCreate Line UI\u003c/strong\u003e\u0026rdquo; article.\u003c/em\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eSince I want to make the UI in \u003cstrong\u003emodular way\u003c/strong\u003e, hence I will create the UI in parts.\u003c/p\u003e","tags":[],"title":"Create Line UI - Part 1"},{"content":"In this post, I tell you about how to create a Parallelogram through Solidworks VBA Macros in a sketch.\nThe process is almost identical with previous Solidworks Macros - Create 3-Point Corner Rectangle post.\nIn this post, I tell you about CreateParallelogram method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a Parallelogram.\nVideo of Code on YouTube Please see below video on how to create Parallelogram from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating a Parallelogram.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Creating a \u0026#34;Variant\u0026#34; Variable which holds the values return by \u0026#34;CreateParallelogram\u0026#34; method Dim vSketchLines As Variant \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating a Parallelogram vSketchLines = swSketchManager.CreateParallelogram (0, 0, 0, 1, 0, 0, 0, 1, 0) \u0026#39; De-select the line after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable which we define earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue(). This method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating a \u0026#34;Variant\u0026#34; Variable which holds the values return by \u0026#34;CreateParallelogram\u0026#34; method Dim vSketchLines As Variant \u0026#39; Creating a Parallelogram vSketchLines = swSketchManager.CreateParallelogram(0, 0, 0, 1, 0, 0, 0, 1, 0)\rIn above sample code, we 1st create a variable named vSketchLines of type Variant.\nA Variant type variable can hold any type of value depends upon the use of variable.\nIn 2nd line, we set the value of variable vSketchLines.\nValue of vSketchLinesis an array of lines. This array is send as return value when we use CreateParallelogram method.\nThis CreateParallelogram method is part of swSketchManager and it is the latest method to create a Parallelogram.\nThis CreateParallelogram method takes following parameters as explained:\nX1 : X coordinate of point 1\nY1 : Y coordinate of point 1\nZ1 : Z coordinate of point 1\nX2 : X coordinate of point 2\nY2 : Y coordinate of point 2\nZ2 : Z coordinate of point 2\nX3 : X coordinate of point 3\nY3 : Y coordinate of point 3\nZ3 : Z coordinate of point 3\nBelow image shows more clearly about these parameters.\nIn the above code sample for 1st point I have used (0, 0, 0) point at origin.\nFor point 2, I used (1, 0, 0) which is 1 point distance in X-direction.\nFor point 3, I used (0, 1, 0) which is 1 point distance in Y-direction.\nThis CreateParallelogram method returns an array of sketch segments that represent the edges created for this Parallelogram.\nA Sketch Segment can represent a sketch arc, line, ellipse, parabola or spline.\nSketch Segment has ISketchSegment Interface, which provides functions that are generic to every type of sketch segment.\nFor example, every sketch segment has an ID and can be programmatically selected.\nTherefore, the ISketchSegment interface provides functions to obtain the ID and to select the item.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means inches for distance. But when I used Solidworks API through VBA macros or C#, I need to use converted numeric values.\nBecause Solidworks API output the distance in Meter which is not my requirement.\n\u0026#39; De-select the lines after creation swDoc.ClearSelection2 True\rIn the this line of code, we deselect the 3 Point Corner Rectangle we have created.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nHope this post helps you to create a Parallelogram in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":65,"permalink":"/solidworks-macros/create-parallelogram/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create a Parallelogram through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e\n\u003cp\u003eThe process is almost identical with previous \u003cstrong\u003e\u003ca href=\"/solidworks-macros/create-3point-corner-rectangle\"\u003eSolidworks Macros - Create 3-Point Corner Rectangle\u003c/a\u003e\u003c/strong\u003e post.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create A Parallelogram"},{"content":"An assignment statement is a VBA statement that assigns the result of an expression to a variable or an object.\nNote\nIn a book I read Excel‚Äôs Help system defines the term expression as:\n\u0026ldquo;Combination of keywords, operators, variables, and constants that yields a string, number, or object. An expression can be used to perform a calculation, manipulate characters, or test data.\u0026rdquo;\nMuch of your work in VBA involves developing (and debugging) expressions.\nIf you know how to create simple formulas in Excel, you‚Äôll have no trouble creating expressions.\nWith a formula, Excel displays the result in a cell.\nA VBA expression, on the other hand, can be assigned to a variable.\nNote\nFor understanding purpose, I used Excel as an example. Please don\u0026rsquo;t get confused with it.\nIn the assignment statement examples that follow, the expressions are to the right of the equal sign:\nvba\r1X = 1 2X = x + 1 3X = (y * 2) / (z * 2) 4NumberOfParts = 15 5SelectObject = True\rExpressions can be as complex as you need them to be; use the line continuation character (a space followed by an underscore) to make lengthy expressions easier to read.\nOperators As you can see in the VBA uses the equal sign as its assignment operator.\nYou‚Äôre probably accustomed to using an equal sign as a mathematical symbol for equality.\nTherefore, an assignment statement like the following may cause you to raise your eyebrows:\nvba\r1x = x + 1\rHow can the variable x be equal to itself plus 1?\nAnswer: It can‚Äôt.\nIn this case, the assignment statement is increasing the value of x by 1.\nJust remember that an assignment uses the equal sign as an operator, not a symbol of equality.\n{% include adsense/adsense-horizontal-ads.html %}\nSmooth Operators Operators play a major role in VBA. Besides the assignment operator i.e. equal sign (discussed in the previous topic), VBA provides several other operators.\nBelow table lists these operators.\nFunction Operator Symbol Addition + Multiplication * Division / Subtraction - Exponentiation ^ String concatenation \u0026amp; Integer division (the result is always an integer) \\ Modulo arithmetic (returns the remainder of a division operation) Mod The term concatenation is programmer speak for ‚Äújoin together‚Äù.\nThus, if you concatenate strings, you are combining strings to make a new and improved string.\nVBA also provides a full set of logical operators. Below table, shows some of logical operators.\nOperator What it does Not Performs a logical negation on an expression. And Performs a logical conjunction on two expressions. Or Performs a logical disjunction on two expressions. XoR Performs a logical exclusion on two expressions. Eqv Performs a logical equivalence on two expressions. Imp Performs a logical implication on two expressions. The precedence order for operators in VBA is exactly the same as in Excel formulas.\nExponentiation has the highest precedence. multiplication and division come next, followed by addition and subtraction.\nYou can use parentheses to change the natural precedence order, making whatever‚Äôs operation in parentheses come before any operator.\nTake a look at this code:\nvba\r1z = x + 5 * y\rWhen this code is executed, what‚Äôs the value of z?\nIf you answered 13, you get a gold star that proves you understand the concept of operator precedence.\nIf you answered 16, read this: The multiplication operation (5 * y) is performed first, and that result is added to x.\nIf you answered something other than 13 or 16, I have no comment.\nBy the way, I can never remember how operator precedence works, so I tend to use parentheses even when they aren‚Äôt required.\nFor example, in real life I would write that last assignment statement like this:\nvba\r1z = x + (5 * y)\rNote\nDon‚Äôt be shy about using parentheses even if they aren‚Äôt required ‚Äî especially if doing so makes your code easier to understand. VBA doesn‚Äôt care if you use extra parentheses.\nNext post will be about VBA Arrays.\n","date":"0001-01-01","id":66,"permalink":"/vba/assignment-statements-and-operators/","summary":"\u003cp\u003eAn \u003cem\u003eassignment statement\u003c/em\u003e is a \u003cem\u003eVBA statement\u003c/em\u003e that assigns the result of an expression to a variable or an object.\u003c/p\u003e","tags":[],"title":"VBA Assignment Statements And Operators"},{"content":"","date":"2023-09-07","id":67,"permalink":"/solidworks-macros/14-sketch---dimensions/","summary":"","tags":[],"title":"Sketch - Dimensions"},{"content":"Objective In this article we continued from üöÄ Create Line UI - Part 1 article.\nWe will create remaining UI controls and bindings with viewmodels.\nDemo Video Below üé¨ video shows how to Create Line UI Part 2 in Visual Studio 2022.\nUpdate [MainWindowViewModel] Now we need to ‚Äúadd Properties and Methods‚Äù for ‚ÄúBinding‚Äù with our view.\nView: MainWindow ViewModel: MainWindowViewModel Add [Properties] Now we need to add 2 properties for Start Point and End Point.\nPlease see below üëáüèª image for reference. Please see below üëáüèª code sample for reference. C#\r1private PointViewModel _startPointViewModel; 2public PointViewModel StartPointViewModel 3{ 4 get { return _startPointViewModel; } 5 set { SetProperty(ref _startPointViewModel, value); } 6} 7 8private PointViewModel _endpointViewModel; 9public PointViewModel EndPointViewModel 10{ 11 get { return _endpointViewModel; } 12 set { SetProperty(ref _endpointViewModel, value); } 13}\rUpdate Constructor Now we need to update Constructor, so that we can resolve [StartPointViewModel] and [EndPointViewModel] properties through DI Container.\nFirst, we need to add a parameter to constructor and then assign it to a private field.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. C#\r1private readonly IEventAggregator eventAggregator; 2private readonly IContainerProvider container; 3 4public MainWindowViewModel(IEventAggregator eventAggregator, IContainerProvider container) 5{ 6 this.eventAggregator = eventAggregator; 7 this.container = container; 8}\rNow, we need to set resolve value of [StartPointViewModel] and [EndPointViewModel] properties through DI Container.\nWe resolve values in \u0026ldquo;Constructor\u0026rdquo;.\nPlease see below üëáüèª image for reference.\nPlease see below üëáüèª code sample for reference. C#\r1public MainWindowViewModel(IEventAggregator eventAggregator, IContainerProvider container) 2{ 3 this.eventAggregator = eventAggregator; 4 this.container = container; 5 6 StartPointViewModel = this.container.Resolve\u0026lt;PointViewModel\u0026gt;(); 7 EndPointViewModel = this.container.Resolve\u0026lt;PointViewModel\u0026gt;(); 8}\rAdd [Prism Command] We need 1 Prism Command for Create Line Sketch Button.\nThis command will be responsible for Create Line Sketch in Solidworks Part Document.\nPlease see below üëáüèª code sample for adding ‚ÄúPrism Command‚Äù in MainWindowViewModel.\nC#\r1private DelegateCommand _createCommand; 2 3public DelegateCommand CreateLineCommand =\u0026gt; 4 _createCommand ?? (_createCommand = new DelegateCommand(ExecuteCreateLineCommand)); 5 6void ExecuteCreateLineCommand() 7{ 8 9}\rPlease see below üëáüèª image for adding ‚ÄúPrism Command‚Äù in MainWindowViewModel. Add Code To Function Now we will add some code ExecuteCreateLineCommand function.\nWe already used this code for in various articles.\nPlease see below üëáüèª code sample for waiting code to add.\nC#\r1private DelegateCommand _createCommand; 2 3public DelegateCommand CreateLineCommand =\u0026gt; 4 _createCommand ?? (_createCommand = new DelegateCommand(ExecuteCreateLineCommand)); 5 6async void ExecuteCreateLineCommand() 7{ 8 // Show busy indicator 9 IsBusy = true; 10 11 await Task.Run(() =\u0026gt; 12 { 13 // Sleeping with 5 sec 14 Thread.Sleep(5000); 15 }); 16 17 // Hide busy indicator 18 IsBusy = false; 19}\rPlease see below üëáüèª image for waiting code to add. Update View [MainWindow] Now we need to update a [MainWindow] window.\nAdd [ViewModel] Namespace Now we need to add [ViewModel] Namespace in \u0026lt;syncfusion:ChromelessWindow\u0026gt; tag.\nPlease see below üëáüèª image for reference. Please see below üëáüèª code sample for reference. XAML\r1\u0026lt;syncfusion:ChromelessWindow 2 x:Class=\u0026#34;SolidworksTest.Views.MainWindow\u0026#34; 3 xmlns=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0026#34; 4 xmlns:x=\u0026#34;http://schemas.microsoft.com/winfx/2006/xaml\u0026#34; 5 xmlns:d=\u0026#34;http://schemas.microsoft.com/expression/blend/2008\u0026#34; 6 xmlns:mc=\u0026#34;http://schemas.openxmlformats.org/markup-compatibility/2006\u0026#34; 7 xmlns:prism=\u0026#34;http://prismlibrary.com/\u0026#34; 8 xmlns:syncfusion=\u0026#34;http://schemas.syncfusion.com/wpf\u0026#34; 9 xmlns:view=\u0026#34;clr-namespace:SolidworksTest.Views\u0026#34; 10 xmlns:viewmodel=\u0026#34;clr-namespace:SolidworksTest.ViewModels\u0026#34; 11 Title=\u0026#34;{Binding Title}\u0026#34; 12 Width=\u0026#34;525\u0026#34; 13 Height=\u0026#34;450\u0026#34; 14 d:DataContext=\u0026#34;{d:DesignInstance viewmodel:MainWindowViewModel}\u0026#34; 15 prism:ViewModelLocator.AutoWireViewModel=\u0026#34;True\u0026#34; 16 Background=\u0026#34;White\u0026#34; 17 WindowStartupLocation=\u0026#34;CenterScreen\u0026#34; 18 mc:Ignorable=\u0026#34;d\u0026#34;\u0026gt;\rAdd [Start Point] View Now we need to add [Start Point View].\nAdd \u0026lt;StackPanel\u0026gt; tag.\nXAML\r1\u0026lt;StackPanel\u0026gt; 2 3\u0026lt;/StackPanel\u0026gt;\rInside this \u0026lt;StackPanel\u0026gt; tag, we add \u0026lt;view:PointView\u0026gt;\u0026lt;/view:PointView\u0026gt; tag.\nPlease see below üëáüèª image for reference. Please see below üëáüèª code sample for reference. XAML\r1\u0026lt;view:PointView 2 HorizontalAlignment=\u0026#34;Stretch\u0026#34; 3 VerticalAlignment=\u0026#34;Stretch\u0026#34; 4 HorizontalContentAlignment=\u0026#34;Stretch\u0026#34; 5 VerticalContentAlignment=\u0026#34;Stretch\u0026#34; 6 DataContext=\u0026#34;{Binding StartPointViewModel}\u0026#34; /\u0026gt;\rAbove view bind [DataContext] property of [view:PointView] with StartPointViewModel property of [MainWindowViewModel]. Add [End Point] View Now we need to add [End Point View]. Inside \u0026lt;StackPanel\u0026gt; tag, we add \u0026lt;view:PointView\u0026gt;\u0026lt;/view:PointView\u0026gt; tag.\nPlease see below üëáüèª image for reference. Please see below üëáüèª code sample for reference. XAML\r1\u0026lt;view:PointView 2 HorizontalAlignment=\u0026#34;Stretch\u0026#34; 3 VerticalAlignment=\u0026#34;Stretch\u0026#34; 4 HorizontalContentAlignment=\u0026#34;Stretch\u0026#34; 5 VerticalContentAlignment=\u0026#34;Stretch\u0026#34; 6 DataContext=\u0026#34;{Binding EndPointViewModel}\u0026#34; /\u0026gt;\rAbove view bind [DataContext] property of [view:PointView] with EndPointViewModel property of [MainWindowViewModel]. Add [Create Line] Button Now we need to add [Create Line] Button. Inside \u0026lt;StackPanel\u0026gt; tag, we add \u0026lt;syncfusion:ButtonAdv\u0026gt;\u0026lt;/syncfusion:ButtonAdv\u0026gt; tag.\nPlease see below üëáüèª image for reference. Please see below üëáüèª code sample for reference. XAML\r1\u0026lt;syncfusion:ButtonAdv 2 Width=\u0026#34;250\u0026#34; 3 Height=\u0026#34;50\u0026#34; 4 Command=\u0026#34;{Binding CreateLineCommand}\u0026#34; 5 IconHeight=\u0026#34;0\u0026#34; 6 IconWidth=\u0026#34;0\u0026#34; 7 Label=\u0026#34;Click Me\u0026#34; /\u0026gt;\rAbove view bind [Command] property of [syncfusion:ButtonAdv] with CreateLineCommand property of [MainWindowViewModel]. Final Result Now we run the application as shown in below üëáüèª image.\nNow we are able to Creale Line in Solidworks Sketch in MVVM pattern successfully.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Creale Line in Solidworks Sketch in WPF application.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":68,"permalink":"/wpf-tutorials/create-line-ui-part-2/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we continued from üöÄ \u003cstrong\u003e\u003ca href=\"/wpf-tutorials/create-line-ui-part-1/\" target=\"_blank\"\u003eCreate Line UI - Part 1\u003c/a\u003e\u003c/strong\u003e article.\u003c/p\u003e\n\u003cp\u003eWe will create remaining UI controls and bindings with viewmodels.\u003c/p\u003e","tags":[],"title":"Create Line UI - Part 2"},{"content":"In this post, I tell you about how to create Circle through Solidworks VBA Macros in a sketch.\nThe process is almost identical with previous Solidworks Sketch Macros - Create Line post.\nIn this post, I tell you about CreateCircle method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new Circle.\nVideo of Code on YouTube Please see below video on how to create Circle from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating a Circle.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Creating Variable for Solidworks Sketch segment Dim mySketchSegment As SketchSegment \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating a circle Set mySketchSegment = swSketchManager.CreateCircle(0, 0, 0, 1, 0, 0) \u0026#39; De-select the line after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable which we define earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue(). This method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating Variable for Solidworks Sketch segment Dim mySketchSegment As SketchSegment \u0026#39; Creating a Circle Set mySketchSegment = swSketchManager.CreateCircle(0, 0, 0, 1, 0, 0)\rIn above sample code, we 1st create a variable named mySketchSegment of type SketchSegment.\nA SketchSegment represent a line, ellipse, parabola or spline.\nA SketchSegment provides functions that are generic to every type of sketch segment.\nFor example, every sketch segment has an ID and can be selected programmatically.\nTherefore, the SketchSegment interface provides functions to obtain the ID and to select the item.\nFor detailed information about the SketchSegment please visit this page of Solidworks API Help\nIn 2nd line, we set the value of sketch segment variable mySketchSegment.\nWe get this value from CreateCircle method which is inside the swSketchManager variable.\nswSketchManager variable is a type of SketchManager, hence we used CreateCircle method from SketchManager.\nThis CreateCircle method takes following parameters as explained:\nXC : X coordinate of the circle center point\nYC : Y coordinate of the circle center point\nZC : Z coordinate of the circle center point\nXP : X coordinate of the point on the circle perimeter\nYP : Y coordinate of the point on the circle perimeter\nZP : Z coordinate of the point on the circle perimeter\nIn the above code sample I have used origin point (0, 0, 0) for circle center point.\nThis is origin of sketch hence I use center point at origin.\nFor End point I used (0, 2, 0) which is 2 point distance in Y-direction or vertical direction.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means \u0026ldquo;inches\u0026rdquo; for distance.\nBut when I used Solidworks API through VBA macros or C#, I have to use converted numeric values.\nBecause Solidworks API output the distance in Meter only; which is not my requirement.\n\u0026#39; De-select the line after creation swDoc.ClearSelection2 True\rIn the this line of code, we de-select the created line.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document variable swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nHope this post helps you to create Circle in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":69,"permalink":"/solidworks-macros/create-circle/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create Circle through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e\n\u003cp\u003eThe process is almost identical with previous \u003cstrong\u003e\u003ca href=\"/solidworks-macros/sketch-create-line\"\u003eSolidworks Sketch Macros - Create Line\u003c/a\u003e\u003c/strong\u003e post.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create Circle"},{"content":"Most programming languages support arrays. An array is a group of variables that share a common name.\nYou refer to a specific variable in the array by using the array name and an index number in parentheses.\nFor example, you can define an array of 12 string variables to hold the names of the months of the year.\nIf you name the array MonthNames, you can refer to the first element of the array as MonthNames(1), the second element as MonthNames(2), and so on.\nvba\r1Dim MonthNames(\u0026#34;Jan\u0026#34;, \u0026#34;Feb\u0026#34;, \u0026#34;Mar\u0026#34;, \u0026#34;April\u0026#34;, \u0026#34;May\u0026#34;, \u0026#34;Jun\u0026#34;, \u0026#34;July\u0026#34;, \u0026#34;Aug\u0026#34;, \u0026#34;Sep\u0026#34;, \u0026#34;Oct\u0026#34;, \u0026#34;Nov\u0026#34;, \u0026#34;Dec\u0026#34;) As string 2print(MonthNames(1)) \u0026#39;print Feb\rDeclaring Arrays Before you can use an array, you must declare it. No exceptions.\nUnlike normal variables, VBA is very strict about this rule.\nYou declare an array with a Dim or Public statement, just as you declare a regular variable.\nHowever, you also need to specify the number of elements in the array.\nYou do this by specifying the first index number, the keyword To, and the last index number ‚Äî all inside parentheses.\nThe following example shows how to declare an array of 100 integers:\nvba\r1Dim MyArray(1 To 100) As Integer\rWhen you declare an array, you can choose to specify only the upper index.\nVBA assumes that 0 is the lower index. Therefore, both of the following statements declare the same 101-element array:\nvba\r1Dim MyArray(0 To 100) As Integer 2Dim MyArray(100)\rNote\nIf you want VBA to assume that 1 (rather than 0) is the lower index for your arrays, include the following statement in the Declarations section of your module:\nvba\r1Option Base 1\rThis statement forces VBA to use 1 as the first index number for arrays that declare only the upper index.\nIf above statement is present, the following statements are identical, both declaring a 100-element array:\nvba\r1Dim MyArray(1 To 100) As Integer 2Dim MyArray(100)\rThere are two other arrays\nMulti-dimensional array\nDynamic array\nBut I don‚Äôt think these two are that much useful for us to learn hence we will not delve into them.\nNext post will be about VBA Functions.\n","date":"0001-01-01","id":70,"permalink":"/vba/arrays/","summary":"\u003cp\u003eMost programming languages support \u003ccode\u003earrays\u003c/code\u003e. An \u003cem\u003earray\u003c/em\u003e is a group of variables that share a common name.\u003c/p\u003e\n\u003cp\u003eYou refer to a \u003cem\u003especific variable\u003c/em\u003e in the \u003ccode\u003earray\u003c/code\u003e by using the \u003cem\u003earray name\u003c/em\u003e and an \u003cem\u003eindex number\u003c/em\u003e in \u003cem\u003eparentheses\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"VBA Arrays"},{"content":"","date":"2023-09-07","id":71,"permalink":"/solidworks-macros/15-features---extrudes/","summary":"","tags":[],"title":"Features - Extrudes"},{"content":"In this post, I tell you about how to create Circle By Radius through Solidworks VBA Macros in a sketch.\nThe process is identical with previous Solidworks Sketch Macros - Create Circle post.\nIn this post, I tell you about CreateCircleByRadius method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new Circle by Radius.\nVideo of Code on YouTube Please see below video on how to create Circle by Radius from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating a Circle by Radius.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Creating Variable for Solidworks Sketch segment Dim mySketchSegment As SketchSegment \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating a circle Set mySketchSegment = swSketchManager.CreateCircleByRadius(0, 0, 0, 1) \u0026#39; De-select the line after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable which we define earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue(). This method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating Variable for Solidworks Sketch segment Dim mySketchSegment As SketchSegment \u0026#39; Creating a Circle by Radius Set mySketchSegment = swSketchManager.CreateCircleByRadius(0, 0, 0, 1)\rIn above sample code, we 1st create a variable named mySketchSegment of type SketchSegment.\nA SketchSegment represent a line, ellipse, parabola or spline.\nA SketchSegment provides functions that are generic to every type of sketch segment.\nFor example, every sketch segment has an ID and can be selected programmatically.\nTherefore, the SketchSegment interface provides functions to obtain the ID and to select the item.\nFor detailed information about the SketchSegment please visit this page of Solidworks API Help\nIn 2nd line, we set the value of sketch segment variable mySketchSegment.\nWe get this value from CreateCircleByRadius method which is inside the swSketchManager variable.\nswSketchManager variable is a type of SketchManager, hence we used CreateCircleByRadius method from SketchManager.\nThis CreateCircleByRadius method takes following parameters as explained:\nXC : X coordinate of the circle center point\nYC : Y coordinate of the circle center point\nZC : Z coordinate of the circle center point\nRadius : Radius of the circle\nIn the above code sample I have used origin point (0, 0, 0) for circle center point.\nThis is origin of sketch hence I use center point at origin.\nFor Radius of Center, I used 1 meter as value.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means \u0026ldquo;inches\u0026rdquo; for distance.\nBut when I used Solidworks API through VBA macros or C#, I have to use converted numeric values.\nBecause Solidworks API output the distance in Meter only; which is not my requirement.\n\u0026#39; De-select the line after creation swDoc.ClearSelection2 True\rIn the this line of code, we de-select the created line.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document variable swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nHope this post helps you to create Circle by radius in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":72,"permalink":"/solidworks-macros/create-circle-by-radius/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create Circle By Radius through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create Circle By Radius"},{"content":"A function essentially performs a calculation and returns a single value.\nThe SUM function in MS Excel returns the sum of a range of values.\nThe same holds true for functions used in your VBA expressions: Each function does its thing and returns a single value.\nThe functions you use in VBA can come from two sources:\nBuilt-in functions provided by VBA Custom functions that you (or someone else) write, using VBA. Built-In VBA Functions VBA provides numerous built-in functions. Some of these functions take arguments and some do not.\nI present a few examples of VBA functions in code.\nIn many of these examples, I use the MsgBox function to display a value in a message box.\nYes, MsgBox is a VBA function ‚Äî a rather unusual one, but a function nonetheless.\nThis useful function displays a message in a pop-up dialog box.\nDisplaying the system date or time The first example uses VBA‚Äôs Date function to display the current system date in a message box:\nvba\r1Sub ShowDate() 2 MsgBox Date 3End Sub\rNotice that the Date function doesn‚Äôt use an argument.\nA VBA function with no argument doesn‚Äôt require an empty set of parentheses.\nIn fact, if you type an empty set of parentheses, the VBE will promptly remove them.\nTo get the system time, use the Time function. And if you want it all, use the Now function to return both the date and the time.\nvba\r1Sub ShowDate() 2 MsgBox Now 3End Sub\rFinding a string length The following procedure uses the VBA\u0026rsquo;s Len function, which returns the length of a text string.\nThe Len function takes one argument: the string.\nWhen you execute this procedure, the message box displays 11 because the argument has 11 characters.\nvba\r1Sub StringLength() 2 Dim MyString As String 3 Dim StringLength As Integer 4 MyString = ‚ÄúHello World‚Äù 5 StringLength = Len(MyString) 6 MsgBox StringLength 7End Sub\rDisplaying the integer part of a number The following procedure uses the Fix function, which returns the integer portion of a value ‚Äî the value without any decimal digits:\nvba\r1Sub GetIntegerPart() 2 Dim MyValue As Double 3 Dim IntValue As Integer 4 MyValue = 123.456 5 IntValue = Fix(MyValue) 6 MsgBox IntValue 7End Sub\rIn this case, the message box displays 123.\nVBA has a similar function called Int Function.\nThe difference between Int and Fix is how each deals with negative numbers.\nIt‚Äôs a subtle difference, but sometimes it‚Äôs important.\nInt Function returns the first negative integer that‚Äôs less than or equal to the argument. Int(-123.456) returns -124.\nFix Function returns the first negative integer that‚Äôs greater than or equal to the argument. Fix(-123.456) returns -123.\nDetermining a file size The following Sub procedure displays the size, in bytes, of the executable file.\nIt finds this value by using the FileLen function.\nvba\r1Sub GetFileSize() 2 Dim TheFile As String 3 TheFile ‚ÄúC:\\ProgramFiles\\Program File\\SolidworksCorp\\SLDWORKS\\SLDWORKS.exe‚Äù 4 MsgBox FileLen(TheFile) 5End Sub\rNotice that this routine hard codes the filename (that is, it explicitly states the path).\nGenerally, this isn‚Äôt a good idea. The file might not be on the C drive, or the Program File folder may have a different location.\nThe following statement shows a better approach:\nvba\r1TheFile = Application.Path \u0026amp; ‚Äú\\SLDWORKS.EXE‚Äù Path is a property of the Application object.\nIt simply returns the name of the folder in which the application (that is, Solidworks) is installed (without a trailing backslash).\nIdentifying the type of a selected object The following procedure uses the TypeName function, which returns the type of the selection (as a string):\nvba\r1Sub ShowSelectionType() 2 Dim SelType As String 3 SelType = TypeName(Selection) 4 MsgBox SelType 5End Sub\rThis could be a Sketch, a Part, a Assembly or any other type of object that can be selected.\nThe TypeName function is very versatile. You can also use this function to determine the data type of a variable.\nNext post will be about VBA Functions that do more.\n","date":"0001-01-01","id":73,"permalink":"/vba/functions/","summary":"\u003cp\u003eA \u003ccode\u003efunction\u003c/code\u003e essentially performs a calculation and returns a single value.\u003c/p\u003e\n\u003cp\u003eThe \u003ccode\u003eSUM\u003c/code\u003e function in \u003cstrong\u003eMS Excel\u003c/strong\u003e returns the sum of a range of values.\u003c/p\u003e","tags":[],"title":"VBA Functions"},{"content":"","date":"2023-09-07","id":74,"permalink":"/solidworks-macros/16-features---cuts/","summary":"","tags":[],"title":"Features - Cuts"},{"content":"In this post, I tell you about how to create Perimeter Circle through Solidworks VBA Macros in a sketch.\nThe process is identical with previous Solidworks Sketch Macros - Create Circle post.\nIn this post, I tell you about PerimeterCircle method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new Perimeter Circle.\nVideo of Code on YouTube Please see below video on how to create a Perimeter Circle from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating a Perimeter Circle.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating object type Variable Dim myPerimeterCircle As Object \u0026#39; Creating a Perimeter circle Set myPerimeterCircle = swSketchManager.PerimeterCircle(0, 0, 1, 0, 0, 1) \u0026#39; De-select the circle after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable which we define earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue(). This method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating object type Variable Dim myPerimeterCircle As Object \u0026#39; Creating a Perimeter circle Set myPerimeterCircle = swSketchManager.PerimeterCircle(0, 0, 1, 0, 0, 1)\rIn above sample code, we 1st create a variable named myPerimeterCircle of type Object.\nAn object can hold any type of return value. In our example, it holds a 3 point Perimeter Arc as return value.\nIn 2nd line, we set the value of object variable myPerimeterCircle.\nWe get this value from PerimeterCircle method which is inside the swSketchManager variable.\nswSketchManager variable is a type of SketchManager, hence we used PerimeterCircle method from SketchManager.\nThis PerimeterCircle method takes following parameters as explained:\nX1 : X coordinate of the first point\nY1 : Y coordinate of the first point\nX2 : X coordinate of the second point\nY2 : Y coordinate of the second point\nX3 : X coordinate of the third point\nY3 : Y coordinate of the third point\nIn the above code sample I have used (0, 0) for first point which is at origin.\nFor 2nd point on the circle I used (1, 0) which is 1 point distance in X-direction.\nFor 3rd point on the circle I used (0, 1) which is 1 point distance in Y-direction.\nThis PerimeterCircle method returns 3 point Perimeter Arc object.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means \u0026ldquo;inches\u0026rdquo; for distance.\nBut when I used Solidworks API through VBA macros or C#, I have to use converted numeric values.\nBecause Solidworks API output the distance in Meter only; which is not my requirement.\n\u0026#39; De-select the circle after creation swDoc.ClearSelection2 True\rIn the this line of code, we de-select the created circle.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document variable swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nHope this post helps you to create Circle in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":75,"permalink":"/solidworks-macros/create-perimeter-circle/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create Perimeter Circle through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e\n\u003cp\u003eThe process is identical with previous \u003cstrong\u003e\u003ca href=\"/solidworks-macros/create-circle\"\u003eSolidworks Sketch Macros - Create Circle\u003c/a\u003e\u003c/strong\u003e post.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create Perimeter Circle"},{"content":"A few VBA functions go above and beyond the call of duty. Rather than simply return a value, these functions have some useful side effects.\nBelow table lists them.\nFunction What it does MsgBox Displays a handy dialog box containing a message and buttons. The function returns a code that identifies which button the user clicks. InputBox Displays a simple dialog box that asks the user for some input. The function returns whatever the user enters into the dialog box. Shell Executes another program. The function returns the task ID (a unique identifier) of the other program (or an error if the function can‚Äôt start it). GetObject/CreateObject Returns/Create a reference to an object provided by an ActiveX component. (If you don\u0026rsquo;t understand, don\u0026rsquo;t bother about it. Just remember we use this function for checking \u0026amp; creating objects in later topics) Discovering VBA functions How do we find out which function does VBA provides?\nThe best source is the Visual Basic Help system in build in your CAD Application.\nI compiled a partial list of functions, which I share with you in following Table.\nI omitted some of the more specialized or obscure functions.\nFor complete details on a particular function, type the function name into a VBA module, move the cursor anywhere in the text, and press F1.\nFunction What is does Abs Returns a number‚Äôs absolute value. Array Returns a variant containing an array. Asc Converts the first character of a string to its ASCII value. Atn Returns the arctangent of a number. Choose Returns a value from a list of items. Chr Converts an ANSI value to a string. Cos Returns a number‚Äôs cosine. CurDir Returns the current path. Date Returns the current system date. DateAdd Returns a date to which a specified time interval has been added ‚Äî for example, one month from a particular date. DatePart Returns an integer containing the specified part of a given date ‚Äî for example, a date‚Äôs day of the year. DateSerial Converts a date to a serial number. DateValue Converts a string to a date. Day Returns the day of the month from a date value. Dir Returns the name of a file or directory that matches a pattern. Erl Returns the line number that caused an error. Err Returns the error number of an error condition. Error Returns the error message that corresponds to an error number. Exp Returns the base of the natural logarithm (e) raised to a power. FileLen Returns the number of bytes in a file. Fix Returns a number‚Äôs integer portion. Format Displays an expression in a particular format. GetSetting Returns a value from the Windows registry. Hex Converts from decimal to hexadecimal. Hour Returns the hours portion of a time. InputBox Displays a box to prompt a user for input. InStr Returns the position of a string within another string. Int Returns the integer portion of a number. IPmt Returns the interest payment for an annuity or loan. IsArray Returns True if a variable is an array. IsDate Returns True if an expression is a date. IsEmpty Returns True if a variable has not been initialized. IsError Returns True if an expression is an error value. IsMissing Returns True if an optional argument was not passed to a procedure. IsNull Returns True if an expression contains no valid data. IsNumeric Returns True if an expression can be evaluated as a number. IsObject Returns True if an expression references an OLE Automation object. LBound Returns the smallest subscript for a dimension of an array. LCase Returns a string converted to lowercase. Left Returns a specified number of characters from the left of a string. Len Returns the number of characters in a string. Log Returns the natural logarithm of a number to base. LTrim Returns a copy of a string, with any leading spaces removed. Mid Returns a specified number of characters from a string. Minutes Returns the minutes portion of a time value. Month Returns the month from a date value. MsgBox Displays a message box and (optionally) returns a value. Now Returns the current system date and time. RGB Returns a numeric RGB value representing a color. Replace Replaces a substring in a string with another substring. Right Returns a specified number of characters from the right of a string. Rnd Returns a random number between 0 and 1. RTrim Returns a copy of a string, with any trailing spaces removed. Second Returns the seconds portion of a time value. Sgn Returns an integer that indicates a number‚Äôs sign. Shell Runs an executable program. Sin Returns a number‚Äôs sine. Space Returns a string with a specified number of spaces. Split Splits a string into parts, using a delimiting character. Sqr Returns a number‚Äôs square root. Str Returns a string representation of a number. StrComp Returns a value indicating the result of a string comparison. String Returns a repeating character or string. Tan Returns a number‚Äôs tangent. Time Returns the current system time. Timer Returns the number of seconds since midnight. TimeSerial Returns the time for a specified hour, minute, and second. TimeValue Converts a string to a time serial number. Trim Returns a string without leading or trailing spaces. TypeName Returns a string that describes a variable‚Äôs data type. UBound Returns the largest available subscript for an array‚Äôs dimension. UCase Converts a string to uppercase. Val Returns the numbers contained in a string. VarType Returns a value indicating a variable‚Äôs subtype. Weekday Returns a number representing a day of the week. Year Returns the year from a date value. ","date":"0001-01-01","id":76,"permalink":"/vba/functions-that-do-more/","summary":"\u003cp\u003eA few VBA \u003ccode\u003efunctions\u003c/code\u003e go above and beyond the call of duty. Rather than simply return a value, these functions have some useful side effects.\u003c/p\u003e","tags":[],"title":"VBA Functions that do more"},{"content":"","date":"2023-09-07","id":77,"permalink":"/solidworks-macros/17-features---holes-and-threads/","summary":"","tags":[],"title":"Features - Holes and Threads"},{"content":"Some VBA procedures start at the code‚Äôs beginning and progress line by line to the end, never deviating from this top-to-bottom program flow.\nMacros that you record always work like this.\nIn many cases, however, you need to control the flow of your code by skipping over some statements, executing some statements multiple times, and testing conditions to determine what the procedure does next.\nSome programming newbies can‚Äôt understand how a dumb computer can make intelligent decisions.\nThe secret is in several programming constructs that most programming languages support.\nFollowing table provides a quick summary of these constructs.\nConstruct How it works If-Then structure Does something if something else is true. Select Case Does any of several things, depending on something‚Äôs value. For-Next loop Executes a series of statements a specified number of times. Do-While loop Does something as long as something else remains true. Do-Until loop Does something until something else becomes true. Next post will be about If-Then-Else and Select Case structure.\n","date":"0001-01-01","id":78,"permalink":"/vba/controlling-program-flow-and-making-decisions/","summary":"\u003cp\u003eSome VBA \u003cem\u003eprocedures\u003c/em\u003e start at the code‚Äôs beginning and progress line by line to the end, never deviating from this top-to-bottom program flow.\u003c/p\u003e","tags":[],"title":"Controlling Program Flow and Making Decisions"},{"content":"In this post, I tell you about how to create a Centerpoint Arc through Solidworks VBA Macros in a sketch.\nThe process is almost identical with previous Solidworks Sketch Macros - Create Line post.\nIn this post, I tell you about CreateArc method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new Centerpoint Arc.\nVideo of Code on YouTube Please see below video on how to create a Centerpoint Arc from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating a Centerpoint Arc.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating variable name \u0026#34;myCenterpointArc\u0026#34; of \u0026#34;SketchArc\u0026#34; type Dim myCenterpointArc As SldWorks.SketchArc \u0026#39; Creating a new Centerpoint Arc Set myCenterpointArc = swSketchManager.CreateArc(0, 0, 0, 1, 0, 0, -1, 0, 0, 1) \u0026#39; De-select the Arc after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable which we define earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue(). This method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating variable name \u0026#34;myCenterpointArc\u0026#34; of \u0026#34;SketchArc\u0026#34; type Dim myCenterpointArc As SldWorks.SketchArc \u0026#39; Creating a new Centerpoint Arc Set myCenterpointArc = swSketchManager.CreateArc(0, 0, 0, 1, 0, 0, -1, 0, 0, 1)\rIn above sample code, we 1st create a variable named myCenterpointArc of type SketchArc.\nA SketchArc holds variours methods and properties to manage Arcs.\nTo see methods and properties related to SketchArc object, please this page of Solidworks API Help\nIn 2nd line, we set the value of sketch segment variable myCenterpointArc.\nWe get this value from CreateArc method which is inside the swSketchManager variable.\nswSketchManager variable is a type of SketchManager, hence we used CreateArc method from SketchManager.\nThis CreateArc method takes following parameters as explained:\nXc : X coordinate of the center point, of the arc\nYc : Y coordinate of the center point, of the arc\nZc : Z coordinate of the center point, of the arc\nX1 : X coordinate of the start point, of the arc\nY1 : Y coordinate of the start point, of the arc\nZ1 : Z coordinate of the start point, of the arc\nX2 : X coordinate of the end point, of the arc\nY2 : Y coordinate of the end point, of the arc\nZ2 : Z coordinate of the end point, of the arc\nDirection : Clockwise or Anti-clockwise (Counter Clockwise) direction\n+1 : Start point to end point in Anti-clockwise (Counter Clockwise) direction.\n-1 : Start point to end point in Clockwise direction.\nIn the above code sample I have used (0, 0, 0) which is at origin as center of Arc.\nFor start point of the Arc I used (1, 0, 0) which is 1 point distance in X-direction.\nFor End point of the Arc I used (-1, 0, 0) which is -1 point distance in X-direction.\nFor Direction, I give +1 value, which means Anti-Clockwise direction.\nBelow Image show above parameters in Details.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means \u0026ldquo;inches\u0026rdquo; for distance.\nBut when I used Solidworks API through VBA macros or C#, I have to use converted numeric values.\nBecause Solidworks API output the distance in Meter only; which is not my requirement.\n\u0026#39; De-select the Arc after creation swDoc.ClearSelection2 True\rIn the this line of code, we de-select the created Centerpoint Arc.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document variable swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nHope this post helps you to create Centerpoint Arc in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":79,"permalink":"/solidworks-macros/create-centerpoint-arc/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create a Centerpoint Arc through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create Centerpoint Arc"},{"content":"","date":"2023-09-07","id":80,"permalink":"/solidworks-macros/18-features---fillet--chamfer/","summary":"","tags":[],"title":"Features - Fillet \u0026 Chamfer"},{"content":"If-Then is VBA‚Äôs most important control structure. You‚Äôll probably use this command on a daily basis.\nAs in many other aspects of life, effective decision-making is the key to success in writing CAD or any other macros.\nThe If-Then structure has this basic syntax:\nvba\r1If condition Then statements [Else elsestatements]\rUse the If-Then structure when you want to execute one or more statements conditionally.\nThe optional Else clause, if included, lets you execute one or more statements if the condition you‚Äôre testing is not true.\nSound confusing? Don‚Äôt worry; a few examples make this crystal clear.\nIf-Then examples The following routine demonstrates the If-Then structure without the optional Else clause:\nvba\r1Sub GoodMorning() 2 If Time \u0026lt; 0.5 Then MsgBox ‚ÄúGood Morning.‚Äù 3End Sub\rThe GoodMorning procedure uses VBA‚Äôs Time function to get the system time.\nIf the current system time is less than .5 (in other words, before noon), the routine displays a friendly greeting.\nIf Time is greater than or equal to .5, the routine ends and nothing happens.\nTo display a different greeting if Time is greater than or equal to .5, add another If-Then statement after the first one:\nvba\r1Sub GoodMorning2() 2 If Time \u0026lt; 0.5 Then MsgBox ‚ÄúGood Morning.‚Äù 3 If Time \u0026gt;= 0.5 Then MsgBox ‚ÄúGood Afternoon.‚Äù 4End Sub\rNotice that I used \u0026gt;= (greater than or equal to) for the second If-Then statement.\nThis ensures that the entire day is covered. Had I used \u0026gt; (greater than), then no message would appear if this procedure were executed at precisely 12:00 noon.\nIf-Then-Else examples Another approach to the preceding problem uses the Else clause.\nHere‚Äôs the same routine recoded to use the If-Then-Else structure:\nvba\r1Sub GoodMorning3() 2 If Time \u0026lt; 0.5 Then MsgBox ‚ÄúGood Morning.‚Äù Else _ 3 MsgBox ‚ÄúGood Afternoon.‚Äù 4End Sub\rNotice that I use the line continuation character (underscore) in the preceding example.\nThe If-Then-Else statement is actually a single statement.\nVBA provides a slightly different way of coding If-Then-Else constructs that use an End-If statement.\nTherefore, the GoodMorning procedure can be rewritten as:\nvba\r1Sub GoodMorning4() 2 If Time \u0026lt; 0.5 Then 3 MsgBox ‚ÄúGood Morning.‚Äù 4 Else 5 MsgBox ‚ÄúGood Afternoon.‚Äù 6 End If 7End Sub\rIn fact, you can insert any number of statements under the If part, and any number of statements under the Else part.\nI prefer to use this syntax because it‚Äôs easier to read and makes the statements shorter.\nWhat if you need to expand the GoodMorning routine to handle three conditions: morning, afternoon, and evening?\nYou have two options: Use three If-Then statements or use a nested If-Then-Else structure.\nNesting means placing an If-Then-Else structure within another If-Then-Else structure.\nThe first approach, the three statements, is simplest:\nvba\r1Sub GoodMorning5() 2 If Time \u0026lt; 0.5 Then Msg = ‚ÄúMorning.‚Äù 3 If Time \u0026gt;= 0.5 And Time \u0026lt; 0.75 Then Msg = ‚ÄúAfternoon.‚Äù 4 If Time \u0026gt;= 0.75 Then Msg = ‚ÄúEvening.‚Äù 5 MsgBox ‚ÄúGood‚Äù \u0026amp; Msg 6End Sub\rThe Msg variable gets a different text value, depending on the time of day.\nThe final MsgBox statement displays the greeting: Good Morning, Good Afternoon, or Good Evening.\nThe following routine performs the same action but uses an If-Then-End If structure:\nvba\r1Sub GoodMorning6() 2 Dim Msg As String 3 If Time \u0026lt; 0.5 Then 4 Msg = ‚ÄúMorning.‚Äù 5 If Time \u0026gt;= 0.5 And Time \u0026lt; 0.75 Then 6 Msg = ‚ÄúAfternoon.‚Äù 7 If Time \u0026gt;= 0.75 Then 8 Msg = ‚ÄúEvening.‚Äù 9 End If 10 MsgBox ‚ÄúGood‚Äù \u0026amp; Msg 11End Sub\rIf-ElseIf-Else examples In the previous examples, every statement in the routine is executed ‚Äî even in the morning.\nA more efficient structure would exit the routine as soon as a condition is found to be true.\nIn the morning, for example, the procedure should display the Good Morning message and then exit ‚Äî without evaluating the other superfluous conditions.\nWith a tiny routine like this, you don‚Äôt have to worry about execution speed.\nBut for larger applications in which speed is important, you should know about another syntax for the If-Then structure.\nThe ElseIf syntax follows:\nvba\r1If condition Then 2[statements] 3[Else condition-n Then 4[elseifstatements]] 5[Else 6[elsestatements]]\rHere‚Äôs how you can rewrite the GreetMe routine by using this syntax:\nvba\r1Sub GoodMorning7() 2 Dim Msg As String 3 If Time \u0026lt; 0.5 Then 4 Msg = ‚ÄúMorning.‚Äù 5 ElseIf Time \u0026gt;= 0.5 And Time \u0026lt; 0.75 Then 6 Msg = ‚ÄúAfternoon.‚Äù 7 Else 8 Msg = ‚ÄúEvening.‚Äù 9 End If 10 MsgBox ‚ÄúGood‚Äù \u0026amp; Msg 11End Sub\rWhen a condition is true, VBA executes the conditional statements and the If structure ends.\nIn other words, VBA doesn‚Äôt waste time evaluating the extraneous conditions, which makes this procedure a bit more efficient than the previous examples.\nThe trade-off (there are always trade-offs) is that the code is more difficult to understand. (Of course, you already knew that.)\nSelect Case structure The Select Case structure is useful for decisions involving three or more options (although it also works with two options, but using If-Then-Else structure is more efficient for that).\nThe syntax for the Select Case structure follows:\nvba\r1Select Case testexpression 2[Case expressionlist-n 3 [statements-n]] 4[Case Else 5 [elsestatements]] 6End Select\rDon‚Äôt be scared off by this official syntax. Using the Select Case structure is quite easy.\nSelect Case example The following example shows how to use the Select Case structure.\nThis also shows another way to code the examples presented in the previous section:\nvba\r1Sub SelectPartLength() 2 Dim PartNumber As Integer 3 Dim PartLength As Integer 4 PartNumber = InputBox(‚ÄúPlease Enter part number:‚Äù) 5 Select Case PartNumber 6 Case Part001 7 PartLength = 1 8 Case Part002 9 PartLength = 2 10 Case Part003 11 PartLength = 3 12 End Select 13 MsgBox ‚ÄúPart Length for this‚Äù \u0026amp; PartNumber \u0026amp; ‚Äúis‚Äù \u0026amp; PartLength 14End Sub\rIn this example, the PartNumber variable is being evaluated.\nThe routine is checking for three different cases.\nNext post will be about VBA Looping.\n","date":"0001-01-01","id":81,"permalink":"/vba/if-then-structure-select-case/","summary":"\u003cp\u003e\u003ccode\u003eIf-Then\u003c/code\u003e is VBA‚Äôs most important control structure. You‚Äôll probably use this command on a daily basis.\u003c/p\u003e\n\u003cp\u003eAs in many other aspects of life, effective \u003cem\u003edecision-making\u003c/em\u003e is the key to success in writing CAD or any other macros.\u003c/p\u003e","tags":[],"title":"If-Then-Else and Select Case structure"},{"content":"In this post, I tell you about how to create a Tangent Arc through Solidworks VBA Macros in a sketch.\nThe process is almost identical with previous Solidworks Sketch Macros - Create Line post.\nIn this post, I tell you about CreateTangentArc method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new Tangent Arc.\nVideo of Code on YouTube Please see below video on how to create a Tangent Arc from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating a Tangent Arc.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating Variable for Solidworks Sketch segment Dim mySketchSegment As SketchSegment \u0026#39; Creating an horizontal line Set mySketchSegment = swSketchManager.CreateLine(0, 0, 0, 0, 1, 0) \u0026#39; Creating a Tangent Arc Set mySketchSegment = swSketchManager.CreateTangentArc(0, 1, 0, 2, 1, 0, swTangentArcTypes_e.swForward) \u0026#39; De-select the Arc after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named as main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable swApp which we defined earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, holds the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor more detailed information about above lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout this post if you don\u0026rsquo;t understand above code.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\nI have discussed about different Selection methods in details in Soldworks Macros - Selection Methods post, so do visit this post for more Selection methods.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating Variable for Solidworks Sketch segment Dim mySketchSegment As SketchSegment \u0026#39; Creating an horizontal line Set mySketchSegment = swSketchManager.CreateLine(0, 0, 0, 0, 1, 0) \u0026#39; Creating a Tangent Arc Set mySketchSegment = swSketchManager.CreateTangentArc(0, 1, 0, 2, 1, 0, swTangentArcTypes_e.swForward)\rIn above sample code, we 1st create a variable named mySketchSegment of type SketchSegment.\nA SketchSegment represent a line, ellipse, parabola or spline.\nA SketchSegment provides functions that are generic to every type of sketch segment.\nFor example, every sketch segment has an ID and can be selected programmatically.\nTherefore, the SketchSegment interface provides functions to obtain the ID and to select the item.\nFor detailed information about the SketchSegment please visit this page of Solidworks API Help\nIn 2nd line, we set the value of sketch segment variable mySketchSegment.\nWe get this value from CreateLine method which is inside the swSketchManager variable.\nswSketchManager variable is a type of SketchManager, hence we used CreateLine method from SketchManager.\nFor detailed information on Creating Sketch Line visit Solidworks Sketch Macros - Create Line\nIn 3rd line, we again set the value of sketch segment variable mySketchSegment.\nWe get this value from CreateTangentArc method which is inside the swSketchManager variable.\nswSketchManager variable is a type of SketchManager, hence we used CreateTangentArc method from SketchManager.\nThis CreateTangentArc method takes following parameters as explained:\nX1 : X coordinate of the start point, of the arc\nY1 : Y coordinate of the start point, of the arc\nZ1 : Z coordinate of the start point, of the arc\nX2 : X coordinate of the end point, of the arc\nY2 : Y coordinate of the end point, of the arc\nZ2 : Z coordinate of the end point, of the arc\nArc Type : Types of Tangent Arcs as defined in swTangentArcTypes_e enum list.\nBelow are the values inside swTangentArcTypes_e\nswBack = 3\nswForward = 1\nswLeft = 2\nswRight = 4\nIn the above code sample, first I create a Sketch line and then at one end of the line I create a Tangent arc.\nFor creating a Sketch line, I have used (0, 0, 0) which is at origin as starting point of the line.\nFor End point of the line, I used (0, 1, 0) which is 1 point distance in Y-direction.\nFor creating a Tangent arc, I used End point of line i.e. (0, 1, 0) as the Start point for Tangent Arc.\nFor End point of Tangent arc, I used (2, 1, 0) which is 2 point distance in X-direction and 1 point distance in Y-direction.\nBasically, I want to end the Tangent arc at the same height of the Sketch line.\nFor Arc type, I have used swForward as value.\nThis creates a forward clockwise Tangent arc.\nThis CreateTangentArc method returns sketch segments which represent the sides created for this Tangent arc.\nA Sketch Segment can represent a sketch arc, line, ellipse, parabola or spline.\nSketch Segment has ISketchSegment Interface, which provides functions that are generic to every type of sketch segment.\nFor example, every sketch segment has an ID and can be programmatically selected.\nTherefore, the ISketchSegment interface provides functions to obtain the ID and to select the item.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means \u0026ldquo;inches\u0026rdquo; for distance.\nBut when I used Solidworks API through VBA macros or C#, I have to use converted numeric values.\nBecause Solidworks API output the distance in Meter only; which is not my requirement.\n\u0026#39; De-select the Arc after creation swDoc.ClearSelection2 True\rIn the this line of code, we de-select the created Tangent Arc.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document variable swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nHope this post helps you to create Tangent Arc in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":82,"permalink":"/solidworks-macros/create-tangent-arc/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create a Tangent Arc through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create Tangent Arc"},{"content":"","date":"2023-09-07","id":83,"permalink":"/solidworks-macros/19-features---mirror--patterns/","summary":"","tags":[],"title":"Features - Mirror \u0026 Patterns"},{"content":"In this post, I tell you about how to create a 3-Point Arc through Solidworks VBA Macros in a sketch.\nThe process is almost identical with previous Sketch - Create Tangent Arc post.\nIn this post, I tell you about Create3PointArc method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new 3-Point Arc.\nVideo of Code on YouTube Please see below video on how to create a 3-Point Arc from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating a 3-Point Arc.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating Variable for Solidworks Sketch segment Dim mySketchSegment As SketchSegment \u0026#39; Creating a 3-Point Arc Set mySketchSegment = swSketchManager.Create3PointArc(-1, 0, 0, 1, 0, 0, 0, 1, 0) \u0026#39; De-select the Arc after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named as main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable swApp which we defined earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, holds the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor more detailed information about above lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout this post if you don\u0026rsquo;t understand above code.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\nI have discussed about different Selection methods in details in Soldworks Macros - Selection Methods post, so do visit this post for more Selection methods.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating Variable for Solidworks Sketch segment Dim mySketchSegment As SketchSegment \u0026#39; Creating a 3-Point Arc Set mySketchSegment = swSketchManager.Create3PointArc(-1, 0, 0, 1, 0, 0, 0, 1, 0)\rIn above sample code, we 1st create a variable named mySketchSegment of type SketchSegment.\nA SketchSegment represent a line, ellipse, parabola or spline.\nA SketchSegment provides functions that are generic to every type of sketch segment.\nFor example, every sketch segment has an ID and can be selected programmatically.\nTherefore, the SketchSegment interface provides functions to obtain the ID and to select the item.\nFor detailed information about the SketchSegment please visit this page of Solidworks API Help\nIn 2nd line, we set the value of sketch segment variable mySketchSegment.\nWe get this value from Create3PointArc method which is inside the swSketchManager variable.\nswSketchManager variable is a type of SketchManager, hence we used Create3PointArc method from SketchManager.\nThis Create3PointArc method takes following parameters as explained:\nX1 : X coordinate of the start point, of the arc\nY1 : Y coordinate of the start point, of the arc\nZ1 : Z coordinate of the start point, of the arc\nX2 : X coordinate of the end point, of the arc\nY2 : Y coordinate of the end point, of the arc\nZ2 : Z coordinate of the end point, of the arc\nX3 : X coordinate of the middle point, of the arc\nY3 : Y coordinate of the middle point, of the arc\nZ3 : Z coordinate of the middle point, of the arc\nFor creating a 3-Point arc, I used (-1, 0, 0) as the Start point for 3-Point Arc, which is -1 point distance in X-direction.\nFor End point of 3-Point arc, I used (1, 0, 0) which is 1 point distance in X-direction.\nFor Middle point of 3-Point arc, I used (0, 1, 0) which is 1 point distance in Y-direction.\nBelow Image show above parameters in Details.\nThis Create3PointArc method returns sketch segments which represent the sides created for this 3-Point arc.\nA Sketch Segment can represent a sketch arc, line, ellipse, parabola or spline.\nSketch Segment has ISketchSegment Interface, which provides functions that are generic to every type of sketch segment.\nFor example, every sketch segment has an ID and can be programmatically selected.\nTherefore, the ISketchSegment interface provides functions to obtain the ID and to select the item.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means \u0026ldquo;inches\u0026rdquo; for distance.\nBut when I used Solidworks API through VBA macros or C#, I have to use converted numeric values.\nBecause Solidworks API output the distance in Meter only; which is not my requirement.\n\u0026#39; De-select the Arc after creation swDoc.ClearSelection2 True\rIn the this line of code, we de-select the created 3-Point Arc.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document variable swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nHope this post helps you to create 3-Point Arc in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":84,"permalink":"/solidworks-macros/create-3point-arc/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create a 3-Point Arc through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create 3-Point Arc"},{"content":"The term looping refers to repeating a block of VBA statements numerous times.\nVBA provides various looping command for repeating code to make correct decision making.\nWe will go through them in following topics:\nFor -Next Loop The simplest type of loop is a For-Next loop. Here‚Äôs the syntax for this structure:\nvba\r1For counter = start To end [Step stepval] 2[statements] 3[Exit For] 4[statements] 5Next [counter]\rThe looping is controlled by a counter variable, which starts at one value and stops at another value.\nThe statements between the For statement and the Next statement are the statements that get repeated in the loop.\nTo see how this works, keep reading.\nFor-Next example The following example shows a For-Next loop that doesn‚Äôt use the optional Step value or the optional Exit For statement.\nThis routine loops 10 times and uses the VBA MsgBox function to show a number from 1 to 10:\nvba\r1Sub ShowNumbers1() 2 Dim i As Integer 3 For i = 1 to 10 4 MsgBox i 5 Next i 6End Sub\rIn this example, i (the loop counter variable) starts with a value of 1 and increases by 1 each time through the loop.\nBecause I didn‚Äôt specify a Step value the MsgBox method uses the value of i as an argument.\nThe first time through the loop, i is 1 and the procedure shows a number.\nThe second time through (i = 2), the procedure show a number, and so on.\nvba\r1Sub ShowNumbers2() 2 Dim i As Integer Step 2 3 For i = 1 to 10 4 MsgBox i 5 Next i 6End Sub\rCount starts out as 1 and then takes on a value of 3, 5, 7, and 9. The final Count value is 9.\nThe Step value determines how the counter is incremented. Notice that the upper loop value (9) is not used because the highest value of Count after 9 would be 11, and 11 is larger than 10.\nFor-Next example with an Exit For statement A For-Next loop can also include one or more Exit For statements within the loop.\nWhen VBA encounters this statement, the loop terminates immediately.\nHere‚Äôs the same procedure as in the preceding section, rewritten to insert random numbers.\nvba\r1Sub ShowNumbers3() 2 Dim i As Integer Step 2 3 For i = 1 to 10 4 If i = 5 Then 5 MsgBox ‚ÄúThis is a mid value‚Äù 6 Exit For 7 End If 8 MsgBox i 9 Next i 10End Sub\rThis routine performs the as earlier but when the variable i reached to 5, it shows a message, stating that this is a mid value and exit from loop.\nDo-While Loop VBA supports another type of looping structure known as a Do-While loop.\nUnlike a For-Next loop, a Do-While loop continues until a specified condition is met.\nHere‚Äôs the Do-While loop syntax:\nvba\r1\u0026#39; Do-While Structure 2Do [While condition] 3 [statements] 4 [Exit Do] 5 [statements] 6Loop\rThe following example uses a Do-While loop. This routine uses 1 as a starting point and runs through next numbers.\nThe loop continues until the routine encounter the condition of i = 8.\nvba\r1\u0026#39; Do-While Example 2Sub ShowNumbers4() 3 Dim i As Integer 4 Do While i \u0026lt;\u0026gt; 8 5 MsgBox i 6 i = i + 1 7 Loop 8End Sub\rSome people prefer to code a Do-While loop as a Do-Loop While loop.\nThis example performs exactly as the previous procedure but uses different loop syntax:\nvba\r1\u0026#39; Do-Loop While Example 2Sub ShowNumbers5() 3 Dim i As Integer 4 Do 5 MsgBox i 6 i = i + 1 7 Loop While i \u0026lt;\u0026gt; 8 8End Sub\rHere‚Äôs the key difference between the Do-while and Do-Loop While loops.\nThe Do-While loop always performs its conditional test first. If the test is not true, the instructions inside the loop are never executed.\nThe Do-Loop While loop, on the other hand, always performs its conditional test after the instructions inside the loop are executed.\nThus, the loop instructions are always executed at least once, regardless of the test.\nThis difference can sometimes have a big effect on how your program functions.\nDo-Until Loop The Do-Until loop structure is similar to the Do-While structure.\nThe two structures differ in their handling of the tested condition.\nA program continues to execute a Do-While loop while the condition remains true.\nIn a Do-Until loop, the program executes the loop until the condition is true. Here‚Äôs the Do-Until syntax:\nvba\r1\u0026#39; Do-Until Structure 2Do [Until condition] 3 [statements] 4 [Exit Do] 5 [statements] 6Loop\rThe following example is the same one presented for the Do-While loop but recoded to use a Do-Until loop:\nvba\r1Sub ShowNumbers6() 2 Dim i As Integer 3 Do Until i \u0026lt;\u0026gt; 8 4 MsgBox i 5 i = i + 1 6 Loop 7End Sub\rJust like with the Do-while loop, you may encounter a different form of the Do-Until loop ‚Äî a Do-Loop Until loop.\nThe following example, which has the same effect as the preceding procedure, demonstrates an alternate syntax for this type of loop:\nvba\r1Sub ShowNumbers7() 2\u0026#39; Do-Loop Until Example 3 Dim i As Integer 4 Do 5 MsgBox i 6 i = i + 1 7 Loop Until i \u0026lt;\u0026gt; 8 8End Sub\rThere is a subtle difference in how the Do-Until loop and the Do-Loop Until loop operate.\nIn the former, the test is performed at the beginning of the loop, before anything in the body of the loop is executed.\nThis means that it is possible that the code in the loop body will not be executed if the test condition is met.\nIn the later version, the condition is tested at the end of the loop.\nTherefore, at a minimum, the Do-Loop Until loop always results in the body of the loop being executed once.\nAnother way to think about it is like this: The Do-While loop keeps looping as long as the condition is true.\nThe Do-Until loop keeps looping as long as the condition is False.\nLooping through a Collection VBA supports yet another type of looping ‚Äî looping through each object in a collection of objects.\nPlease note that I have not covered Object topic so far. For your understanding I give a brief explanation about collection.\nA collection is a group of same type of objects.\nFor example, a drawing file in any CAD application is a collection of Sheets, and each sheet is a collection of drawing views and so on.\nWhen you need to loop through each object in a collection, use the For Each-Next structure. The syntax is\nvba\r1\u0026#39; For Each-Next Structure 2For Each element In collection 3 [statements] 4 [Exit For] 5 [statements] 6Next [element]\rThe following example loops through each drawing sheet in the active drawing and shows name of each active drawing sheet:\nvba\r1\u0026#39; For Each-Next Example 2Option Explicit 3Dim swApp As SldWorks.SldWorks 4Dim swPart As SldWorks.ModelDoc2 5Dim swDwg As SldWorks.DrawingDoc 6Dim BoolStatus As Boolean 7Dim SheetNamesList As Variant 8Sub ShowSheetName() 9 Set swApp = Application.SldWorks 10 Set swPart = swApp.ActiveDoc 11 Set swDwg = swPart 12 SheetNamesList = swDwg.GetSheetNames 13 Dim SheetName As Variant 14 For Each SheetName In SheetNamesList 15 MsgBox SheetName 16 Next SheetName 17End Sub\rIn this example, first we get the list of all sheet names in opened drawing, then we loop through each sheet name in collection and show sheet name in a message box.\nFor this example please notes that we did not need to load all sheet, this code can work on non-activate and non-loaded sheets also.\nNext post will be about Bug Finding.\n","date":"0001-01-01","id":85,"permalink":"/vba/looping/","summary":"\u003cp\u003eThe term \u003cem\u003elooping\u003c/em\u003e refers to repeating a block of VBA statements numerous times.\u003c/p\u003e\n\u003cp\u003eVBA provides various looping command for repeating code to make correct decision making.\u003c/p\u003e","tags":[],"title":"VBA Looping"},{"content":"","date":"2023-09-07","id":86,"permalink":"/solidworks-macros/20-features---transformation/","summary":"","tags":[],"title":"Features - Transformation"},{"content":"A bug is an error in your programming. Here I cover the topic of programming bugs ‚Äî how to identify them and how to remove them from your module.\nTypes of Bugs The term program bug, as you probably know, refers to a problem with software.\nIn other words, if software doesn‚Äôt perform as expected, it has a bug.\nFact is, all major software programs have bugs ‚Äî lots of bugs.\nA CAD software like Solidworks itself has hundreds (if not thousands) of bugs.\nFortunately, the vast majority of these bugs are relatively obscure and appear in only very specific circumstances.\nWhen you write non-trivial VBA programs, your code probably will have bugs.\nThis is a fact of life and not necessarily a reflection of your programming ability. The bugs may fall into any of the following categories:\nLogical flaws in your code: You can often avoid these bugs by carefully thinking through the problem your program addresses.\nIncorrect context bugs: This type of bug surfaces when you attempt to do something at the wrong time. For example, you may try to update the sketch dimension and there are no sketch is activated.\nExtreme-case bugs: These bugs rear their heads when you encounter data you didn‚Äôt anticipate, such as very large or very small numbers.\nWrong data types bugs: This type of bug occurs when you try to process data of the wrong type, such as attempting to take the square root of a text string.\nDebugging is the process of identifying and correcting bugs in your program.\nDeveloping debugging skills takes time, so don‚Äôt be discouraged if this process is difficult at first.\nIt‚Äôs important to understand the distinction between bugs and syntax errors.\nA syntax error is a language error. For example, you might misspell a keyword, omit the Next statement in a For-Next loop, or have a mismatched parenthesis.\nBefore you can even execute the procedure, you must correct these syntax errors.\nA program bug is much subtler. You can execute the routine, but it doesn‚Äôt perform as expected.\nIdentifying Bugs Before you can do any debugging, you must determine whether a bug actually exists.\nYou can tell that your macro contains a bug if it doesn‚Äôt work the way it should. Usually, but not always, you can easily discern this.\nA key fact known to all programmers is that bugs often appear when you least expect them.\nFor example, just because your macro works fine with one data set doesn‚Äôt mean you can assume it will work equally as well with all data sets.\nOr your macro runs fine in your system but not working properly in your friend\u0026rsquo;s system.\nSuch cases happened all the time and are part of debugging.\nThe best debugging approach is to start with thorough testing, under a variety of real-life conditions.\nBecause any changes made by your VBA code cannot be undone, it is always a good idea to use a backup copy of your CAD files that you use for testing.\nI usually copy some files into a temporary folder and use those files for my testing.\nDebugging Techniques In this section, I discuss the some of the most common methods for debugging VBA code:\nExamine your code Inserting MsgBox functions at various locations in your code Inserting Debug.Print statement Examine your code Perhaps the most straightforward debugging technique is simply taking a close look at your code to see whether you can find the problem.\nIf you‚Äôre lucky, the error jumps right out, and you can fix the problem.\nNotice I said, ‚ÄúIf you‚Äôre lucky.‚Äù That‚Äôs because often you discover errors when you have been working on your program for long hours and you are running on caffeine and willpower.\nAt times like that, you are lucky if you can even see your code.\nThus, don‚Äôt be surprised if simply examining your code isn‚Äôt enough to make you find and expunge all the bugs it contains.\nUsing the MsgBox function A common problem in many programs involves one or more variables not taking on the values you expect.\nIn such cases, monitoring the variable(s) while your code runs is a helpful debugging technique.\nOne way to do this is by inserting temporary MsgBox functions into your routine.\nFor example, I used MsgBox function to check conditions. Whenever I use If-Else statement, I put one message in If condition and put another message in Else condition.\nBy this way, I make sure condition which I want is working correct or not.\nFeel free to use MsgBox functions frequently when you debug your code.\nJust make sure that you remove them after you identify and correct the problem.\nInserting Debug.Print Statement As an alternative to using MsgBox functions in your code, you can insert one or more temporary Debug.Print statements.\nUse these statements to print the value of one or more variables in the Immediate window.\nHere‚Äôs an example that displays a message of \u0026ldquo;This condition is working fine\u0026rdquo;.\nvba\r1If swPart Is Nothing Then 2 Debug.Print \u0026#34;This condition is working fine.\u0026#34; 3End If\rIf VBE‚Äôs Immediate window is not visible, press Ctrl+G.\nUnlike MsgBox, Debug.Print statements do not halt your code.\nSo you‚Äôll need to keep an eye on the Immediate window to see what‚Äôs going on.\nAfter you‚Äôve debugged your code, be sure to remove all the Debug.Print statements.\nNext post will be about VBA Debugger.\n","date":"0001-01-01","id":87,"permalink":"/vba/bug-finding/","summary":"\u003cp\u003eA \u003cstrong\u003ebug\u003c/strong\u003e is an error in your programming. Here I cover the topic of programming bugs ‚Äî how to identify them and how to remove them from your module.\u003c/p\u003e","tags":[],"title":"Bug Finding"},{"content":"In this post, I tell you about how to create a Polygon through Solidworks VBA Macros in a sketch.\nThe process is almost identical with previous Sketch - Create Tangent Arc post.\nIn this post, I tell you about CreatePolygon method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new Polygon.\nVideo of Code on YouTube Please see below video on how to create a Polygon from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating a Polygon.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating Varient for Polygon Dim myPolygon As Variant \u0026#39; Creating a Polygon myPolygon = swSketchManager.CreatePolygon(0, 0, 0, 1, 0, 0, 6, True) \u0026#39; De-select the Polygon after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named as main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable swApp which we defined earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, holds the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor more detailed information about above lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout this post if you don\u0026rsquo;t understand above code.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\nI have discussed about different Selection methods in details in Soldworks Macros - Selection Methods post, so do visit this post for more Selection methods.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating Varient for Polygon Dim myPolygon As Variant \u0026#39; Creating a Polygon myPolygon = swSketchManager.CreatePolygon(0, 0, 0, 1, 0, 0, 6, True)\rIn above sample code, we 1st create a variable named myPolygon of type Variant.\nIn 2nd line, we get the value of Variant variable myPolygon.\nWe get this value from CreatePolygon method which is inside the swSketchManager variable.\nswSketchManager variable is a type of SketchManager, hence we used CreatePolygon method from SketchManager.\nThis CreatePolygon method takes following parameters as explained:\nXC : X coordinate of the center point, of the polygon\nYC : Y coordinate of the center point, of the polygon\nZC : Z coordinate of the center point, of the polygon\nXp : X coordinate of the vertex point, of the polygon\nYp : Y coordinate of the vertex point, of the polygon\nZp : Z coordinate of the vertex point, of the polygon\nSides : Number of sides in the polygon\nInscribed : True to show an inscribed construction circle, False to show a circumscribed construction circle\nFor creating a Polygon, I used (0, 0, 0) as the Center point, which is origin point of our Sketch.\nFor Vertex point of Polygon, I used (1, 0, 0) which is 1 point distance in X-direction.\nFor Number of sides in the Polygon, I used 6 which represent a Hexagon.\nBelow Image show when Inscribed option is True and show an inscribed construction circle.\nBelow Image show when Inscribed option is Falseand show a circumscribed construction circle.\nThis CreatePolygon method returns an array of sketch segments that represent the sides created for this Polygon.\nA Sketch Segment can represent a sketch arc, line, ellipse, parabola or spline.\nSketch Segment has ISketchSegment Interface, which provides functions that are generic to every type of sketch segment.\nFor example, every sketch segment has an ID and can be programmatically selected.\nTherefore, the ISketchSegment interface provides functions to obtain the ID and to select the item.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means \u0026ldquo;inches\u0026rdquo; for distance.\nBut when I used Solidworks API through VBA macros or C#, I have to use converted numeric values.\nBecause Solidworks API output the distance in Meter only; which is not my requirement.\n\u0026#39; De-select the Polygon after creation swDoc.ClearSelection2 True\rIn the this line of code, we de-select the created Polygon.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document variable swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nHope this post helps you to create a Polygon in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":88,"permalink":"/solidworks-macros/polygon/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create a Polygon through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e\n\u003cp\u003eThe process is almost identical with previous \u003cstrong\u003e\u003ca href=\"/solidworks-macros/create-tangent-arc\"\u003eSketch - Create Tangent Arc\u003c/a\u003e\u003c/strong\u003e post.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create Polygon"},{"content":"","date":"2023-09-07","id":89,"permalink":"/solidworks-macros/21-reference-geometry/","summary":"","tags":[],"title":"Reference Geometry"},{"content":"In this post, I tell you about how to create a Straight Slot through Solidworks VBA Macros in a sketch.\nThe process is almost identical with previous Sketch - Create Tangent Arc post.\nIn this post, I tell you about CreateSketchSlot method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new Straight Slot.\nVideo of Code on YouTube Please see below video on how to create a Straight Slot from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating a Straight Slot.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating Variable for Solidworks Slot Dim mySketchSlot As SketchSlot \u0026#39; Creating a Straight slot Set mySketchSlot = swSketchManager.CreateSketchSlot(swSketchSlotCreationType_e.swSketchSlotCreationType_line, swSketchSlotLengthType_e.swSketchSlotLengthType_CenterCenter, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, False) \u0026#39; De-select the Slot after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named as main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable swApp which we defined earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, holds the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor more detailed information about above lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout this post if you don\u0026rsquo;t understand above code.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\nI have discussed about different Selection methods in details in Soldworks Macros - Selection Methods post, so do visit this post for more Selection methods.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating Variable for Solidworks Slot Dim mySketchSlot As SketchSlot \u0026#39; Creating a Straight slot Set mySketchSlot = swSketchManager.CreateSketchSlot(swSketchSlotCreationType_e.swSketchSlotCreationType_line, swSketchSlotLengthType_e.swSketchSlotLengthType_CenterCenter, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, False)\rIn above sample code, we 1st create a variable named mySketchSlot of type SketchSlot.\nIn 2nd line, we set the value of SketchSlot variable mySketchSlot.\nWe get this value from CreateSketchSlot method which is inside the swSketchManager variable.\nswSketchManager variable is a type of SketchManager, hence we used CreateSketchSlot method from SketchManager.\nThis CreateSketchSlot method takes following parameters as explained:\nSlotCreationType : Type of sketch slot as defined in swSketchSlotCreationType_e.\nThere are 4 Different types of Slots we can create.\nStraight Slot : swSketchSlotCreationType_e.swSketchSlotCreationType_line or 0\nCenterpoint straight Slot : swSketchSlotCreationType_e.swSketchSlotCreationType_center_line or 1\nCenterpoint arc Slot : swSketchSlotCreationType_e.swSketchSlotCreationType_arc or 2\n3-point arc Slot : swSketchSlotCreationType_e.swSketchSlotCreationType_3pointarc or 4\nSlotLengthType : Type of length of sketch slot as defined in swSketchSlotLengthType_e.\nThere are 2 different types of Sketch slot length we can create.\nCenter to Center : swSketchSlotLengthType_e.swSketchSlotLengthType_CenterCenter or 0\nFull Length : swSketchSlotLengthType_e.swSketchSlotLengthType_FullLength or 1\nWidth : Width of Slot\nX1 : X coordinate of the point 1, of the Slot\nY1 : Y coordinate of the point 1, of the Slot\nZ1 : Z coordinate of the point 1, of the Slot\nX2 : X coordinate of the point 2, of the Slot\nY2 : Y coordinate of the point 2, of the Slot\nZ2 : Z coordinate of the point 2, of the Slot\nX3 : X coordinate of the point 3, of the Slot\nY3 : Y coordinate of the point 3, of the Slot\nZ3 : Z coordinate of the point 3, of the Slot\nCenterArcDirection : We need to set the direction eiter Clockwise or Anti-Clockwise/Counterclockwise as follows:\nClockwise (CW) : -1\nAnti-Clockwise/Counterclockwise (CCW) : 1\nAddDimension : True to automatically add dimensions, False to not.\nFor more details about Slot Parameter you can visit this page of Solidworks API Help\nFor creating a Straight Slot, I used following parameter Values:\nSlotCreationType : swSketchSlotCreationType_e.swSketchSlotCreationType_line Since we want to create a Straight Slot hence I select above value.\nSlotLengthType : swSketchSlotLengthType_e.swSketchSlotLengthType_CenterCenter I want length of this Slot from Center to Center hence I select above value.\nWidth : 1\nX1, Y1, Z1 : 0, 0, 0\nFor Point 1, I use (0, 0, 0) values, which is origin of Sketch.\nX2, Y2, Z2 : 1, 0, 0 For Point 2, I use (1, 0, 0) values, which is which is 1 point distance in X-direction.\nX3, Y3, Z3 : 1, 1, 0 For Point 2, I use (1, 1, 0) values, which is which is 1 point distance in X-direction and 1 point distance in Y-direction.\nCenterArcDirection : 1 I want to create Anti-Clockwise/Counterclockwise Slot.\nAddDimension : False Below Image described the Parameters for Straight Slot in more detail.\nThis CreateSketchSlot method returns Sketch Slot interface i.e. ISketchSlot interface.\nThis ISketchSlot interface has various methods and properties for a Slot.\nFor more detail about methods and properties of ISketchSlot interface you can visit this page of Solidworks API Help\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means \u0026ldquo;inches\u0026rdquo; for distance.\nBut when I used Solidworks API through VBA macros or C#, I have to use converted numeric values.\nBecause Solidworks API output the distance in Meter only; which is not my requirement.\n\u0026#39; De-select the Slot after creation swDoc.ClearSelection2 True\rIn the this line of code, we de-select the created Straight Slot.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document variable swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nHope this post helps you to create a Straight Slot in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":90,"permalink":"/solidworks-macros/create-straight-slot/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create a Straight Slot through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create a Straight Slot"},{"content":"In this section, I discuss the details of using the VBA debugging tools.\nThese tools are much more powerful than the techniques I discuss in the previous section.\nBut along with power comes responsibility. Using the debugging tools takes a bit of setup work.\nSetting breakpoints in your code In earlier sections, I discuss using MsgBox functions in your code to monitor the values of certain variables.\nDisplaying a message box essentially halts your code in mid-execution, and clicking the OK button resumes execution.\nWouldn‚Äôt it be nice if you could halt a routine‚Äôs execution, take a look at the value of any of your variables, and then continue execution?\nWell, that‚Äôs exactly what you can do by setting a breakpoint.\nYou can set a breakpoint in your VBA code in several ways:\nMove the cursor to the statement at which you want execution to stop; then press F9. Click in the gray margin to the left of the statement at which you want execution to stop. This is I used mainly. Position the insertion point in the statement at which you want execution to stop. Then use the Debug -\u0026gt; Toggle Breakpoint command. Right-click a statement and choose Toggle -\u0026gt; Breakpoint from the shortcut menu. The results of setting a breakpoint are shown in below figure.\nVBE highlights the line to remind you that you set a breakpoint there; it also inserts a large dot in the gray margin.\nWhen you execute the procedure, VBE goes into Break mode before the line with the breakpoint is executed.\nIn Break mode, the word break is displayed in the VBE title bar.\nTo get out of Break mode and continue execution, press F5 or click the Run Sub/UserForm button in the VBE toolbar.\nTo quickly remove a breakpoint, click the large dot in the gray margin or move the cursor to the highlighted line and press F9.\nTo remove all breakpoints in the module, press Ctrl+Shift+F9.\nWhat is Break mode? You can think of it as a state of suspended animation.\nYour VBA code stops running and the current statement is highlighted in bright yellow. In Break mode, you can\nType VBA statements in the Immediate window. Press F8 to step through your code one line at a time to check various things while the program is paused. Move the mouse pointer over a variable to display its value in a small pop-up window. Skip the next statement(s) and continue execution there (or even go back a couple of statements). Edit a statement and then continue. Below figure shows some debugging action.\nA breakpoint is set (notice the big dot), and I‚Äôm using the F8 key to step through the code line by line (notice the arrow that points to the current statement).\nI used the Immediate window to print Hello world.\nUsing the Immediate window The Immediate window may not be visible in the VBE.\nYou can display the VBE‚Äôs Immediate window at any time by pressing Ctrl+G.\nIn Break mode, the Immediate window is particularly useful for finding the current value of any variable in your program.\nFor example, if you want to know the current value of a variable, enter the following in the Immediate window and press Enter.\nvba\r1?MyVariable\rThe Immediate window lets you do other things besides check variable values.\nFor example, you can change the value of a variable, try for a new condition.\nJust make sure that the command you enter is a valid VBA statement.\nStepping through your code While in Break mode, you can also step through your code line by line.\nOne statement is executed each time you press F8.\nThroughout this line-by-line execution of your code, you can activate the Immediate window at any time to check the status of your variables.\nYou can use your mouse to change which statement VBA will execute next.\nIf you put your mouse pointer in the gray margin to the left of the currently highlighted statement (which will usually be yellow), your pointer changes to a right-pointing arrow.\nSimply drag your mouse to the statement you want done next and watch that statement turn yellow.\nUsing the Watch window In some cases, you may want to know whether a certain variable or expression takes on a particular value.\nFor example, suppose that a procedure loops through 1,000 times.\nYou notice that a problem occurs during the 800th iteration of the loop.\nWell, you could insert a breakpoint in the loop, but that would mean responding to 799 prompts before the code finally gets to the iteration you want to see (and that gets boring real fast).\nA more efficient solution involves setting a watch expression.\nFor example, you can create a watch expression that puts the procedure into Break mode whenever a certain variable takes on a specific value ‚Äî for example, AnyNumber=800.\nTo create a watch expression, choose Debug -\u0026gt; Add Watch to display the Add Watch dialog box. See below figure.\nThe Add Watch dialog has three parts:\nExpression: Enter a valid VBA expression or a variable here. For example, AnyNumber=900 or just AnyNumber.\nContext: Select the procedure and the module you want to watch. Note that you can select All Procedures and All Modules.\nWatch Type: Select the type of watch by clicking an option button. Your choice here depends on the expression you enter. The first choice, Watch Expression, does not cause a break; it simply displays the expression‚Äôs value when a break occurs.\nExecute your procedure after setting up your watch expression(s).\nThings run normally until your watch expression is satisfied (based on the Watch Type you specified).\nWhen that happens, VBE enters Break mode (you did set the Watch Type to ‚ÄúBreak When Value Is True,‚Äù didn‚Äôt you?).\nFrom there, you can step through the code or use the Immediate window to debug your code.\nWhen you create a watch, VBE displays the Watches window shown in below figure.\nThis window displays the value of all watches that you‚Äôve defined.\nIn this figure, when the value hit 800, which caused VBE to enter Break mode.\nThe best way to understand how this Watch business works is to use it and try various options.\nBefore long, you‚Äôll probably wonder how you ever got along without it.\nUsing the Locals window Another useful debugging aid is the Locals window.\nYou can show this window by choosing View -\u0026gt; Locals Window from the VBE‚Äôs menu.\nWhen you are in Break mode, this window will show you a list of all variables that are local to the current procedure (see below figure).\nThe nice thing about this window is that you don‚Äôt have to add a load of watches manually if you want to look at the content of many variables.\nThe VBE has done all the hard work for you.\nNext post will be about VBA Bug Reduction Tips.\n","date":"0001-01-01","id":91,"permalink":"/vba/debugger/","summary":"\u003cp\u003eIn this section, I discuss the details of using the VBA debugging tools.\u003c/p\u003e\n\u003cp\u003eThese tools are much more powerful than the techniques I discuss in the previous section.\u003c/p\u003e","tags":[],"title":"VBA Debugger"},{"content":"","date":"2023-09-07","id":92,"permalink":"/solidworks-macros/22-assembly---general/","summary":"","tags":[],"title":"Assembly - General"},{"content":"","date":"2023-09-07","id":93,"permalink":"/solidworks-macros/22-assembly---standard-mates/","summary":"","tags":[],"title":"Assembly - Standard Mates"},{"content":"In this post, I tell you about how to create a Centerpoint Straight Slot through Solidworks VBA Macros in a sketch.\nThe process is almost identical with previous Sketch - Create Straight Slot post.\nIn this post, I tell you about CreateSketchSlot method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new Centerpoint Straight Slot.\nVideo of Code on YouTube Please see below video on how to create a Centerpoint Straight Slot from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating a Centerpoint Straight Slot.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating Variable for Solidworks Slot Dim mySketchSlot As SketchSlot \u0026#39; Creating a Centerpoint Straight slot Set mySketchSlot = swSketchManager.CreateSketchSlot(swSketchSlotCreationType_e.swSketchSlotCreationType_center_line, swSketchSlotLengthType_e.swSketchSlotLengthType_CenterCenter, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, False) \u0026#39; De-select the Slot after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named as main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable swApp which we defined earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, holds the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor more detailed information about above lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout this post if you don\u0026rsquo;t understand above code.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\nI have discussed about different Selection methods in details in Soldworks Macros - Selection Methods post, so do visit this post for more Selection methods.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating Variable for Solidworks Slot Dim mySketchSlot As SketchSlot \u0026#39; Creating a Centerpoint Straight slot Set mySketchSlot = swSketchManager.CreateSketchSlot(swSketchSlotCreationType_e.swSketchSlotCreationType_center_line, swSketchSlotLengthType_e.swSketchSlotLengthType_CenterCenter, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, False)\rIn above sample code, we 1st create a variable named mySketchSlot of type SketchSlot.\nIn 2nd line, we set the value of SketchSlot variable mySketchSlot.\nWe get this value from CreateSketchSlot method which is inside the swSketchManager variable.\nswSketchManager variable is a type of SketchManager, hence we used CreateSketchSlot method from SketchManager.\nThis CreateSketchSlot method takes following parameters as explained:\nSlotCreationType : Type of sketch slot as defined in swSketchSlotCreationType_e.\nThere are 4 Different types of Slots we can create.\nStraight Slot : swSketchSlotCreationType_e.swSketchSlotCreationType_line or 0\nCenterpoint straight Slot : swSketchSlotCreationType_e.swSketchSlotCreationType_center_line or 1\nCenterpoint arc Slot : swSketchSlotCreationType_e.swSketchSlotCreationType_arc or 2\n3-point arc Slot : swSketchSlotCreationType_e.swSketchSlotCreationType_3pointarc or 4\nSlotLengthType : Type of length of sketch slot as defined in swSketchSlotLengthType_e.\nThere are 2 different types of Sketch slot length we can create.\nCenter to Center : swSketchSlotLengthType_e.swSketchSlotLengthType_CenterCenter or 0\nFull Length : swSketchSlotLengthType_e.swSketchSlotLengthType_FullLength or 1\nWidth : Width of Slot\nX1 : X coordinate of the point 1, of the Slot\nY1 : Y coordinate of the point 1, of the Slot\nZ1 : Z coordinate of the point 1, of the Slot\nX2 : X coordinate of the point 2, of the Slot\nY2 : Y coordinate of the point 2, of the Slot\nZ2 : Z coordinate of the point 2, of the Slot\nX3 : X coordinate of the point 3, of the Slot\nY3 : Y coordinate of the point 3, of the Slot\nZ3 : Z coordinate of the point 3, of the Slot\nCenterArcDirection : We need to set the direction eiter Clockwise or Anti-Clockwise/Counterclockwise as follows:\nClockwise (CW) : -1\nAnti-Clockwise/Counterclockwise (CCW) : 1\nAddDimension : True to automatically add dimensions, False to not.\nFor more details about Slot Parameter you can visit this page of Solidworks API Help\nFor creating a Centerpoint Straight Slot, I used following parameter Values:\nSlotCreationType : swSketchSlotCreationType_e.swSketchSlotCreationType_center_line Since we want to create a Centerpoint Straight Slot hence I select above value.\nSlotLengthType : swSketchSlotLengthType_e.swSketchSlotLengthType_CenterCenter I want length of this Slot from Center to Center hence I select above value.\nWidth : 1\nX1, Y1, Z1 : 0, 0, 0\nFor Point 1, I use (0, 0, 0) values, which is origin of Sketch.\nX2, Y2, Z2 : 1, 0, 0 For Point 2, I use (1, 0, 0) values, which is which is 1 point distance in X-direction.\nX3, Y3, Z3 : 1, 1, 0 For Point 2, I use (1, 1, 0) values, which is which is 1 point distance in X-direction and 1 point distance in Y-direction.\nCenterArcDirection : 1 I want to create Anti-Clockwise/Counterclockwise Slot.\nAddDimension : False Below Image described the Parameters for Centerpoint Straight Slot in more detail.\nThis CreateSketchSlot method returns Sketch Slot interface i.e. ISketchSlot interface.\nThis ISketchSlot interface has various methods and properties for a Slot.\nFor more detail about methods and properties of ISketchSlot interface you can visit this page of Solidworks API Help\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means \u0026ldquo;inches\u0026rdquo; for distance.\nBut when I used Solidworks API through VBA macros or C#, I have to use converted numeric values.\nBecause Solidworks API output the distance in Meter only; which is not my requirement.\n\u0026#39; De-select the Slot after creation swDoc.ClearSelection2 True\rIn the this line of code, we de-select the created Centerpoint Straight Slot.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document variable swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nHope this post helps you to create a Centerpoint Straight Slot in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":94,"permalink":"/solidworks-macros/create-centerpoint-straight-slot/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create a Centerpoint Straight Slot through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create a Centerpoint Straight Slot"},{"content":"I can‚Äôt tell you how to completely eliminate bugs in your programs.\nFinding bugs in software can be a profession by itself, but I can provide a few tips to help you keep those bugs to a minimum:\nUse an Option Explicit statement at the beginning of your modules. This statement requires you to define the data type for every variable you use. This creates a bit more work for you, but you avoid the common error of misspelling a variable name. And it has a nice side benefit: Your routines run a bit faster.\nFormat your code with indentation. Using indentations helps delineate different code segments. If your program has several nested For-Next loops, for example, consistent indentation helps you keep track of them all.\nUse lots of comments. Nothing is more frustrating than revisiting code you wrote six months ago and not having a clue as to how it works. By adding a few comments to describe your logic, you can save lots of time down the road.\nKeep your Sub and Function procedures simple. By writing your code in small modules, each of which has a single, well-defined purpose, you simplify the debugging process.\nUse the macro recorder to help identify properties and methods. When I can‚Äôt remember the name or the syntax of a property or method, I often simply record a macro and look at the recorded code\nDebugging code is not one of my favorite activities, but it‚Äôs a necessary evil that goes along with programming.\nAs you gain more experience with VBA, you spend less time debugging and, when you have to debug, are more efficient at doing so.\nNext post will be about VBA Dialog Boxes.\n","date":"0001-01-01","id":95,"permalink":"/vba/bug-reduction-tips/","summary":"\u003cp\u003eI can‚Äôt tell you how to completely eliminate bugs in your programs.\u003c/p\u003e\n\u003cp\u003eFinding bugs in software can be a profession by itself, but I can provide a few tips to help you keep those bugs to a minimum:\u003c/p\u003e","tags":[],"title":"VBA Bug Reduction Tips"},{"content":"","date":"2023-09-07","id":96,"permalink":"/solidworks-macros/23-assembly---advanced-mates/","summary":"","tags":[],"title":"Assembly - Advanced Mates"},{"content":"In this post, I tell you about how to create a 3-Point Arc Slot through Solidworks VBA Macros in a sketch.\nThe process is almost identical with previous Sketch - Create Straight Slot post.\nIn this post, I tell you about CreateSketchSlot method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new 3-Point Arc Slot.\nVideo of Code on YouTube Please see below video on how to create a 3-Point Arc Slot from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating a 3-Point Arc Slot.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating Variable for Solidworks Slot Dim mySketchSlot As SketchSlot \u0026#39; Creating a 3-Point Arc slot Set mySketchSlot = swSketchManager.CreateSketchSlot(swSketchSlotCreationType_e.swSketchSlotCreationType_3pointarc, swSketchSlotLengthType_e.swSketchSlotLengthType_CenterCenter, 1, -1, 0, 0, 1, 0, 0, 0, 1, 0, 1, False) \u0026#39; De-select the Slot after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named as main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable swApp which we defined earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, holds the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor more detailed information about above lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout this post if you don\u0026rsquo;t understand above code.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\nI have discussed about different Selection methods in details in Soldworks Macros - Selection Methods post, so do visit this post for more Selection methods.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating Variable for Solidworks Slot Dim mySketchSlot As SketchSlot \u0026#39; Creating a 3-Point Arc slot Set mySketchSlot = swSketchManager.CreateSketchSlot(swSketchSlotCreationType_e.swSketchSlotCreationType_3pointarc, swSketchSlotLengthType_e.swSketchSlotLengthType_CenterCenter, 1, -1, 0, 0, 1, 0, 0, 0, 1, 0, 1, False)\rIn above sample code, we 1st create a variable named mySketchSlot of type SketchSlot.\nIn 2nd line, we set the value of SketchSlot variable mySketchSlot.\nWe get this value from CreateSketchSlot method which is inside the swSketchManager variable.\nswSketchManager variable is a type of SketchManager, hence we used CreateSketchSlot method from SketchManager.\nThis CreateSketchSlot method takes following parameters as explained:\nSlotCreationType : Type of sketch slot as defined in swSketchSlotCreationType_e.\nThere are 4 Different types of Slots we can create.\nStraight Slot : swSketchSlotCreationType_e.swSketchSlotCreationType_line or 0\nCenterpoint straight Slot : swSketchSlotCreationType_e.swSketchSlotCreationType_center_line or 1\nCenterpoint arc Slot : swSketchSlotCreationType_e.swSketchSlotCreationType_arc or 2\n3-point arc Slot : swSketchSlotCreationType_e.swSketchSlotCreationType_3pointarc or 4\nSlotLengthType : Type of length of sketch slot as defined in swSketchSlotLengthType_e.\nThere are 2 different types of Sketch slot length we can create.\nCenter to Center : swSketchSlotLengthType_e.swSketchSlotLengthType_CenterCenter or 0\nFull Length : swSketchSlotLengthType_e.swSketchSlotLengthType_FullLength or 1\nWidth : Width of Slot\nX1 : X coordinate of the point 1, of the Slot\nY1 : Y coordinate of the point 1, of the Slot\nZ1 : Z coordinate of the point 1, of the Slot\nX2 : X coordinate of the point 2, of the Slot\nY2 : Y coordinate of the point 2, of the Slot\nZ2 : Z coordinate of the point 2, of the Slot\nX3 : X coordinate of the point 3, of the Slot\nY3 : Y coordinate of the point 3, of the Slot\nZ3 : Z coordinate of the point 3, of the Slot\nCenterArcDirection : We need to set the direction eiter Clockwise or Anti-Clockwise/Counterclockwise as follows:\nClockwise (CW) : -1\nAnti-Clockwise/Counterclockwise (CCW) : 1\nAddDimension : True to automatically add dimensions, False to not.\nFor more details about Slot Parameter you can visit this page of Solidworks API Help\nFor creating a 3-Point Arc Slot, I used following parameter Values:\nSlotCreationType : swSketchSlotCreationType_e.swSketchSlotCreationType_3pointarc Since we want to create a 3-Point Arc Slot hence I select above value.\nSlotLengthType : swSketchSlotLengthType_e.swSketchSlotLengthType_CenterCenter I want length of this Slot from Center to Center hence I select above value.\nWidth : 1\nX1, Y1, Z1 : -1, 0, 0\nFor Point 1, I use (-1, 0, 0) values, which is -1 point distance in X-direction.\nX2, Y2, Z2 : 1, 0, 0 For Point 2, I use (1, 0, 0) values, which is which is 1 point distance in X-direction.\nX3, Y3, Z3 : 0, 1, 0 For Point 2, I use (0, 1, 0) values, which is which is 1 point distance in Y-direction.\nCenterArcDirection : 1 I want to create Anti-Clockwise/Counterclockwise Slot.\nAddDimension : False Below Image described the Parameters for 3-Point Arc Slot in more detail.\nThis CreateSketchSlot method returns Sketch Slot interface i.e. ISketchSlot interface.\nThis ISketchSlot interface has various methods and properties for a Slot.\nFor more detail about methods and properties of ISketchSlot interface you can visit this page of Solidworks API Help\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means \u0026ldquo;inches\u0026rdquo; for distance.\nBut when I used Solidworks API through VBA macros or C#, I have to use converted numeric values.\nBecause Solidworks API output the distance in Meter only; which is not my requirement.\n\u0026#39; De-select the Slot after creation swDoc.ClearSelection2 True\rIn the this line of code, we de-select the created 3-Point Arc Slot.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document variable swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nHope this post helps you to create a 3-Point Arc Slot in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":97,"permalink":"/solidworks-macros/create-3point-arc-slot/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create a 3-Point Arc Slot through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create a 3-Point Arc Slot"},{"content":"You can‚Äôt use VBA very long without being exposed to dialog boxes.\nThey seem to pop up almost every time you select a command.\nVBA uses dialog boxes to obtain information, clarify commands, and display messages.\nIf you develop VBA macros, you can create your own dialog boxes that work just like those built in.\nThose custom dialog boxes are called UserForms in VBA. About which we look into next section.\nUserForm Alternatives Some of the VBA macros you create behave the same every time you execute them.\nFor example, you may develop a macro for intermediate steps you do every day.\nThis macro always produces the same result and requires no additional user input.\nYou might develop other macros that behave differently under various circumstances or that offer the user options.\nIn such cases, the macro may benefit from a custom dialog box.\nA custom dialog box provides a simple means for getting information from the user.\nYour macro then uses that information to determine what it should do.\nUserForms can be quite useful, but creating them takes time.\nBefore I cover the topic of creating UserForms in the next section, you need to know about some potentially timesaving alternatives.\nVBA lets you display several different types of dialog boxes that you can sometimes use in place of a UserForm.\nYou can customize these built-in dialog boxes in some ways, but they certainly don‚Äôt offer the options available in a UserForm.\nIn some cases, however, they‚Äôre just what you need.\nIn the following sections you read about\nVBA MsgBox function\nVBA InputBox function\nVBA GetOpenFilename method\nVBA GetSaveAsFilename method\nVBA FileDialog method\nNext post will be about VBA MsgBox Function.\n","date":"0001-01-01","id":98,"permalink":"/vba/dialog-boxes/","summary":"\u003cp\u003eYou can‚Äôt use VBA very long without being exposed to dialog boxes.\u003c/p\u003e\n\u003cp\u003eThey seem to pop up almost every time you select a command.\u003c/p\u003e","tags":[],"title":"VBA Dialog Boxes"},{"content":"","date":"2023-09-07","id":99,"permalink":"/solidworks-macros/24-assembly---editing-mates/","summary":"","tags":[],"title":"Assembly - Editing Mates"},{"content":"In this post, I tell you about how to create a Centerpoint Arc Slot through Solidworks VBA Macros in a sketch.\nThe process is almost identical with previous Sketch - Create Straight Slot post.\nVideo of Code on YouTube Please see below video on how to create a Centerpoint Arc Slot from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nFor Experience Macro Developer If you are an experience Solidworks Macro developer, then you are looking for a specific code sample.\nBelow is the code for creating A Centerpoint Arc Slot from Solidworks VBA Macro.\n\u0026#39; Creating Variable for Solidworks Slot Dim mySketchSlot As SketchSlot \u0026#39; Setting the value of a Centerpoint Arc slot Set mySketchSlot = swSketchManager.CreateSketchSlot(swSketchSlotCreationType_e.swSketchSlotCreationType_arc, swSketchSlotLengthType_e.swSketchSlotLengthType_CenterCenter, 0.5, 0, 0, 0, -1, 0, 0, 1, 0, 0, -1, False)\rFirst you need to Create a variable of SketchSlot type.\nAfter creating variable, you need to set the value of this variable.\nFor this you used CreateSketchSlot method from Solidworks Sketch Manager.\nThis CreateSketchSlot method set the value of SketchSlot type variable.\nThe CreateSketchSlot method takes following parameters:\nSlotCreationType : Type of sketch slot.\nSlotLengthType : Type of length of sketch slot.\nWidth : Width of Slot\nX1 : X coordinate of the point 1, of the Slot\nY1 : Y coordinate of the point 1, of the Slot\nZ1 : Z coordinate of the point 1, of the Slot\nX2 : X coordinate of the point 2, of the Slot\nY2 : Y coordinate of the point 2, of the Slot\nZ2 : Z coordinate of the point 2, of the Slot\nX3 : X coordinate of the point 3, of the Slot\nY3 : Y coordinate of the point 3, of the Slot\nZ3 : Z coordinate of the point 3, of the Slot\nCenterArcDirection : We need to set the direction eiter Clockwise or Anti-Clockwise/Counterclockwise\nAddDimension : True to automatically add dimensions, False to not.\nIf you want a more detail explaination then please read further otherwise this will help you to Create a Centerpoint Arc Slot From VBA Macro.\nFor Beginners Macro Developers In this post, I tell you about CreateSketchSlot method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new Centerpoint Arc Slot.\nBelow is the code sample for creating a Centerpoint Arc Slot.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating Variable for Solidworks Slot Dim mySketchSlot As SketchSlot \u0026#39; Creating a Centerpoint Arc slot Set mySketchSlot = swSketchManager.CreateSketchSlot(swSketchSlotCreationType_e.swSketchSlotCreationType_arc, swSketchSlotLengthType_e.swSketchSlotLengthType_CenterCenter, 0.5, 0, 0, 0, -1, 0, 0, 1, 0, 0, -1, False) \u0026#39; De-select the Slot after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named as main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable swApp which we defined earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, holds the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor more detailed information about above lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout this post if you don\u0026rsquo;t understand above code.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\nI have discussed about different Selection methods in details in Soldworks Macros - Selection Methods post, so do visit this post for more Selection methods.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating Variable for Solidworks Slot Dim mySketchSlot As SketchSlot \u0026#39; Creating a Centerpoint Arc slot Set mySketchSlot = swSketchManager.CreateSketchSlot(swSketchSlotCreationType_e.swSketchSlotCreationType_arc, swSketchSlotLengthType_e.swSketchSlotLengthType_CenterCenter, 0.5, 0, 0, 0, -1, 0, 0, 1, 0, 0, -1, False\rIn above sample code, we 1st create a variable named mySketchSlot of type SketchSlot.\nIn 2nd line, we set the value of SketchSlot variable mySketchSlot.\nWe get this value from CreateSketchSlot method which is inside the swSketchManager variable.\nswSketchManager variable is a type of SketchManager, hence we used CreateSketchSlot method from SketchManager.\nThis CreateSketchSlot method takes following parameters as explained:\nSlotCreationType : Type of sketch slot as defined in swSketchSlotCreationType_e.\nThere are 4 Different types of Slots we can create.\nStraight Slot : swSketchSlotCreationType_e.swSketchSlotCreationType_line or 0\nCenterpoint straight Slot : swSketchSlotCreationType_e.swSketchSlotCreationType_center_line or 1\nCenterpoint arc Slot : swSketchSlotCreationType_e.swSketchSlotCreationType_arc or 2\n3-point arc Slot : swSketchSlotCreationType_e.swSketchSlotCreationType_3pointarc or 4\nSlotLengthType : Type of length of sketch slot as defined in swSketchSlotLengthType_e.\nThere are 2 different types of Sketch slot length we can create.\nCenter to Center : swSketchSlotLengthType_e.swSketchSlotLengthType_CenterCenter or 0\nFull Length : swSketchSlotLengthType_e.swSketchSlotLengthType_FullLength or 1\nWidth : Width of Slot\nX1 : X coordinate of the point 1, of the Slot\nY1 : Y coordinate of the point 1, of the Slot\nZ1 : Z coordinate of the point 1, of the Slot\nX2 : X coordinate of the point 2, of the Slot\nY2 : Y coordinate of the point 2, of the Slot\nZ2 : Z coordinate of the point 2, of the Slot\nX3 : X coordinate of the point 3, of the Slot\nY3 : Y coordinate of the point 3, of the Slot\nZ3 : Z coordinate of the point 3, of the Slot\nCenterArcDirection : We need to set the direction eiter Clockwise or Anti-Clockwise/Counterclockwise as follows:\nClockwise (CW) : -1\nAnti-Clockwise/Counterclockwise (CCW) : 1\nAddDimension : True to automatically add dimensions, False to not.\nFor more details about Slot Parameter you can visit this page of Solidworks API Help\nFor creating a Centerpoint Arc Slot, I used following parameter Values:\nSlotCreationType : swSketchSlotCreationType_e.swSketchSlotCreationType_arc Since we want to create a Centerpoint Arc Slot hence I select above value.\nSlotLengthType : swSketchSlotLengthType_e.swSketchSlotLengthType_CenterCenter I want length of this Slot from Center to Center hence I select above value.\nWidth : 0.5\nX1, Y1, Z1 : 0, 0, 0\nFor Point 1, I use (0, 0, 0) values, which is origin of Sketch.\nX2, Y2, Z2 : -1, 0, 0 For Point 2, I use (-1, 0, 0) values, which is which is -1 point distance in X-direction.\nX3, Y3, Z3 : 1, 0, 0 For Point 2, I use (1, 0, 0) values, which is which is 1 point distance in X-direction.\nCenterArcDirection : -1 I want to create Clockwise Slot.\nAddDimension : False Below Image described the Parameters for Centerpoint Arc Slot in more detail.\nThis CreateSketchSlot method returns Sketch Slot interface i.e. ISketchSlot interface.\nThis ISketchSlot interface has various methods and properties for a Slot.\nFor more detail about methods and properties of ISketchSlot interface you can visit this page of Solidworks API Help\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means \u0026ldquo;inches\u0026rdquo; for distance.\nBut when I used Solidworks API through VBA macros or C#, I have to use converted numeric values.\nBecause Solidworks API output the distance in Meter only; which is not my requirement.\n\u0026#39; De-select the Slot after creation swDoc.ClearSelection2 True\rIn the this line of code, we de-select the created Centerpointrc Slot.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document variable swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nAfter this our Solidworks VBA Macro ends the Sub procedure and we create a Centerpoint Arc Slot.\nVBA Language feature used in this post In this post used some features of VBA programming language.\nThis section of post, has some brief information about the VBA programming language specific features.\nWe use Option Explicit for capturing un-declared variables. If you want to read more about Option Explicit then please visit Declaring and Scoping of Variables.\nThen we create variable for different data types. If you don\u0026rsquo;t know about them, then please visit Variables and Data-types posts of this blog. These posts will help you to understand what Variables are and how to use them.\nThen we create main Sub procedure for our macro. If you don\u0026rsquo;t know about the Sub procedure, then I suggest you to visit VBA Sub and Function Procedures and Executing Sub and Function Procedures posts of this blog. These posts will help you to understand what Procedures are and how to use them.\nIn most part we create some variables and set their values. We set those values by using some functions provided from objects. If you don\u0026rsquo;t know about the functions, then you should visit VBA Functions and VBA Functions that do more posts of this blog. These posts will help you to understand what functions are and how to use them.\nFor creating Centerpoint Arc Slot, we use CreateSketchSlot function. This function take some input values in form of VBA Constants. If you don\u0026rsquo;t know about the VBA Constants, then you should visit VBA Constants post of this blog. This posts will help you to understand what VBA Constants are and how to use them.\nSolidworks API Objects In this post, for creating Centerpoint Arc Slot, we use Solidworks API objects and their methods.\nThis section contains the list of all Solidworks Objects used in this post.\nI have also attached links of these Solidworks API Objects in API Help website.\nIf you want to explore those objects, you can use these links.\nThese Solidworks API Objects are listed below:\nSolidworks Application Object If you want explore Properties and Methods/Functions of Solidworks Application Object object you can visit this link of Solidworks AP Help.\nSolidworks Document Object If you want explore Properties and Methods/Functions of Solidworks Document Object object you can visit this link of Solidworks AP Help.\nSolidworks Sketch Manager Object If you want explore Properties and Methods/Functions of this Solidworks Sketch Manager Object you can visit this link of Solidworks AP Help.\nSolidworks Sketch Slot Object If you want explore Properties and Methods/Functions of this Solidworks Sketch Slot Object you can visit this link of Solidworks AP Help.\nHope this post helps you to create a Centerpoint Arc Slot in Sketches with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":100,"permalink":"/solidworks-macros/create-centerpoint-arc-slot/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create a Centerpoint Arc Slot through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create a Centerpoint Arc Slot"},{"content":"You‚Äôre probably already familiar with the VBA MsgBox function ‚Äî I use it quite a bit in the examples.\nThe MsgBox function, which accepts the arguments shown in below table, is handy for displaying information and getting simple user input.\nIt‚Äôs able to get user input because it‚Äôs a function.\nA function, as you recall, returns a value.\nIn the case of the Msgbox function, it uses a dialog box to get the value that it returns.\nKeep reading to see exactly how it works.\nHere‚Äôs a simplified version of the syntax for the MsgBox function:\nvba\r1\u0026#39; MsgBox Structure 2MsgBox(prompt[, buttons][, title])\rArguments What it does prompt The text your application displays in the message box buttons A number that specifies which buttons (along with what icon) appear in the message box (optional) title The text that appears in the message box‚Äôs title bar (optional) displaying a simple message box You can use the MsgBox function in two ways:\nTo simply show a message to the user. In this case, you don‚Äôt care about the result returned by the function. To get a response from the user. In this case, you do care about the result returned by the function. The result depends on the button that the user clicks. If you use the MsgBox function by itself, don‚Äôt include parentheses around the arguments.\nThe following example simply displays a message and does not return a result.\nWhen the message is displayed, the code stops until the user clicks OK.\nvba\r1\u0026#39; MsgBox function Example 2Sub main() 3 MsgBox \u0026#34;Hello, world!\u0026#34; 4End Sub\rBelow figure shows how this message box looks:\nGetting a response from a message box If you display a message box that has more than just an OK button, you‚Äôll probably want to know which button the user clicks.\nThe MsgBox function can return a value that represents which button is clicked.\nYou can assign the result of the MsgBox function to a variable.\nIn the following code, I use some built-in constants that make it easy to work with the values returned by MsgBox:\nvba\r1\u0026#39; MsgBox built-in constants Example 2Sub GetAnswer() 3 Dim Ans as Integer 4 Ans = MsgBox (\u0026#34;Did you eat lunch?\u0026#34;, vbYesNo) 5 Select Case Ans 6 Case vbYes 7 \u0026#39;......[Some code here].... 8 Case vbNo 9 \u0026#39;......[Some code here].... 10 End Select 11End Sub\rBelow figure shows how it looks.\nWhen you execute this procedure, the Ans variable is assigned a value of either vbYes or vbNo, depending on which button the user clicks.\nThe Select Case statement uses the Ans value to determine which action the code should perform.\nYou can also use the MsgBox function result without using a variable, as the following example demonstrates:\nvba\r1\u0026#39; MsgBox without variable 2Sub GetAnswer2() 3 If MsgBox (\u0026#34;Continue?\u0026#34;, vbYesNo) = vbYes Then 4 \u0026#39;......[Some code here].... 5 Else 6 \u0026#39;......[Some code here].... 7 End If 8End Sub\rCustomizing message boxes The flexibility of the buttons argument makes it easy to customize your message boxes.\nYou can specify which buttons to display, determine whether an icon appears, and decide which button is the default (the default button is ‚Äúclicked‚Äù if the user presses Enter).\nBelow table lists some of the built-in constants you can use for the buttons argument.\nIf you prefer, you can use the value rather than a constant (but I think using the built-in constants is a lot easier).\nConstant Value What it does vbOKOnly 0 Display OK button only. vbOKCancel 1 Display OK and Cancel buttons vbAbortRetryIgnore 2 Displays Abort, Retry, and Ignore buttons. vbYesNoCancel 3 Displays Yes, No, and Cancel buttons. vbYesNo 4 Displays Yes and No buttons. vbRetryCancel 5 Displays Retry and Cancel buttons. vbCritical 16 Displays Critical Message icon. vbQuestion 32 Displays Warning Query icon. vbExclamation 48 Displays Warning Message icon. vbInformation 64 Displays Information Message icon. vbDefaultButton1 0 First button is default. vbDefaultButton2 256 Second button is default. vbDefaultButton3 512 Third button is default. vbDefaultButton4 768 Fourth button is default. For using more than one of these constants as an argument, just connect them with a + operator.\nFor example, to display a message box with Yes and No buttons and an exclamation icon, use the following expression as the second MsgBox argument:\nvba\r1\u0026#39; Using multiple MsgBox built-in constants 2vbYesNo + vbExclamation\rOr, if you prefer to make your code less understandable, use a value of 52 (that is, 4 + 48).\nThe following example uses a combination of constants to display a message box with a Yes button and a No button (vbYesNo) as well as a question mark icon (vbQuestion).\nThe constant vbDefaultButton2 designates the second button (No) as the default button ‚Äî that is, the button that is clicked if the user presses Enter.\nFor simplicity, we assign these constants to the Config variable and then use Config as the second argument in the MsgBox function:\nvba\r1\u0026#39; Using multiple MsgBox built-in constants 2Sub GetAnswer3() 3 Dim Config As Integer 4 Dim Ans as Integer 5 Config = vbYesNo + vbQuestion + vbDefaultButton2 6 Ans = MsgBox(\u0026#34;Is part opened?\u0026#34;, Config) 7 If Ans = vbYes Then OpenPart 8End Sub\rBelow figure shows the message box application displays when you execute the GetAnswer3 procedure.\nIf the user clicks the Yes button, the routine executes the procedure named OpenPart (which is not shown).\nIf the user clicks the No button (or presses Enter), the routine ends with no action.\nBecause I omitted the title argument in the MsgBox function, our application uses the default title, in my case it is Solidworks.\nPrevious examples have used constants (such as vbYes and vbNo) for the return value of a MsgBox function.\nBesides these two constants, below table lists a few others.\nConstant Value What it does vbOK 1 User clicked OK. vbCancel 2 User clicked Cancel. vbAbort 3 User clicked Abort. vbRetry 4 User clicked Retry. vbIgnore 5 User clicked Ignore. vbYes 6 User clicked Yes. vbNo 7 User clicked No. Next post will be about VBA InputBox Function.\n","date":"0001-01-01","id":101,"permalink":"/vba/msgBox-function/","summary":"\u003cp\u003eYou‚Äôre probably already familiar with the VBA \u003ccode\u003eMsgBox\u003c/code\u003e function ‚Äî I use it quite a bit in the examples.\u003c/p\u003e\n\u003cp\u003eThe \u003ccode\u003eMsgBox\u003c/code\u003e function, which accepts the arguments shown in below table, is handy for displaying information and getting simple user input.\u003c/p\u003e","tags":[],"title":"VBA MsgBox Function"},{"content":"","date":"2023-09-07","id":102,"permalink":"/solidworks-macros/25-assembly---components/","summary":"","tags":[],"title":"Assembly - Components"},{"content":"In this post, I tell you about how to create a Point through Solidworks VBA Macros in a sketch.\nThe process is almost identical with previous Sketch - Create Lines post.\nVideo of Code on YouTube Please see below video on how to create a Sketch Point from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nFor Experience Macro Developer If you are an experience Solidworks Macro developer, then you are looking for a specific code sample.\nBelow is the code for creating A Point from Solidworks VBA Macro.\n\u0026#39; Creating Variable for Sketch Point Dim myPoint As SketchPoint \u0026#39; Creating a Point Set myPoint = swSketchManager.CreatePoint(0, 1, 0)\rFor creating a Point first you need to Create a variable of SketchPoint type.\nAfter creating variable, you need to set the value of this variable.\nFor this you used CreatePoint method from Solidworks Sketch Manager.\nThis CreatePoint method set the value of SketchPoint type variable.\nThis CreatePoint method takes following parameters as explained:\nX : X Location of Point\nY : Y Location of Point\nZ : Z Location of Point\nIf you want a more detail explaination then please read further otherwise this will help you to Create a Point From VBA Macro.\nFor Beginners Macro Developers In this post, I tell you about CreatePoint method from Solidworks SketchManager object.\nBy this method 1st we create a simple point, after that we create a sequence of points.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new Point or sequence of points.\nBelow is the code sample for creating a Point.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating Varient for Polygon Dim myPoint As SketchPoint \u0026#39; Creating a Point Set myPoint = swSketchManager.CreatePoint(0, 1, 0) \u0026#39; #########Creating a number of points############## \u0026#39; Declaring integer type variable for loop Dim i As Integer \u0026#39; Looping through 1 to 5 For i = 0 To 5 \u0026#39; Declaring integer type variables for X, Y and Z cordinates of point Dim x, y, z As Integer \u0026#39; Setting values of x, y and z x = i y = x + i z = 0 \u0026#39; Create points till loop continues Set myPoint = swSketchManager.CreatePoint(x, y, z) Next \u0026#39; De-select the Polygon after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nNext is our Sub procedure named as main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable swApp which we defined earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, holds the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor more detailed information about above lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout this post if you don\u0026rsquo;t understand above code.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn 1st line, we create a variable named BoolStatus as Boolean object.\nIn next line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\nI have discussed about different Selection methods in details in Soldworks Macros - Selection Methods post, so do visit this post for more Selection methods.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating Variable for Sketch Point Dim myPoint As SketchPoint \u0026#39; Creating a Point Set myPoint = swSketchManager.CreatePoint(0, 1, 0)\rIn above sample code, we 1st create a variable named myPoint of type SketchPoint.\nIn 2nd line, we set the value of SketchPoint variable myPoint.\nWe get this value from CreatePoint method which is inside the swSketchManager variable.\nswSketchManager variable is a type of SketchManager, hence we used CreatePoint method from SketchManager.\nThis CreatePoint method takes following parameters as explained:\nX : X Location of Point\nY : Y Location of Point\nZ : Z Location of Point\nFor creating a Sketch Point, I used following parameter Values:\nX : 0\nY : 1\nZ : 0\nThis create a point in Y - Direction at the distance of 1.\nBelow Image described the Parameters for a Point in more detail.\nThis CreatePoint method returns Point interface i.e. ISketchPoint interface.\nThis ISketchPoint interface has various methods and properties for a Point.\nFor more detail about methods and properties of ISketchPoint interface you can visit this page of Solidworks API Help\nCreating sequence of Points Below code describe how to create Sequence of Points.\n\u0026#39; Declaring integer type variable for loop Dim i As Integer \u0026#39; Looping through 1 to 5 For i = 0 To 5 \u0026#39; Declaring integer type variables for X, Y and Z cordinates of point Dim x, y, z As Integer \u0026#39; Setting values of x, y and z x = i y = x + i z = 0 \u0026#39; Create points till loop continues Set myPoint = swSketchManager.CreatePoint(x, y, z) Next\rLet us understand each line of code.\nAbove Lines of code creates a number of points.\n\u0026#39; Declaring integer type variable for loop Dim i As Integer\rIn above line, we create a variable named i of integer type.\n\u0026#39; Looping through 1 to 5 For i = 0 To 5 Next\rIn above lines, we create a For loop.\nThis loop iterate the value of i variable from 0 -\u0026gt; 5.\n\u0026#39; Declaring integer type variables for X, Y and Z cordinates of point Dim x, y, z As Integer \u0026#39; Setting values of x, y and z x = i y = x + i z = 0\rIn above lines, we 1st declare 3 variable x, y and z of integer type.\nx, y and z are co-ordinates of a single point in X, Y and Z direction.\nIn next 3 lines, we set the values of x, y and z.\nFor all points, we set the value of z to 0 because we want to place our points in XY plane.\nIf the value of i = 0, then we set the value of x equal to i.\nThis makes x = 0 also.\nNow, we set the value of y which is equal to SUM of x and i.\nHence for i = 0, x = 0 and y = 0.\nFor i = 1, x = 1 and y = 2.\n\u0026#39; Create points till loop continues Set myPoint = swSketchManager.CreatePoint(x, y, z)\rIn above line, we create a Point using CreatePoint function of swSketchManager variable with the values of x, y and z.\nCode sample in this section, create a sequence of points.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means \u0026ldquo;inches\u0026rdquo; for distance.\nBut when I used Solidworks API through VBA macros or C#, I have to use converted numeric values.\nBecause Solidworks API output the distance in Meter only; which is not my requirement.\n\u0026#39; De-select the Point after creation swDoc.ClearSelection2 True\rIn the this line of code, we de-select the created Point.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document variable swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nVBA Language feature used in this post In this post used some features of VBA programming language.\nThis section of post, has some brief information about the VBA programming language specific features.\nWe use Option Explicit for capturing un-declared variables. If you want to read more about Option Explicit then please visit Declaring and Scoping of Variables.\nThen we create variable for different data types. If you don\u0026rsquo;t know about them, then please visit Variables and Data-types posts of this blog. These posts will help you to understand what Variables are and how to use them.\nThen we create main Sub procedure for our macro. If you don\u0026rsquo;t know about the Sub procedure, then I suggest you to visit VBA Sub and Function Procedures and Executing Sub and Function Procedures posts of this blog. These posts will help you to understand what Procedures are and how to use them.\nIn most part we create some variables and set their values. We set those values by using some functions provided from objects. If you don\u0026rsquo;t know about the functions, then you should visit VBA Functions and VBA Functions that do more posts of this blog. These posts will help you to understand what functions are and how to use them.\nFor creating a sequence of points, we use a For-Next loop. We use a loop to set values of x, y and z co-ordinates of each points. If you don\u0026rsquo;t know about the For-Next loop, then you should visit VBA Looping post of this blog. This posts will help you to understand what For-Next loop are and how to use them.\nSolidworks API Objects In this post, for creating a Point, we use Solidworks API objects and their methods.\nThis section contains the list of all Solidworks Objects used in this post.\nI have also attached links of these Solidworks API Objects in API Help website.\nIf you want to explore those objects, you can use these links.\nThese Solidworks API Objects are listed below:\nSolidworks Application Object If you want explore Properties and Methods/Functions of Solidworks Application Object object you can visit this link of Solidworks AP Help.\nSolidworks Document Object If you want explore Properties and Methods/Functions of Solidworks Document Object object you can visit this link of Solidworks AP Help.\nSolidworks Sketch Manager Object If you want explore Properties and Methods/Functions of Solidworks Sketch Manager Object you can visit this link of Solidworks AP Help.\nSolidworks Sketch Point Object If you want explore Properties and Methods/Functions of Solidworks Sketch Point Object you can visit this link of Solidworks AP Help.\nHope this post helps you to create a Point in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":103,"permalink":"/solidworks-macros/create-point/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create a Point through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e\n\u003cp\u003eThe process is almost identical with previous \u003cstrong\u003e\u003ca href=\"/solidworks-macros/sketch-create-line\"\u003eSketch - Create Lines\u003c/a\u003e\u003c/strong\u003e post.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create a Point"},{"content":"The VBA\u0026rsquo;s InputBox function is useful for obtaining a single piece of information from the user.\nThat information could be a value, a text string, or even a range address.\nThis is a good alternative to developing a UserForm when you need to get only one value.\nInputBox syntax Here‚Äôs a simplified version of the syntax for the InputBox function:\nvba\r1\u0026#39; InputBox syntax 2InputBox(prompt[, title][, default])\rThe InputBox function accepts the arguments listed in below.\nArguments What it means prompt The text displayed in the input box. Title The text displayed in the input box‚Äôs title bar (optional). Default The default value for the user‚Äôs input (optional) An InputBox example Here‚Äôs an example showing how you can use the InputBox function:\nvba\r1\u0026#39; InputBox example 2TheName = InputBox(\u0026#34;What is your name?\u0026#34;, \u0026#34;Greetings\u0026#34;)\rWhen you execute this VBA statement, application displays the dialog box shown in below figure.\nNotice that this example uses only the first two arguments and does not supply a default value.\nWhen the user enters a value and clicks OK, the routine assigns the value to the variable TheName.\nPlease note that VBA‚Äôs InputBox function always returns a string, so if you need to get a value, your code will need to do some additional checking.\nThe following example uses the InputBox function to get a number.\nIt uses the IsNumeric function to check whether the string is a number.\nIf the string does contain a number, all is fine.\nIf the user‚Äôs entry cannot be interpreted as a number, the code displays a message box.\nvba\r1\u0026#39; InputBox example 2Sub GetDrawingSheetNumber() 3 Dim NumberOfSheets as String 4 Prompt = \u0026#34;How many sheets drawing have?\u0026#34; 5 NumberOfSheets = InputBox (Prompt) 6 7 If NumberOfSheets = \u0026#34;\u0026#34; Then Exit Sub 8 If (IsNumeric)NumberOfSheets Then 9 \u0026#39;......[Some code here].... 10 Else 11 MsgBox \u0026#34;Please enter a number.\u0026#34; 12 End If 13End Sub\r","date":"0001-01-01","id":104,"permalink":"/vba/inputbox-function/","summary":"\u003cp\u003eThe VBA\u0026rsquo;s \u003ccode\u003eInputBox\u003c/code\u003e function is useful for obtaining a single piece of information from the user.\u003c/p\u003e\n\u003cp\u003eThat information could be \u003cem\u003ea value\u003c/em\u003e, \u003cem\u003ea text string\u003c/em\u003e, or even \u003cem\u003ea range address\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"VBA InputBox Function"},{"content":"","date":"2023-09-07","id":105,"permalink":"/solidworks-macros/26-assembly---misc/","summary":"","tags":[],"title":"Assembly - Misc"},{"content":"In this post, I tell you about how to create a Spline through Solidworks VBA Macros in a sketch.\nThis post take some functionality from previous Sketch - Create Create a Point post.\nHence if you have not read Sketch - Create Create a Point post, then it is recommended that please read it 1st.\nVideo of Code on YouTube Please see below video how visually we can create a Spline from Solidworks VBA macro.\nPlease note that there are no explaination given in the video.\nExplaination of each line and why we write code this way is explained here.\nFor Experience Macro Developer If you are an experience Solidworks Macro developer, then you are looking for a specific code sample.\nBelow is the code for creating A Spline from Solidworks VBA Macro.\n\u0026#39; Creating variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Set the value of Solidworks Sketch segment by \u0026#34;CreateSpline2\u0026#34; method from Solidworks sketch manager Set swSketchSegment = swSketchManager.CreateSpline2((pointArray), True)\rFor creating a Spline first you need to Create a variable of SketchSegment type.\nAfter creating variable, you need to set the value of this variable.\nFor this you used CreateSpline2 method from Solidworks Sketch Manager.\nThis CreateSpline2 method set the value of SketchSegment type variable.\nThis CreateSpline2 method takes following parameters as explained:\nPointData : Array of X,Y,Z point coordinates to use in creating the spline.\nSimulateNaturalEnds : True to simulate natural ends, false to not simulate natural ends.\nIf you want a more detail explaination then please read further otherwise this will help you to Create a Spline From VBA Macro.\nFor Beginners Macro Developers In this post, I tell you about CreateSpline2 method from Solidworks SketchManager object.\nBy this method we create a simple Spline from a sequence of points.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new Spline.\nBelow is the code sample for creating a Spline.\nPlease don\u0026rsquo;t get distracted by length of code, I just want to do everything programatically. So that you have some sort of experience in developing logic.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Creating variable for Solidworks Sketch Dim swSketch As SldWorks.Sketch \u0026#39; Creating variable for Solidworks Sketch Point Dim swSketchPoint As SldWorks.SketchPoint \u0026#39; Creating variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Set Solidworks application variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Create integer type local variable Dim i As Integer \u0026#39; Loop through 0 to 10 For i = 0 To 10 \u0026#39; Create integer type variables Dim x, y, z, incrementFactor As Integer \u0026#39; Set value of incrementFactor incrementFactor = i * 0.5 \u0026#39; Set value of x co-ordinate x = i \u0026#39; Set value of y co-ordinate y = x + incrementFactor \u0026#39; Set value of z co-ordinate z = 0 \u0026#39; Create a Sketch Point using x, y \u0026amp; z variables Set swSketchPoint = swSketchManager.CreatePoint(x, y, z) Next i \u0026#39; De-select the points after creation swDoc.ClearSelection2 True \u0026#39; Set Solidworks Sketch variable to active sketch Set swSketch = swSketchManager.ActiveSketch \u0026#39; Create variant type variable named \u0026#34;sketchPointArray\u0026#34; Dim sketchPointArray As Variant \u0026#39; Get all the points in this active sketch and store them into our variant type variable sketchPointArray = swSketch.GetSketchPoints2() \u0026#39; Creating a new Collection, \u0026#39; we use this collecction to store x,y,z co-ordinates of all sketch points Dim pointCollection As New Collection \u0026#39; Loop through all points in \u0026#34;sketchPointArray\u0026#34; For i = 0 To UBound(sketchPointArray) \u0026#39; Set Solidworks sketch point variable to current point Set swSketchPoint = sketchPointArray(i) \u0026#39; Add X co-ordinate of current point into collection pointCollection.Add (swSketchPoint.x) \u0026#39; Add Y co-ordinate of current point into collection pointCollection.Add (swSketchPoint.y) \u0026#39; Add Z co-ordinate of current point into collection pointCollection.Add (swSketchPoint.z) Next i \u0026#39; Create an array variable, this is Double type variable Dim point() As Double \u0026#39; Define the size of array Dynamically ReDim point(0 To pointCollection.Count) As Double \u0026#39; Loop through the collection we have For i = 0 To (pointCollection.Count - 1) \u0026#39; Add each item of collection into our array variable point(i) = pointCollection(i + 1) Next i \u0026#39; Create a local variable name \u0026#34;pointArray\u0026#34; of variant type Dim pointArray As Variant \u0026#39; Set the new created variable equal to point array variable pointArray = point \u0026#39; Exit the sketch swSketchManager.InsertSketch True \u0026#39; De-select the sketch swDoc.ClearSelection2 True \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Insert a sketch into \u0026#34;Front Plane\u0026#34; swSketchManager.InsertSketch True \u0026#39; Set the value of Solidworks Sketch segment by \u0026#34;CreateSpline2\u0026#34; method from Solidworks sketch manager Set swSketchSegment = swSketchManager.CreateSpline2((pointArray), True) \u0026#39; De-select the Spline after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 \u0026#39; Exit the sketch swSketchManager.InsertSketch True \u0026#39; Force Re-build the model swDoc.Rebuild (swRebuildOptions_e.swForceRebuildAll) End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Creating variable for Solidworks Sketch Dim swSketch As SldWorks.Sketch\rIn this line, we are creating a variable which we named as swSketch and the type of this swSketch variable is SldWorks.Sketch.\nWe create variable swSketch for Solidworks Sketches.\nTo see methods and properties related to Sketch object, please visit this page of Solidworks API Help\n\u0026#39; Creating variable for Solidworks Sketch Point Dim swSketchPoint As SldWorks.SketchPoint\rIn this line, we are creating a variable which we named as swSketchPoint and the type of this swSketchPoint variable is SldWorks.SketchPoint.\nWe create variable swSketchPoint for Solidworks Sketch Points.\nTo see methods and properties related to SketchPoint object, please visit this page of Solidworks API Help\n\u0026#39; Creating variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment\rIn this line, we are creating a variable which we named as swSketchSegment and the type of this swSketchSegment variable is SldWorks.SketchSegment.\nWe create variable swSketchSegment for Solidworks Sketch Segments.\nTo see methods and properties related to swSketchSegment object, please visit this page of Solidworks API Help\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure named as main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable swApp which we defined earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, holds the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor more detailed information about above lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout this post if you don\u0026rsquo;t understand above code.\n\u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\nI have discussed about different Selection methods in details in Soldworks Macros - Selection Methods post, so do visit this post for more Selection methods.\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Solidworks Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert/exit a sketch in selected plane.\nNow I have created a sequence of Points for our Spline.\nBecause if you already have co-ordinates of points in your machine somewhere you can use the approach I shown here to create a Spline.\nTIP: I like to save co-ordinates in MS Excel file and then use it.\nCreating sequence of Points Below code shows how to create Sequence of Points.\n\u0026#39; Create integer type local variable Dim i As Integer \u0026#39; Loop through 0 to 10 For i = 0 To 10 \u0026#39; Create integer type variables Dim x, y, z, incrementFactor As Integer \u0026#39; Set value of incrementFactor incrementFactor = i * 0.5 \u0026#39; Set value of x co-ordinate x = i \u0026#39; Set value of y co-ordinate y = x + incrementFactor \u0026#39; Set value of z co-ordinate z = 0 \u0026#39; Create a Sketch Point using x, y \u0026amp; z variables Set swSketchPoint = swSketchManager.CreatePoint(x, y, z) Next i \u0026#39; De-select the points after creation swDoc.ClearSelection2 True\rLet us understand each line of code and how above Lines of code creates a number of points.\n\u0026#39; Create integer type local variable Dim i As Integer\rIn above line, we create a local variable named i of integer type.\n\u0026#39; Looping through 1 to 10 For i = 0 To 10 Next\rIn above lines, we create a For loop.\nThis loop iterate the value of i variable from 0 -\u0026gt; 10.\nI use max value of 10, because I want to create 10 points.\n\u0026#39; Create integer type variables Dim x, y, z, incrementFactor As Integer \u0026#39; Set value of incrementFactor incrementFactor = i * 0.5 \u0026#39; Setting values of x, y and z x = i y = x + incrementFactor z = 0\rIn above lines, we 1st declare 4 variable x, y, z and incrementFactor of integer type.\nx, y and z are co-ordinates of a single point in X, Y and Z direction.\nincrementFactor is the factor by which I want to increase the value of Y co-ordinate of a single point.\n\u0026#39; Set value of incrementFactor incrementFactor = i * 0.5\rIn above line, I set the value of incrementFactor.\nThis value is 0.5 times of value of i variable.\nExample: i = 3 then incrementFactor = 3 * 0.5 =\u0026gt; incrementFactor = 1.5\nIn next 3 lines, we set the values of x, y and z.\nFor all points, we set the value of z to 0 because we want to place our points in X-Y plane.\nIf the value of i = 0, then we set the value of x equal to i.\nThis makes x = 0 also.\nNow, we set the value of y which is equal to SUM of x and incrementFactor.\nHence for i = 0, x = 0, y = 0 and incrementFactor = 0.\nFor i = 1, x = 1, y = 1.5 and incrementFactor = 0.5.\n\u0026#39; Create a Sketch Point using x, y \u0026amp; z variables Set swSketchPoint = swSketchManager.CreatePoint(x, y, z)\rIn above line, we create a Point using CreatePoint function of swSketchManager variable with the values of x, y and z.\n\u0026#39; De-select the Points after creation swDoc.ClearSelection2 True\rIn the this line of code, we de-select the created Points.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document variable swDoc.\nCreate a Collection of Points Co-ordinates After creating points, I want to do following things:\nGet all points in this sketch\nAdd co-ordinates of each point into a collection\nWhy I want to do this when I already know co-ordinates of all points in previous section?\nIt is because I create points from this macro hence I know their co-ordinates.\nI can add them to collection there BUT I want to take this opportunity to show following things:\nHow you get points of an Sketch.\nHow to create a Collection and Add values in it.\nBelow code shows how to do all those things.\n\u0026#39; Set Solidworks Sketch variable to active sketch Set swSketch = swSketchManager.ActiveSketch \u0026#39; Create variant type variable named \u0026#34;sketchPointArray\u0026#34; Dim sketchPointArray As Variant \u0026#39; Get all the points in this active sketch and store them into our variant type variable sketchPointArray = swSketch.GetSketchPoints2() \u0026#39; Creating a new Collection, \u0026#39; we use this collecction to store x,y,z co-ordinates of all sketch points Dim pointCollection As New Collection \u0026#39; Loop through all points in \u0026#34;sketchPointArray\u0026#34; For i = 0 To UBound(sketchPointArray) \u0026#39; Set Solidworks sketch point variable to current point Set swSketchPoint = sketchPointArray(i) \u0026#39; Add X co-ordinate of current point into collection pointCollection.Add (swSketchPoint.x) \u0026#39; Add Y co-ordinate of current point into collection pointCollection.Add (swSketchPoint.y) \u0026#39; Add Z co-ordinate of current point into collection pointCollection.Add (swSketchPoint.z) Next i\rLet us understand each line of code.\n\u0026#39; Set Solidworks Sketch variable to active sketch Set swSketch = swSketchManager.ActiveSketch\rIn the above line, I set the value of Solidworks Sketch variable swSketch to active sketch.\nFor this we use ActiveSketch method of Solidworks Sketch Manager variable swSketchManager.\nThis method give us a SldWorks.Sketch type return value which we store into swSketch variable.\n\u0026#39; Create variant type variable named \u0026#34;sketchPointArray\u0026#34; Dim sketchPointArray As Variant \u0026#39; Get all the points in this active sketch and store them into our variant type variable sketchPointArray = swSketch.GetSketchPoints2()\rIn 1st line of above code, I create a variable sketchPointArray.\nThis variable is Variant type variable.\nIn 2nd line of above code, I set the value of variable sketchPointArray using GetSketchPoints2() method.\nWe use GetSketchPoints2() method from our Solidworks Sketch type variable swSketch.\nGetSketchPoints2() method gives us all points in this sketch and we store those points into sketchPointArray variable.\n\u0026#39; Creating a new Collection, \u0026#39; we use this collecction to store x,y,z co-ordinates of all sketch points Dim pointCollection As New Collection\rIn the above line, I create variable pointCollection of Collection type.\n\u0026#39; Loop through all points in \u0026#34;sketchPointArray\u0026#34; For i = 0 To UBound(sketchPointArray) Next i\rIn above lines, we create a For loop.\nThis loop iterate the value of i variable from 0 -\u0026gt; UBound(sketchPointArray).\nI use max value of UBound(sketchPointArray), because I want to iterate through Maximum number of points we get from the GetSketchPoints2() method.\nIf number of points are other than 10, then UBound(sketchPointArray) method return only that number of points.\nHence it is useful to know for future use.\n\u0026#39; Set Solidworks sketch point variable to current point Set swSketchPoint = sketchPointArray(i)\rNow inside, this loop in 1st line we set Solidworks sketch point variable to current point of sketchPointArray.\n\u0026#39; Add X co-ordinate of current point into collection pointCollection.Add (swSketchPoint.x) \u0026#39; Add Y co-ordinate of current point into collection pointCollection.Add (swSketchPoint.y) \u0026#39; Add Z co-ordinate of current point into collection pointCollection.Add (swSketchPoint.z)\rIn above 3 lines, we add X, Y and Z co-ordinates of current point into our collection.\nPreparing Co-ordinates of Points You know from For Experience Macro Developers section, we need an Array of PointData.\nThis array contains X, Y and Z co-ordinates for Spline Points.\nNow I tried to add X, Y and Z co-ordinates directly into an Array and then use this array to create Spline.\nBut it did not work, hence I had to store all X, Y and Z co-ordinates 1st into Collection.\nNow I have all co-ordinates in my Collection and I have to create an Array for Spline from this Collection.\nBelow code sample show how to prepare Co-ordinate points for Spline.\n\u0026#39; Create an array variable, this is Double type variable Dim point() As Double \u0026#39; Define the size of array Dynamically ReDim point(0 To pointCollection.Count) As Double \u0026#39; Loop through the collection we have For i = 0 To (pointCollection.Count - 1) \u0026#39; Add each item of collection into our array variable point(i) = pointCollection(i + 1) Next i \u0026#39; Create a local variable name \u0026#34;pointArray\u0026#34; of variant type Dim pointArray As Variant \u0026#39; Set the new created variable equal to point array variable pointArray = point \u0026#39; Exit the sketch swSketchManager.InsertSketch True \u0026#39; De-select the sketch swDoc.ClearSelection2 True\rLet us understand each line of above code sample.\n\u0026#39; Create an array variable, this is Double type variable Dim point() As Double \u0026#39; Define the size of array Dynamically ReDim point(0 To pointCollection.Count) As Double\rIn above code, 1st line creates an Array variable. This is double type variable.\nIf you don\u0026rsquo;t know what an array is, then please visit VBA Arrays post.\nIn 2nd line, we define the size of array. This size is dynamic means it automatic in nature.\nWe don\u0026rsquo;t have to give exact value every time, this code adjust the values if there is any change in our Collection.\nThis size of this array is from 0 to Number of Co-ordinates in the collection.\nIn our case size of array is 0 -\u0026gt; 30.\n\u0026#39; Loop through the collection we have For i = 0 To (pointCollection.Count - 1) \u0026#39; Add each item of collection into our array variable point(i) = pointCollection(i + 1) Next i\rIn above code we 1st create a Loop.\nThis Loop iterate from 0 to pointCollection.Count - 1.\nWhy pointCollection.Count - 1 ? It is because pointCollection.Count starts from 1 and our loop start with 0.\nBecause of additional 1 count in pointCollection, we need to remove 1 from the count.\nInside this loop, we add every item of pointCollection into our point() array.\n\u0026#39; Create a local variable name \u0026#34;pointArray\u0026#34; of variant type Dim pointArray As Variant \u0026#39; Set the new created variable equal to point array variable pointArray = point\rIn 1st line of above code, we create local variable \u0026ldquo;pointArray\u0026rdquo;. This variable is Variant type.\nIn 2nd line of above code, we set the value of variable \u0026ldquo;pointArray\u0026rdquo; to value of variable \u0026ldquo;point\u0026rdquo;.\n\u0026#39; Exit the sketch swSketchManager.InsertSketch True \u0026#39; De-select the sketch swDoc.ClearSelection2 True\rIn 1st line of above code, we Exit the sketch.\nIn 2nd line of above code, we De-select the sketch.\nCreate Spline Now we have all information available for creating a Spline.\nBelow code sample shows how to create a Spline.\n\u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Insert a sketch into \u0026#34;Front Plane\u0026#34; swSketchManager.InsertSketch True \u0026#39; Set the value of Solidworks Sketch segment by \u0026#34;CreateSpline2\u0026#34; method from Solidworks sketch manager Set swSketchSegment = swSketchManager.CreateSpline2((pointArray), True) \u0026#39; De-select the Spline after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 \u0026#39; Exit the sketch swSketchManager.InsertSketch True \u0026#39; Force Re-build the model swDoc.Rebuild (swRebuildOptions_e.swForceRebuildAll)\rLet us understand each line of above code sample.\n\u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\nI have discussed about different Selection methods in details in Soldworks Macros - Selection Methods post, so do visit this post for more Selection methods.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert/exit a sketch in selected plane.\n\u0026#39; Set the value of Solidworks Sketch segment by \u0026#34;CreateSpline2\u0026#34; method from Solidworks sketch manager Set swSketchSegment = swSketchManager.CreateSpline2((pointArray), True)\rIn above line we set the value of Solidworks Sketch segment variable swSketchSegment.\nFor this we use, CreateSpline2 method from Solidworks sketch manager variable swSketchManager.\nThis CreateSpline2 method takes following parameters as explained:\nPointData : Array of X,Y,Z point coordinates to use in creating the spline.\nSimulateNaturalEnds : True to simulate natural ends, false to not simulate natural ends.\nBelow Image described the Parameters for a Spline.\nIn this CreateSpline2 method, we pass our pointArray variable as PointData.\nWe want our spline to simulate natural ends. Hence we True as second parameter.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means \u0026ldquo;inches\u0026rdquo; for distance.\nBut when I used Solidworks API through VBA macros or C#, I have to use converted numeric values.\nBecause Solidworks API output the distance in Meter only; which is not my requirement.\n\u0026#39; De-select the Spline after creation swDoc.ClearSelection2 True\rIn above line, we de-select the created Spline.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document variable swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn above line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\n\u0026#39; Exit the sketch swSketchManager.InsertSketch True\rIn above line, we exit the sketch.\n\u0026#39; Force Re-build the model swDoc.Rebuild (swRebuildOptions_e.swForceRebuildAll)\rIn above line, we Force Re-build the model the model.\nFor \u0026ldquo;Force Re-build\u0026rdquo; we use Rebuild method from Solidworks Document variable swDoc.\nIn this Rebuild method, we use swRebuildOptions_e.swForceRebuildAll option for re-build all.\nThis is it !!!\nIt is a BIG post but I tried to explain all.\nIf you found anything to add or update, please let me know on my e-mail.\nVBA Language feature used in this post In this post used some features of VBA programming language.\nThis section of post, has some brief information about the VBA programming language specific features.\nWe use Option Explicit for capturing un-declared variables. If you want to read more about Option Explicit then please visit Declaring and Scoping of Variables.\nThen we create variable for different data types. If you don\u0026rsquo;t know about them, then please visit Variables and Data-types posts of this blog. These posts will help you to understand what Variables are and how to use them.\nThen we create main Sub procedure for our macro. If you don\u0026rsquo;t know about the Sub procedure, then I suggest you to visit VBA Sub and Function Procedures and Executing Sub and Function Procedures posts of this blog. These posts will help you to understand what Procedures are and how to use them.\nIn most part we create some variables and set their values. We set those values by using some functions provided from objects. If you don\u0026rsquo;t know about the functions, then you should visit VBA Functions and VBA Functions that do more posts of this blog. These posts will help you to understand what functions are and how to use them.\nFor creating a sequence of points and data for Spline, we use a For-Next loop. We use a loop to set values of x, y and z co-ordinates of each points. If you don\u0026rsquo;t know about the For-Next loop, then you should visit VBA Looping post of this blog. This posts will help you to understand what For-Next loop are and how to use them.\nFor storing co-ordinates of points we use Collection. In an Collection, we store objects or data. This is very helpful and important language feature. If you don\u0026rsquo;t know about the Collection, then you should visit Collections (Visual Basic) from Microsoft Official Document Website. This will help you to understand what Collection are and how to use them.\nFor creating Spline we use an Array. An Array is similar to Collection, in which we store objects or data. But Array is more basic version actually Array is a basic programming feature and used frequently C and C++ programming languages. This is also very helpful and important language feature. If you don\u0026rsquo;t know about the Array, then you should visit Arrays in Visual Basic from Microsoft Official Document Website. This will help you to understand what Array are and how to use them.\nSolidworks API Objects In this post, for creating a Point, we use Solidworks API objects and their methods.\nThis section contains the list of all Solidworks Objects used in this post.\nI have also attached links of these Solidworks API Objects in API Help website.\nIf you want to explore those objects, you can use these links.\nThese Solidworks API Objects are listed below:\nSolidworks Application Object If you want explore Properties and Methods/Functions of Solidworks Application Object object you can visit this link.\nSolidworks Document Object If you want explore Properties and Methods/Functions of Solidworks Document Object object you can visit this link.\nSolidworks Sketch Manager Object If you want explore Properties and Methods/Functions of Solidworks Sketch Manager Object you can visit this link.\nSolidworks Sketches Object If you want explore Properties and Methods/Functions of Solidworks Sketches Object you can visit this link.\nSolidworks Sketch Point Object If you want explore Properties and Methods/Functions of Solidworks Sketch Point Object you can visit this link.\nSolidworks Sketch Segment Object If you want explore Properties and Methods/Functions of Solidworks Sketch Segment Object you can visit this link.\nHope this post helps you to create a Spline in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":106,"permalink":"/solidworks-macros/create-spline/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create a Spline through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e\n\u003cp\u003eThis post take some functionality from previous \u003cstrong\u003e\u003ca href=\"/solidworks-macros/create-point\"\u003eSketch - Create Create a Point\u003c/a\u003e\u003c/strong\u003e post.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create a Spline"},{"content":"If your VBA procedure needs to ask the user for a filename, you could use the InputBox function.\nAn input box usually isn‚Äôt the best tool for this job, however, because most users find it difficult to remember paths, backslashes, filenames, and file extensions.\nIn other words, it‚Äôs far too easy to make a typographical error when typing a filename.\nFor a better solution to this problem, use the GetOpenFilename method of the Application object, which ensures that your code gets its hands on a valid filename, including its complete path.\nThe GetOpenFilename method displays the familiar Open dialog box.\nThe GetOpenFilename method doesn‚Äôt actually open the specified file.\nThis method simply returns the user-selected filename as a string.\nThen you can write code to do whatever you want with the filename.\nSyntax for the GetOpenFilename method The official syntax for the GetOpenFilename method is as follows:\nvba\r1\u0026#39; The GetOpenFilename method syntax 2object.GetOpenFilename ([fileFilter], [filterIndex], [title],[buttonText], [multiSelect])\rThe GetOpenFilename method takes the optional arguments shown in below Table.\nArguments What it does FileFilter Determines the types of files that appear in the dialog box (for example, *.TXT). You can specify several different filters from which the user can choose. FilterIndex Determines which of the file filters the dialog box displays by default. Title Specifies the caption for the dialog box‚Äôs title bar. ButtonText Ignored MultiSelect If True, the user can select multiple files. A GetOpenFilename example The fileFilter argument determines what appears in the dialog box‚Äôs Files of Type drop-down list.\nThis argument consists of pairs of file filter strings followed by the wild card file filter specification, with commas separating each part and pair.\nIf omitted, this argument defaults to the following:\nvba\r1\u0026#39; A GetOpenFilename example 2All Files (*.*), *.*\rNotice that this string consists of two parts:\nvba\r1All Files (*.*)\rand\nvba\r1*.*\rThe first part of this string is the text displayed in the Files of Type dropdown list.\nThe second part determines which files the dialog box displays. For example, . means all files.\nThe code in the following example brings up a dialog box that asks the user for a filename.\nThe procedure defines five file filters.\nNotice that I use the VBA line continuation sequence to set up the Filter variable; doing so helps simplify this rather complicated argument.\nvba\r1\u0026#39; A GetOpenFilename example 2Sub GetImportFileName() 3 Dim Finfo As String 4 Dim FilterIndex As Integer 5 Dim Title As String 6 Dim FileName As Variant 7 8 \u0026#39;Set up list of file filters 9 If (IsNumeric)NumberOfSheets Then 10 FInfo = \u0026#34;Text Files (*.txt),*.txt,\u0026#34; \u0026amp; _ 11 \u0026#34;Lotus Files (*.prn),*.prn,\u0026#34; \u0026amp; _ 12 \u0026#34;Comma Separated Files (*.csv),*.csv,\u0026#34; \u0026amp; _ 13 \u0026#34;ASCII Files (*.asc),*.asc,\u0026#34; \u0026amp; _ 14 \u0026#34;All Files (*.*),*.*\u0026#34; 15 16 \u0026#39;Display *.* by default 17 FilterIndex = 5 18 19 \u0026#39;Set the dialog box caption 20 Title = \u0026#34;Select a File to Import\u0026#34; 21 22 \u0026#39;Get the filename 23 FileName = Application.GetOpenFilename (FInfo, FilterIndex, Title) 24 25 \u0026#39;Handle return info from dialog box 26 If FileName = False Then 27 MsgBox \u0026#34;No file was selected.\u0026#34; 28 Else 29 MsgBox \u0026#34;You selected \u0026#34; \u0026amp; FileName 30 End If 31End Sub\rNotice that the FileName variable is declared as a Variant data type.\nIf the user clicks Cancel, that variable contains a Boolean value (False).\nOtherwise, FileName is a string. Therefore, using a Variant data type handles both possibilities.\nGetSaveAsFilename Method The GetSaveAsFilename method works just like the GetOpenFilename method, but it displays the Save As dialog box rather than its Open dialog box.\nThe GetSaveAsFilename method gets a path and filename from the user but doesn‚Äôt do anything with it.\nIt‚Äôs up to you to write code that actually saves the file.\nThe syntax for this method follows:\nvba\r1\u0026#39; The GetSaveAsFilename method syntax 2object.GetSaveAsFilename ([InitialFilename], [FileFilter], [FilterIndex], [Title], [ButtonText])\rThe GetSaveAsFilename method takes below arguments, all of which are optional.\nArguments What it does InitialFileName Specifies a default filename that appears in the File Name box. FileFilter Determines the types of files that appear in the dialog box (for example, *.TXT). You can specify several different filters from which the user can choose. FilterIndex Determines which of the file filters the dialog box displays by default. Title Specifies the caption for the dialog box‚Äôs title bar. Getting a Folder Name Sometimes, you don‚Äôt need to get a filename; you just need to get a folder name.\nIf that‚Äôs the case, the FileDialog object is just what the doctor ordered.\nThe following procedure displays a dialog box that allows the user to select a directory.\nThe selected directory name (or ‚ÄúCanceled‚Äù) is then displayed by using the MsgBox function.\nvba\r1\u0026#39; FileDialog example 2Sub GetAFolder() 3 With Application.FileDialog(msoFileDialogFolderPicker) 4 .InitialFileName = Application.DefaultFilePath \u0026amp; \u0026#34;\\\u0026#34; 5 .Title = \u0026#34;Please select a location for the backup\u0026#34; 6 .Show 7 If .SelectedItems.Count = 0 Then 8 MsgBox \u0026#34;Canceled\u0026#34; 9 Else 10 MsgBox .SelectedItems(1) 11 End If 12 End With 13End Sub\rThe FileDialog object lets you specify the starting directory by specifying a value for the InitialFileName property.\nIn this case, the code uses default file path as the starting directory.\nNext post will be about VBA UserForms.\n","date":"0001-01-01","id":107,"permalink":"/vba/other-dialogs/","summary":"\u003cp\u003eIf your VBA procedure needs to ask the user for a filename, you could use the \u003cem\u003eInputBox\u003c/em\u003e function.\u003c/p\u003e\n\u003cp\u003eAn input box usually isn‚Äôt the best tool for this job, however, because most users find it difficult to remember paths, backslashes, filenames, and file extensions.\u003c/p\u003e","tags":[],"title":"VBA GetOpenFilename, GetSaveAsFilename and Getting a Folder Name"},{"content":"","date":"2023-09-07","id":108,"permalink":"/solidworks-macros/27-drawing---insert-views/","summary":"","tags":[],"title":"Drawing - Insert Views"},{"content":"In this post, I tell you about how to create a Fillet through Solidworks VBA Macros in a sketch.\nThis post is an extension of Sketch - Create Corner Rectangle post.\nVideo of Code on YouTube Please see below video how visually we can create a Fillet from Solidworks VBA macro.\nPlease note that there are no explaination given in the video.\nExplaination of each line and why we write code this way is given in this post.\nFor Experience Macro Developer If you are an experience Solidworks Macro developer, then you are looking for a specific code sample.\nBelow is the code for creating A Fillet from Solidworks VBA Macro.\n\u0026#39; Creating variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Set the value of Solidworks Sketch segment by \u0026#34;CreateFillet\u0026#34; method from Solidworks sketch manager Set swSketchSegment = swSketchManager.CreateFillet(0.1, swConstrainedCornerAction_e.swConstrainedCornerDeleteGeometry)\rFor creating a Fillet first you need to Create a variable of SketchSegment type.\nAfter creating variable, you need to set the value of this variable.\nFor this you used CreateFillet method from Solidworks Sketch Manager.\nThis CreateFillet method set the value of SketchSegment type variable.\nThis CreateFillet method takes following parameters as explained:\nRadius : Radius of the fillet in meters.\nConstrainedCorners : Action to take if the corner to be filleted is constrained or has a dimension.\nIf you want a more detail explaination then please read further otherwise this will help you to Create a Fillet From VBA Macro.\nFor Beginners Macro Developers In this post, I tell you about CreateFillet method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a Fillet.\nBelow is the code sample for creating a Fillet.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Creating Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating a \u0026#34;Variant\u0026#34; Variable which holds the values return by \u0026#34;CreateCornerRectangle\u0026#34; method Dim vSketchLines As Variant \u0026#39; Creating a Corner Rectangle vSketchLines = swSketchManager.CreateCornerRectangle(0, 1, 0, 1, 0, 0) \u0026#39; De-select the lines after creation swDoc.ClearSelection2 True \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Point1\u0026#34;, \u0026#34;SKETCHPOINT\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set the value of Solidworks Sketch segment by \u0026#34;CreateFillet\u0026#34; method from Solidworks sketch manager Set swSketchSegment = swSketchManager.CreateFillet(0.1, swConstrainedCornerAction_e.swConstrainedCornerDeleteGeometry) \u0026#39; De-select the Fillet after creation swDoc.ClearSelection2 True \u0026#39; Show Front View after creating Fillet swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Creating variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment\rIn this line, we are creating a variable which we named as swSketchSegment and the type of this swSketchSegment variable is SldWorks.SketchSegment.\nWe create variable swSketchSegment for Solidworks Sketch Segments.\nTo see methods and properties related to swSketchSegment object, please visit this page of Solidworks API Help\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure named main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable which we define earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue(). This method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout this post if you don\u0026rsquo;t understand above code.\n\u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating a \u0026#34;Variant\u0026#34; Variable which holds the values return by \u0026#34;CreateCornerRectangle\u0026#34; method Dim vSketchLines As Variant \u0026#39; Creating a Corner Rectangle vSketchLines = swSketchManager.CreateCornerRectangle(0, 1, 0, 1, 0, 0)\rIn above sample code, we 1st create a variable named vSketchLines of type Variant.\nA Variant type variable can hold any type of value depends upon the use of variable.\nIn 2nd line, we set the value of variable vSketchLines.\nValue of vSketchLinesis an array of lines. This array is send as return value when we use CreateCornerRectangle method.\nThis CreateCornerRectangle method is part of swSketchManager and it is the latest method to create a corner rectangle.\nFor detail explaination on CreateCornerRectangle method, please see Sketch - Create Corner Rectangle post.\nIn the above code sample I have used (0, 1, 0) Upper-left point in Y-direction.\nFor Lower-right point I used (1, 0, 0) which is 1 point distance in X-direction.\n\u0026#39; De-select the Rectangle after creation swDoc.ClearSelection2 True\rIn above line, we de-select the ractangle we just create.\n\u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Set the value of Solidworks Sketch segment by \u0026#34;CreateFillet\u0026#34; method from Solidworks sketch manager Set swSketchSegment = swSketchManager.CreateFillet(0.1, swConstrainedCornerAction_e.swConstrainedCornerDeleteGeometry)\rIn above line, we set the value of Solidworks Sketch Segment variable swSketchSegment by CreateFillet method from Solidworks Sketch Manager.\nThis CreateFillet method takes following parameters:\nRadius : Radius of the fillet in meters.\nConstrainedCorners : Action to take if the corner to be filleted is constrained or has a dimension.\nBelow Image described the Parameters for a Fillet.\nIn our code, I have used following values:\nRadius : I have used 0.1 (This value is in meter) as the radius of fillet.\nConstrainedCorners : I have used swConstrainedCornerAction_e.swConstrainedCornerDeleteGeometry enumerator as value for constraining corners.\nIn swConstrainedCornerAction_e we have 4 constant values.\nThese values are as follows:\nswConstrainedCornerDeleteGeometry : 2 = Delete the constraint or dimension and add the fillet\nswConstrainedCornerInteract : 0 = Ask the user whether to delete the geometry or stop processing\nswConstrainedCornerKeepGeometry : 1 = Keep the constraint or dimension by creating a virtual intersection point before adding the fillet\nswConstrainedCornerStopProcessing : 3 = Do not delete the constrain or dimension and do not create the fillet\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means inches for distance. But when I used Solidworks API through VBA macros or C#, I need to use converted numeric values.\nBecause Solidworks API output the distance in Meter which is not my requirement.\n\u0026#39; De-select the Fillet after creation swDoc.ClearSelection2 True\rIn the above line of code, we deselect the Fillet we have created.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Show Front View after creating Fillet swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView\rIn the above line of code, we update the view orientation to Front View.\nIn my machine, after inserting a sketch view orientation does not changed.\nBecause of this I have to update the view to Front view.\nFor showing Front View we used ShowNamedView2 method from our Solidworks document name swDoc.\nThis method takes 2 parameter described as follows:\nVName : Name of the view to display or an empty string to use ViewId instead\nViewId : ID of the view to display as defined by swStandardViews_e or -1 to use the VName argument instead.\nNOTE: If you specify both VName and ViewId, then ViewId takes precedence if the two arguments do not resolve to the same view.\nswStandardViews_e has following Standard View Types:\nswBackView\nswBottomView\nswDimetricView\nswFrontView\nswIsometricView\nswLeftView\nswRightView\nswTopView\nswTrimetricView\nIn our code, we did not use VName instead I used empty string in form of \u0026quot;\u0026quot; symbol.\nI used ViewId value to specify view and used swStandardViews_e.swFrontView value to use Standard Front View.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nThis is it !!!\nIf you found anything to add or update, please let me know on my e-mail.\nVBA Language feature used in this post In this post used some features of VBA programming language.\nThis section of post, has some brief information about the VBA programming language specific features.\nWe use Option Explicit for capturing un-declared variables. If you want to read more about Option Explicit then please visit Declaring and Scoping of Variables.\nThen we create variable for different data types. If you don\u0026rsquo;t know about them, then please visit Variables and Data-types posts of this blog. These posts will help you to understand what Variables are and how to use them.\nThen we create main Sub procedure for our macro. If you don\u0026rsquo;t know about the Sub procedure, then I suggest you to visit VBA Sub and Function Procedures and Executing Sub and Function Procedures posts of this blog. These posts will help you to understand what Procedures are and how to use them.\nIn most part we create some variables and set their values. We set those values by using some functions provided from objects. If you don\u0026rsquo;t know about the functions, then you should visit VBA Functions and VBA Functions that do more posts of this blog. These posts will help you to understand what functions are and how to use them.\nSolidworks API Objects In this post, for creating a Fillet, we use Solidworks API objects and their methods.\nThis section contains the list of all Solidworks Objects used in this post.\nI have also attached links of these Solidworks API Objects in API Help website.\nIf you want to explore those objects, you can use these links.\nThese Solidworks API Objects are listed below:\nSolidworks Application Object If you want explore Properties and Methods/Functions of Solidworks Application Object object you can visit this link.\nSolidworks Document Object If you want explore Properties and Methods/Functions of Solidworks Document Object object you can visit this link.\nSolidworks Sketch Manager Object If you want explore Properties and Methods/Functions of Solidworks Sketch Manager Object you can visit this link.\nSolidworks Sketch Segment Object If you want explore Properties and Methods/Functions of Solidworks Sketch Segment Object you can visit this link.\nHope this post helps you to create a Fillet in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":109,"permalink":"/solidworks-macros/create-sketch-fillet/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create a Fillet through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e\n\u003cp\u003eThis post is an extension of \u003cstrong\u003e\u003ca href=\"/solidworks-macros/create-corner-rectangle\"\u003eSketch - Create Corner Rectangle\u003c/a\u003e\u003c/strong\u003e post.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create a Fillet"},{"content":"A UserForm is useful if your VBA macro needs to get information from a user.\nFor example, your macro may have some options that can be specified in a UserForm.\nIf only a few pieces of information are required (for example, a Yes/No answer or a text string), one of the techniques I describe in previous articles may do the job.\nBut if you need to obtain more information, you must create a UserForm.\nTo create a UserForm, you usually take the following general steps:\nDetermine how the dialog box will be used and where it will be displayed in your VBA macro.\nActivate the VBE and insert a new UserForm object. A UserForm object holds a single UserForm.\nAdd controls to the UserForm. Controls include items such as text boxes, buttons, check boxes, and list boxes.\nUse the Properties window to modify the properties for the controls or for the UserForm itself.\nWrite event-handler procedures for the controls (for example, a macro that executes when the user clicks a button in the dialog box). These procedures are stored in the Code window for the UserForm object.\nWrite a procedure (stored in a VBA module) that displays the dialog box to the user.\nWhen you are designing a UserForm, you are creating what developers call the Graphical User Interface (GUI) to your application.\nTake some time to consider what your form should look like and how your users are likely to want to interact with the elements on the UserForm.\nTry to guide them through the steps they need to take on the form by carefully considering the arrangement and wording of the controls.\nLike most things VBA-related, the more you do it, the easier it gets.\nUserforms Working Each dialog box that you create is stored in its own UserForm object ‚Äî one dialog box per UserForm.\nYou create and access these UserForms in the Visual Basic Editor.\nInserting a new UserForm To insert a UserForm object with the following steps:\nIn the macro, you can insert User form with following 2 ways: From \u0026ldquo;Menu Bar\u0026rdquo; -\u0026gt; \u0026ldquo;UserForm\u0026rdquo;\nFrom ‚ÄúStandard Toolbar‚Äù by clicking ‚ÄúInsert UserForm‚Äù The VBE insert a new UserForm object with an empty dialog box.\nIf ‚ÄúProperty window‚Äù is not available in your macro, press F4 to display ‚ÄúProperty window‚Äù. The VBE inserts a new UserForm object, which contains an empty dialog box.\nBelow figure shows a UserForm ‚Äî an empty dialog box with some controls in Toolbox.\nAdding controls to a UserForm When you activate a UserForm, the VBE displays the Toolbox in a floating window, as shown in above figure.\nYou use the tools in the Toolbox to add controls to your UserForm.\nIf the Toolbox doesn‚Äôt appear when you activate your UserForm, choose View -\u0026gt; Toolbox.\nTo add a control, just click the desired control in the Toolbox and drag it into the dialog box to create the control.\nAfter you add a control, you can move and resize it by using standard techniques.\nBelow table indicates the various tools, as well as their capabilities.\nTo determine which tool is which, hover your mouse pointer over the control and read the small pop-up description.\nControls What it does Label Shows text TextBox Determines which of the file filters the dialog box displays by default. ComboBox Display a drop-down list. ListBox Display a list of items. CheckBox Useful for On/off or Yes/No options. OptionButton Used in groups; allows the user to select one of several options. ToggleButoon A button that is either on or off. Frame A container for other control. CommandButton A clickable button. TabStrip Display Tabs MultiPage A tabbed container for other objects. ScrollBar A draggable bar. SpinButton A clickable button often used for changing a value. Image Contains an image RefEdit Allows the user to select a range. Changing properties for a UserForm control Every control you add to a UserForm has a number of properties that determine how the control looks or behaves.\nIn addition, the UserForm itsel also has its own set of properties.\nYou can change these properties with the Properties window.\nBelow figure shows the properties window when a CommandButton control is selected:\nProperties for controls include the following:\nName Width Height Value Caption Each control has its own set of properties (although many controls have some common properties). To change a property using the Properties window:\nMake sure that the correct control is selected in the UserForm. Make sure the Properties window is visible (press F4 if it‚Äôs not). In the Properties window, click on the property that you want to change. Make the change in the right portion of the Properties window. If you select the UserForm itself (not a control on the UserForm), you can use the Properties window to adjust UserForm properties\nNote\nSome of the UserForm properties serve as default settings for new controls you drag onto the UserForm. For example, if you change the Font property for a UserForm, controls that you add will use that same font. Controls that are already on the UserForm are not affected.\nViewing the UserForm Code window Every UserForm object has a Code module that holds the VBA code (the event-handler procedures) executed when the user works with the dialog box.\nTo view the Code module, press F7.\nThe Code window is empty until you add some procedures. Press Shift+F7 to return to the dialog box.\nHere‚Äôs another way to switch between the Code window and the UserForm display:\nUse the View Code and View Object buttons in the Project window‚Äôs title bar.\nOr right-click the UserForm and choose View Code.\nIf you‚Äôre viewing code, double-click the UserForm name in the Project window to return to the UserForm.\nShowing the UserForm You display a UserForm by using the UserForm‚Äôs Show method in a VBA procedure.\nThe macro that displays the dialog box must be in a VBA module ‚Äî not in the Code window for the UserForm.\nThe following procedure displays the dialog box named UserForm1:\nvba\r1\u0026#39; Showing the UserForm 2Sub ShowDialogBox() 3 UserForm.Show 4 \u0026#39;Other statements can go here 5End Sub\rWhen Solidworks displays the dialog box, the ShowDialogBox macro halts until the user closes the dialog box.\nThen VBA executes any remaining statements in the procedure.\nMost of the time, you won‚Äôt have any more code in the procedure.\nUsing information from a UserForm The VBE provides a name for each control you add to a UserForm.\nThe control‚Äôs name corresponds to its Name property.\nUse this name to refer to a particular control in your code.\nFor example, if you add a CheckBox control to a UserForm named UserForm1, the CheckBox control is named CheckBox1 by default.\nThe following statement makes this control appear with a check mark:\nvba\r1UserForm1.CheckBox1.Value = True\rMost of the time, you write the code for a UserForm in the UserForm‚Äôs code module.\nIf that‚Äôs the case, you can omit the UserForm object qualifier and write the statement like this:\nvba\r1CheckBox1.Value = True\rNote\nI recommend that you change the default name the VBE has given to your controls to something more meaningful.\nThis will sum-up our tutorials on Visual Basic for Application. From now on I will give tutorials on how to use Solidworks commands with the help of VBA Macro.\nIf you want to know any explaination on any topic related to VBA, please drop a comment and I will try to give it to you.\nThank you!!!! UPDATE: I have started VBA UserForm Example in this tutorials lists.\nSo if you want to learn how I use these Forms, you can watch them in UserForm Example List Post.\n","date":"0001-01-01","id":110,"permalink":"/vba/userform/","summary":"\u003cp\u003eA \u003cem\u003eUserForm\u003c/em\u003e is useful if your VBA macro needs to get information from a user.\u003c/p\u003e\n\u003cp\u003eFor example, your macro may have some options that can be specified in a UserForm.\u003c/p\u003e","tags":[],"title":"VBA UserForms"},{"content":"","date":"2023-09-07","id":111,"permalink":"/solidworks-macros/28-drawing---view-position-and-boundary/","summary":"","tags":[],"title":"Drawing - View Position and Boundary"},{"content":"In this post, I tell you about how to create a Chamfer through Solidworks VBA Macros in a sketch.\nThis post is an extension of Sketch - Create Corner Rectangle post.\nVideo of Code on YouTube Please see below video how visually we can create a Chamfer from Solidworks VBA macro.\nPlease note that there are no explaination given in the video.\nExplaination of each line and why we write code this way is given in this post.\nFor Experience Macro Developer If you are an experience Solidworks Macro developer, then you are looking for a specific code sample.\nBelow is the code for creating A Chamfer from Solidworks VBA Macro.\n\u0026#39; Creating variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Set the value of Solidworks Sketch segment by \u0026#34;CreateChamfer\u0026#34; method from Solidworks sketch manager Set swSketchSegment = swSketchManager.CreateChamfer(swSketchChamferType_e.swSketchChamfer_DistanceEqual, 0.1, 0.2)\rFor creating a Chamfer first you need to Create a variable of SketchSegment type.\nAfter creating variable, you need to set the value of this variable.\nFor this you used CreateChamfer method from Solidworks Sketch Manager.\nThis CreateChamfer method set the value of SketchSegment type variable.\nThis CreateChamfer method takes following parameters as explained:\nType : Type of chamfer as defined in swSketchChamferType_e\nDistance : Distance of the chamfer\nAngleORdist : These are as follows\nIf Type = swSketchChamfer_DistanceDistance, then the second chamfer distance\nIf Type = swSketchChamfer_DistanceAngle, then the second chamfer angle\nIf Type = swSketchChamfer_DistanceEqual, then this argument is ignored because Distance is used for both edges\nIf you want a more detail explaination then please read further otherwise this will help you to Create a Chamfer From VBA Macro.\nFor Beginners Macro Developers In this post, I tell you about CreateChamfer method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a Chamfer.\nBelow is the code sample for creating a Chamfer.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Creating Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating a \u0026#34;Variant\u0026#34; Variable which holds the values return by \u0026#34;CreateCornerRectangle\u0026#34; method Dim vSketchLines As Variant \u0026#39; Creating a Corner Rectangle vSketchLines = swSketchManager.CreateCornerRectangle(0, 1, 0, 1, 0, 0) \u0026#39; De-select the lines after creation swDoc.ClearSelection2 True \u0026#39; Selecting Point 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Point1\u0026#34;, \u0026#34;SKETCHPOINT\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set the value of Solidworks Sketch segment by \u0026#34;CreateChamfer\u0026#34; method from Solidworks sketch manager Set swSketchSegment = swSketchManager.CreateChamfer(swSketchChamferType_e.swSketchChamfer_DistanceEqual, 0.1, 0.2) \u0026#39; De-select the Chamfer after creation swDoc.ClearSelection2 True \u0026#39; Show Front View after creating Chamfer swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we are creating a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we are creating a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Creating variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment\rIn this line, we are creating a variable which we named as swSketchSegment and the type of this swSketchSegment variable is SldWorks.SketchSegment.\nWe create variable swSketchSegment for Solidworks Sketch Segments.\nTo see methods and properties related to swSketchSegment object, please visit this page of Solidworks API Help\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure named main. This procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable which we define earlier to Solidworks application.\n\u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue(). This method is a part of our main Solidworks variable swApp.\n\u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout this post if you don\u0026rsquo;t understand above code.\n\u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating a \u0026#34;Variant\u0026#34; Variable which holds the values return by \u0026#34;CreateCornerRectangle\u0026#34; method Dim vSketchLines As Variant \u0026#39; Creating a Corner Rectangle vSketchLines = swSketchManager.CreateCornerRectangle(0, 1, 0, 1, 0, 0)\rIn above sample code, we 1st create a variable named vSketchLines of type Variant.\nA Variant type variable can hold any type of value depends upon the use of variable.\nIn 2nd line, we set the value of variable vSketchLines.\nValue of vSketchLinesis an array of lines. This array is send as return value when we use CreateCornerRectangle method.\nThis CreateCornerRectangle method is part of swSketchManager and it is the latest method to create a corner rectangle.\nFor detail explaination on CreateCornerRectangle method, please see Sketch - Create Corner Rectangle post.\nIn the above code sample I have used (0, 1, 0) Upper-left point in Y-direction.\nFor Lower-right point I used (1, 0, 0) which is 1 point distance in X-direction.\n\u0026#39; De-select the Rectangle after creation swDoc.ClearSelection2 True\rIn above line, we de-select the ractangle we just create.\n\u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Set the value of Solidworks Sketch segment by \u0026#34;CreateChamfer\u0026#34; method from Solidworks sketch manager Set swSketchSegment = swSketchManager.CreateChamfer(swSketchChamferType_e.swSketchChamfer_DistanceEqual, 0.1, 0.2)\rIn above line, we set the value of Solidworks Sketch Segment variable swSketchSegment by CreateChamfer method from Solidworks Sketch Manager.\nThis CreateChamfer method takes following parameters:\nType : Type of chamfer as defined in swSketchChamferType_e.\nThe swSketchChamferType_e has 3 values for type of chamfers:\nswSketchChamfer_DistanceAngle\nswSketchChamfer_DistanceDistance\nswSketchChamfer_DistanceEqual\nDistance : Distance of the chamfer\nAngleORdist : Angle or Distance for chamfer. These are as follows\nIf Type = swSketchChamfer_DistanceDistance, then the second chamfer distance\nIf Type = swSketchChamfer_DistanceAngle, then the second chamfer angle\nIf Type = swSketchChamfer_DistanceEqual, then this argument is ignored because Distance is used for both edges.\nBelow Image described the Parameters for a Chamfer.\nIn our code, I have used following values:\nType : I have used swSketchChamferType_e.swSketchChamfer_DistanceEqual enumerator as value for type of Chamfer.\nDistance : I have used 0.1 (This value is in meter) as the distance of Chamfer.\nAngleORdist : I have used 0.2 (This value is in meter). But in our code Type = swSketchChamfer_DistanceEqual, then this argument is ignored because Distance is used for both edges.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means inches for distance. But when I used Solidworks API through VBA macros or C#, I need to use converted numeric values.\nBecause Solidworks API output the distance in Meter which is not my requirement.\n\u0026#39; De-select the Fillet after creation swDoc.ClearSelection2 True\rIn the above line of code, we deselect the Chamfer we have created.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Show Front View after creating Chamfer swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView\rIn the above line of code, we update the view orientation to Front View.\nIn my machine, after inserting a sketch view orientation does not changed.\nBecause of this I have to update the view to Front view.\nFor showing Front View we used ShowNamedView2 method from our Solidworks document name swDoc.\nThis method takes 2 parameter described as follows:\nVName : Name of the view to display or an empty string to use ViewId instead\nViewId : ID of the view to display as defined by swStandardViews_e or -1 to use the VName argument instead.\nNOTE: If you specify both VName and ViewId, then ViewId takes precedence if the two arguments do not resolve to the same view.\nswStandardViews_e has following Standard View Types:\nswBackView\nswBottomView\nswDimetricView\nswFrontView\nswIsometricView\nswLeftView\nswRightView\nswTopView\nswTrimetricView\nIn our code, we did not use VName instead I used empty string in form of \u0026quot;\u0026quot; symbol.\nI used ViewId value to specify view and used swStandardViews_e.swFrontView value to use Standard Front View.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nThis is it !!!\nIf you found anything to add or update, please let me know on my e-mail.\nVBA Language feature used in this post In this post used some features of VBA programming language.\nThis section of post, has some brief information about the VBA programming language specific features.\nWe use Option Explicit for capturing un-declared variables. If you want to read more about Option Explicit then please visit Declaring and Scoping of Variables.\nThen we create variable for different data types. If you don\u0026rsquo;t know about them, then please visit Variables and Data-types posts of this blog. These posts will help you to understand what Variables are and how to use them.\nThen we create main Sub procedure for our macro. If you don\u0026rsquo;t know about the Sub procedure, then I suggest you to visit VBA Sub and Function Procedures and Executing Sub and Function Procedures posts of this blog. These posts will help you to understand what Procedures are and how to use them.\nIn most part we create some variables and set their values. We set those values by using some functions provided from objects. If you don\u0026rsquo;t know about the functions, then you should visit VBA Functions and VBA Functions that do more posts of this blog. These posts will help you to understand what functions are and how to use them.\nSolidworks API Objects In this post, for creating a Fillet, we use Solidworks API objects and their methods.\nThis section contains the list of all Solidworks Objects used in this post.\nI have also attached links of these Solidworks API Objects in API Help website.\nIf you want to explore those objects, you can use these links.\nThese Solidworks API Objects are listed below:\nSolidworks Application Object If you want explore Properties and Methods/Functions of Solidworks Application Object object you can visit this link.\nSolidworks Document Object If you want explore Properties and Methods/Functions of Solidworks Document Object object you can visit this link.\nSolidworks Sketch Manager Object If you want explore Properties and Methods/Functions of Solidworks Sketch Manager Object you can visit this link.\nSolidworks Sketch Segment Object If you want explore Properties and Methods/Functions of Solidworks Sketch Segment Object you can visit this link.\nHope this post helps you to create a Chamfer in Sketches with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":112,"permalink":"/solidworks-macros/create-sketch-chamfer/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create a Chamfer through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e\n\u003cp\u003eThis post is an extension of \u003cstrong\u003e\u003ca href=\"/solidworks-macros/create-corner-rectangle\"\u003eSketch - Create Corner Rectangle\u003c/a\u003e\u003c/strong\u003e post.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create a Chamfer"},{"content":"In this post, we learn how can we open a part document from a Visual Basic for Application\u0026rsquo;s Userform.\nFor this please we need to do following steps as described below.\nVideo of Code on YouTube Please see below video on Solidworks VBA Macro - Open new Part document in Solidwoks VBA Userforms.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCreate a new macro 1st we need to create a new macro in Solidworks 3D CAD Software.\nIf you don\u0026rsquo;t know how to create a new macro in Solidworks, please go to VBA in Solidworks post for this.\nThis will open a new macro in Visual Basic Editor with some code as shown in below image.\nInsert userform in the macro After this we need to insert a userform in our macro.\nFor this, select the button shown in below image.\nThis button is called insert userform.\nAs the name suggest, function of this button is inserting a userform.\nNote\nPlease note that in a macro we can insert any number of userform as we like. But for this example we insert only 1 userform.\nAfter clicking the insert userform button we get the userform window as shown in below image.\nAdding a Button Now in our userform window, we add a Command Button at center of window.\nYou can find Command Button highlighted in red in below image.\nYou can place command button at your desire. I placed it at center of the userform window as shown in below image.\nUpdating Properties of Command Button and Userform Windows Now we update some properties of Command Button and Userform Windows for our use.\nNote\nIt is not necessary to update properties but it is a good habit to update them for our purpose.\n1st we update the properties of Userform.\nIn below image, I have shown the properties of Userform1 and update following properties:\nName of Userform\nCaption of Userform\nUpdate the value of Name property from UserForm1 to OurWindow.\nNote\nFrom Name property, we access the Userform.\nUpdate the value of Caption property from UserForm1 to Our Window.\nNote\nFrom Caption property, we update the text appears in the window of our Userform.\nNow, we repeat the same process for Command Button.\n1st we need to select the Command Button in the user form after that we update same properties of Command Button.\nName of Command Button\nCaption of Command Button\nUpdate the value of Name property from CommandButton1 to OpenNewPartButton.\nNote\nFrom Name property, we access the Command Button.\nUpdate the value of Caption property from CommandButton1 to Open NewPart Button.\nNote\nFrom Caption property, we update the text appears in the Command Button of our Userform.\nAdd Functionality to Open NewPart Button To add functionality in our Open NewPart Button, just double click the Open NewPart Button.\nThis will add give some code behind the designer and opens the code window of Userform designer.\nvba\r1Private Sub OpenNewPartButton_Click() 2 3End Sub\rWe need to update this code for opening new part after clicking the button.\nFor this replace all above code with below code.\nvba\r1Option Explicit 2 3\u0026#39; Creating variable for Solidworks application 4Dim swApp As SldWorks.SldWorks 5\u0026#39; Creating variable for Solidworks document 6Dim swDoc As SldWorks.ModelDoc2 7 8\u0026#39; Private function of Open New Part Button 9Private Sub OpenNewPartButton_Click() 10 11 \u0026#39; Setting Solidworks variable to Solidworks application 12 Set swApp = Application.SldWorks 13 14 \u0026#39; Creating string type variable for storing default part location 15 Dim defaultTemplate As String 16 \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; 17 defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) 18 19 \u0026#39; Setting Solidworks document to new part document 20 Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) 21 22End Sub\r","date":"0001-01-01","id":113,"permalink":"/vba/open-part-from-userform/","summary":"\u003cp\u003eIn this post, we learn how can we \u003cem\u003eopen a part document\u003c/em\u003e from a Visual Basic for Application\u0026rsquo;s \u003cem\u003eUserform\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003eFor this please we need to do following steps as described below.\u003c/p\u003e","tags":[],"title":"VBA Userforms - Open new Part document"},{"content":"","date":"2023-09-07","id":114,"permalink":"/solidworks-macros/29-drawing---get-views-and-views-count/","summary":"","tags":[],"title":"Drawing - Get Views and Views Count"},{"content":"In this post, I tell you about how to Trim Sketch Entities using Solidworks VBA Macros in a Sketch.\nVideo of Code on YouTube Please see below video how visually we Trim Sketch Entities in Solidworks VBA macro.\nPlease note that there are no explaination given in the video.\nExplaination of each line and why we write code this way is given in this post.\nFor Experience Macro Developer If you are an experience Solidworks Macro developer, then you are looking for a specific code sample.\nBelow is the code for Trim Sketch Entities from Solidworks VBA Macro.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Select Line 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Select Line 2 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line2\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Trim Solidworks Sketch segment by \u0026#34;SketchTrim\u0026#34; method from Solidworks sketch manager BoolStatus = swSketchManager.SketchTrim(swSketchTrimChoice_e.swSketchTrimCorner, 0, 0, 0)\rFor Trim Solidworks Sketch segment, first you need to Create a variable of Boolean type.\nAfter creating variable, you need to set the value of this Boolean variable.\nFor this you used SketchTrim method from Solidworks Sketch Manager.\nThis SketchTrim method set the value of Boolean type variable.\nIf Trim is successful then SketchTrim method return True otherwise SketchTrim returns False.\nThis SketchTrim method takes following parameters as explained:\nOption : Sketch trim options as defined in swSketchTrimChoice_e\nX : X pick location\nY : Y pick location\nIn swSketchTrimChoice_e we have following options:\nswSketchTrimClosest : This option Trim Closest selected Sketch Entity.\nswSketchTrimCorner : This option Trim/Extend Corners of selected Sketch Entity.\nswSketchTrimEntities : This option Trim/Delete selected Sketch Entity.\nswSketchTrimEntityPoint : This option migth be Trim selected Sketch Point or Entity. (I did not know what it do!!!)\nswSketchTrimInside : This option Trim selected Sketch Entity between two boundaries.\nswSketchTrimOutside : This option Keep selected Sketch Entity between two boundaries and Trim outside of the boundaries.\nswSketchTrimTwoEntities : This option Trim/Delete selected two Sketch Entities.\nIf you want a more detail explaination then please read further otherwise this will help you to Trim Sketch Entities From VBA Macro.\nFor Beginners Macro Developers In this post, I tell you about SketchTrim method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to Trim Sketces..\nBelow is the code sample for Trim Sketces.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Create Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Set Sketch Segment value and Create Line 1 Set swSketchSegment = swSketchManager.CreateLine(0, 0, 0, 1, 0, 0) \u0026#39; Set Sketch Segment value and Create Line 2 Set swSketchSegment = swSketchManager.CreateLine(1.5, 0, 0, 1.5, 1, 0) \u0026#39; De-select the lines after creation swDoc.ClearSelection2 True \u0026#39; Select Line 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Select Line 2 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line2\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Trim selected Sketch Segments by \u0026#34;SketchTrim\u0026#34; method from Solidworks sketch manager BoolStatus = swSketchManager.SketchTrim(swSketchTrimChoice_e.swSketchTrimCorner, 0.0, 0.0, 0.0) \u0026#39; De-select the Sketch Segment after Trim swDoc.ClearSelection2 True \u0026#39; Show Front View after Trim Sketch Segments swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Create variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment\rIn this line, we Create a variable which we named as swSketchSegment and the type of this swSketchSegment variable is SldWorks.SketchSegment.\nWe create variable swSketchSegment for Solidworks Sketch Segments.\nTo see methods and properties related to swSketchSegment object, please visit this page of Solidworks API Help\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable which we define earlier to Solidworks application.\n\u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis GetUserPreferenceStringValue() method is a part of our main Solidworks variable swApp.\n\u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout this post if you don\u0026rsquo;t understand above code.\n\u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Set Sketch Segment value and Create Line 1 Set swSketchSegment = swSketchManager.CreateLine(0, 0, 0, 1, 0, 0)\rIn above line, we set the value of Solidworks Sketch Segment variable swSketchSegment by CreateLine method from Solidworks Sketch Manager.\nThis CreateLine method creates Lines between 2 given points.\nFor more information about CreateLine method, you can read my Solidworks Sketch Macros - Create Line post..\nThis post describe all the parameters we need for this CreateLine method.\nIn above line, we create a Line between origin of Sketch (0, 0, 0) and 1 distance in X-axis direction.\n\u0026#39; Set Sketch Segment value and Create Line 2 Set swSketchSegment = swSketchManager.CreateLine(1.5, 0, 0, 1.5, 1, 0)\rIn above line we create Line 2 by using same CreateLine method from Solidworks Sketch Manager.\nIn above code, we create our 2nd line between point (1.5, 0, 0) and point (1.5, 1, 0).\nThis line start at 1.5 distance in X-axis and ends at a distance of 1 in Y-axis.\n\u0026#39; De-select the lines after creation swDoc.ClearSelection2 True\rAfter creating both lines we de-select those lines.\nWe don\u0026rsquo;t need to de-select the lines for Trim operation as I will select those lines agains in next 2 lines. I just want to show you how to select a Sketch Segment with SelectById Menthod.\n\u0026#39; Select Line 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Select Line 2 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line2\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select Line 1 and 2.\nThe thing to notice here is that Append value I set to False for Line 1 and True for Line 2.\nLine 1 is 1st entity in items of selection hence we can use False here.\nFor Line 2, we want to add this line into Selection List, hence Append value I set to True.\n\u0026#39; Trim selected Sketch Segments by \u0026#34;SketchTrim\u0026#34; method from Solidworks sketch manager BoolStatus = swSketchManager.SketchTrim(swSketchTrimChoice_e.swSketchTrimCorner, 0.0, 0.0, 0.0)\rIn above line, we Trim selected Sketch Segments by SketchTrim method from Solidworks sketch manager.\nThis SketchTrim method takes following parameters:\nOption : Sketch trim options as defined in swSketchTrimChoice_e\nThe swSketchTrimChoice_e we have following options:\nswSketchTrimClosest : This option Trim Closest selected Sketch Entity.\nswSketchTrimCorner : This option Trim/Extend Corners of selected Sketch Entity.\nswSketchTrimEntities : This option Trim/Delete selected Sketch Entity.\nswSketchTrimEntityPoint : This option migth be Trim selected Sketch Point or Entity. (I did not know what it do!!!)\nswSketchTrimInside : This option Trim selected Sketch Entity between two boundaries.\nNOTES: Please note following point for this Trim option:\nLines needed: For this we need at-least 3 lines.\nBoudaries: 1st and 2nd seletced sketch act as the Boundaries for this option.\nTrim Entity: 3rd sketch is the Trimed entity. In this option, 3rd sketch between the boundary is trimed.\nswSketchTrimOutside : This option Keep selected Sketch Entity between two boundaries and Trim outside of the boundaries.\nNOTES: Please note following point for this Trim option::\nLines needed: For this we need at-least 3 lines.\nBoudaries: 1st and 2nd seletced sketch act as the Boundaries for this option.\nTrim Entity: 3rd sketch is the Trimed entity. In this option, 3rd sketch outside of the boundary is trimed.\nswSketchTrimTwoEntities : This option Trim/Delete selected two Sketch Entities.\nX : X pick location\nY : Y pick location\nZ : Z pick location\nNOTE:\nX, Y and Z arguments are passed in the swSketchTrimClosest and swSketchTrimEntityPoint options.\nZ arguments is needed only for 3D Sketch.\nReturn Value:\nTrue: If Trim operation is Success. False: If Trim operation is Fail. In our code, I have used following values:\nOption : I have used swSketchTrimChoice_e.swSketchTrimCorner enumerator as the type of Sketch Trim option.\nX : I have used 0.0 value for X pick location.\nY : I have used 0.0 value for Y pick location.\nZ : I have used 0.0 value for Z pick location.\nBelow image shows before and after Trim operation on the sketch.\nBefore Trim Operation\nAfter Trim Operation\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means inches for distance. But when I used Solidworks API through VBA macros or C#, I need to use converted numeric values.\nBecause Solidworks API output the distance in Meter which is not my requirement.\n\u0026#39; De-select the Sketch after creation swDoc.ClearSelection2 True\rIn the above line of code, we deselect the Sketch after the Trim operation.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Show Front View after Sketch Trim swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView\rIn the above line of code, we update the view orientation to Front View.\nIn my machine, after inserting a sketch view orientation does not changed.\nBecause of this I have to update the view to Front view.\nFor showing Front View we used ShowNamedView2 method from our Solidworks document name swDoc.\nThis method takes 2 parameter described as follows:\nVName : Name of the view to display or an empty string to use ViewId instead\nViewId : ID of the view to display as defined by swStandardViews_e or -1 to use the VName argument instead.\nNOTE: If you specify both VName and ViewId, then ViewId takes precedence if the two arguments do not resolve to the same view.\nswStandardViews_e has following Standard View Types:\nswBackView\nswBottomView\nswDimetricView\nswFrontView\nswIsometricView\nswLeftView\nswRightView\nswTopView\nswTrimetricView\nIn our code, we did not use VName instead I used empty string in form of \u0026quot;\u0026quot; symbol.\nI used ViewId value to specify view and used swStandardViews_e.swFrontView value to use Standard Front View.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nThis is it !!!\nIf you found anything to add or update, please let me know on my e-mail.\nVBA Language feature used in this post In this post used some features of VBA programming language.\nThis section of post, has some brief information about the VBA programming language specific features.\nWe use Option Explicit for capturing un-declared variables. If you want to read more about Option Explicit then please visit Declaring and Scoping of Variables.\nThen we create variable for different data types. If you don\u0026rsquo;t know about them, then please visit Variables and Data-types posts of this blog. These posts will help you to understand what Variables are and how to use them.\nThen we create main Sub procedure for our macro. If you don\u0026rsquo;t know about the Sub procedure, then I suggest you to visit VBA Sub and Function Procedures and Executing Sub and Function Procedures posts of this blog. These posts will help you to understand what Procedures are and how to use them.\nIn most part we create some variables and set their values. We set those values by using some functions provided from objects. If you don\u0026rsquo;t know about the functions, then you should visit VBA Functions and VBA Functions that do more posts of this blog. These posts will help you to understand what functions are and how to use them.\nSolidworks API Objects In this post of Sketch Trim, we use Solidworks API objects and their methods.\nThis section contains the list of all Solidworks Objects used in this post.\nI have also attached links of these Solidworks API Objects in API Help website.\nIf you want to explore those objects, you can use these links.\nThese Solidworks API Objects are listed below:\nSolidworks Application Object\nIf you want explore Properties and Methods/Functions of Solidworks Application Object object you can visit this link.\nSolidworks Document Object\nIf you want explore Properties and Methods/Functions of Solidworks Document Object object you can visit this link.\nSolidworks Sketch Manager Object\nIf you want explore Properties and Methods/Functions of Solidworks Sketch Manager Object you can visit this link.\nSolidworks Sketch Segment Object\nIf you want explore Properties and Methods/Functions of Solidworks Sketch Segment Object you can visit this link.\nHope this post helps you to Trim Sketch Entities with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":115,"permalink":"/solidworks-macros/trim-entities/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to Trim Sketch Entities using Solidworks VBA Macros\u003c/em\u003e in a Sketch.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"video-of-code-on-youtube\"\u003eVideo of Code on YouTube\u003c/h2\u003e\n\u003cp\u003ePlease see below video how visually we \u003cem\u003eTrim Sketch Entities\u003c/em\u003e in \u003cstrong\u003eSolidworks VBA macro\u003c/strong\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Trim Sketch Entities"},{"content":"In this post, we learn how can we Open new Assembly and Drawing document from a Visual Basic for Application\u0026rsquo;s Userform.\nFor this please we need to do following steps as described below.\nVideo of Code on YouTube Please see below video how visually we Open new Assembly and Drawing document in Solidworks VBA macro Userform.\nPlease note that there are no explanation in the video.\nExplanation of each line and why we write code this way is given in this post.\nCreate a new macro 1st we need to create a new macro in Solidworks 3D CAD Software.\nIf you don\u0026rsquo;t know how to create a new macro in Solidworks, please go to VBA in Solidworks post for this.\nThis will open a new macro in Visual Basic Editor with some code as shown in below image.\nInsert userform in the macro After this we need to insert a userform in our macro.\nFor this, select the button shown in below image.\nThis button is called insert userform.\nAs the name suggest, function of this button is inserting a userform.\nNote\nPlease note that in a macro we can insert any number of userform as we like. But for this example we insert only 1 userform.\nAfter clicking the insert userform button we get the userform window.\nAdding Controls into Userform Now in our userform window, we add following controls:\nA ComboBox\nA CommandButton\nAdding ComboBox You can find ComboBox option, as highlighted in Red Square in below image.\nAfter adding ComboBox, we get window as shown in below image.\nAdding CommandButton You can find CommandButton option, as highlighted in Red Square in below image.\nAfter adding CommandButton, we get window as shown in below image.\nUpdating Properties Now we update some properties of following:\nUserForm\nComboBox\nCommandButton\nUpdating Properties of the UserForm We update following properties of the Userform:\nName of Userform\nCaption of Userform\nIn below image, I have shown the properties of Userform1 and update the properties:\nUpdate the value of Name property from UserForm1 to OpenDocumentWindow.\nNote\nFrom Name property, we access the Userform.\nUpdate the value of Caption property from UserForm1 to Open Document.\nNote\nFrom Caption property, we update the text appears in the window of our Userform.\nNote\nPlease note that it is not necessary to update properties but it is a good habit to update them for our purpose.\nUpdating Properties of the ComboBox Now, we update following property of the ComboBox:\nName of ComboBox In below image, I have shown the properties of ComboBox1 and update the properties:\nUpdate the value of Name property from ComboBox1 to DocumentTypeComboBox.\nNote\nFrom Name property, we access the ComboBox.\nUpdating Properties of the Command Button Now, we update following property of the Command Button:\nName of Command Button\nCaption of Command Button\nIn below image, I have shown the properties of CommandButton1 and update the properties:\nUpdate the value of Name property from CommandButton1 to OpenDocumentButton.\nNote\nFrom Name property, we access the Command Button.\nUpdate the value of Caption property from CommandButton1 to Open Selected Document.\nNote\nFrom Caption property, we update the text appears in the Command Button of our Userform.\nCalling UserForm in Main Module Now, we need to call the our Userform inside main module.\nFor this goto main Sub procedure inside the main Module.\nCode inside the main Module is as given below.\nvba\r1Dim swApp As Object 2Sub main() 3 4Set swApp = Application.SldWorks 5End Sub\rTo call our Userform, replace above code with below code:\nvba\r1\u0026#39; Main function of our VBA program 2Sub main() 3 \u0026#39; Calling our window to show 4 OpenDocumentWindow.Show 5End Sub\rAbove function call our window to appears on screen.\nWhen the window appears on screen, we 1st select the document we want to open and then hit the button to open selected document.\nAdding Document list Before anything we need to add a list of documents inside our combobox.\nFrom this list, we select the document which we want to open.\nIn this post, we are listing only \u0026ldquo;Assembly\u0026rdquo; and \u0026ldquo;Drawing\u0026rdquo; documents.\nFor \u0026ldquo;Part\u0026rdquo; document, I will give you a simple exercise.\nTo add documents list inside our combobox, we 1st need to go in Code Window of userform.\nFor this, we need to right click on userform and select \u0026ldquo;View Code\u0026rdquo; option.\nPlease see below image for \u0026ldquo;how to open code window of userform\u0026rdquo;.\nAfter selecting \u0026ldquo;View Code\u0026rdquo; a Code window appears, which is shown in below image.\nNow before adding document list we need to understand one important thing!!!\nWe want to add document list, when we load our Userform.\nFor this we need to create an Initialize Function.\nBelow Code is that Initialize Function which load document lists in our combobox.\nvba\r1\u0026#39; Call when user load 2Private Sub UserForm_Initialize() 3 \u0026#39; Adding items in Combo Box and also set index to \u0026#39;0\u0026#39; 4 \u0026#39; \u0026#39;0\u0026#39; index means by default we can see \u0026#34;Assembly Document\u0026#34; as already filled 5 With DocumentTypeComboBox 6 .AddItem \u0026#34;Assembly Document\u0026#34; \u0026#39; Adding Assembly Document in Combo Box 7 .AddItem \u0026#34;Drawing Document\u0026#34; \u0026#39; Adding Drawing Document in Combo Box 8 .ListIndex = 0 \u0026#39; Select list index for default value to show in combobox 9 End With 10End Sub\rNow, above code is fully commented and self explanatory hence I will not explain it.\nFirst Test of Macro After writing code sample in previous section, we will test if every thing is working correct?\nBy working correct means:\nWhen we Run macro, is Open Document window appears or not?\nIf window appears, then combobox has documents listed in it?\nIf both item listed, then \u0026ldquo;Assembly document\u0026rdquo; is showing as pre-filled value or not?\nSince we have not given any functionality to \u0026ldquo;Open Document\u0026rdquo; button, hence it should not any done anything when clicking!!!\nFor testing all the above points we need to Run the macro as shown in below image.\nAfter running the window we got a window as shown in below image.\nPlease do check if your macro is running perfectly till now or not!\nIf not, then I suggest you to read this article again.\nAdd Functionality to Open NewPart Button To add functionality in our Open Selected Button, just double click the Open NewPart Button.\nThis will add give some code behind the designer and opens the code window of Userform designer.\nvba\r1Private Sub OpenDocumentButton_Click() 2 3End Sub\rWe need to update this code for opening new part after clicking the button.\nFor this replace all above code with below code.\nvba\r1Option Explicit 2 3\u0026#39; Creating variable for Solidworks application 4Dim swApp As SldWorks.SldWorks 5\u0026#39; Creating variable for Solidworks document 6Dim swDoc As SldWorks.ModelDoc2 7 8\u0026#39; Private function of Open New Part Button 9Private Sub OpenDocumentButton_Click() 10 11 \u0026#39; Setting Solidworks variable to Solidworks application 12 Set swApp = Application.SldWorks 13 14 \u0026#39; Creating string type variable for storing default Assembly location 15 Dim defaultTemplate As String 16 17 If DocumentTypeComboBox.Value = \u0026#34;Assembly Document\u0026#34; Then 18 \u0026#39; Setting value of this string type variable to \u0026#34;Default Assembly template\u0026#34; 19 defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateAssembly) 20 Else 21 \u0026#39; Setting value of this string type variable to \u0026#34;Default drawing template\u0026#34; without define paper size 22 defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateDrawing) 23 End If 24 25 \u0026#39; Setting Solidworks document to new Assembly document 26 Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) 27 28 \u0026#39; Hiding the Window after opening the selected document 29 OpenDocumentWindow.Hide 30 31 \u0026#39; Reset the Index of Combo Box to \u0026#34;0\u0026#34; again 32 DocumentTypeComboBox.ListIndex = 0 33 34End Sub\rNow I have added codes in 2 parts.\nIn 1st part I added below code lines at top of the code window.\nvba\r1Option Explicit 2 3\u0026#39; Creating variable for Solidworks application 4Dim swApp As SldWorks.SldWorks 5\u0026#39; Creating variable for Solidworks document 6Dim swDoc As SldWorks.ModelDoc2\rPlease see below image for more reference.\nIn 2nd part I added OpenDocumentButton_Click function in the code window as shown in below image.\nI have already explained code inside OpenDocumentButton_Click function in Open Assembly and Drawing document.\nBut here, I have added a condition which is shown in Red colored box in below image.\nBasically, this condition stated that, if we select \u0026ldquo;Assembly Document\u0026rdquo; in combobox, then by clicking \u0026ldquo;Open Select Document\u0026rdquo; button our macro open \u0026ldquo;Assembly\u0026rdquo; document in Solidworks.\nOtherwise, it will always open \u0026ldquo;Drawing\u0026rdquo; document in Solidworks.\nThe above code will open New part document when we click the button.\nRun the macro, and check wheather our macro is working correct document or not!!\nIf not, send your macro and I will guide you in doing it correctly!\nExercise to do For those who wants to do more I have an exercise!!\nAdd \u0026ldquo;Part Document\u0026rdquo; in ComboBox list.\nMake \u0026ldquo;Part Document\u0026rdquo; as pre-filled value in ComboBox.\nChange the conditional statement, so that it can handle all 3 conditions!!\nSend me the Code of macro in my below e-mail and I will verify it.\nThat\u0026rsquo;s it for now.\nHope you learn some use of Userforms and by this post you can get the idea how they works.\nI will provide more tutorials on using of Userform time to time.\nTill then do come to visit this blog and Happy learning!!!\n","date":"0001-01-01","id":116,"permalink":"/vba/open-assembly-and-drawing-from-userform/","summary":"\u003cp\u003eIn this post, we learn how can we \u003cstrong\u003eOpen new Assembly and Drawing document\u003c/strong\u003e from a Visual Basic for Application\u0026rsquo;s \u003cstrong\u003eUserform\u003c/strong\u003e.\u003c/p\u003e","tags":[],"title":"VBA Userforms - Open new Assembly and Drawing document"},{"content":"","date":"2023-09-07","id":117,"permalink":"/solidworks-macros/30-drawing---break-views/","summary":"","tags":[],"title":"Drawing - Break Views"},{"content":"In this post, I tell you about how to Extend Sketch Entities using Solidworks VBA Macros in a Sketch.\nVideo of Code on YouTube Please see below video how visually we Extend Sketch Entities in Solidworks VBA macro.\nPlease note that there are no explaination given in the video.\nExplaination of each line and why we write code this way is given in this post.\nFor Experience Macro Developer If you are an experience Solidworks Macro developer, then you are looking for a specific code sample.\nBelow is the code for Extend Sketch Entities from Solidworks VBA Macro.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Select Line 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Extend Solidworks Sketch segment by \u0026#34;SketchExtend\u0026#34; method from Solidworks sketch manager BoolStatus = swSketchManager.SketchExtend(0, 0, 0)\rMethod Name: SketchExtend\nDescription: Add lengths to the selected Sketch Entity till next sketch entity.\nFor Extend Solidworks Sketch segment, first you need to Create a variable of Boolean type.\nAfter creating variable, you need to set the value of this Boolean variable.\nFor this you used SketchExtend method from Solidworks Sketch Manager.\nThis SketchExtend method set the value of Boolean type variable.\nIf Extend is successful then SketchExtend method return True otherwise SketchExtend returns False.\nThis SketchExtend method takes following parameters as explained:\nX : Not used\nY : Not used\nZ : Not used\nIf you want a more detail explaination then please read further otherwise this will help you to Extend Sketch Entities From VBA Macro.\nFor Beginners Macro Developers In this post, I tell you about SketchExtend method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to Extend Sketces..\nBelow is the code sample for Extend Sketces.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Create Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Set Sketch Segment value and Create Line 1 Set swSketchSegment = swSketchManager.CreateLine(-0.5, 0.75, 0, -0.25, -0.5, 0) \u0026#39; Set Sketch Segment value and Create Line 2 Set swSketchSegment = swSketchManager.CreateLine(-0.75, -1.25, 0, 0.5, -1.25, 0) \u0026#39; De-select the lines after creation swDoc.ClearSelection2 True \u0026#39; Select Line 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Extend selected Sketch Segments by \u0026#34;SketchExtend\u0026#34; method from Solidworks sketch manager BoolStatus = swSketchManager.SketchExtend(0.0, 0.0, 0.0) \u0026#39; De-select the Sketch Segment after Extend swDoc.ClearSelection2 True \u0026#39; Show Front View after Extend Sketch Segments swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning of every line.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Create variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment\rIn this line, we Create a variable which we named as swSketchSegment and the type of this swSketchSegment variable is SldWorks.SketchSegment.\nWe create variable swSketchSegment for Solidworks Sketch Segments.\nTo see methods and properties related to swSketchSegment object, please visit this page of Solidworks API Help\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we are setting the value of our Solidworks variable which we define earlier to Solidworks application.\n\u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis GetUserPreferenceStringValue() method is a part of our main Solidworks variable swApp.\n\u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout this post if you don\u0026rsquo;t understand above code.\n\u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Set Sketch Segment value and Create Line 1 Set swSketchSegment = swSketchManager.CreateLine(-0.5, 0.75, 0, -0.25, -0.5, 0)\rIn above line, we set the value of Solidworks Sketch Segment variable swSketchSegment by CreateLine method from Solidworks Sketch Manager.\nThis CreateLine method creates Lines between 2 given points.\nFor more information about CreateLine method, you can read my Solidworks Sketch Macros - Create Line post.\nThis post describe all the parameters we need for this CreateLine method.\nIn above line, we create a Line between point (-0.5, 0.75, 0) and point (-0.25, -0.5, 0).\nThis line is not parallel to any axis.\nThis line is at an angle to Vertical axis.\n\u0026#39; Set Sketch Segment value and Create Line 2 Set swSketchSegment = swSketchManager.CreateLine(-0.75, -1.25, 0, 0.5, -1.25, 0)\rIn above line we create Line 2 by using same CreateLine method from Solidworks Sketch Manager.\nIn above code, we create our 2nd line between point (-0.75, -1.25, 0) and point (0.5, -1.25, 0).\nThis line is parallel to X-axis.\n\u0026#39; De-select the lines after creation swDoc.ClearSelection2 True\rAfter creating both lines we de-select those lines.\nWe don\u0026rsquo;t need to de-select the lines for Extend operation as I will select those lines agains in next 2 lines. I just want to show you how to select a Sketch Segment with SelectById Menthod.\n\u0026#39; Select Line 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line of code, we select Line 1.\n\u0026#39; Extend selected Sketch Segments by \u0026#34;SketchExtend\u0026#34; method from Solidworks sketch manager BoolStatus = swSketchManager.SketchExtend(0.0, 0.0, 0.0)\rIn above line, we Extend selected Sketch Segments by SketchExtend method from Solidworks sketch manager.\nThis SketchExtend method takes following parameters:\nX : Not used\nY : Not used\nZ : Not used\nReturn Value:\nTrue: If Extend operation is Success. False: If Extend operation is Fail. In our code, I have used following values:\nX : I have used 0.0 value for X.\nY : I have used 0.0 value for Y.\nZ : I have used 0.0 value for Z.\nBelow image shows before and after Extend operation on the sketch.\nBefore Extend Operation\nAfter Extend Operation\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means inches for distance. But when I used Solidworks API through VBA macros or C#, I need to use converted numeric values.\nBecause Solidworks API output the distance in Meter which is not my requirement.\n\u0026#39; De-select the Sketch after creation swDoc.ClearSelection2 True\rIn the above line of code, we deselect the Sketch after the Extend operation.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Show Front View after Sketch Extend swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView\rIn the above line of code, we update the view orientation to Front View.\nIn my machine, after inserting a sketch view orientation does not changed.\nBecause of this I have to update the view to Front view.\nFor showing Front View we used ShowNamedView2 method from our Solidworks document name swDoc.\nThis method takes 2 parameter described as follows:\nVName : Name of the view to display or an empty string to use ViewId instead\nViewId : ID of the view to display as defined by swStandardViews_e or -1 to use the VName argument instead.\nNOTE: If you specify both VName and ViewId, then ViewId takes precedence if the two arguments do not resolve to the same view.\nswStandardViews_e has following Standard View Types:\nswBackView\nswBottomView\nswDimetricView\nswFrontView\nswIsometricView\nswLeftView\nswRightView\nswTopView\nswExtendetricView\nIn our code, we did not use VName instead I used empty string in form of \u0026quot;\u0026quot; symbol.\nI used ViewId value to specify view and used swStandardViews_e.swFrontView value to use Standard Front View.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nThis is it !!!\nIf you found anything to add or update, please let me know on my e-mail.\nVBA Language feature used in this post In this post used some features of VBA programming language.\nThis section of post, has some brief information about the VBA programming language specific features.\nWe use Option Explicit for capturing un-declared variables. If you want to read more about Option Explicit then please visit Declaring and Scoping of Variables.\nThen we create variable for different data types. If you don\u0026rsquo;t know about them, then please visit Variables and Data-types posts of this blog. These posts will help you to understand what Variables are and how to use them.\nThen we create main Sub procedure for our macro. If you don\u0026rsquo;t know about the Sub procedure, then I suggest you to visit VBA Sub and Function Procedures and Executing Sub and Function Procedures posts of this blog. These posts will help you to understand what Procedures are and how to use them.\nIn most part we create some variables and set their values. We set those values by using some functions provided from objects. If you don\u0026rsquo;t know about the functions, then you should visit VBA Functions and VBA Functions that do more posts of this blog. These posts will help you to understand what functions are and how to use them.\nSolidworks API Objects In this post of Sketch Extend, we use Solidworks API objects and their methods.\nThis section contains the list of all Solidworks Objects used in this post.\nI have also attached links of these Solidworks API Objects in API Help website.\nIf you want to explore those objects, you can use these links.\nThese Solidworks API Objects are listed below:\nSolidworks Application Object\nIf you want explore Properties and Methods/Functions of Solidworks Application Object object you can visit this link.\nSolidworks Document Object\nIf you want explore Properties and Methods/Functions of Solidworks Document Object object you can visit this link.\nSolidworks Sketch Manager Object\nIf you want explore Properties and Methods/Functions of Solidworks Sketch Manager Object you can visit this link.\nSolidworks Sketch Segment Object\nIf you want explore Properties and Methods/Functions of Solidworks Sketch Segment Object you can visit this link.\nHope this post helps you to Extend Sketch Entities with Solidworks VB Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":118,"permalink":"/solidworks-macros/extend-entities/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to Extend Sketch Entities using Solidworks VBA Macros\u003c/em\u003e in a Sketch.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"video-of-code-on-youtube\"\u003eVideo of Code on YouTube\u003c/h2\u003e\n\u003cp\u003ePlease see below video how visually we \u003cem\u003eExtend Sketch Entities\u003c/em\u003e in \u003cstrong\u003eSolidworks VBA macro\u003c/strong\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Extend Sketch Entities"},{"content":"Introduction In this post, we test our Open new Assembly and Drawing document code sample.\nThis post is supplement of VBA Userforms - Open new Assembly and Drawing document post.\nNote\nPlease visit above post before this post.\nFrom VBA Userforms - Open new Assembly and Drawing document post we expect following results :\nOpen Assembly document when we select \u0026ldquo;Assembly document\u0026rdquo;.\nOpen Drawing document when we select \u0026ldquo;Drawing document\u0026rdquo;.\nWhen we run our VBA macro we get the expected result.\nNow, as a developer, we want to give a thoroughly tested macro/application to our users.\nFor testing our VBA macro, we apply some checks so that macro perform same at all machine.\nCode block to check Below is code block where we want to apply our check.\nvba\r1Option Explicit 2 3\u0026#39; Creating variable for Solidworks application 4Dim swApp As SldWorks.SldWorks 5\u0026#39; Creating variable for Solidworks document 6Dim swDoc As SldWorks.ModelDoc2 7 8\u0026#39; Private function of Open New Part Button 9Private Sub OpenDocumentButton_Click() 10 11 \u0026#39; Setting Solidworks variable to Solidworks application 12 Set swApp = Application.SldWorks 13 14 \u0026#39; Creating string type variable for storing default Assembly location 15 Dim defaultTemplate As String 16 17 If DocumentTypeComboBox.Value = \u0026#34;Assembly Document\u0026#34; Then 18 \u0026#39; Setting value of this string type variable to \u0026#34;Default Assembly template\u0026#34; 19 defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateAssembly) 20 Else 21 \u0026#39; Setting value of this string type variable to \u0026#34;Default drawing template\u0026#34; without define paper size 22 defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateDrawing) 23 End If 24 25 \u0026#39; Setting Solidworks document to new Assembly document 26 Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) 27 28 \u0026#39; Hiding the Window after opening the selected document 29 OpenDocumentWindow.Hide 30 31 \u0026#39; Reset the Index of Combo Box to \u0026#34;0\u0026#34; again 32 DocumentTypeComboBox.ListIndex = 0 33 34End Sub\rApply check In above code there is only one check we apply.\nWe need to check if get the template value or not.\nFor this, we need to put an If condition before opening a new document.\nPlease see below code for condition.\nvba\r1\u0026#39; Checking if we got template path 2If defaultTemplate = vbNullString Then 3 \u0026#39; If template path is empty then show message and exit from procedure. 4 MsgBox \u0026#34;Failed to open \u0026#34; + DocumentTypeComboBox.Value + \u0026#34; template.\u0026#34; 5 Exit Sub 6End If\rIn above code, we check if got the template path or not.\nIf template path is empty then\nwe show a message to user as show in below image. we end our sub procedure from here. After adding our check, procedure has following code.\nvba\r1\u0026#39; Private function of Open New Part Button 2Private Sub OpenDocumentButton_Click() 3 4 \u0026#39; Setting Solidworks variable to Solidworks application 5 Set swApp = Application.SldWorks 6 7 \u0026#39; Creating string type variable for storing default Assembly location 8 Dim defaultTemplate As String 9 10 If DocumentTypeComboBox.Value = \u0026#34;Assembly Document\u0026#34; Then 11 \u0026#39; Setting value of this string type variable to \u0026#34;Default Assembly template\u0026#34; 12 defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateAssembly) 13 Else 14 \u0026#39; Setting value of this string type variable to \u0026#34;Default drawing template\u0026#34; without define paper size 15 defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateDrawing) 16 End If 17 18 \u0026#39; Checking if we got template path 19 If defaultTemplate = vbNullString Then 20 \u0026#39; If template path is empty then show message and exit from procedure. 21 MsgBox \u0026#34;Failed to open \u0026#34; + DocumentTypeComboBox.Value + \u0026#34; template.\u0026#34; 22 Exit Sub 23 End If 24 25 \u0026#39; Setting Solidworks document to new Assembly document 26 Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) 27 28 \u0026#39; Hiding the Window after opening the selected document 29 OpenDocumentWindow.Hide 30 31 \u0026#39; Reset the Index of Combo Box to \u0026#34;0\u0026#34; again 32 DocumentTypeComboBox.ListIndex = 0 33 34End Sub\rCause of Error Note\nYou might wondering how can we have such error?\nWe have this error, if the value of templates path is not set in option setting.\nFor reference please see below image.\nAs you can see, in my machine these value are already set.\nBut they are empty in case of fresh installation.\nHence if someone runs this macro on fresh SOLIDWORKS copy, they might get error message which we give.\nThis is it !!!\nI hope this be will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail which is given in bottom.\nthis post helps us to test our Open new Assembly and Drawing document macro.\nWe will see this type of testing of all our macros which we in this website.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":119,"permalink":"/vba/testing-open-assembly-and-drawing-document-macro/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eIn this post, we \u003cstrong\u003etest\u003c/strong\u003e our \u003cstrong\u003eOpen new Assembly and Drawing document\u003c/strong\u003e code sample.\u003c/p\u003e\n\u003cp\u003eThis post is supplement of \u003cstrong\u003e\u003ca href=\"/vba/open-assembly-and-drawing-from-userform/\"\u003eVBA Userforms - Open new Assembly and Drawing document\u003c/a\u003e\u003c/strong\u003e post.\u003c/p\u003e","tags":[],"title":"VBA Userforms - Testing Open new Assembly and Drawing document"},{"content":"In this post, I tell you about how to Offset Sketch Entities using Solidworks VBA Macros in a Sketch.\nVideo of Code on YouTube Please see below video how visually we Offset Sketch Entities in Solidworks VBA macro.\nPlease note that there are no explaination given in the video.\nExplaination of each line and why we write code this way is given in this post.\nFor Experience Macro Developer If you are an experience Solidworks Macro developer, then you are looking for a specific code sample.\nBelow is the code for Offset Sketch Entities from Solidworks VBA Macro.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Select Line 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Select Line 2 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line2\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Offset Solidworks Sketch segment by \u0026#34;SketchOffset2\u0026#34; method from Solidworks sketch manager BoolStatus = swSketchManager.SketchOffset2(0.5, False, False, swSkOffsetCapEndType_e.swSkOffsetNoCaps, swSkOffsetMakeConstructionType_e.swSkOffsetDontMakeConstruction, True)\rMethod Name: SketchOffset2\nDescription: Offsets the selected sketch entities.\nFor Offset Solidworks Sketch entities, first you need to Create a variable of Boolean type.\nAfter creating variable, you need to set the value of this Boolean variable.\nFor this you used SketchOffset2 method from Solidworks Sketch Manager.\nThis SketchOffset2 method set the value of Boolean type variable.\nIf Offset is successful then SketchOffset2 method return True value otherwise SketchOffset2 returns False value.\nThis SketchOffset2 method takes following parameters as explained:\nOffset : Offset value; negative value offsets the sketch entities in the opposite direction\nBothDirections : True to offset the sketch entities in both directions, false to offset the sketch entities in one direction\nChain : True to offset the chain of sketch entities, false to offset only the selected sketch entities\nCapEnds : Cap the ends as defined by swSkOffsetCapEndType_e\nswSkOffsetCapEndType_e enum defines following different End cap types constants:\nswSkOffsetArcCaps\nswSkOffsetLineCaps\nswSkOffsetNoCaps\nMakeConstruction : Convert original and offset sketch entities to construction sketch entities as defined by swSkOffsetMakeConstructionType_e\nswSkOffsetMakeConstructionType_e enum defines following different Construction Types constants:\nswSkOffsetDontMakeConstruction\nswSkOffsetMakeBothConstruction\nswSkOffsetMakeOffsConstruction\nswSkOffsetMakeOrigConstruction\nAddDimensions : True to add the dimension to the offset, false if not want to add the dimension to the offset.\nIf you want more detailed explaination then please read further otherwise this will help you to Offset Sketch Entities From VBA Macro.\nFor Beginners Macro Developers In this post, I tell you about SketchOffset2 method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to Offset Sketches.\nBelow is the code sample for Offset Sketches.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Create Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Set Sketch Segment value and Create Line 1 Set swSketchSegment = swSketchManager.CreateLine(-0.5, 0.75, 0, -0.25, -0.5, 0) \u0026#39; Set Sketch Segment value and Create Line 2 Set swSketchSegment = swSketchManager.CreateLine(-0.75, -1.25, 0, 0.5, -1.25, 0) \u0026#39; De-select the lines after creation swDoc.ClearSelection2 True \u0026#39; Select Line 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Select Line 2 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line2\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Offset selected Sketch Segments by \u0026#34;SketchOffset2\u0026#34; method from Solidworks sketch manager BoolStatus = swSketchManager.SketchOffset2(0.5, False, False, swSkOffsetCapEndType_e.swSkOffsetNoCaps, swSkOffsetMakeConstructionType_e.swSkOffsetDontMakeConstruction, True) \u0026#39; De-select the Sketch Segment after Offset swDoc.ClearSelection2 True \u0026#39; Show Front View after Offset Sketch Segments swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Create variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment\rIn this line, we Create a variable which we named as swSketchSegment and the type of this swSketchSegment variable is SldWorks.SketchSegment.\nWe create variable swSketchSegment for Solidworks Sketch Segments.\nTo see methods and properties related to swSketchSegment object, please visit this page of Solidworks API Help\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis GetUserPreferenceStringValue() method is a part of our main Solidworks variable swApp.\n\u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout that post if you want to understand above code in more detail.\n\u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Set Sketch Segment value and Create Line 1 Set swSketchSegment = swSketchManager.CreateLine(-0.5, 0.75, 0, -0.25, -0.5, 0)\rIn above line, we set the value of Solidworks Sketch Segment variable swSketchSegment by CreateLine method from Solidworks Sketch Manager.\nThis CreateLine method creates Lines between 2 given points.\nFor more information about CreateLine method, you can read my Solidworks Sketch Macros - Create Line post.\nThat post describe all the parameters we need for this CreateLine method in details.\nIn above line, we create a Line between point (-0.5, 0.75, 0) and point (-0.25, -0.5, 0).\nThis line is not parallel to any axis.\nThis line is at an angle to Vertical axis.\n\u0026#39; Set Sketch Segment value and Create Line 2 Set swSketchSegment = swSketchManager.CreateLine(-0.75, -1.25, 0, 0.5, -1.25, 0)\rIn above line we create Line 2 by using same CreateLine method from Solidworks Sketch Manager.\nIn above code, we create our 2nd line between point (-0.75, -1.25, 0) and point (0.5, -1.25, 0).\nThis line is parallel to X-axis.\n\u0026#39; De-select the lines after creation swDoc.ClearSelection2 True\rAfter creating both lines we de-select those lines.\nWe don\u0026rsquo;t need to de-select the lines for Offset operation as we will select those lines agains in next 2 lines. I just want to show you how to select a Sketch Segment with SelectById Menthod in next line of code.\n\u0026#39; Select Line 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line of code, we select Line 1.\n\u0026#39; Select Line 2 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line of code, we select Line 2 and add Line 2 to selection list.\n\u0026#39; Offset selected Sketch Segments by \u0026#34;SketchOffset2\u0026#34; method from Solidworks sketch manager BoolStatus = swSketchManager.SketchOffset2(0.5, False, False, swSkOffsetCapEndType_e.swSkOffsetNoCaps, swSkOffsetMakeConstructionType_e.swSkOffsetDontMakeConstruction, True)\rIn above line, we Offset selected Lines by SketchOffset2 method from Solidworks sketch manager.\nThis SketchOffset2 method takes following parameters as explained:\nOffset : Offset value; negative value offsets the sketch entities in the opposite direction\nBothDirections : True to offset the sketch entities in both directions, false to offset the sketch entities in one direction\nChain : True to offset the chain of sketch entities, false to offset only the selected sketch entities\nCapEnds : Cap the ends as defined by swSkOffsetCapEndType_e\nswSkOffsetCapEndType_e enum defines following different End cap types constants:\nswSkOffsetArcCaps\nswSkOffsetLineCaps\nswSkOffsetNoCaps\nMakeConstruction : Convert original and offset sketch entities to construction sketch entities as defined by swSkOffsetMakeConstructionType_e\nswSkOffsetMakeConstructionType_e enum defines following different constants:\nswSkOffsetDontMakeConstruction\nswSkOffsetMakeBothConstruction\nswSkOffsetMakeOffsConstruction\nswSkOffsetMakeOrigConstruction\nAddDimensions : True to add the dimension to the offset, false if not want to add the dimension to the offset.\nReturn Value:\nTrue: If Extend operation is Success.\nFalse: If Extend operation is Fail.\nIn our code, I have used following values:\nOffset : I have used 0.5 value for Offset.\nBothDirections : I have used False value for BothDirections.\nChain : I have used False value for Chain.\nCapEnds : I have used swSkOffsetCapEndType_e.swSkOffsetNoCaps value for CapEnds.\nMakeConstruction : I have used swSkOffsetMakeConstructionType_e.swSkOffsetDontMakeConstruction value for MakeConstruction.\nAddDimensions : I have used True value for AddDimensions.\nBelow image shows before and after Offset operation on the sketch.\nBefore Offset Operation\nAfter Offset Operation\nNow let us modify some values and look for the changes:\nBothDirections : Let us change the value to True value for BothDirections and see the result:\nCapEnds : Now we change the value of End cap.\nPlease see below for both Line and Arc option for End cap:\nIf we change CapEnds value to swSkOffsetLineCaps and then the result would be: If we change CapEnds value to swSkOffsetArcCaps and then the result would be: These 2 covers all option available in Cap End.\nMakeConstruction : Now we change the value of MakeConstruction.\nPlease see below for all MakeConstruction options:\nIf we change MakeConstruction value to swSkOffsetMakeOrigConstruction and then the result would be: If we change MakeConstruction value to swSkOffsetMakeOffsConstruction and then the result would be: If we change MakeConstruction value to swSkOffsetMakeBothConstruction and then the result would be: This covers all options in SketchOffset2 method.\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means inches for distance. But when I used Solidworks API through VBA macros or C#, I need to use converted numeric values.\nBecause Solidworks API output the distance in Meter which is not my requirement.\n\u0026#39; De-select the Sketch after creation swDoc.ClearSelection2 True\rIn the above line of code, we deselect the Sketch after the Offset operation.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Show Front View after Sketch Offset swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView\rIn the above line of code, we update the view orientation to Front View.\nIn my machine, after inserting a sketch view orientation does not changed.\nBecause of this I have to update the view to Front view.\nFor showing Front View we used ShowNamedView2 method from our Solidworks document name swDoc.\nThis method takes 2 parameter described as follows:\nVName : Name of the view to display or an empty string to use ViewId instead\nViewId : ID of the view to display as defined by swStandardViews_e or -1 to use the VName argument instead.\nNOTE: If you specify both VName and ViewId, then ViewId takes precedence if the two arguments do not resolve to the same view.\nswStandardViews_e has following Standard View Types:\nswBackView\nswBottomView\nswDimetricView\nswFrontView\nswIsometricView\nswLeftView\nswRightView\nswTopView\nswExtendetricView\nIn our code, we did not use VName instead I used empty string in form of \u0026quot;\u0026quot; symbol.\nI used ViewId value to specify view and used swStandardViews_e.swFrontView value to use Standard Front View.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nThis is it !!!\nIf you found anything to add or update, please let me know on my e-mail.\nVBA Language feature used in this post In this post used some features of VBA programming language.\nThis section of post, has some brief information about the VBA programming language specific features.\nWe use Option Explicit for capturing un-declared variables. If you want to read more about Option Explicit then please visit Declaring and Scoping of Variables.\nThen we create variable for different data types. If you know in detail about the Variables, then please visit Variables and Data-types posts of this blog. It will help you to understand what Variables are and how to use them.\nThen we create main Sub procedure for our macro. If you know in detail about the Sub procedure, then I suggest you to visit VBA Sub and Function Procedures and Executing Sub and Function Procedures posts of this blog. It will help you to understand what Procedures are and how to use them.\nIn most part we create some variables and set their values. We set those values by using some functions provided from objects. If you don\u0026rsquo;t know about the functions, then you should visit VBA Functions and VBA Functions that do more posts of this blog. It will help you to understand what functions are and how to use them.\nSolidworks API Objects In this post of Sketch Offset, we use Solidworks API objects and their methods.\nThis section contains the list of all Solidworks Objects used in this post.\nI have also attached links of these Solidworks API Objects in API Help website.\nIf you want to explore those objects, you can use these links.\nThese Solidworks API Objects are listed below:\nSolidworks Application Object\nIf you want explore Properties and Methods/Functions of Solidworks Application Object object you can visit this link.\nSolidworks Document Object\nIf you want explore Properties and Methods/Functions of Solidworks Document Object object you can visit this link.\nSolidworks Sketch Manager Object\nIf you want explore Properties and Methods/Functions of Solidworks Sketch Manager Object you can visit this link.\nSolidworks Sketch Segment Object\nIf you want explore Properties and Methods/Functions of Solidworks Sketch Segment Object you can visit this link.\nHope this post helps you to Offset Sketch Entities with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":120,"permalink":"/solidworks-macros/offset-entities/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to Offset Sketch Entities using Solidworks VBA Macros\u003c/em\u003e in a Sketch.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"video-of-code-on-youtube\"\u003eVideo of Code on YouTube\u003c/h2\u003e\n\u003cp\u003ePlease see below video how visually we \u003cem\u003eOffset Sketch Entities\u003c/em\u003e in \u003cstrong\u003eSolidworks VBA macro\u003c/strong\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Offset Sketch Entities"},{"content":"Introduction In this article, we learn how to browse SOLIDWORKS file(s) from a SOLIDWORKS VBA Userform.\nIn this article, I explain about 2 different methods which are listed below.\nFrom SldWorks object directly.\nFrom Microsoft Excel externally.\nMethods from these objects are updated methods, hence use any one of them for browsing SOLIDWORKS file(s).\nCreating Userform 1st we need to create a new macro in SOLIDWORKS.\nIf you don\u0026rsquo;t know how to create a new macro in Solidworks, please go to VBA in Solidworks post for this.\nThis opens a Visual Basic Editor with some code as shown in below image.\nAfter this we need to insert a userform in our macro.\nFor this, select the button shown in below image.\nThis button is called insert userform.\nAs the name suggest, function of this button is inserting a userform.\nNote\nPlease note that in a macro we can insert any number of userform as we like. But for this example we insert only 1 userform.\nAfter clicking the insert userform button we get the userform window as shown in above image.\nAdding Controls into Userform Now in our userform window, we add following controls:\nA TextBox\nA CommandButton\nAdding ComboBox You can find TextBox option, as highlighted in Red Square in below image.\nAfter adding ComboBox, we get window as shown in below image.\nAdding CommandButton You can find CommandButton option, as highlighted in Red Square in below image.\nAfter adding CommandButton, we get window as shown in below image.\nUpdating Properties Now we update some properties of following:\nUserform\nTextBox\nCommandButton\nUpdate Userform Properties We update following properties of the Userform:\nName of Userform\nCaption of Userform\nIn below image, I have shown the properties of Userform1 and update the properties:\nUpdate the value of Name property from UserForm1 to BrowseDocumentWindow.\nFrom Name property, we access the Userform. Update the value of Caption property from UserForm1 to Browse Document.\nFrom Caption property, we update the text appears in the window of our Userform. Please note that it is not necessary to update properties but it is a good habit to update them for our purpose.\nUpdate TextBox Properties We update following property of the TextBox:\nName of TextBox In below image, I have shown the properties of TextBox and update the properties:\nUpdate the value of Name property from TextBox to SelectedFileTextBox.\nFrom Name property, we access the TextBox properties like Text we want to show. Update CommandButton Properties We update following properties of the Command Button:\nName of Command Button\nCaption of Command Button\nIn below image, I have shown the properties of CommandButton1 and update the properties:\nUpdate the value of Name property from CommandButton1 to BrowseDocumentButton.\nFrom Name property, we access the Command Button.\nUpdate the value of Caption property from CommandButton1 to Browse SOLIDOWRKS File(s).\nFrom Caption property, we update the text appears in the Command Button of our Userform.\nCall UserForm in Main Module Now, we need to call the our Userform inside main module.\nFor this goto main Sub procedure inside the main Module.\nCode inside the main Module is as given below.\nvba\r1Dim swApp As Object 2Sub main() 3 4Set swApp = Application.SldWorks 5End Sub\rTo call our Userform, replace above code with below code:\nvba\r1\u0026#39; Main function of our VBA program 2Sub main() 3 \u0026#39; Calling our window to show 4 BrowseDocumentWindow.Show 5End Sub\rAbove function call our window to appears on screen.\nWhen the window appears on screen, we hit the Browse button to browse SOLIDWORKS File(s).\nAdd Functionality to Button To add functionality in our BrowseDocumentButton, just double click the button.\nThis will add some code behind the designer.\nNow open the code window of Userform designer.\nPrivate Sub CommandButton1_Click() End Sub\rWe need to update this code for opening new part after clicking the button.\nMethod 1 - From SldWorks object directly For this replace all above code with below code.\nvba\r1Option Explicit 2 3\u0026#39; Creating variable for Solidworks application 4Dim swApp As SldWorks.SldWorks 5 6\u0026#39; Private function of Open New Part Button 7Private Sub BrowseDocumentButton_Click() 8 9 \u0026#39; Setting Solidworks variable to Solidworks application 10 Set swApp = Application.SldWorks 11 12 \u0026#39; Solidworks file filter string 13 Dim swFilter As String 14 15 \u0026#39; Method parameters 16 Dim fileName As String 17 Dim fileConfig As String 18 Dim fileDispName As String 19 Dim fileOptions As Long 20 21 \u0026#39; Set filters for different Solidworks files. 22 swFilter = \u0026#34;SOLIDWORKS Files (*.sldprt; *.sldasm; *.slddrw)|*.sldprt;*.sldasm;*.slddrw\u0026#34; 23 24 \u0026#39; Browse and get the Selected file name 25 fileName = swApp.GetOpenFileName(\u0026#34;Browse Document\u0026#34;, \u0026#34;\u0026#34;, swFilter, fileOptions, fileConfig, fileDispName) 26 27 \u0026#39; Show the selected file\u0026#39;s full path in text box 28 SelectedFileTextBox.Text = fileName 29 30End Sub\rUnderstanding Method 1 Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\nNext is our button click event BrowseDocumentButton_Click procedure.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Solidworks file filter string Dim swFilter As String \u0026#39; Method parameters Dim fileName As String Dim fileConfig As String Dim fileDispName As String Dim fileOptions As Long\rIn above lines of code, we create SOLIDWORKS files filter string and Method parameters.\n\u0026#39; Set filters for different Solidworks files. Filter = \u0026#34;SOLIDWORKS Files (*.sldprt; *.sldasm; *.slddrw)|*.sldprt;*.sldasm;*.slddrw\u0026#34;\rIn above line of code, we set filters for different SOLIDWORKS files.\n\u0026#39; Browse and get the Selected file name fileName = swApp.GetOpenFileName(\u0026#34;Browse Document\u0026#34;, \u0026#34;\u0026#34;, swFilter, fileOptions, fileConfig, fileDispName)\rFor \u0026ldquo;Browse and get the Selected file name\u0026rdquo;, we use GetOpenFileName method from Solidworks SldWorks object.\nThis GetOpenFileName method takes following parameters as explained:\nDialogTitle : Title of the dialog.\nInitialFileName : Path and file name of the file to open.\nFileFilter : File name extension of the file to open.\nOpenOptions : Not used.\nConfigName : Name of the configuration.\nDisplayName : Recommended file name to use.\nAfter the function complete following are the results:\nReturn Value:\nPath and file name of the file to open. Below image shows our form in SOLIDWORKS.\nBelow image shows the opened window.\n\u0026#39; Show the selected file\u0026#39;s full path in text box SelectedFileTextBox.Text = fileName\rNow we set the value of text box to browsed file name.\nFinal window of method 1 is shown below/.\nMethod 2 - From Microsoft Excel externally Prerequisite:\nOffice 365\nFollowing below steps carefully\nFor this method we need to use Microsoft Excel from SOLIDWORKS.\nFor using Microsoft Excel, we need to add reference files.\nPlease see following steps for adding reference files:\nSelect reference option as shown in below image. This open Reference window as shown in below image. Now select option given in below images and Press OK after selecting files.. Now, replace code in Add Functionality to Button with below code sample.\nOption Explicit \u0026#39; Private function of Open New Part Button Private Sub BrowseDocumentButton_Click() \u0026#39; Excel object Dim xlObj As Object \u0026#39; File dialog object Dim fDialog As Object \u0026#39; File name sting Dim strFile As String \u0026#39; Create Excel object Set xlObj = CreateObject(\u0026#34;Excel.Application\u0026#34;) \u0026#39; Create File dialog object by setting option 3 Set fDialog = xlObj.FileDialog(3) \u0026#39; Setting different properties of file dialog With fDialog .Title = \u0026#34;Browse Document\u0026#34; \u0026#39; Title of window .AllowMultiSelect = True \u0026#39; Allowing multiple select .Filters.Clear \u0026#39; Clear the filters .Filters.Add \u0026#34;SOLIDWORKS Files\u0026#34;, \u0026#34;*.sldprt; *.sldasm; *.slddrw\u0026#34; \u0026#39; Add filters for Solidworks files If .Show Then strFile = .SelectedItems(1) Else strFile = vbNullString End If End With \u0026#39; Show the selected file\u0026#39;s full path in text box SelectedFileTextBox.Text = strFile End Sub\rUnderstanding Method 2 Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\nNext is our button click event BrowseDocumentButton_Click procedure.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Excel object Dim xlObj As Object\rIn this line, we create object for Microsoft Excel Application.\n\u0026#39; File dialog object Dim fDialog As Object \u0026#39; File name sting Dim strFile As String\rIn above lines of code, we create objects for File Dialog and string for file name.\n\u0026#39; Create Excel object Set xlObj = CreateObject(\u0026#34;Excel.Application\u0026#34;)\rIn above line of code, we create Microsoft Excel Application and set the value of excel object.\n\u0026#39; Create File dialog object by setting option 3 Set fDialog = xlObj.FileDialog(3)\rIn above line of code, we create File dialog and set the value of file dialog by FileDialog method.\nFileDialog method take 1 parameter enum. Please see below links for more details about FileDialog\nApplication.FileDialog property (Excel)\nMsoFileDialogType enumeration (Office)\n\u0026#39; Setting different properties of file dialog With fDialog .Title = \u0026#34;Browse Document\u0026#34; \u0026#39; Title of window .AllowMultiSelect = True \u0026#39; Allowing multiple select .Filters.Clear \u0026#39; Clear the filters .Filters.Add \u0026#34;SOLIDWORKS Files\u0026#34;, \u0026#34;*.sldprt; *.sldasm; *.slddrw\u0026#34; \u0026#39; Add filters for Solidworks files If .Show Then strFile = .SelectedItems(1) \u0026#39; Select 3rd item from list Else strFile = vbNullString End If End With\rIn above code we set different properties of File dialog object.\nTitle : Title of the dialog.\nAllowMultiSelect : Allowing multi select of files.\nFileFilter : File name extension of the file to open.\nIf statement shows that, if file dialog is shown then assign the first value to file name string object.\nAfter the function complete following are the results:\nReturn Value:\nPath and file name of the selected file(s). Below image shows our form in SOLIDWORKS.\nBelow image shows the opened window.\nBelow image shows the multi-selection in opened window.\n\u0026#39; Show the selected file\u0026#39;s full path in text box SelectedFileTextBox.Text = strFile\rNow we set the value of text box to browsed file name.\nFinal window of method 1 is shown below/.\nFinal window of both method is same.\nFinal words This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you in Browsing SOLIDWORKS file(s) with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\n","date":"0001-01-01","id":121,"permalink":"/vba/browse-solidworks-file/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eIn this article, we learn \u003cstrong\u003ehow to browse SOLIDWORKS file(s)\u003c/strong\u003e from a \u003cstrong\u003eSOLIDWORKS VBA Userform\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003eIn this article, I explain about \u003cem\u003e\u003cstrong\u003e2 different methods\u003c/strong\u003e\u003c/em\u003e which are listed below.\u003c/p\u003e","tags":[],"title":"VBA Userforms - Browse SOLIDWORKS file(s)"},{"content":"In this post, I tell you about how to Mirror Sketch Entities using Solidworks VBA Macros in a Sketch.\nVideo of Code on YouTube Please see below video how visually we Mirror Sketch Entities in Solidworks VBA macro.\nPlease note that there are no explaination given in the video.\nExplaination of each line and why we write code this way is given in this post.\nFor Experience Macro Developer If you are an experience Solidworks Macro developer, then you are looking for a specific code sample.\nBelow is the code for Mirror Sketch Entities from Solidworks VBA Macro.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Select Center Line for Mirror BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, False, 2, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Select Circle we want to Mirror BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 1, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Mirror Selected Sketch entities swDoc.SketchMirror\rMethod Name: SketchMirror\nDescription: Mirrors the selected sketch entities with reference from a Centerline.\nFor Mirror Solidworks Sketch entities, first we need following things:\nSketch Entity/Entities to Mirror\nA Centerline, from which we Mirror the sketch entities\nIf you want more detailed explaination then please read further otherwise this will help you to Mirror Sketch Entities From VBA Macro.\nFor Beginners Macro Developers In this post, I tell you about SketchMirror method from Solidworks ModelDoc2 object.\nThis method is easiest method, I found in Solidworks API Help.\nSo use this method if you want to Mirror Sketches.\nBelow is the code sample for Mirror Sketches.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Create Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Set Sketch Segment value and Create a Center Line Set swSketchSegment = swSketchManager.CreateCenterLine(0, 0, 0, 0, 1, 0) \u0026#39; Set Sketch Segment value and Create a Circle Set swSketchSegment = swSketchManager.CreateCircleByRadius(-0.75, 0, 0, 0.2) \u0026#39; De-select the lines after creation swDoc.ClearSelection2 True \u0026#39; Select Center Line for Mirror BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, False, 2, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Select Circle we want to Mirror BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 1, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Mirror Selected Sketch entities swDoc.SketchMirror \u0026#39; De-select the Sketch Segment after Mirror swDoc.ClearSelection2 True \u0026#39; Show Front View after Mirror Sketch Segments swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Create variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment\rIn this line, we Create a variable which we named as swSketchSegment and the type of this swSketchSegment variable is SldWorks.SketchSegment.\nWe create variable swSketchSegment for Solidworks Sketch Segments.\nTo see methods and properties related to swSketchSegment object, please visit this page of Solidworks API Help\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis GetUserPreferenceStringValue() method is a part of our main Solidworks variable swApp.\n\u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout that post if you want to understand above code in more detail.\n\u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Set Sketch Segment value and Create a Center Line Set swSketchSegment = swSketchManager.CreateCenterLine(0, 0, 0, 0, 1, 0)\rIn above line, we set the value of Solidworks Sketch Segment variable swSketchSegment by CreateCenterLine method from Solidworks Sketch Manager.\nThis CreateCenterLine method creates a Center Line between 2 given points.\nFor more information about CreateCenterLine method, you can read my Solidworks Sketch Macros - Create CenterLines post.\nThat post describe all the parameters we need for this CreateCenterLine method in details.\nIn above line, we create a Line between point (0, 0, 0) and point (0, 1, 0).\n\u0026#39; Set Sketch Segment value and Create a Circle Set swSketchSegment = swSketchManager.CreateCircleByRadius(-0.75, 0, 0, 0.2)\rIn above line we create a Circle by using same CreateCircleByRadius method from Solidworks Sketch Manager.\nIn above code, we create a Circle at point (0, 0, 0) with a radius of 0.2.\n\u0026#39; De-select the lines after creation swDoc.ClearSelection2 True\rAfter creating both entities we de-select them.\nWe need to de-select both the entities because we have to mark them with options when we select them individually.\n\u0026#39; Select Center Line for Mirror BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, False, 2, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line of code, we select the Center Line i.e. Line 1 for our Mirror option.\nNOTE: To differentiate a Center Line between selected entities, we use Mark option of 2 while selecting the Center Line. This is IMPORTANT for defining the Centerline in Mirror operation.\n\u0026#39; Select Circle we want to Mirror BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 1, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line of code, we select the Circle i.e. Arc 1 and add it to selection list.\nNOTE: While selecting entities to Mirror, we use Mark option of 1 while selecting the Center Line. This is IMPORTANT for while selecting sketch entities in Mirror operation. If any selected entity is NOT marked with 1 then it will not mirror.\n\u0026#39; Mirror Selected Sketch entities swDoc.SketchMirror\rIn above line, we Mirror selected Circle by SketchMirror method from Solidworks Document variable.\nThis SketchMirror method does not take any parameters.\nBelow image shows before and after Mirror operation on the sketch.\nBefore Mirror Operation\nAfter Mirror Operation\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means inches for distance. But when I used Solidworks API through VBA macros or C#, I need to converted numeric values.\nBecause Solidworks API output the distance in Meter which is not my requirement.\n\u0026#39; De-select the Sketch after creation swDoc.ClearSelection2 True\rIn the above line of code, we deselect the Sketch after the Mirror operation.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Show Front View after Sketch Mirror swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView\rIn the above line of code, we update the view orientation to Front View.\nIn my machine, after inserting a sketch view orientation does not changed.\nBecause of this I have to update the view to Front view.\nFor showing Front View we used ShowNamedView2 method from our Solidworks document name swDoc.\nThis method takes 2 parameter described as follows:\nVName : Name of the view to display or an empty string to use ViewId instead\nViewId : ID of the view to display as defined by swStandardViews_e or -1 to use the VName argument instead.\nNOTE: If you specify both VName and ViewId, then ViewId takes precedence if the two arguments do not resolve to the same view.\nswStandardViews_e has following Standard View Types:\nswBackView\nswBottomView\nswDimetricView\nswFrontView\nswIsometricView\nswLeftView\nswRightView\nswTopView\nswExtendetricView\nIn our code, we did not use VName instead I used empty string in form of \u0026quot;\u0026quot; symbol.\nI used ViewId value to specify view and used swStandardViews_e.swFrontView value to use Standard Front View.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nThis is it !!!\nIf you found anything to add or update, please let me know on my e-mail.\nVBA Language feature used in this post In this post used some features of VBA programming language.\nThis section of post, has some brief information about the VBA programming language specific features.\nWe use Option Explicit for capturing un-declared variables. If you want to read more about Option Explicit then please visit Declaring and Scoping of Variables.\nThen we create variable for different data types. If you know in detail about the Variables, then please visit Variables and Data-types posts of this blog. It will help you to understand what Variables are and how to use them.\nThen we create main Sub procedure for our macro. If you know in detail about the Sub procedure, then I suggest you to visit VBA Sub and Function Procedures and Executing Sub and Function Procedures posts of this blog. It will help you to understand what Procedures are and how to use them.\nIn most part we create some variables and set their values. We set those values by using some functions provided from objects. If you don\u0026rsquo;t know about the functions, then you should visit VBA Functions and VBA Functions that do more posts of this blog. It will help you to understand what functions are and how to use them.\nSolidworks API Objects In this post of Sketch Mirror, we use Solidworks API objects and their methods.\nThis section contains the list of all Solidworks Objects used in this post.\nI have also attached links of these Solidworks API Objects in API Help website.\nIf you want to explore those objects, you can use these links.\nThese Solidworks API Objects are listed below:\nSolidworks Application Object\nIf you want explore Properties and Methods/Functions of Solidworks Application Object object you can visit this link.\nSolidworks Document Object\nIf you want explore Properties and Methods/Functions of Solidworks Document Object object you can visit this link.\nSolidworks Sketch Manager Object\nIf you want explore Properties and Methods/Functions of Solidworks Sketch Manager Object you can visit this link.\nSolidworks Sketch Segment Object\nIf you want explore Properties and Methods/Functions of Solidworks Sketch Segment Object you can visit this link.\nHope this post helps you to Mirror Sketch Entities with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macros, do come to this blog after sometime.\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":122,"permalink":"/solidworks-macros/mirror-entities/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to Mirror Sketch Entities using Solidworks VBA Macros\u003c/em\u003e in a Sketch.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"video-of-code-on-youtube\"\u003eVideo of Code on YouTube\u003c/h2\u003e\n\u003cp\u003ePlease see below video how visually we \u003cem\u003eMirror Sketch Entities\u003c/em\u003e in \u003cstrong\u003eSolidworks VBA macro\u003c/strong\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Mirror Sketch Entities"},{"content":"In this post, I tell you about how to Linear Sketch Pattern using Solidworks VBA Macros in a Sketch.\nVideo of Code on YouTube Please see below video how visually we Linear Sketch Pattern in Solidworks VBA macro.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nFor Experience Macro Developers If you are an experience Solidworks Macro developer, then you are looking for a specific code sample.\nBelow is the code for Linear Sketch Pattern from Solidworks VBA Macro.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Select Circle we want to Pattern BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 1, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Create a Linear Sketch Pattern BoolStatus = swSketchManager.CreateLinearSketchStepAndRepeat(1, 3, 1, 1, 0, 1.57, \u0026#34;\u0026#34;, False, True, True, False, True)\rMethod Name: CreateLinearSketchStepAndRepeat\nDescription: Create Linear Sketch Pattern of the selected sketch entity or entities.\nPrerequisites: To create a Linear Sketch Pattern a Solidworks Sketch entity or entities, first we need following things:\nSketch Entity/Entities to Pattern\nThat Entity/Entities is selected before pattern\nHow it works:\nFor Linear Sketch Pattern, first you need to Create a variable of Boolean type.\nAfter creating variable, you need to set the value of this Boolean variable.\nFor this you used CreateLinearSketchStepAndRepeat method from Solidworks Sketch Manager.\nThis CreateLinearSketchStepAndRepeat method set the value of Boolean type variable.\nIf the Linear Sketch Pattern is successful then CreateLinearSketchStepAndRepeat method return True value otherwise CreateLinearSketchStepAndRepeat returns False value.\nThis CreateLinearSketchStepAndRepeat method takes following parameters as explained:\nNumX : Total number of instances along the x axis, including the seed i.e. original entity/entities.\nNumY : Total number of instances along the y axis, including the seed i.e. original entity/entities.\nSpacingX : Spacing between instances along the x axis.\nSpacingY : Spacing between instances along the y axis.\nAngleX : Angle for direction 1 relative to the x axis.\nAngleY : Angle for direction 1 relative to the y axis.\nDeleteInstances : Number of instances to delete, passed as a string in the format: \u0026ldquo;(a) (b) (c)\u0026rdquo;.\nXSpacingDim : True to display the spacing between instances dimension along the x axis in the graphics area, false to not\nYSpacingDim : True to display the spacing between instances dimension along the y axis in the graphics area, false to not\nAngleDim : True to display the angle dimension between axes in the graphics area, false to not.\nCreateNumOfInstancesDimInXDir : True to display the number of instances in the x direction dimension in the graphics area, false to not.\nCreateNumOfInstancesDimInYDir : True to display the number of instances in the y direction dimension in the graphics area, false to not.\nIf you want more detailed explaination then please read further otherwise this will help you to create a Linear Sketch Pattern.\nFor Beginner Macro Developers In this post, I tell you about CreateLinearSketchStepAndRepeat method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create Linear Sketch Pattern.\nBelow is the code sample to create Linear Sketch Pattern.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Create Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Set Sketch Segment value and Create a Circle Set swSketchSegment = swSketchManager.CreateCircleByRadius(0, 0, 0, 0.2) \u0026#39; De-select the lines after creation swDoc.ClearSelection2 True \u0026#39; Select Circle we want to Pattern BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 1, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Create a Linear Sketch Pattern BoolStatus = swSketchManager.CreateLinearSketchStepAndRepeat(3, 1, 1, 0, 0, 0, \u0026#34;\u0026#34;, True, False, True, True, False) \u0026#39; De-select the Sketch Segment after Linear Sketch Pattern swDoc.ClearSelection2 True \u0026#39; Show Front View after Linear Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Create variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment\rIn this line, we Create a variable which we named as swSketchSegment and the type of this swSketchSegment variable is SldWorks.SketchSegment.\nWe create variable swSketchSegment for Solidworks Sketch Segments.\nTo see methods and properties related to swSketchSegment object, please visit this page of Solidworks API Help\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis GetUserPreferenceStringValue() method is a part of our main Solidworks variable swApp.\n\u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout that post if you want to understand above code in more detail.\n\u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Set Sketch Segment value and Create a Circle Set swSketchSegment = swSketchManager.CreateCircleByRadius(0, 0, 0, 0.2)\rIn above line, we set the value of Solidworks Sketch Segment variable swSketchSegment by CreateCircleByRadius method from Solidworks Sketch Manager.\nThis CreateCircleByRadius method creates a Circle at given point with radius.\nFor more information about CreateCircleByRadius method, you can read my Solidworks Macro - Create Circle By Radius post.\nThat post describe all the parameters we need for this CreateCircleByRadius method in details.\nIn above line, we create a Circle with:\nCircle Centerpoint : At origin i.e. (0, 0, 0)\nCircle Radius : 0.2\n\u0026#39; De-select the lines after creation swDoc.ClearSelection2 True\rAfter creating the circle we de-select it.\nWe don\u0026rsquo;t need to de-select the circle for Pattern as we will select the circle agains in next line. I just want to show you how to select a Sketch Segment with SelectById Menthod in next line of code.\n\u0026#39; Select Circle we want to Pattern BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line of code, we select the Circle i.e. Arc 1 and add it to selection list.\n\u0026#39; Create a Linear Sketch Pattern BoolStatus = swSketchManager.CreateLinearSketchStepAndRepeat(3, 1, 1, 0, 0, 0, \u0026#34;\u0026#34;, True, False, True, True, False)\rIn above line, we Pattern selected Circle by CreateLinearSketchStepAndRepeat method from Solidworks Sketch Manger variable.\nThis CreateLinearSketchStepAndRepeat method takes following parameters as explained:\nNumX : Total number of instances along the x axis, including the seed i.e. original entity/entities.\nNumY : Total number of instances along the y axis, including the seed i.e. original entity/entities.\nSpacingX : Spacing between instances along the x axis.\nSpacingY : Spacing between instances along the y axis.\nAngleX : Angle for direction 1 relative to the x axis.\nAngleY : Angle for direction 1 relative to the y axis.\nDeleteInstances : Number of instances to delete, passed as a string in the format: \u0026ldquo;(a) (b) (c)\u0026rdquo;.\nXSpacingDim : True to display the spacing between instances dimension along the x axis in the graphics area, false to not\nYSpacingDim : True to display the spacing between instances dimension along the y axis in the graphics area, false to not\nAngleDim : True to display the angle dimension between axes in the graphics area, false to not.\nCreateNumOfInstancesDimInXDir : True to display the number of instances in the x direction dimension in the graphics area, false to not.\nCreateNumOfInstancesDimInYDir : True to display the number of instances in the y direction dimension in the graphics area, false to not.\nAfter the function complete following are the results:\nReturn Value:\nTrue: If Linear Sketch Pattern is Success.\nFalse: If Linear Sketch Pattern is Fail.\nIn our code, I have used following values:\nNumX : I have used 3 as Total number of instances along the x axis including original circle.\nNumY : I have used 1 as Total number of instances along the y axis which includes original circle only.\nEven uf you don\u0026rsquo;t want to pattern in Y direction, you have to give atleast 1 as a value. Same goes for X direction.\nSpacingX : I use 1 as Spacing between instances along the x axis.\nSpacingY : I use 0 Spacing between instances along the y axis.\nAngleX : I use 0 Angle for direction 1 relative to the x axis.\nAngleY : I use 0 Angle for direction 1 relative to the y axis.\nDeleteInstances : I use \u0026quot;\u0026quot; as Number of instances to delete, because I don\u0026rsquo;t want to delete any instances.\nXSpacingDim : I use True to display the spacing between instances dimension along the x axis in the graphics area.\nYSpacingDim : I use False to display the spacing between instances dimension along the y axis in the graphics area.\nAngleDim : I use True to display the angle dimension between axes in the graphics area.\nCreateNumOfInstancesDimInXDir : I use True to display the number of instances in the x direction dimension in the graphics area.\nCreateNumOfInstancesDimInYDir : I use False to display the number of instances in the y direction dimension in the graphics area.\nBelow image shows before and after Linear Sketch Pattern.\nBefore Linear Sketch Pattern\nAfter Linear Sketch Pattern\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nPlease see below for detail:\nLength: Meter\nAngle: Radian\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means inches for distance. But when I used Solidworks API through VBA macros or C#, I need to converted numeric values.\nBecause Solidworks API output the distance in Meter which is not my requirement.\n\u0026#39; De-select the Sketch after creation swDoc.ClearSelection2 True\rIn the above line of code, we deselect the Sketch after the Linear Sketch Pattern operation.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Show Front View after Linear Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView\rIn the above line of code, we update the view orientation to Front View.\nIn my machine, after inserting a sketch view orientation does not changed.\nBecause of this I have to update the view to Front view.\nFor showing Front View we used ShowNamedView2 method from our Solidworks document name swDoc.\nThis method takes 2 parameter described as follows:\nVName : Name of the view to display or an empty string to use ViewId instead\nViewId : ID of the view to display as defined by swStandardViews_e or -1 to use the VName argument instead.\nNOTE: If you specify both VName and ViewId, then ViewId takes precedence if the two arguments do not resolve to the same view.\nswStandardViews_e has following Standard View Types:\nswBackView\nswBottomView\nswDimetricView\nswFrontView\nswIsometricView\nswLeftView\nswRightView\nswTopView\nswExtendetricView\nIn our code, we did not use VName instead I used empty string in form of \u0026quot;\u0026quot; symbol.\nI used ViewId value to specify view and used swStandardViews_e.swFrontView value to use Standard Front View.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nThis is it !!!\nIf you found anything to add or update, please let me know on my e-mail.\nVBA Language feature used in this post In this post used some features of VBA programming language.\nThis section of post, has some brief information about the VBA programming language specific features.\nWe use Option Explicit for capturing un-declared variables. If you want to read more about Option Explicit then please visit Declaring and Scoping of Variables.\nThen we create variable for different data types. If you know in detail about the Variables, then please visit Variables and Data-types posts of this blog. It will help you to understand what Variables are and how to use them.\nThen we create main Sub procedure for our macro. If you know in detail about the Sub procedure, then I suggest you to visit VBA Sub and Function Procedures and Executing Sub and Function Procedures posts of this blog. It will help you to understand what Procedures are and how to use them.\nIn most part we create some variables and set their values. We set those values by using some functions provided from objects. If you don\u0026rsquo;t know about the functions, then you should visit VBA Functions and VBA Functions that do more posts of this blog. It will help you to understand what functions are and how to use them.\nSolidworks API Objects In this post of Linear Sketch Pattern, we use Solidworks API objects and their methods.\nThis section contains the list of all Solidworks Objects used in this post.\nI have also attached links of these Solidworks API Objects in API Help website.\nIf you want to explore those objects, you can use these links.\nThese Solidworks API Objects are listed below:\nSolidworks Application Object\nIf you want explore Properties and Methods/Functions of Solidworks Application Object object you can visit this link.\nSolidworks Document Object\nIf you want explore Properties and Methods/Functions of Solidworks Document Object object you can visit this link.\nSolidworks Sketch Manager Object\nIf you want explore Properties and Methods/Functions of Solidworks Sketch Manager Object you can visit this link.\nSolidworks Sketch Segment Object\nIf you want explore Properties and Methods/Functions of Solidworks Sketch Segment Object you can visit this link.\nHope this post helps you to Create Linear Sketch Pattern with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":123,"permalink":"/solidworks-macros/linear-skech-pattern/","summary":"\u003cp\u003eIn this post, I tell you about \u003cstrong\u003ehow to Linear Sketch Pattern using Solidworks VBA Macros\u003c/strong\u003e in a Sketch.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"video-of-code-on-youtube\"\u003eVideo of Code on YouTube\u003c/h2\u003e\n\u003cp\u003ePlease see below video how visually we \u003cem\u003eLinear Sketch Pattern\u003c/em\u003e in \u003cstrong\u003eSolidworks VBA macro\u003c/strong\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Linear Sketch Pattern"},{"content":"In this post, I tell you about how to Edit Linear Sketch Pattern using Solidworks VBA Macros in a Sketch.\nThis post is extension of previous Solidworks Macro - Linear Sketch Pattern post.\nI recommend you to read Solidworks Macro - Linear Sketch Pattern post because we are using same code sample.\nVideo of Code on YouTube Please see below video how we can Edit Linear Sketch Pattern in Solidworks VBA macro.\nPlease note that there is no explanation in the video.\nWhy we write our code this way is explained in this post.\nFor Experience Macro Developers If you are an experienced Solidworks Macro developer, then you are looking for a specific code sample.\nBelow is the code for Edit Linear Sketch Pattern from Solidworks VBA Macro.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Edit a Linear Sketch Pattern BoolStatus = swSketchManager.EditLinearSketchStepAndRepeat(5, 4, 1, 0.75, 0.785, 1.5708, \u0026#34;(3,2)(2,1)\u0026#34;, True, True, False, False, True, \u0026#34;Arc1_\u0026#34;)\rMethod Name: EditLinearSketchStepAndRepeat\nDescription: Edit Linear Sketch Pattern.\nPrerequisites: To edit a Linear Sketch Pattern a Solidworks Sketch entity or entities, first, we need the following things:\nExisting Linear Sketch Pattern How it works:\nFor Edit a Linear Sketch Pattern, first, we need to create a variable of Boolean type.\nAfter creating variable, we need to set the value of this Boolean variable.\nFor this, we used EditLinearSketchStepAndRepeat method from Solidworks Sketch Manager.\nThis EditLinearSketchStepAndRepeat method set the value of Boolean type variable.\nIf the editing of Linear Sketch Pattern is successful then EditLinearSketchStepAndRepeat method return True value otherwise EditLinearSketchStepAndRepeat returns False value.\nThis EditLinearSketchStepAndRepeat method takes the following parameters as explained:\nNumX: Total number of instances along the x axis, including the seed i.e. original entity/entities.\nNumY: Total number of instances along the y axis, including the seed i.e. original entity/entities.\nSpacingX: Spacing between instances along the x axis.\nSpacingY: Spacing between instances along the y axis.\nAngleX: Angle for direction 1 relative to the x axis.\nAngleY: Angle for direction 1 relative to the y axis.\nDeleteInstances: Number of instances to delete, passed as a string in the format: \u0026ldquo;(a) (b) (c)\u0026rdquo;.\nXSpacingDim: True to display the spacing between instances dimension along the x axis in the graphics area, false to not\nYSpacingDim: True to display the spacing between instances dimension along the y axis in the graphics area, false to not\nAngleDim: True to display the angle dimension between axes in the graphics area, false to not.\nCreateNumOfInstancesDimInXDir: True to display the number of instances in the x direction dimension in the graphics area, false to not.\nCreateNumOfInstancesDimInYDir: True to display the number of instances in the y direction dimension in the graphics area, false to not.\nSeed: List of the names of the entities, separated by the underscore character (_), that comprise the seed pattern (e.g., Line1_Line2_Line3_Line4 for a rectangular-shaped seed pattern).\nReturn Value:\nTrue: If Editing of Linear Sketch Pattern is \u0026ldquo;Success\u0026rdquo;.\nFalse: If Editing of Linear Sketch Pattern is \u0026ldquo;Fail\u0026rdquo;.\nIf you want more detailed explaination then please read further otherwise this will help you to edit a Linear Sketch Pattern.\nFor Beginner Macro Developers In this post, I tell you about EditLinearSketchStepAndRepeat method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to edit Linear Sketch Pattern.\nBelow is the code sample to edit Linear Sketch Pattern.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Create Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Set Sketch Segment value and Create a Circle Set swSketchSegment = swSketchManager.CreateCircleByRadius(0, 0, 0, 0.2) \u0026#39; De-select the lines after creation swDoc.ClearSelection2 True \u0026#39; Select Circle we want to Pattern BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 1, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Create a Linear Sketch Pattern BoolStatus = swSketchManager.CreateLinearSketchStepAndRepeat(3, 1, 1, 0, 0, 0, \u0026#34;\u0026#34;, True, False, True, True, False) \u0026#39; De-select the Sketch Segment after Linear Sketch Pattern swDoc.ClearSelection2 True \u0026#39; Show Front View after Linear Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 \u0026#39; Edit a Linear Sketch Pattern \u0026lt;--- FROM HERE IS THE LAST LINE I EXPLAIN BoolStatus = swSketchManager.EditLinearSketchStepAndRepeat(5, 1, 1, 0, 0, 0, \u0026#34;\u0026#34;, True, False, True, True, False, \u0026#34;Arc1_\u0026#34;) End Sub\rSince this post is an extension of previous Solidworks Macro - Linear Sketch Pattern post, then I will start explaining from Last line only.\nIf you want to understand every line of code, then please visit Solidworks Macro - Linear Sketch Pattern post \u0026ldquo;first\u0026rdquo;, then read this post.\nBy doing this, you learn 2 thing:\nHow to create a Linear Sketch Pattern\nHow to edit/modify an existing Linear Sketch Pattern\nI also give some links so that you can go through them if there are anything I explained in previous posts.\n\u0026#39; Edit a Linear Sketch Pattern BoolStatus = swSketchManager.EditLinearSketchStepAndRepeat(5, 1, 1, 0, 0, 0, \u0026#34;\u0026#34;, True, False, True, True, False, \u0026#34;Arc1_\u0026#34;)\rFor \u0026ldquo;editing\u0026rdquo; a Linear Sketch pattern, we need EditLinearSketchStepAndRepeat method from Solidworks Sketch Manager object/variable.\nThis EditLinearSketchStepAndRepeat method takes the following parameters as explained:\nNumX: Total number of instances along the x axis, including the seed i.e. original entity/entities.\nNumY: Total number of instances along the y axis, including the seed i.e. original entity/entities.\nSpacingX: Spacing between instances along the x axis.\nSpacingY: Spacing between instances along the y axis.\nAngleX: Angle for direction 1 relative to the x axis.\nAngleY: Angle for direction 1 relative to the y axis.\nDeleteInstances: Number of instances to delete, passed as a string in the format: \u0026ldquo;(a) (b) (c)\u0026rdquo;.\nXSpacingDim: True to display the spacing between instances dimension along the x axis in the graphics area, false to not\nYSpacingDim: True to display the spacing between instances dimension along the y axis in the graphics area, false to not\nAngleDim: True to display the angle dimension between axes in the graphics area, false to not.\nCreateNumOfInstancesDimInXDir: True to display the number of instances in the x direction dimension in the graphics area, false to not.\nCreateNumOfInstancesDimInYDir: True to display the number of instances in the y direction dimension in the graphics area, false to not.\nSeed: List of the names of the entities, separated by the underscore character (_), that comprise the seed pattern (e.g., Line1_Line2_Line3_Line4 for a rectangular-shaped seed pattern).\nNOTE: In Seed, adding underscore(_) after selected entity is important, otherwise code will note work.\nAfter the function complete, we get following results:\nReturn Value:\nTrue: If Editing of Linear Sketch Pattern is \u0026ldquo;Success\u0026rdquo;.\nFalse: If Editing of Linear Sketch Pattern is \u0026ldquo;Fail\u0026rdquo;.\nIn our code, I have used following values:\nNumX : I have used 5 as Total number of instances along the x axis including original circle.\nNumY : I have used 1 as Total number of instances along the y axis which includes original circle only.\nEven uf you don\u0026rsquo;t want to pattern in Y direction, you have to give atleast 1 as a value. Same goes for X direction.\nSpacingX : I use 1 as Spacing between instances along the x axis.\nSpacingY : I use 0 Spacing between instances along the y axis.\nAngleX : I use 0 Angle for direction 1 relative to the x axis.\nAngleY : I use 0 Angle for direction 1 relative to the y axis.\nDeleteInstances : I use \u0026quot;\u0026quot; as Number of instances to delete, because I don\u0026rsquo;t want to delete any instances.\nXSpacingDim : I use True to display the spacing between instances dimension along the x axis in the graphics area.\nYSpacingDim : I use False to display the spacing between instances dimension along the y axis in the graphics area.\nAngleDim : I use True to display the angle dimension between axes in the graphics area.\nCreateNumOfInstancesDimInXDir : I use True to display the number of instances in the x direction dimension in the graphics area.\nCreateNumOfInstancesDimInYDir : I use False to display the number of instances in the y direction dimension in the graphics area.\nSeed : I use Arc1_ as the seed of this Edit Pattern Function. We can select multiple sketch entities into existing Linear Sketch Pattern.\nCases In this section, we will go through different cases by\nModifying different parameters\nA basic 1 line description\nSample Code of parameter modification\nSee images, before and after parameter modification\nCASE 1 : Increase Total number of instances along the \u0026ldquo;X\u0026rdquo; axis To increase Total number of instances along the \u0026ldquo;X\u0026rdquo; axis, we need to update NumX parameter in EditLinearSketchStepAndRepeat method.\nIn my previous Solidworks Macro - Linear Sketch Pattern post, we created a Linear pattern 3 instances in x-direction.\nCode sample:\n\u0026#39; Edit a Linear Sketch Pattern BoolStatus = swSketchManager.EditLinearSketchStepAndRepeat(5, 1, 1, 0, 0, 0, \u0026#34;\u0026#34;, True, False, True, True, False, \u0026#34;Arc1_\u0026#34;)\rIn above code, we update the number of instances from 3 instances to 5 instances.\nExample Images:\nBelow image shows before and after we update number of instance in X-direction.\nBefore Edit Linear Sketch Pattern\nAfter Edit Linear Sketch Pattern\nCASE 2 : Increase Total number of instances along the \u0026ldquo;Y\u0026rdquo; axis To increase Total number of instances along the \u0026ldquo;Y\u0026rdquo; axis, we need to update NumY parameter in EditLinearSketchStepAndRepeat method.\nIf we increase the number of instances in Y-direction, then we also need to give value for SpacingY parameter.\nWe need following parameters to update:\nNumY\nSpacingY\nWe will use following values for these parameters:\nNumY: 4\nSpacingY: 0.75\nCode sample:\n\u0026#39; Edit a Linear Sketch Pattern BoolStatus = swSketchManager.EditLinearSketchStepAndRepeat(5, 4, 1, 0.75, 0, 0, \u0026#34;\u0026#34;, True, False, True, True, False, \u0026#34;Arc1_\u0026#34;)\rExample Images:\nBelow image shows before and after we update number of instance in Y-direction.\nBefore Edit Linear Sketch Pattern\nAfter Edit Linear Sketch Pattern\nNOTE:\nAs you notice in previous image, when you give values for NumY and SpacingY, number of instances increased in X-direction!\nWhy the instances are increased in X-direction not in Y-direction as I was expecting?\nThis question comes in my mind after seeing the result!\nReason is that we did not give value of AngleY parameter.\nIf you provide the value of AngleY parameter then we can have instances in Y-direction.\nMore detail with example in CASE 4.\nCASE 3 : Update Angle for direction 1 along the \u0026ldquo;X\u0026rdquo; axis To update Angle for direction 1 along the \u0026ldquo;X\u0026rdquo; axis, we need to update AngleX parameter in EditLinearSketchStepAndRepeat method.\nWe will use following value for AngleX parameter:\nAngleX: 0.785. Code sample:\n\u0026#39; Edit a Linear Sketch Pattern BoolStatus = swSketchManager.EditLinearSketchStepAndRepeat(5, 4, 1, 0.75, 0.785, 0, \u0026#34;\u0026#34;, True, False, True, True, False, \u0026#34;Arc1_\u0026#34;)\rExample Images:\nBelow image shows before and after we update Angle for direction 1 along the \u0026ldquo;X\u0026rdquo; axis.\nBefore Edit Linear Sketch Pattern\nAfter Edit Linear Sketch Pattern\nNOTE:\nIn this case, we use AngleX = 0.785.\nThis value is in Radian.\nHence, 0.785 Radian = 44.999 Degree\nSo we have update Angle for direction 1 in ~45 degree.\nCASE 4 : Update Angle for direction 1 along the \u0026ldquo;Y\u0026rdquo; axis To update Angle for direction 2 along the \u0026ldquo;Y\u0026rdquo; axis, we need to update AngleY parameter in EditLinearSketchStepAndRepeat method.\nWe will use following value for AngleY parameter:\nAngleX: 1.5708. Code sample:\n\u0026#39; Edit a Linear Sketch Pattern BoolStatus = swSketchManager.EditLinearSketchStepAndRepeat(5, 4, 1, 0.75, 0.785, 1.5708, \u0026#34;\u0026#34;, True, False, True, True, False, \u0026#34;Arc1_\u0026#34;)\rExample Images:\nBelow image shows before and after we update Angle for direction 2 along the \u0026ldquo;Y\u0026rdquo; axis.\nBefore Edit Linear Sketch Pattern\nAfter Edit Linear Sketch Pattern\nNOTE:\nIn this case, we use AngleY = 1.5708.\nThis value is in Radian.\nHence, 1.5708 Radian = 90 Degree\nSo we have update Angle for direction 1 in 90 degree.\nCASE 5 : Number of instances to delete Ok, this one is a little \u0026ldquo;tricky\u0026rdquo;!!!\nWe want to delete some instance now.\nFor deleting instances, we need following:\nDeleting instance\u0026rsquo;s position with respect to X and Y directions.\nThose position in a particular format.\nGrid Position Image:\nI tried my best to describe you this position system in Grid format using image.\nPlease see below image for this Grid position.\nWe are going to delete 2 instances.\n1st Instance: First we will get the position of this instance.\nIn X-Direction: As you can see in above image, position of this instance is 3 in Grid position system for X-Direction.\nIn Y-Direction: As you can see in above image, position of this instance is 2 in Grid position system for Y-Direction.\n2nd Instance: First we will get the position of this instance.\nIn X-Direction: As you can see in above image, position of this instance is 2 in Grid position system for X-Direction.\nIn Y-Direction: As you can see in above image, position of this instance is 1 in Grid position system for Y-Direction.\nPosition in special format: After we get the position, we need to put \u0026ldquo;Grid position\u0026rdquo; of each instance inside a bracket (or paranthesis).\nOne thing to note here is that, there should be no \u0026ldquo;comma\u0026rdquo; between bracket (or paranthesis).\nPlease see below code sample for detail.\nCode sample:\n\u0026#39; Edit a Linear Sketch Pattern BoolStatus = swSketchManager.EditLinearSketchStepAndRepeat(5, 4, 1, 0.75, 0.785, 1.5708, \u0026#34;(3,2)(2,1)\u0026#34;, True, False, True, True, False, \u0026#34;Arc1_\u0026#34;)\rCASE 6 : Display the spacing between instances dimension along the \u0026ldquo;Y\u0026rdquo; axis In our code sample, we display the spacing between instances dimension along the X axis.\nWe do this by XSpacingDim = True.\nIf we want to display the spacing between instances dimension along the Y axis.\nFor that we need to set YSpacingDim = True.\nCode sample:\n\u0026#39; Edit a Linear Sketch Pattern BoolStatus = swSketchManager.EditLinearSketchStepAndRepeat(5, 4, 1, 0.75, 0.785, 1.5708, \u0026#34;(3,2)(2,1)\u0026#34;, True, True, True, True, False, \u0026#34;Arc1_\u0026#34;)\rExample Images:\nBelow image shows after we update value for display dimension along the Y axis.\nBefore Edit Linear Sketch Pattern\nCASE 7 : Display the angle dimension between axes In our code sample, we display the angle dimension between axes.\nWe do this by AngleDim = True.\nIf we don\u0026rsquo;t want to display the angle dimension between axes then we need to set AngleDim = False.\nCode sample:\n\u0026#39; Edit a Linear Sketch Pattern BoolStatus = swSketchManager.EditLinearSketchStepAndRepeat(5, 4, 1, 0.75, 0.785, 1.5708, \u0026#34;(3,2)(2,1)\u0026#34;, True, True, False, True, False, \u0026#34;Arc1_\u0026#34;)\rExample Images:\nBelow image shows after we update value to False for the angle dimension between axes.\nBefore Edit Linear Sketch Pattern\nCASE 8 : Display the number of instances in the \u0026ldquo;X\u0026rdquo; direction In our code sample, we display the number of instances along the X axis.\nWe do this by CreateNumOfInstancesDimInXDir = True.\nIf we don\u0026rsquo;t want to display the number of instances along the X axis then we need to set CreateNumOfInstancesDimInXDir = False.\nCode sample:\n\u0026#39; Edit a Linear Sketch Pattern BoolStatus = swSketchManager.EditLinearSketchStepAndRepeat(5, 4, 1, 0.75, 0.785, 1.5708, \u0026#34;(3,2)(2,1)\u0026#34;, True, True, False, False, False, \u0026#34;Arc1_\u0026#34;)\rExample Images:\nBelow image shows after we update value to False for not display the number of instances in the X direction.\nBefore Edit Linear Sketch Pattern\nCASE 9 : Display the number of instances in the \u0026ldquo;Y\u0026rdquo; direction In our code sample, we don\u0026rsquo;t display the number of instances along the Y axis.\nWe do this by CreateNumOfInstancesDimInYDir = False.\nIf we want to display the number of instances along the Y axis then we need to set CreateNumOfInstancesDimInYDir = True.\nCode sample:\n\u0026#39; Edit a Linear Sketch Pattern BoolStatus = swSketchManager.EditLinearSketchStepAndRepeat(5, 4, 1, 0.75, 0.785, 1.5708, \u0026#34;(3,2)(2,1)\u0026#34;, True, True, False, False, True, \u0026#34;Arc1_\u0026#34;)\rExample Images:\nBelow image shows after we update value to True for display the number of instances in the Y direction.\nBefore Edit Linear Sketch Pattern\nCASE 10 : Multiple entities as Seed In our code sample, we use only 1 circle for Linear Sketch pattern.\nBut in many cases we need to select many sketch entities.\nIn this condition, add the entities name with an underscore (_) one by one.\nFor example, we want to pattern a Ractangle, in this case, value of seed should be following:\nSeed : Line1_Line2_Line3_Line4_ NOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nPlease see below for detail:\nLength: Meter\nAngle: Radian\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means inches for distance. But when I used Solidworks API through VBA macros or C#, I need to converted numeric values.\nBecause Solidworks API output the distance in Meter which is not my requirement.\nThis is it !!!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Edit a Linear Sketch Pattern with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":124,"permalink":"/solidworks-macros/edit-linear-skech-pattern/","summary":"\u003cp\u003eIn this post, I tell you about \u003cstrong\u003ehow to Edit Linear Sketch Pattern using Solidworks VBA Macros\u003c/strong\u003e in a Sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Edit Linear Sketch Pattern"},{"content":"In this post, I tell you about how to Circular Sketch Pattern using Solidworks VBA Macros in a Sketch.\nVideo of Code on YouTube Please see below video how visually we Circular Sketch Pattern in Solidworks VBA macro.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nFor Experience Macro Developers If you are an experience Solidworks Macro developer, then you are looking for a specific code sample.\nBelow is the code for Circular Sketch Pattern from Solidworks VBA Macro.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Select Circle we want to Pattern BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 1, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Create a Circular Sketch Pattern BoolStatus = swSketchManager.CreateCircularSketchStepAndRepeat(0.5, 0, 3, 1, True, \u0026#34;\u0026#34;, True, True, True)\rMethod Name: CreateCircularSketchStepAndRepeat\nDescription: Create Linear Sketch Pattern of the selected sketch entity or entities.\nPrerequisites: To create a Linear Sketch Pattern a Solidworks Sketch entity or entities, first we need following things:\nSketch Entity/Entities to Pattern\nThat Entity/Entities is selected before pattern\nHow it works:\nFor Circular Sketch Pattern, first you need to Create a variable of Boolean type.\nAfter creating variable, you need to set the value of this Boolean variable.\nFor this you used CreateCircularSketchStepAndRepeat method from Solidworks Sketch Manager.\nThis CreateCircularSketchStepAndRepeat method set the value of Boolean type variable.\nIf the Circular Sketch Pattern is successful then CreateCircularSketchStepAndRepeat method return True value otherwise CreateCircularSketchStepAndRepeat returns False value.\nThis CreateCircularSketchStepAndRepeat method takes following parameters as explained:\nArcRadius : Radius for the circular sketch pattern.\nArcAngle : Angle relative to the sketch entities being patterned.\nPatternNum : Total number of instances, including the seed geometry.\nPatternSpacing : Spacing between pattern instances.\nPatternRotate : True to rotate the pattern, false to not.\nDeleteInstances : Number of instances to delete, passed as a string in the format: \u0026ldquo;(a) (b) (c)\u0026rdquo;.\nRadiusDim : True to display the radius dimension in the graphics area, false to not.\nAngleDim : True to display the angle dimension between axes in the graphics area, false to not.\nCreateNumOfInstancesDim : True to display the number of instances dimension in the graphics area, false to not.\nIf you want more detailed explaination then please read further otherwise this will help you to create a Circular Sketch Pattern.\nFor Beginner Macro Developers In this post, I tell you about CreateCircularSketchStepAndRepeat method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create Circular Sketch Pattern.\nBelow is the code sample to create Circular Sketch Pattern.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Create Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Set Sketch Segment value and Create a Circle Set swSketchSegment = swSketchManager.CreateCircleByRadius(0, 0, 0, 0.2) \u0026#39; De-select the lines after creation swDoc.ClearSelection2 True \u0026#39; Select Circle we want to Pattern BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Create a Circular Sketch Pattern BoolStatus = swSketchManager.CreateCircularSketchStepAndRepeat(0.5, 0, 3, 1, True, \u0026#34;\u0026#34;, True, True, True) \u0026#39; De-select the Sketch Segment after Circular Sketch Pattern swDoc.ClearSelection2 True \u0026#39; Show Front View after Circular Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Create variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment\rIn this line, we Create a variable which we named as swSketchSegment and the type of this swSketchSegment variable is SldWorks.SketchSegment.\nWe create variable swSketchSegment for Solidworks Sketch Segments.\nTo see methods and properties related to swSketchSegment object, please visit this page of Solidworks API Help\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis GetUserPreferenceStringValue() method is a part of our main Solidworks variable swApp.\n\u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout that post if you want to understand above code in more detail.\n\u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Set Sketch Segment value and Create a Circle Set swSketchSegment = swSketchManager.CreateCircleByRadius(0, 0, 0, 0.2)\rIn above line, we set the value of Solidworks Sketch Segment variable swSketchSegment by CreateCircleByRadius method from Solidworks Sketch Manager.\nThis CreateCircleByRadius method creates a Circle at given point with radius.\nFor more information about CreateCircleByRadius method, you can read my Solidworks Macro - Create Circle By Radius post.\nThat post describe all the parameters we need for this CreateCircleByRadius method in details.\nIn above line, we create a Circle with:\nCircle Centerpoint : At origin i.e. (0, 0, 0)\nCircle Radius : 0.2\n\u0026#39; De-select the lines after creation swDoc.ClearSelection2 True\rAfter creating the circle we de-select it.\nWe don\u0026rsquo;t need to de-select the circle for Pattern as we will select the circle agains in next line. I just want to show you how to select a Sketch Segment with SelectById Menthod in next line of code.\n\u0026#39; Select Circle we want to Pattern BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line of code, we select the Circle i.e. Arc 1 and add it to selection list.\n\u0026#39; Create a Circular Sketch Pattern BoolStatus = swSketchManager.CreateCircularSketchStepAndRepeat(0.5, 0, 3, 1, True, \u0026#34;\u0026#34;, True, True, True)\rIn above line, we Pattern selected Circle by CreateCircularSketchStepAndRepeat method from Solidworks Sketch Manger variable.\nThis CreateCircularSketchStepAndRepeat method takes following parameters as explained:\nArcRadius : Radius for the circular sketch pattern. This value is in radian.\nArcAngle : Angle relative to the sketch entities being patterned. This value is in radian.\nPatternNum : Total number of instances, including the seed geometry.\nPatternSpacing : Spacing between pattern instances. This value is in radian.\nPatternRotate : True to rotate the pattern, false to not.\nDeleteInstances : Number of instances to delete, passed as a string in the format: \u0026ldquo;(a) (b) (c)\u0026rdquo;.\nRadiusDim : True to display the radius dimension in the graphics area, false to not.\nAngleDim : True to display the angle dimension between axes in the graphics area, false to not.\nCreateNumOfInstancesDim : True to display the number of instances dimension in the graphics area, false to not.\nAfter the function complete following are the results:\nReturn Value:\nTrue: If Circular Sketch Pattern is Success.\nFalse: If Circular Sketch Pattern is Fail.\nCircular Sketch Pattern Parameter\nBelow image shows Circular Sketch Pattern Parameter.\nIn our code, I have used following values:\nArcRadius : I have used 0.5 value, Radius for the circular sketch pattern.\nArcAngle : I have used 0 value, Angle relative to the sketch entities being patterned.\nPatternNum : I have used 3 value, Total number of instances, including the seed geometry.\nPatternSpacing : I have used 1 value, Spacing between pattern instances.\nPatternRotate : I have used True value, to rotate the pattern.\nDeleteInstances : I have used \u0026quot;\u0026quot; i.e. empty string value number of instances to delete.\nRadiusDim : I have used True value, to display the radius dimension.\nAngleDim : I have used True value, to display the angle dimension between axes.\nCreateNumOfInstancesDim : I have used True value, display the number of instances dimension.\nBelow image shows before and after Circular Sketch Pattern.\nBefore Circular Sketch Pattern\nAfter Circular Sketch Pattern\nNOTE It is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nPlease see below for detail:\nLength: Meter\nAngle: Radian\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means inches for distance.\nBut when I used Solidworks API through VBA macros or C#, I need to converted numeric values.\nBecause Solidworks API output the distance in Meter which is not my requirement.\n\u0026#39; De-select the Sketch after creation swDoc.ClearSelection2 True\rIn the above line of code, we deselect the Sketch after the Circular Sketch Pattern operation.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Show Front View after Circular Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView\rIn the above line of code, we update the view orientation to Front View.\nIn my machine, after inserting a sketch view orientation does not changed.\nBecause of this I have to update the view to Front view.\nFor showing Front View we used ShowNamedView2 method from our Solidworks document name swDoc.\nThis method takes 2 parameter described as follows:\nVName : Name of the view to display or an empty string to use ViewId instead\nViewId : ID of the view to display as defined by swStandardViews_e or -1 to use the VName argument instead.\nNOTE: If you specify both VName and ViewId, then ViewId takes precedence if the two arguments do not resolve to the same view.\nswStandardViews_e has following Standard View Types:\nswBackView\nswBottomView\nswDimetricView\nswFrontView\nswIsometricView\nswLeftView\nswRightView\nswTopView\nswExtendetricView\nIn our code, we did not use VName instead I used empty string in form of \u0026quot;\u0026quot; symbol.\nI used ViewId value to specify view and used swStandardViews_e.swFrontView value to use Standard Front View.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nThis is it !!!\nIf you found anything to add or update, please let me know on my e-mail.\nVBA Language feature used in this post In this post used some features of VBA programming language.\nThis section of post, has some brief information about the VBA programming language specific features.\nWe use Option Explicit for capturing un-declared variables. If you want to read more about Option Explicit then please visit Declaring and Scoping of Variables.\nThen we create variable for different data types. If you know in detail about the Variables, then please visit Variables and Data-types posts of this blog. It will help you to understand what Variables are and how to use them.\nThen we create main Sub procedure for our macro. If you know in detail about the Sub procedure, then I suggest you to visit VBA Sub and Function Procedures and Executing Sub and Function Procedures posts of this blog. It will help you to understand what Procedures are and how to use them.\nIn most part we create some variables and set their values. We set those values by using some functions provided from objects. If you don\u0026rsquo;t know about the functions, then you should visit VBA Functions and VBA Functions that do more posts of this blog. It will help you to understand what functions are and how to use them.\nSolidworks API Objects In this post of Circular Sketch Pattern, we use Solidworks API objects and their methods.\nThis section contains the list of all Solidworks Objects used in this post.\nI have also attached links of these Solidworks API Objects in API Help website.\nIf you want to explore those objects, you can use these links.\nThese Solidworks API Objects are listed below:\nSolidworks Application Object\nIf you want explore Properties and Methods/Functions of Solidworks Application Object object you can visit this link.\nSolidworks Document Object\nIf you want explore Properties and Methods/Functions of Solidworks Document Object object you can visit this link.\nSolidworks Sketch Manager Object\nIf you want explore Properties and Methods/Functions of Solidworks Sketch Manager Object you can visit this link.\nSolidworks Sketch Segment Object\nIf you want explore Properties and Methods/Functions of Solidworks Sketch Segment Object you can visit this link.\nHope this post helps you to Create Circular Sketch Pattern with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":125,"permalink":"/solidworks-macros/circular-skech-pattern/","summary":"\u003cp\u003eIn this post, I tell you about \u003cstrong\u003ehow to Circular Sketch Pattern using Solidworks VBA Macros\u003c/strong\u003e in a Sketch.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"video-of-code-on-youtube\"\u003eVideo of Code on YouTube\u003c/h2\u003e\n\u003cp\u003ePlease see below video how visually we \u003cem\u003eCircular Sketch Pattern\u003c/em\u003e in \u003cstrong\u003eSolidworks VBA macro\u003c/strong\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Circular Sketch Pattern"},{"content":"Introduction In this post, I tell you about how to Edit Circular Sketch Pattern using Solidworks VBA Macros in a Sketch.\nIn this post, I explain about EditCircularSketchStepAndRepeat method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to edit existing Circular Sketch Pattern.\nThis post is a little different of previous Solidworks Macro - Circular Sketch Pattern post.\nThere are 2 changes I have made, which I am going to use on future posts also.\nThese change are explain below:\nIn this post I used code sample from General - Fix Unit Issue post to fix unit conversion issue and show how to use it.\nIn input parameter of EditCircularSketchStepAndRepeat method, I passed variables not direct values. This helps us to maintain the code and modification of existing code is simple.\nVideo of Code on YouTube Please see below video on how to Edit Circular Sketch Pattern from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample to edit Circular Sketch Pattern.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Create Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39;-----------------------UNIT CONVERSION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;---------------------------------------------------------------- \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Circle Radius Dim circleRadius As Double circleRadius = 5 * LengthConversionFactor \u0026#39; Set Sketch Segment value and Create a Circle Set swSketchSegment = swSketchManager.CreateCircleByRadius(0, 0, 0, circleRadius) \u0026#39; De-select the lines after creation swDoc.ClearSelection2 True \u0026#39; Select Circle we want to Pattern BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Arc Radius Dim arcRadius As Double arcRadius = 10 * LengthConversionFactor \u0026#39; Arc Angle Dim arcAngle As Double arcAngle = 0 * AngleConversionFactor \u0026#39; Number of Instances Dim numberOfInstance As Double numberOfInstance = 3 \u0026#39; Pattern Spacing Dim patternSpacing As Double patternSpacing = 5 * AngleConversionFactor \u0026#39; Create a Circular Sketch Pattern BoolStatus = swSketchManager.CreateCircularSketchStepAndRepeat(arcRadius, arcAngle, numberOfInstance, patternSpacing, True, \u0026#34;\u0026#34;, True, True, True) \u0026#39; De-select the Sketch Segment after Circular Sketch Pattern swDoc.ClearSelection2 True \u0026#39; Update Arc Radius arcRadius = 20 * LengthConversionFactor \u0026#39; Edit a Circular Sketch Pattern BoolStatus = swSketchManager.EditCircularSketchStepAndRepeat(arcRadius, arcAngle, numberOfInstance, patternSpacing, True, \u0026#34;\u0026#34;, True, True, True, \u0026#34;Arc1_\u0026#34;) \u0026#39; Show Front View after Circular Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Create variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment\rIn this line, we Create a variable which we named as swSketchSegment and the type of this swSketchSegment variable is SldWorks.SketchSegment.\nWe create variable swSketchSegment for Solidworks Sketch Segments.\nTo see methods and properties related to swSketchSegment object, please visit this page of Solidworks API Help\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis GetUserPreferenceStringValue() method is a part of our main Solidworks variable swApp.\n\u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout that post if you want to understand above code in more detail.\n\u0026#39;-----------------------UNIT CONVERSION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;----------------------------------------------------------------\rAbove code sample shows how to fix Solidworks API Unit issue.\nWe 1st get the current unit of the part and apply the switch statements to update our Length and Angle Conversion factors.\nI have already explained in detail about Fixing Solidworks API Unit Issue in General - Fix Unit Issue blog post.\nDo checkout above post for Fixing Solidworks API Issue.\n\u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Circle Radius Dim circleRadius As Double circleRadius = 5 * LengthConversionFactor\rIn above code sample, we do following:\nCreate a local variable named circleRadius, which is Double type.\nIn 2nd line, we assign a value of 5 to our circleRadius variable, also we multiple with our LengthConversionFactor variable.\nSince I am using IPS unit system, I want to create a circle of Radius 5 inch.\n\u0026#39; Set Sketch Segment value and Create a Circle Set swSketchSegment = swSketchManager.CreateCircleByRadius(0, 0, 0, circleRadius)\rIn above line, we set the value of Solidworks Sketch Segment variable swSketchSegment by CreateCircleByRadius method from Solidworks Sketch Manager.\nThis CreateCircleByRadius method creates a Circle at given point with radius.\nFor more information about CreateCircleByRadius method, you can read my Solidworks Macro - Create Circle By Radius post.\nThat post describe all the parameters we need for this CreateCircleByRadius method in details.\nIn above line, we create a Circle with:\nCircle Centerpoint : At origin i.e. (0, 0, 0)\nCircle Radius : circleRadius\n\u0026#39; De-select the Sketch after creation swDoc.ClearSelection2 True\rIn the above line of code, we deselect the Sketch after the Circular Sketch Pattern operation.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Select Circle we want to Pattern BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line of code, we select the Circle i.e. Arc 1 and add it to selection list.\n\u0026#39; Arc Radius Dim arcRadius As Double arcRadius = 10 * LengthConversionFactor\rAbove code sample creates a variable for Arc Radius and assign value.\nWhile assigning the value we multiple with LengthConversionFactor to get correct length.\nVariable Name: arcRadius\nVariable type: Double\nVariable Value: 10 inch\nWe want Arc Radius to 10 inch.\nBy creating the variables we can handle the values more effciently.\n\u0026#39; Arc Angle Dim arcAngle As Double arcAngle = 0 * AngleConversionFactor\rAbove code sample creates a variable for Arc Angle and assign value.\nWhile assigning the value we multiple with AngleConversionFactor to get correct angle.\nVariable Name: arcAngle\nVariable type: Double\nVariable Value: 0\nWe want Arc Angle to 0 degree.\n\u0026#39; Number of Instances Dim numberOfInstance As Double numberOfInstance = 3\rAbove code sample creates a variable for Number of Instances and assign value.\nVariable Name: numberOfInstance\nVariable type: Double\nVariable Value: 3\nWe want 3 copies of the circle including the seed i.e. original circle.\n\u0026#39; Pattern Spacing Dim patternSpacing As Double patternSpacing = 5 * AngleConversionFactor\rAbove code sample creates a variable for Pattern Spacing and assign value.\nWhile assigning the value we multiple with AngleConversionFactor to get correct angle.\nVariable Name: patternSpacing\nVariable type: Double\nVariable Value: 5\nWe want 5 degree of spacing between each circle.\n\u0026#39; Create a Circular Sketch Pattern BoolStatus = swSketchManager.CreateCircularSketchStepAndRepeat(arcRadius, arcAngle, numberOfInstance, patternSpacing, True, \u0026#34;\u0026#34;, True, True, True)\rIn above code sample we Create a Circular Sketch Pattern of the selected circle by CreateCircularSketchStepAndRepeat method from Solidworks Sketch Manger variable.\nAs you can see we pass our previously created variables arcRadius, arcAngle, numberOfInstance and patternSpacing in CreateCircularSketchStepAndRepeat method as parameters.\nI have explained CreateCircularSketchStepAndRepeat method in detail in Sketch - Circular Sketch Pattern post.\nPlease see above post if you want to learn more about CreateCircularSketchStepAndRepeat method and its parameters.\nBelow image shows Circular Sketch Pattern Parameter.\n\u0026#39; De-select the Sketch Segment after Circular Sketch Pattern swDoc.ClearSelection2 True\rIn above line we de-select the Sketch Segment after creating Circular Sketch Pattern.\n\u0026#39; Update Arc Radius arcRadius = 20 * LengthConversionFactor\rIn above line we Update Arc Radius to new value which we will use in Editing previously created Circular Sketch pattern.\nVariable Name: arcRadius\nUpdated Value: 20 inch\n\u0026#39; Edit a Circular Sketch Pattern BoolStatus = swSketchManager.EditCircularSketchStepAndRepeat(arcRadius, arcAngle, numberOfInstance, patternSpacing, True, \u0026#34;\u0026#34;, True, True, True, \u0026#34;Arc1_\u0026#34;)\rFor \u0026ldquo;editing\u0026rdquo; a Circular Sketch pattern, we need EditCircularSketchStepAndRepeat method from Solidworks Sketch Manager object/variable.\nThis CreateCircularSketchStepAndRepeat method takes following parameters as explained:\nArcRadius : Radius for the circular sketch pattern. This value is in radian.\nArcAngle : Angle relative to the sketch entities being patterned. This value is in radian.\nPatternNum : Total number of instances, including the seed geometry.\nPatternSpacing : Spacing between pattern instances. This value is in radian.\nPatternRotate : True to rotate the pattern, false to not.\nDeleteInstances : Number of instances to delete, passed as a string in the format: \u0026ldquo;(a) (b) (c)\u0026rdquo;.\nRadiusDim : True to display the radius dimension in the graphics area, false to not.\nAngleDim : True to display the angle dimension between axes in the graphics area, false to not.\nCreateNumOfInstancesDim : True to display the number of instances dimension in the graphics area, false to not.\nSeed: List of the names of the entities, separated by the underscore character (), that comprise the seed pattern (e.g., Arc1 as a seed pattern).\nNOTE: In Seed, adding underscore(_) after selected entity is important, otherwise code will note work.\nAfter the function complete following are the results:\nReturn Value:\nTrue: If Edit Circular Sketch Pattern is Success.\nFalse: If Edit Circular Sketch Pattern is Fail.\nCases In this section, we will go through different cases by\nModifying different parameters\nSee images, before and after parameter modification\nCASE 1 : Update Arc Radius In our code, if we want to update Arc Radius, then we need to update arcRadius variable only.\n\u0026#39; Update Arc Radius arcRadius = 20 * LengthConversionFactor\rIn above line we Update Arc Radius to new value. of 20 inch.\nExample Images:\nBelow image shows before and after we update Arc Radius.\nBefore Update Arc Radius\nAfter Update Arc Radius\nCASE 2 : Update Arc Angle In our code, if we want to update Arc Angle, then we need to update arcAngle variable only.\n\u0026#39; Update Arc Angle arcAngle = 30 * AngleConversionFactor\rIn above line we Update Arc Angle to new value of 30 inch.\nExample Images:\nBelow image shows before and after we update Arc Angle.\nBefore Update Arc Angle\nAfter Update Arc Angle\nCASE 3 : Update Number of Instances In our code, if we want to update Number of Instances, then we need to update numberOfInstance variable only.\n\u0026#39; Update Number of Instances numberOfInstance = 5\rIn above line we Update Number of Instances to new value of 5 number of instances.\nExample Images:\nBelow image shows before and after we update Number of Instances.\nBefore Update Number of Instances\nAfter Update Number of Instances\nCASE 4 : Update Pattern Spacing In our code, if we want to update Number of Instances, then we need to update patternSpacing variable only.\n\u0026#39; Update Pattern Spacing patternSpacing = 10 * AngleConversionFactor\rIn above line we Update Pattern Spacing to new value of 10 degree.\nExample Images:\nBelow image shows before and after we update Pattern Spacing.\nBefore Update Pattern Spacing\nAfter Update Pattern Spacing\nCASE 5 : Update Display Rotation of Pattern If we want to update Display Rotation of Pattern, then we need to update value to either True or False.\nIn our code, we set this value to True which means we are displaying the rotation of pattern.\nWe update our code for not displaying the rotation of pattern as given in below code sample.\n\u0026#39; Edit a Circular Sketch Pattern BoolStatus = swSketchManager.EditCircularSketchStepAndRepeat(arcRadius, arcAngle, numberOfInstance, patternSpacing, False, \u0026#34;\u0026#34;, True, True, True, \u0026#34;Arc1_\u0026#34;)\rExample Images:\nBelow image shows before and after we update Display Rotation of Pattern.\nBefore Update Display Rotation of Pattern\nAfter Update Display Rotation of Pattern\nCASE 6 : Update Number of Instances to Delete If we want to update Number of Instances to Delete, then we need to update value of \u0026quot;\u0026quot; as given in below code sample.\n\u0026#39; Edit a Circular Sketch Pattern BoolStatus = swSketchManager.EditCircularSketchStepAndRepeat(arcRadius, arcAngle, numberOfInstance, patternSpacing, False, \u0026#34;(3)\u0026#34;, True, True, True, \u0026#34;Arc1_\u0026#34;)\rIn above code sample, we want to delete 3rd instance hence we pass the number 3 inside ().\nNote: For delete any instance we need to pass its position in paranthesis (). Otherwise it won\u0026rsquo;t work.\nExample Images:\nBelow image shows before and after we update Number of Instances to Delete.\nBefore Update Number of Instances to Delete\nAfter Update Number of Instances to Delete\nCASE 7 : Update Display Radius Dimension If we want to update Display Radius Dimension, then we need to update value to either True or False.\nIn our code, we set this value to True which means we are displaying the Display Radius Dimension.\nWe update our code for not displaying the Display Radius Dimension as given in below code sample.\n\u0026#39; Edit a Circular Sketch Pattern BoolStatus = swSketchManager.EditCircularSketchStepAndRepeat(arcRadius, arcAngle, numberOfInstance, patternSpacing, False, \u0026#34;(3)\u0026#34;, False, True, True, \u0026#34;Arc1_\u0026#34;)\rExample Images:\nBelow image shows before and after we update Display Radius Dimension.\nBefore Update Display Radius Dimension\nAfter Update Display Radius Dimension\nCASE 8 : Update Display Angle Dimension If we want to update Display Angle Dimension, then we need to update value to either True or False.\nIn our code, we set this value to True which means we are displaying the Display Angle Dimension.\nWe update our code for not displaying the Display Angle Dimension as given in below code sample.\n\u0026#39; Edit a Circular Sketch Pattern BoolStatus = swSketchManager.EditCircularSketchStepAndRepeat(arcRadius, arcAngle, numberOfInstance, patternSpacing, False, \u0026#34;(3)\u0026#34;, False, False, True, \u0026#34;Arc1_\u0026#34;)\rExample Images:\nBelow image shows before and after we update Display Angle Dimension.\nBefore Update Display Angle Dimension\nAfter Update Display Angle Dimension\nCASE 9 : Update Display Number of Instances If we want to update Display Number of Instances, then we need to update value to either True or False.\nIn our code, we set this value to True which means we are displaying the Display Number of Instances.\nWe update our code for not displaying the Display Number of Instances as given in below code sample.\n\u0026#39; Edit a Circular Sketch Pattern BoolStatus = swSketchManager.EditCircularSketchStepAndRepeat(arcRadius, arcAngle, numberOfInstance, patternSpacing, False, \u0026#34;(3)\u0026#34;, False, False, False, \u0026#34;Arc1_\u0026#34;)\rExample Images:\nBelow image shows before and after we update Display Number of Instances.\nBefore Update Display Number of Instances\nAfter Update Display Number of Instances\nThis is it !!!\nIt is indeed a very LONG post. But I try to update the code and move into the direction where we were able to use these code samples in UserForms.\nI hope you like my effort!!!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Edit a Circular Sketch Pattern with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":126,"permalink":"/solidworks-macros/edit-circular-skech-pattern/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eIn this post, I tell you about \u003cstrong\u003ehow to Edit Circular Sketch Pattern using Solidworks VBA Macros\u003c/strong\u003e in a Sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Edit Circular Sketch Pattern"},{"content":"Introduction In this post, I tell you about how to Move/Copy Sketch Entities using Solidworks VBA Macros in a Sketch.\nIn this post, I explain about MoveOrCopy method from Solidworks ModelDoc2\u0026rsquo;s Extension object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to MoveOrCopy Sketch Entities.\nThis post is similar to previous Solidworks Macro - Edit Circular Sketch Pattern post.\nIf you have not visited my previous Solidworks Macro - Edit Circular Sketch Pattern post, then please do check-it if you want to learn Editing Circular Sketch Patterns.\nVideo of Code on YouTube Please see below video on how to Move/Copy Sketch Entities from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample to Move/Copy Sketch Entities.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Create Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39;-----------------------UNIT CONVERSION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;---------------------------------------------------------------- \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Circle Radius Dim circleRadius As Double circleRadius = 5 * LengthConversionFactor \u0026#39; Set Sketch Segment value and Create a Circle Set swSketchSegment = swSketchManager.CreateCircleByRadius(0, 0, 0, circleRadius) \u0026#39; Defining variables for Destination Co-ordinates Dim destinationCoOrdinateInXDir As Double, destinationCoOrdinateInYDir As Double \u0026#39; Setting the values of Destination Co-ordinates in X \u0026amp; Y directions for Move destinationCoOrdinateInXDir = 10 * LengthConversionFactor destinationCoOrdinateInYDir = 10 * LengthConversionFactor \u0026#39; Move circle swDoc.Extension.MoveOrCopy False, 1, False, 0, 0, 0, destinationCoOrdinateInXDir, destinationCoOrdinateInYDir, 0 \u0026#39; Setting the values of Destination Co-ordinates in X \u0026amp; Y directions for Copy destinationCoOrdinateInXDir = 15 * LengthConversionFactor destinationCoOrdinateInYDir = 15 * LengthConversionFactor \u0026#39; Copy circle swDoc.Extension.MoveOrCopy True, 3, True, 0, 0, 0, destinationCoOrdinateInXDir, destinationCoOrdinateInYDir, 0 \u0026#39; De-select the lines after creation swDoc.ClearSelection2 True \u0026#39; Show Front View after Circular Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Create variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment\rIn this line, we Create a variable which we named as swSketchSegment and the type of this swSketchSegment variable is SldWorks.SketchSegment.\nWe create variable swSketchSegment for Solidworks Sketch Segments.\nTo see methods and properties related to swSketchSegment object, please visit this page of Solidworks API Help\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis GetUserPreferenceStringValue() method is a part of our main Solidworks variable swApp.\n\u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout that post if you want to understand above code in more detail.\n\u0026#39;-----------------------UNIT CONVERSION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;----------------------------------------------------------------\rAbove code sample shows how to fix Solidworks API Unit issue.\nWe 1st get the current unit of the part and apply the switch statements to update our Length and Angle Conversion factors.\nI have already explained in detail about Fixing Solidworks API Unit Issue in General - Fix Unit Issue blog post.\nDo checkout above post for Fixing Solidworks API Issue.\n\u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Circle Radius Dim circleRadius As Double circleRadius = 5 * LengthConversionFactor\rIn above code sample, we do following:\nCreate a local variable named circleRadius, which is Double type.\nIn 2nd line, we assign a value of 5 to our circleRadius variable, also we multiple with our LengthConversionFactor variable.\nSince I am using IPS unit system, I want to create a circle of Radius 5 inch.\n\u0026#39; Set Sketch Segment value and Create a Circle Set swSketchSegment = swSketchManager.CreateCircleByRadius(0, 0, 0, circleRadius)\rIn above line, we set the value of Solidworks Sketch Segment variable swSketchSegment by CreateCircleByRadius method from Solidworks Sketch Manager.\nThis CreateCircleByRadius method creates a Circle at given point with radius.\nFor more information about CreateCircleByRadius method, you can read my Solidworks Macro - Create Circle By Radius post.\nThat post describe all the parameters we need for this CreateCircleByRadius method in details.\nIn above line, we create a Circle with:\nCircle Centerpoint : At origin i.e. (0, 0, 0)\nCircle Radius : circleRadius\n\u0026#39; Defining variables for Destination Co-ordinates Dim destinationCoOrdinateInXDir As Double, destinationCoOrdinateInYDir As Double\rIn above line of code, we create two variables of double type in one single line.\nThese variables we use for defining Destination Co-ordinates.\nVariables Name:\ndestinationCoOrdinateInXDir\ndestinationCoOrdinateInYDir\n\u0026#39; Setting the values of Destination Co-ordinates in X \u0026amp; Y directions for Move destinationCoOrdinateInXDir = 10 * LengthConversionFactor destinationCoOrdinateInYDir = 10 * LengthConversionFactor\rIn above line of code, we set the values of Destination Co-ordinates in X \u0026amp; Y directions for Move selected circle.\nVariables Values:\ndestinationCoOrdinateInXDir = 10 * LengthConversionFactor\n10\u0026quot; in X direction.\ndestinationCoOrdinateInYDir = 10 * LengthConversionFactor\n10\u0026quot; in Y direction.\n\u0026#39; Move circle swDoc.Extension.MoveOrCopy False, 1, False, 0, 0, 0, destinationCoOrdinateInXDir, destinationCoOrdinateInYDir, 0\rFor \u0026ldquo;Moving\u0026rdquo; a sketch entity, we need MoveOrCopy method from Solidworks ModelDoc2\u0026rsquo;s Extension object.\nThis MoveOrCopy method takes following parameters as explained:\nCopy : True to copy the sketch entities, False to not.\nNumCopies : Number of copies you want to create.\nKeepRelations : True to keep sketch relations after Move or Copy operation, False to not.\nBaseX : X coordinate of the base point from which to move the sketch entities.\nBaseY : Y coordinate of the base point from which to move the sketch entities.\nBaseZ : Z coordinate of the base point from which to move the sketch entities.\nDestX : X coordinate of the destination point from which to move the sketch entities.\nDestY : Y coordinate of the destination point from which to move the sketch entities.\nDestZ : Z coordinate of the destination point from which to move the sketch entities.\nNOTE: There are no return value after this function.\nCases In this section, we will go through different cases by\nModifying different parameters\nSee images, before and after parameter modification\nCASE 1 : Move Sketch Entities In our code, if we want to Move Sketch Entities, then we need to use code sample as given below:\n\u0026#39; Defining variables for Destination Co-ordinates Dim destinationCoOrdinateInXDir As Double, destinationCoOrdinateInYDir As Double \u0026#39; Setting the values of Destination Co-ordinates in X \u0026amp; Y directions for Move destinationCoOrdinateInXDir = 10 * LengthConversionFactor destinationCoOrdinateInYDir = 10 * LengthConversionFactor \u0026#39; Move circle swDoc.Extension.MoveOrCopy False, 1, False, 0, 0, 0, destinationCoOrdinateInXDir, destinationCoOrdinateInYDir, 0\rIn above line we Move Sketch Entities to new position i.e. 10\u0026quot; in X-Direction and 10\u0026quot; in Y-Direction.\nIn above code we need to set following parameters:\nCopy : False to not create a copy.\nNumCopies : Number of copies you want to create to 1 which is itself.\nKeepRelations : True to keep sketch relations after Move or Copy operation.\nBaseX : X coordinate of the base point = 0\nBaseY : Y coordinate of the base point = 0\nBaseZ : Z coordinate of the base point = 0\nDestX : X coordinate of the destination = 10\u0026quot;\nDestY : Y coordinate of the destination point = 10\u0026quot;\nDestZ : Z coordinate of the destination point = 0\nExample Images:\nBelow image shows before and after we Move Sketch Entitny.\nBefore Move Sketch Entitny\nAfter Move Sketch Entitny\nCASE 2 : Copy Sketch Entities In our code, if we want to Copy Sketch Entities, then we need to use code sample as given below:\n\u0026#39; Defining variables for Destination Co-ordinates Dim destinationCoOrdinateInXDir As Double, destinationCoOrdinateInYDir As Double \u0026#39; Setting the values of Destination Co-ordinates in X \u0026amp; Y directions for Move destinationCoOrdinateInXDir = 15 * LengthConversionFactor destinationCoOrdinateInYDir = 15 * LengthConversionFactor \u0026#39; Copy circle swDoc.Extension.MoveOrCopy True, 3, True, 0, 0, 0, destinationCoOrdinateInXDir, destinationCoOrdinateInYDir, 0\rIn above line we Copy Sketch Entities to new position i.e. 15\u0026quot; in X-Direction and 15\u0026quot; in Y-Direction for every copy of sketch.\nThis will more clear in below images when you scroll down.\nIn above code we need to set following parameters:\nCopy : True to create a copy.\nNumCopies : Number of copies we want to create: 3\nKeepRelations : True to keep sketch relations after Move or Copy operation.\nBaseX : X coordinate of the base point = 0\nBaseY : Y coordinate of the base point = 0\nBaseZ : Z coordinate of the base point = 0\nDestX : X coordinate of the destination = 15\u0026quot;\nDestY : Y coordinate of the destination point = 15\u0026quot;\nDestZ : Z coordinate of the destination point = 0\nExample Images:\nBelow image shows before and after we Copy Sketch Entitny.\nBefore Copy Sketch Entitny\nAfter Copy Sketch Entitny\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Move/Copy Sketch Entities with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":127,"permalink":"/solidworks-macros/move-copy-sketch-entities/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eIn this post, I tell you about \u003cstrong\u003ehow to Move/Copy Sketch Entities using Solidworks VBA Macros\u003c/strong\u003e in a Sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Move/Copy Sketch Entities"},{"content":"Introduction In this post, I tell you about how to Rotate/Copy Sketch Entities using Solidworks VBA Macros in a Sketch.\nIn this post, I explain about RotateOrCopy method from Solidworks ModelDoc2\u0026rsquo;s Extension object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to RotateOrCopy Sketch Entities.\nThis post is similar to previous Sketch Transformation - Move/Copy Sketch Entities post.\nIf you have not visited my previous Sketch Transformation - Move/Copy Sketch Entities post, then please do check-it if you want to learn Move/Copy Sketch Entitiess.\nVideo of Code on YouTube Please see below video on how to Rotate/Copy Sketch Entities from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample to Rotate/Copy Sketch Entities.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Create Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39;-----------------------UNIT CONVERSION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;---------------------------------------------------------------- \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Create a local variable for CenterPoint ractangle Dim vSketch As Variant \u0026#39; Create CenterPoint ractangle vSketch = swSketchManager.CreateCenterRectangle(0, 0, 0, 1 * LengthConversionFactor, 1 * LengthConversionFactor, 0) \u0026#39; De-select the lines after creation swDoc.ClearSelection2 True \u0026#39; Select all lines of CenterPoint Ractangle BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line2\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line3\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line4\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Rotate CenterPoint Ractangle by 45 degree only swDoc.Extension.RotateOrCopy False, 1, True, 0, 0, 0, 0, 0, 1, 45 * AngleConversionFactor \u0026#39; De-select all after creation swDoc.ClearSelection2 True \u0026#39; Show Front View after Circular Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Create variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment\rIn this line, we Create a variable which we named as swSketchSegment and the type of this swSketchSegment variable is SldWorks.SketchSegment.\nWe create variable swSketchSegment for Solidworks Sketch Segments.\nTo see methods and properties related to swSketchSegment object, please visit this page of Solidworks API Help\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis GetUserPreferenceStringValue() method is a part of our main Solidworks variable swApp.\n\u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout that post if you want to understand above code in more detail.\n\u0026#39;-----------------------UNIT CONVERSION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;----------------------------------------------------------------\rAbove code sample shows how to fix Solidworks API Unit issue.\nWe 1st get the current unit of the part and apply the switch statements to update our Length and Angle Conversion factors.\nI have already explained in detail about Fixing Solidworks API Unit Issue in General - Fix Unit Issue blog post.\nDo checkout above post for Fixing Solidworks API Issue.\n\u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Create a local variable for CenterPoint ractangle Dim vSketch As Variant \u0026#39; Create CenterPoint ractangle vSketch = swSketchManager.CreateCenterRectangle(0, 0, 0, 1 * LengthConversionFactor, 1 * LengthConversionFactor, 0)\rIn above code sample, we do following:\nCreate a local variable named vSketch, which is Variant type.\nIn 2nd line, we Create CenterPoint ractangle by using CreateCenterRectangle method.\nThis `CreateCenterRectangle` method is available in `swSketchManager` variable.\rThis CreateCenterRectangle method return a value. We store that value in previously defined variable vSketch. Side of CenterPoint ractangle: 1\u0026quot; or 1 inch\nIf you want to know more about CreateCenterRectangle method, then please visit Sketch - Create Center Rectangle post.\nI have given a detail explaination about CreateCenterRectangle method there.\n\u0026#39; De-select the lines after creation swDoc.ClearSelection2 True\rAfter creating a Square, we de-select all entities.\n\u0026#39; Select all lines of Center Ractangle BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line2\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line3\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line4\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line of code, we select all lines of Center Ractangle by using SelectByID2 method from swDoc.Extension object.\nI have not create separate variable Extension, because I like to avoid creating extra objects.\nPlease not that we have selected only Sides, not the diagonals.\n\u0026#39; Rotate Center Ractangle swDoc.Extension.RotateOrCopy False, 1, True, 0, 0, 0, 0, 0, 1, 45 * AngleConversionFactor\rFor \u0026ldquo;Rotating\u0026rdquo; a sketch entity, we need RotateOrCopy method from Solidworks ModelDoc2\u0026rsquo;s Extension object.\nThis RotateOrCopy method takes following parameters as explained:\nCopy : True to copy the sketch entities, False to not.\nNumCopies : Number of copies you want to create.\nKeepRelations : True to keep sketch relations after Rotate or Copy operation, False to not.\nBaseX : X coordinate of the base point from which to Rotate the sketch entities.\nBaseY : Y coordinate of the base point from which to Rotate the sketch entities.\nBaseZ : Z coordinate of the base point from which to Rotate the sketch entities.\nDestX : X coordinate of the destination point from which to Rotate the sketch entities.\nDestY : Y coordinate of the destination point from which to Rotate the sketch entities.\nDestZ : Z coordinate of the destination point from which to Rotate the sketch entities.\nAngle : Angle of Rotation by which we rotate the selected sketch entities.\nNOTE: There are no return value after this function.\nDestination Point Values Destination Point is defined by following parameters:\nDestX\nDestY\nDestZ\nThe values of these parameters are mainly dependent on the plane, you have selected.\nThere values as per Default Planes is given below.\nOn X-Y Plane When X-Y plane is selected, then values are:\nDestX = 0\nDestY = 0\nDestZ = 1\nOn Y-Z Plane When Y-Z plane is selected, then values are:\nDestX = 1\nDestY = 0\nDestZ = 0\nOn X-Z Plane When X-Z plane is selected, then values are:\nDestX = 0\nDestY = 1\nDestZ = 0\nSince we are creating our Sketch in X-Y plane, hence I used the values accordingly.\nCases In this section, we will go through different cases by\nModifying different parameters\nSee images, before and after parameter modification\nCASE 1 : Rotate Sketch Entities In our code, if we want to Rotate Sketch Entities, then we need to use code sample as given below:\n\u0026#39; Rotate circle swDoc.Extension.RotateOrCopy False, 1, True, 0, 0, 0, 0, 0, 1, 45 * AngleConversionFactor\rIn above code we Rotate Sketch Entities with:\nBase Point : 0, 0, 0\nRotation Angle : 45 Degree Anti-clock wise.\nIf you want to rotate Clock-wise, then then use Negeative (-ve) value.\nIn above code we need to set following parameters:\nCopy : False to not create a copy.\nNumCopies : Number of copies you want to create to 1 which is itself.\nKeepRelations : True to keep sketch relations after Rotate or Copy operation.\nBaseX : X coordinate of the base point = 0\nBaseY : Y coordinate of the base point = 0\nBaseZ : Z coordinate of the base point = 0\nSince we are creating sketch in X-Y plane, hence I used values mentioned in Destination Point Values section of this post.\nDestX : X coordinate of the destination = 0\nDestY : Y coordinate of the destination point = 0\nDestZ : Z coordinate of the destination point = 1\nRotation Angle : Angle of Rotation by which we rotate the selected sketch entities = 45 Degree Anti-clock wise.\nExample Images:\nBelow image shows before and after we Rotate Sketch Entitny.\nBefore Rotate Sketch Entitny\nAfter Rotate Sketch Entitny\nCASE 2 : Copy and Rotate Sketch Entities In our code, if we want to Copy and Rotate Sketch Entities, then we need to use code sample as given below:\n\u0026#39; Copy circle swDoc.Extension.RotateOrCopy True, 2, True, 0, 0, 0, destinationCoOrdinateInXDir, destinationCoOrdinateInYDir, 0\rIn above code we Rotate Sketch Entities with:\nCreate Copy : True\nBase Point : 0, 0, 0\nRotation Angle of Copied Entity : 45 Degree Anti-clock wise.\nIf you want to rotate Clock-wise, then then use Negeative (-ve) value.\nIn above code we need to set following parameters:\nCopy : True to not create a copy.\nNumCopies : Number of copies you want to create to 2 which is itself.\nKeepRelations : True to keep sketch relations after Rotate or Copy operation.\nBaseX : X coordinate of the base point = 0\nBaseY : Y coordinate of the base point = 0\nBaseZ : Z coordinate of the base point = 0\nSince we are creating sketch in X-Y plane, hence I used values mentioned in Destination Point Values sections of this post.\nDestX : X coordinate of the destination = 0\nDestY : Y coordinate of the destination point = 0\nDestZ : Z coordinate of the destination point = 1\nRotation Angle : Angle of Rotation by which we rotate the selected sketch entities = 45 Degree Anti-clock wise.\nExample Images:\nBelow image shows before and after we Rotate Sketch Entitny.\nBefore Rotate Sketch Entitny\nAfter Rotate Sketch Entitny\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Rotate/Copy Sketch Entities with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":128,"permalink":"/solidworks-macros/rotate-copy-sketch-entities/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eIn this post, I tell you about \u003cstrong\u003ehow to Rotate/Copy Sketch Entities using Solidworks VBA Macros\u003c/strong\u003e in a Sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Rotate/Copy Sketch Entities"},{"content":"In this post, I tell you about how to Toggle (Hide/Show) Sketch Relations using Solidworks VBA Macros in a Sketch.\nThis post is extension to Sketch Transformation - Rotate/Copy Sketch Entities post.\nHence I will explained only Toggle (Hide/Show) Sketch Relations related code.\nIn this post, I explain about SetUserPreferenceToggle method from Solidworks\u0026rsquo;s ModelDoc2 object.\nThis method is NOT updated method, but it is easiest way to Toggle (Hide/Show) Sketch Relations.\nVideo of Code on YouTube Please see below video on how to Toggle (Hide/Show) Sketch Relations from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample to Toggle (Hide/Show) Sketch Relations.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Create Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39;-----------------------UNIT CONVERSION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;---------------------------------------------------------------- \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Create a local variable for CenterPoint ractangle Dim vSketch As Variant \u0026#39; Create CenterPoint ractangle vSketch = swSketchManager.CreateCenterRectangle(0, 0, 0, 1 * LengthConversionFactor, 1 * LengthConversionFactor, 0) \u0026#39; De-select the lines after creation swDoc.ClearSelection2 True \u0026#39; Select all lines of CenterPoint Ractangle BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line2\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line3\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line4\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Rotate CenterPoint Ractangle by 45 degree only swDoc.Extension.RotateOrCopy True, 2, True, 0, 0, 0, 0, 0, 1, 45 * AngleConversionFactor \u0026#39; Toggle (Hide/Show) Sketch Relations BoolStatus = swDoc.SetUserPreferenceToggle(swUserPreferenceToggle_e.swViewSketchRelations, True) \u0026#39; De-select all after creation swDoc.ClearSelection2 True \u0026#39; Show Front View after Circular Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding the Code I have already discuss above code in previous Sketch Transformation - Rotate/Copy Sketch Entities post except below line of code.\n\u0026#39; Toggle (Hide/Show) Sketch Relations BoolStatus = swDoc.SetUserPreferenceToggle(swUserPreferenceToggle_e.swViewSketchRelations, True)\rFor \u0026ldquo;Toggle (Hide/Show)\u0026rdquo; Sketch Relations, we need SetUserPreferenceToggle method from Solidworks\u0026rsquo;s ModelDoc2 object.\nThis SetUserPreferenceToggle method takes following parameters as explained:\nUserPreferenceValue : Use Preference Values to toggle as defined in swUserPreferenceToggle_e. NOTE: swUserPreferenceToggle_e has many values!!! Hence it is not possible to list all of them here. If you want to check full list, please visit this page of Solidworks API Help.\nOnFlag : True to toggle the value on, false to toggle the value off. In our code, we used following values:\nUserPreferenceValue : swUserPreferenceToggle_e.swViewSketchRelations\nOnFlag : True\nReturn Value:\nTrue: If Toggle (Hide/Show) of Sketch Relations is Success.\nFalse: If Toggle (Hide/Show) of Sketch Relations is Fail.\nBefore Toggle (Hide/Show) of Sketch Relations\nAfter Toggle (Hide/Show) of Sketch Relations\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Toggle (Hide/Show) of Sketch Relations with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":129,"permalink":"/solidworks-macros/toggle-display-sketch-relation/","summary":"\u003cp\u003eIn this post, I tell you about \u003cstrong\u003ehow to Toggle (Hide/Show) Sketch Relations using Solidworks VBA Macros\u003c/strong\u003e in a Sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Toggle (Hide/Show) Sketch Relations"},{"content":"In this post, I tell you about how to Add Sketch Relations (Constraints) using Solidworks VBA Macros in a Sketch.\nIn this post, I explain about SketchAddConstraints method from Solidworks\u0026rsquo;s ModelDoc2 object.\nThis method is most updated method, I found in Solidworks API Help.\nThis post will utilize the methods explained in earlier posts, hence knowledge to those is required but it is not mandatory.\nAn absolute beginner can follow what is written here.\nAdd Sketch Relations (Constraints) method For adding relations to a sketch segment, we use SketchAddConstraints method from Solidworks\u0026rsquo;s ModelDoc2 object.\nThis SketchAddConstraints method takes following parameters as explained:\nConstraint : ID of constraint as given on this page of Solidworks API Help. Return Value: There are no return value for this method.\nIn following sections we add different sketch constraints to sketch segments.\nAdd \u0026lsquo;Fix\u0026rsquo; Sketch Relation to a sketch segment Here we learn how to add Fixed sketch relation to a sketch segment through VBA.\nWe need an unconstraint sketch segment.\nIn this post, I use a circle as shown in below image:\nBefore Add Fix Sketch Relation to Circle\nCode to add Fix sketch relation\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document to active part document Set swDoc = swApp.ActiveDoc \u0026#39; Select Circle BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Add Fix sketch relation swDoc.SketchAddConstraints (\u0026#34;sgFIXED\u0026#34;) \u0026#39; Clear selection after adding relation swDoc.ClearSelection2 True End Sub\rAfter Add Fix Sketch Relation to Circle\nI have added comments to each line code sample, hence it is easy to understand.\nAdd \u0026lsquo;Coincident\u0026rsquo; Sketch Relation to a sketch segment Here we learn how to add Coincident sketch relation to a sketch segment through VBA.\nWe need an unconstraint sketch segment.\nIn this post, I use a circle as shown in below image:\nBefore Add Coincident Sketch Relation to Circle\nCode to add Coincident sketch relation\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.ActiveDoc \u0026#39; Select Circle center point BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Point2\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Select Origin BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Point1@Origin\u0026#34;, \u0026#34;EXTSKETCHPOINT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Add Coincident sketch relation swDoc.SketchAddConstraints (\u0026#34;sgCOINCIDENT\u0026#34;) \u0026#39; Clear selection after adding relation swDoc.ClearSelection2 True End Sub\rAfter Add Coincident Sketch Relation to Circle\nI have added comments to each line code sample, hence it is easy to understand.\nAdd \u0026lsquo;Horizontal\u0026rsquo; Sketch Relation to a sketch segment Here we learn how to add Horizontal sketch relation to a sketch segment through VBA.\nWe need an unconstraint sketch segment.\nIn this post, I use a Line as shown in below image:\nBefore Add Horizontal Sketch Relation to Line\nCode to add Horizontal sketch relation\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.ActiveDoc \u0026#39; Select Line BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Add Horizontal sketch relation swDoc.SketchAddConstraints (\u0026#34;sgHORIZONTAL2D\u0026#34;) \u0026#39; Clear selection after adding relation swDoc.ClearSelection2 True End Sub\rAfter Add Horizontal Sketch Relation to Line\nI have added comments to each line code sample, hence it is easy to understand.\nAdd \u0026lsquo;Vertical\u0026rsquo; Sketch Relation to a sketch segment Here we learn how to add Vertical sketch relation to a sketch segment through VBA.\nWe need an unconstraint sketch segment.\nIn this post, I use a Line as shown in below image:\nBefore Add Vertical Sketch Relation to Line\nCode to add Vertical sketch relation\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.ActiveDoc \u0026#39; Select Line BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Add Vertical sketch relation swDoc.SketchAddConstraints (\u0026#34;sgVERTICAL2D\u0026#34;) \u0026#39; Clear selection after adding relation swDoc.ClearSelection2 True End Sub\rAfter Add Vertical Sketch Relation to Line\nI have added comments to each line code sample, hence it is easy to understand.\nAdd \u0026lsquo;Midpoint\u0026rsquo; Sketch Relation to a sketch segment Here we learn how to add Midpoint sketch relation to a sketch segment through VBA.\nWe need an unconstraint sketch segment.\nIn this post, I use a Line as shown in below image:\nBefore Add Midpoint Sketch Relation to Line\nCode to add Midpoint sketch relation\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.ActiveDoc \u0026#39; Select Line BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Select Origin BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Point1@Origin\u0026#34;, \u0026#34;EXTSKETCHPOINT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Add Midpoint sketch relation swDoc.SketchAddConstraints (\u0026#34;sgATMIDDLE\u0026#34;) \u0026#39; Clear selection after adding relation swDoc.ClearSelection2 True End Sub\rAfter Add Midpoint Sketch Relation to Line\nI have added comments to each line code sample, hence it is easy to understand.\nAdd \u0026lsquo;Co-Linear\u0026rsquo; Sketch Relation to a sketch segment Here we learn how to add Co-Linear sketch relation to a sketch segment through VBA.\nWe need an unconstraint sketch segment.\nIn this post, I use two Lines as shown in below image:\nBefore Add Co-Linear Sketch Relation to Line\nCode to add Co-Linear sketch relation\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.ActiveDoc \u0026#39; Select Line 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Select Line 2 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line2\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Add Co-Linear sketch relation swDoc.SketchAddConstraints (\u0026#34;sgCOLINEAR\u0026#34;) \u0026#39; Clear selection after adding relation swDoc.ClearSelection2 True End Sub\rAfter Add Co-Linear Sketch Relation to Line\nI have added comments to each line code sample, hence it is easy to understand.\nAdd \u0026lsquo;Perpendicular\u0026rsquo; Sketch Relation to a sketch segment Here we learn how to add Perpendicular sketch relation to a sketch segment through VBA.\nWe need an unconstraint sketch segment.\nIn this post, I use two Lines as shown in below image:\nBefore Add Perpendicular Sketch Relation to Line\nCode to add Perpendicular sketch relation\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.ActiveDoc \u0026#39; Select Line 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Select Line 2 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line2\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Add Perpendicular sketch relation swDoc.SketchAddConstraints (\u0026#34;sgPERPENDICULAR\u0026#34;) \u0026#39; Clear selection after adding relation swDoc.ClearSelection2 True End Sub\rAfter Add Perpendicular Sketch Relation to Line\nI have added comments to each line code sample, hence it is easy to understand.\nAdd \u0026lsquo;Parallel\u0026rsquo; Sketch Relation to a sketch segment Here we learn how to add Parallel sketch relation to a sketch segment through VBA.\nWe need an unconstraint sketch segment.\nIn this post, I use two Lines as shown in below image:\nBefore Add Parallel Sketch Relation to Line\nCode to add Parallel sketch relation\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.ActiveDoc \u0026#39; Select Line 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Select Line 2 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line2\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Add Parallel sketch relation swDoc.SketchAddConstraints (\u0026#34;sgPARALLEL\u0026#34;) \u0026#39; Clear selection after adding relation swDoc.ClearSelection2 True End Sub\rAfter Add Parallel Sketch Relation to Line\nI have added comments to each line code sample, hence it is easy to understand.\nAdd \u0026lsquo;Equal Length\u0026rsquo; Sketch Relation to a sketch segment Here we learn how to add Equal Length sketch relation to a sketch segment through VBA.\nWe need an unconstraint sketch segment.\nIn this post, I use two Lines as shown in below image:\nBefore Add Equal Length Sketch Relation to Line\nCode to add Equal Length sketch relation\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.ActiveDoc \u0026#39; Select Line 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Select Line 2 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line2\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Add Equal Length sketch relation swDoc.SketchAddConstraints (\u0026#34;sgSAMELENGTH\u0026#34;) \u0026#39; Clear selection after adding relation swDoc.ClearSelection2 True End Sub\rAfter Add Equal Length Sketch Relation to Line\nI have added comments to each line code sample, hence it is easy to understand.\nAdd \u0026lsquo;Tangent\u0026rsquo; Sketch Relation to a sketch segment Here we learn how to add Tangent sketch relation to a sketch segment through VBA.\nWe need an unconstraint sketch segment.\nIn this post, I use a Line and a Circle as shown in below image:\nBefore Add Tangent Sketch Relation to Line\nCode to add Tangent sketch relation\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.ActiveDoc \u0026#39; Select Line 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Select Line 2 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Add Tangent sketch relation swDoc.SketchAddConstraints (\u0026#34;sgTANGENT\u0026#34;) \u0026#39; Clear selection after adding relation swDoc.ClearSelection2 True End Sub\rAfter Add Tangent Sketch Relation to Line\nI have added comments to each line code sample, hence it is easy to understand.\nAdd \u0026lsquo;Same Curve Length\u0026rsquo; Sketch Relation to a sketch segment Here we learn how to add Same Curve Length sketch relation to a sketch segment through VBA.\nWe need an unconstraint sketch segment.\nIn this post, I use a Line and a Circle as shown in below image:\nBefore Add Same Curve Length Sketch Relation to Line\nCode to add Same Curve Length sketch relation\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.ActiveDoc \u0026#39; Select Line 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Line1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Select Line 2 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Add Same Curve Length sketch relation swDoc.SketchAddConstraints (\u0026#34;sgSAMECURVELENGTH\u0026#34;) \u0026#39; Clear selection after adding relation swDoc.ClearSelection2 True End Sub\rAfter Add Same Curve Length Sketch Relation to Line\nI have added comments to each line code sample, hence it is easy to understand.\nAdd \u0026lsquo;Coincident\u0026rsquo; Sketch Relation to a sketch segment Here we learn how to add Coincident sketch relation to a sketch segment through VBA.\nWe need an unconstraint sketch segment.\nIn this post, I use two Circles as shown in below image:\nBefore Add Coincident Sketch Relation to Line\nCode to add Coincident sketch relation\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.ActiveDoc \u0026#39; Select Line 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Select Line 2 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc2\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Add Coincident sketch relation swDoc.SketchAddConstraints (\u0026#34;sgCONCENTRIC\u0026#34;) \u0026#39; Clear selection after adding relation swDoc.ClearSelection2 True End Sub\rAfter Add Coincident Sketch Relation to Line\nI have added comments to each line code sample, hence it is easy to understand.\nAdd \u0026lsquo;Coradial\u0026rsquo; Sketch Relation to a sketch segment Here we learn how to add Coradial sketch relation to a sketch segment through VBA.\nWe need an unconstraint sketch segment.\nIn this post, I use two Circles as shown in below image:\nBefore Add Coradial Sketch Relation to Line\nCode to add Coradial sketch relation\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.ActiveDoc \u0026#39; Select Line 1 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Select Line 2 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc2\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Add Coradial sketch relation swDoc.SketchAddConstraints (\u0026#34;sgCORADIAL\u0026#34;) \u0026#39; Clear selection after adding relation swDoc.ClearSelection2 True End Sub\rAfter Add Coradial Sketch Relation to Line\nI have added comments to each line code sample, hence it is easy to understand.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Add Sketch Relations (Constraints) with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":130,"permalink":"/solidworks-macros/add-sketch-relations/","summary":"\u003cp\u003eIn this post, I tell you about \u003cstrong\u003ehow to Add Sketch Relations (Constraints) using Solidworks VBA Macros\u003c/strong\u003e in a Sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Add Sketch Relations (Constraints)"},{"content":"Introduction In this post, I tell you about how to Add dimension to Sketch Entities using Solidworks VBA Macros in a Sketch.\nIn this post, I explain about 2 different methods from which are listed below.\nFrom ModelDoc2 object\nFrom ModelDocExtension object\nMethods from these objects are updated methods, hence use any one of them for adding dimension.\nMethod From ModelDoc2 object Below is the code sample to Add dimension to Sketch Entities using ModelDoc2 object\u0026rsquo;s AddDimension2 method.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Create Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39;-----------------------UNIT CONVERSION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;---------------------------------------------------------------- \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Create a circle of diameter 10 Set swSketchSegment = swSketchManager.CreateCircle(0, 0, 0, 10 * LengthConversionFactor, 0, 0) \u0026#39; Disable dimension input box before adding dimension swApp.SetUserPreferenceToggle swUserPreferenceToggle_e.swInputDimValOnCreate, False \u0026#39; Add dimension to circle swDoc.AddDimension2 10 * LengthConversionFactor, 10 * LengthConversionFactor, 0 \u0026#39; Enable dimension input box after adding dimension swApp.SetUserPreferenceToggle swUserPreferenceToggle_e.swInputDimValOnCreate, True \u0026#39; De-select all after creation swDoc.ClearSelection2 True \u0026#39; Show Front View after Circular Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding ModelDoc2 object method Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Create variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment\rIn this line, we Create a variable which we named as swSketchSegment and the type of this swSketchSegment variable is SldWorks.SketchSegment.\nWe create variable swSketchSegment for Solidworks Sketch Segments.\nTo see methods and properties related to swSketchSegment object, please visit this page of Solidworks API Help\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis GetUserPreferenceStringValue() method is a part of our main Solidworks variable swApp.\n\u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout that post if you want to understand above code in more detail.\n\u0026#39;-----------------------UNIT CONVERSION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;----------------------------------------------------------------\rAbove code sample shows how to fix Solidworks API Unit issue.\nWe 1st get the current unit of the part and apply the switch statements to update our Length and Angle Conversion factors.\nI have already explained in detail about Fixing Solidworks API Unit Issue in General - Fix Unit Issue blog post.\nDo checkout above post for Fixing Solidworks API Issue.\n\u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Create a circle of diameter 10 Set swSketchSegment = swSketchManager.CreateCircle(0, 0, 0, 10 * LengthConversionFactor, 0, 0)\rIn above line, we set the value of Solidworks Sketch Segment variable swSketchSegment by CreateCircle method from Solidworks Sketch Manager.\nThis CreateCircle method creates a Circle between \u0026ldquo;2 given point distance as diameter\u0026rdquo;.\nFor more information about CreateCircle method, you can read my Solidworks Macro - Create Circle post.\nThat post describe all the parameters we need for this CreateCircle method in details.\nIn above line, we create a Circle with:\nCircle Centerpoint : At origin i.e. (0, 0, 0)\nCircle Diameter : 10 unit length\n\u0026#39; Disable dimension input box before adding dimension swApp.SetUserPreferenceToggle swUserPreferenceToggle_e.swInputDimValOnCreate, False\rIn above line of code, we Disable dimension input box before adding dimension.\n\u0026#39; Add dimension to circle swDoc.AddDimension2 10 * LengthConversionFactor, 10 * LengthConversionFactor, 0\rFor \u0026ldquo;adding dimension\u0026rdquo; to an sketch entity, we need AddDimension2 method from Solidworks ModelDoc2 object.\nThis AddDimension2 method takes following parameters as explained:\nX : X coordinate of Dimension text location in meters.\nY : y coordinate of Dimension text location in meters.\nZ : z coordinate of Dimension text location in meters.\nAfter the function complete following are the results:\nReturn Value:\nIDisplayDimension: Newly created dimension. In our code, I have used following values:\nX : X coordinate of Dimension text location = 10 * LengthConversionFactor.\nY : y coordinate of Dimension text location = 10 * LengthConversionFactor.\nZ : z coordinate of Dimension text location = 0.\nBelow image shows before and after Circular Sketch Pattern.\nBefore Circular Sketch Pattern\nAfter Circular Sketch Pattern\n\u0026#39; Enable dimension input box after adding dimension swApp.SetUserPreferenceToggle swUserPreferenceToggle_e.swInputDimValOnCreate, True\rIn above line of code, we Enable dimension input box after adding dimension.\n\u0026#39; De-select the Sketch after creation swDoc.ClearSelection2 True\rIn the above line of code, we deselect the Sketch after the Linear Sketch Pattern operation.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Show Front View after Linear Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView\rIn the above line of code, we update the view orientation to Front View.\nIn my machine, after inserting a sketch view orientation does not changed.\nBecause of this I have to update the view to Front view.\nFor showing Front View we used ShowNamedView2 method from our Solidworks document name swDoc.\nThis method takes 2 parameter described as follows:\nVName : Name of the view to display or an empty string to use ViewId instead\nViewId : ID of the view to display as defined by swStandardViews_e or -1 to use the VName argument instead.\nNOTE: If you specify both VName and ViewId, then ViewId takes precedence if the two arguments do not resolve to the same view.\nswStandardViews_e has following Standard View Types:\nswBackView\nswBottomView\nswDimetricView\nswFrontView\nswIsometricView\nswLeftView\nswRightView\nswTopView\nswExtendetricView\nIn our code, we did not use VName instead I used empty string in form of \u0026quot;\u0026quot; symbol.\nI used ViewId value to specify view and used swStandardViews_e.swFrontView value to use Standard Front View.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nMethod From ModelDocExtension object Below is the code sample to Add dimension to Sketch Entities using ModelDocExtension object\u0026rsquo;s AddDimension method\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Create Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Create Variable for Solidworks Display Dimension Dim swDisplayDim As SldWorks.DisplayDimension \u0026#39; Main function of our VBA program Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39;-----------------------UNIT CONVERSION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;---------------------------------------------------------------- \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Create a circle of diameter 10 Set swSketchSegment = swSketchManager.CreateCircle(0, 0, 0, 10 * LengthConversionFactor, 0, 0) \u0026#39; Disable dimension input box before adding dimension swApp.SetUserPreferenceToggle swUserPreferenceToggle_e.swInputDimValOnCreate, False \u0026#39; Add dimension to circle Set swDisplayDim = swDoc.Extension.AddDimension(0, 12 * LengthConversionFactor, 0, swSmartDimensionDirection_e.swSmartDimensionDirection_Right) \u0026#39; Enable dimension input box after adding dimension swApp.SetUserPreferenceToggle swUserPreferenceToggle_e.swInputDimValOnCreate, True \u0026#39; De-select all after creation swDoc.ClearSelection2 True \u0026#39; Show Front View after Circular Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding ModelDocExtension object method Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Create variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment\rIn this line, we Create a variable which we named as swSketchSegment and the type of this swSketchSegment variable is SldWorks.SketchSegment.\nWe create variable swSketchSegment for Solidworks Sketch Segments.\nTo see methods and properties related to swSketchSegment object, please visit this page of Solidworks API Help\n\u0026#39; Create Variable for Solidworks Display Dimension Dim swDisplayDim As SldWorks.DisplayDimension\rIn this line, we Create a variable which we named as swDisplayDim and the type of this swDisplayDim variable is SldWorks.DisplayDimension.\nWe create variable swDisplayDim for dimension we create.\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis GetUserPreferenceStringValue() method is a part of our main Solidworks variable swApp.\n\u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout that post if you want to understand above code in more detail.\n\u0026#39;-----------------------UNIT CONVERSION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;----------------------------------------------------------------\rAbove code sample shows how to fix Solidworks API Unit issue.\nWe 1st get the current unit of the part and apply the switch statements to update our Length and Angle Conversion factors.\nI have already explained in detail about Fixing Solidworks API Unit Issue in General - Fix Unit Issue blog post.\nDo checkout above post for Fixing Solidworks API Issue.\n\u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Create a circle of diameter 10 Set swSketchSegment = swSketchManager.CreateCircle(0, 0, 0, 10 * LengthConversionFactor, 0, 0)\rIn above line, we set the value of Solidworks Sketch Segment variable swSketchSegment by CreateCircle method from Solidworks Sketch Manager.\nThis CreateCircle method creates a Circle between \u0026ldquo;2 given point distance as diameter\u0026rdquo;.\nFor more information about CreateCircle method, you can read my Solidworks Macro - Create Circle post.\nThat post describe all the parameters we need for this CreateCircle method in details.\nIn above line, we create a Circle with:\nCircle Centerpoint : At origin i.e. (0, 0, 0)\nCircle Diameter : 10 unit length\n\u0026#39; Disable dimension input box before adding dimension swApp.SetUserPreferenceToggle swUserPreferenceToggle_e.swInputDimValOnCreate, False\rIn above line of code, we Disable dimension input box before adding dimension.\n\u0026#39; Add dimension to circle Set swDisplayDim = swDoc.Extension.AddDimension(0, 12 * LengthConversionFactor, 0, swSmartDimensionDirection_e.swSmartDimensionDirection_Right)\rFor \u0026ldquo;adding dimension\u0026rdquo; to an sketch entity, we need AddDimension method from Solidworks ModelDocExtension object.\nThis AddDimension method takes following parameters as explained:\nX : X coordinate of Dimension text location in meters.\nY : y coordinate of Dimension text location in meters.\nZ : z coordinate of Dimension text location in meters.\nDirection : Direction of dimensioning extension line or rapid dimensioning quadrant as defined in swSmartDimensionDirection_e.\nThere are 4 values we can use from swSmartDimensionDirection_e enum.\nThey are as follows:\nswSmartDimensionDirection_Down\nswSmartDimensionDirection_Left\nswSmartDimensionDirection_Right\nswSmartDimensionDirection_Up\nAfter the function complete following are the results:\nReturn Value:\nIDisplayDimension: Newly created dimension. In our code, I have used following values:\nX : X coordinate of Dimension text location = 0.\nY : y coordinate of Dimension text location = 12 * LengthConversionFactor.\nZ : z coordinate of Dimension text location = 0.\nDirection : Direction of dimensioning extension line or rapid dimensioning quadrant = swSmartDimensionDirection_e.swSmartDimensionDirection_Right.\nBelow image shows before and after Circular Sketch Pattern.\nBefore Circular Sketch Pattern\nAfter Circular Sketch Pattern\n\u0026#39; Enable dimension input box after adding dimension swApp.SetUserPreferenceToggle swUserPreferenceToggle_e.swInputDimValOnCreate, True\rIn above line of code, we Enable dimension input box after adding dimension.\n\u0026#39; De-select the Sketch after creation swDoc.ClearSelection2 True\rIn the above line of code, we deselect the Sketch after the Linear Sketch Pattern operation.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Show Front View after Linear Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView\rIn the above line of code, we update the view orientation to Front View.\nIn my machine, after inserting a sketch view orientation does not changed.\nBecause of this I have to update the view to Front view.\nFor showing Front View we used ShowNamedView2 method from our Solidworks document name swDoc.\nThis method takes 2 parameter described as follows:\nVName : Name of the view to display or an empty string to use ViewId instead\nViewId : ID of the view to display as defined by swStandardViews_e or -1 to use the VName argument instead.\nNOTE: If you specify both VName and ViewId, then ViewId takes precedence if the two arguments do not resolve to the same view.\nswStandardViews_e has following Standard View Types:\nswBackView\nswBottomView\nswDimetricView\nswFrontView\nswIsometricView\nswLeftView\nswRightView\nswTopView\nswExtendetricView\nIn our code, we did not use VName instead I used empty string in form of \u0026quot;\u0026quot; symbol.\nI used ViewId value to specify view and used swStandardViews_e.swFrontView value to use Standard Front View.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Add dimension to Sketch Entities with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":131,"permalink":"/solidworks-macros/add-dimension-methods/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eIn this post, I tell you about \u003cstrong\u003ehow to Add dimension to Sketch Entities using Solidworks VBA Macros\u003c/strong\u003e in a Sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Add dimension to Sketch Entities"},{"content":"In this post, I tell you about how to create Extrude/Boss through Solidworks VBA Macros in a sketch.\nIn this post, I tell you about FeatureExtrusion3 method from Solidworks FeatureManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new Corner Extrude/Boss.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post. \u0026ndash;\u0026gt;\nCode Sample Below is the code sample for creating Corner Rectangle.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Creating variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Creating variable for Solidworks Feature Dim swFeature As SldWorks.Feature \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Creating string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Setting Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Inserting a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Creating a \u0026#34;Variant\u0026#34; Variable which holds the values return by \u0026#34;CreateCornerRectangle\u0026#34; method Dim vSketchLines As Variant \u0026#39; Creating a Corner Rectangle vSketchLines = swSketchManager.CreateCornerRectangle(0, 1, 0, 1, 0, 0) \u0026#39; De-select the lines after creation swDoc.ClearSelection2 True \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 \u0026#39; Exit the Sketch swSketchManager.InsertSketch True \u0026#39; Create Extrude Feature Set swFeature = swDoc.FeatureManager.FeatureExtrusion3(True, False, False, swEndConditions_e.swEndCondBlind, swEndConditions_e.swEndCondBlind, 2, 0, False, False, False, True, 0, 0, False, False, False, False, True, False, True, swEndConditions_e.swEndCondBlind, 0, False) End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Creating variable for Solidworks Feature Dim swFeature As SldWorks.Feature\rIn this line, we Create a variable which we named as swFeature and the type of this swFeature variable is SldWorks.Feature.\nWe create variable swFeature for Solidworks Feature.\nTo see methods and properties related to Feature object, please visit this page of Solidworks API Help\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis GetUserPreferenceStringValue() method is a part of our main Solidworks variable swApp.\n\u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout that post if you want to understand above code in more detail.\n\u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Creating a \u0026#34;Variant\u0026#34; Variable which holds the values return by \u0026#34;CreateCornerRectangle\u0026#34; method Dim vSketchLines As Variant \u0026#39; Creating a Corner Rectangle vSketchLines = swSketchManager.CreateCornerRectangle(0, 1, 0, 1, 0, 0)\rIn above sample code, we 1st create a variable named vSketchLines of type Variant.\nA Variant type variable can hold any type of value depends upon the use of variable.\nIn 2nd line, we set the value of variable vSketchLines.\nIn the above code sample I have used (0, 1, 0) Upper-left point in Y-direction.\nFor Lower-right point I used (1, 0, 0) which is 1 point distance in X-direction.\nThis CreateCornerRectangle method returns an array of sketch segments that represent the edges created for this corner rectangle.\nFor more information about Create Corner Rectangle please visit Solidworks Macros - Selection Methods post.\nIt is very important to remember that, when you give distance or any other numeric value in Solidworks API, Solidworks takes that numeric value in Meter only.\nSolidworks API does not care about your application\u0026rsquo;s Unit systems.\nFor example, I works in ANSI system means inches for distance.\nBut when I used Solidworks API through VBA macros or C#, I need to use converted numeric values.\nBecause Solidworks API output the distance in Meter which is not my requirement. {: .notice\u0026ndash;warning}\n\u0026#39; De-select the lines after creation swDoc.ClearSelection2 True\rIn the this line of code, we deselect the Corner rectangle we have created.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\n\u0026#39; Exit the Sketch swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to exit a sketch in selected plane.\n\u0026#39; Create Extrude Feature Set swFeature = swDoc.FeatureManager.FeatureExtrusion3(True, False, False, swEndConditions_e.swEndCondBlind, swEndConditions_e.swEndCondBlind, 2, 0, False, False, False, True, 0, 0, False, False, False, False, True, True, True, swEndConditions_e.swEndCondBlind, 0, False)\rIn above line of code we set the value of variable swFeature by FeatureExtrusion3 method.\nFeatureExtrusion3 method is part of FeatureManager object.\nThis FeatureManager is again part of swDoc variable i.e. ModelDoc2 object.\nMethod Parameters Details This FeatureExtrusion3 method takes following parameters as explained:\nSd - True for single ended, False for double ended. Flip - True to flip the side to cut\nThis option activate when we select feature \u0026ldquo;Extruded Cut\u0026rdquo;. {: .notice\u0026ndash;warning}\nDir - True to flip the direction of extrusion.\nT1 - Termination type for first end of the extrusion as defined in swEndConditions_e.\nEnd Conditions has following enumeration values:\nswEndCondBlind or 0\nswEndCondMidPlane or 6\nswEndCondOffsetFromSurface or 5\nswEndCondThroughAll or 1\nswEndCondThroughAllBoth or 9\nswEndCondThroughNext or 2\nswEndCondUpToBody or 7\nswEndCondUpToNext or 11\nswEndCondUpToSelection or 10\nswEndCondUpToSurface or 4 = Do not use; superseded by swEndCondUpToSelection\nswEndCondUpToVertex or 3 = Do not use; superseded by swEndCondUpToSelection\nT2 - Termination type for second end of the extrusion as defined in swEndConditions_e.\nEnd Conditions has enumeration values as described in T1.\nD1 - Depth of extrusion for first end in meters; offset, if T1 is set to swEndConditions_e.swEndCondOffsetFromSurface D2 - Depth of extrusion for second end in meters; offset, if T2 is set to swEndConditions_e.swEndCondOffsetFromSurface Dchk1 - True to allow drafting in the first direction, False to not Dchk2 - True to allow drafting in the second direction, False to not Ddir1 - True for first draft angle to be inward, False to be outward; valid only if Dchk1 is true Ddir2 - True for second draft angle to be inward, False to be outward; valid only if Dchk2 is true Dang1 - Draft angle for first end; valid only if Dchk1 is true Dang2 - Draft angle for second end; valid only if Dchk2 is true OffsetReverse1 - True to offset the first end from another face or plane in a direction away from the sketch, False to offset in a direction toward the sketch; valid only if T1 is set to swEndConditions_e.swEndCondOffsetFromSurface OffsetReverse2 - True to offset the second end from another face or plane in a direction away from the sketch, False to offset in a direction toward the sketch; valid only if T2 is set to swEndConditions_e.swEndCondOffsetFromSurface TranslateSurface1 - True if the first end of the extrusion is a translation of the reference surface, False if it has a true offset; valid only if T1 is set to swEndConditions_e.swEndCondOffsetFromSurface TranslateSurface2 - True if the second end of the extrusion is a translation of the reference surface, False if it has a true offset; valid only if T2 is set to swEndConditions_e.swEndCondOffsetFromSurface Merge - True to merge the results in a multibody part, False to not\nThis option visible when we Extrude from existing feature/body. {: .notice\u0026ndash;warning}\nUseFeatScope - True if the feature only affects selected bodies, False if the feature affects all bodies.\nUseAutoSelect - True to automatically select all bodies and have the feature affect those bodies, False to select the bodies that the feature affects.\nT0 - Start condition as defined in swStartConditions_e\nStart Conditions has following enumeration values:\nswStartOffset or 3\nswStartSketchPlane or 0\nswStartSurface or 1\nswStartVertex or 2\nStartOffset - Distance from the sketch plane to start the extrude; valid only if T0 is set to swStartConditions_e.swStartOffset FlipStartOffset - True to flip the direction of the start offset, False to not; valid only if T0 is set to swStartConditions_e.swStartOffset Return Value : This FeatureExtrusion3 method retun Feature object.\nTo see methods and properties related to Feature object, please visit this page of Solidworks API Help.\nIn our code, I have used following values:\nSd - I use True for single ended.\nFlip - I use False to flip the side to cut\nDir - I use False to flip the direction of extrusion\nT1 - *I use swEndConditions_e.swEndCondBlind of Termination type for first end of the extrusion *\nT2 - *I use swEndConditions_e.swEndCondBlind of Termination type for second end of the extrusion *\nD1 - I use 2 as Depth of extrusion for first end in meters\nD2 - I use 0 as Depth of extrusion for second end in meters\nDchk1 - I use False to allow drafting in the first direction\nDchk2 - I use False to allow drafting in the second direction\nDdir1 - I use False for first draft angle to be inward\nDdir2 - I use True for second draft angle to be inward\nSince Dchk2 is False, setting the value to True is invalid. {: .notice\u0026ndash;warning}\nDang1 - I use 0 for first end\u0026rsquo;s draft angle\nDang2 - I use 0 for second end\u0026rsquo;s draft angle\nOffsetReverse1 - I use False to offset the first end from another face or plane in a direction away from the sketch\nOffsetReverse2 - I use False to offset the second end from another face or plane in a direction away from the sketch\nTranslateSurface1 - I use False to the first end of the extrusion is a translation of the reference surface\nTranslateSurface2 - I use False to the second end of the extrusion is a translation of the reference surface\nMerge - I use True to merge the results in a multibody part\nUseFeatScope - I use False so that this feature affects to all bodies\nUseAutoSelect - I use True to automatically select all bodies and have the feature affect those bodies\nT0 - I use swEndConditions_e.swEndCondBlind as Start condition\nStartOffset - I use 0 for distance from the sketch plane to start the extrude\nFlipStartOffset - I use False to flip the direction of the start offset\nAfter running macro we get extrude as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Extrude/Boss with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":132,"permalink":"/solidworks-macros/create-extrude-feature/","summary":"\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create Extrude/Boss through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e\n\u003cp\u003eIn this post, I tell you about \u003ccode\u003eFeatureExtrusion3\u003c/code\u003e method from \u003cstrong\u003eSolidworks\u003c/strong\u003e \u003ccode\u003eFeatureManager\u003c/code\u003e object.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create Extrude/Boss"},{"content":"Objective In this post, I tell you about how to create Revolved Boss/Base through Solidworks VBA Macros in a sketch.\nIn this post, I tell you about FeatureRevolve2 method from Solidworks FeatureManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to create a new Revolved Boss/Base.\nVideo of Code on YouTube Please see below video on how to create Revolved Boss/Base from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating Revolved Boss/Base.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Feature Dim swFeature As SldWorks.Feature \u0026#39; Boolean Variable Dim boolStatus As Boolean \u0026#39; Revolve Boss/Extrude program Sub main() \u0026#39; Setting Solidworks variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Setting Solidworks document variable to opened part document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39;-----------------------BELOW IS THE SOLUTION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;---------------------------------------------------------------- \u0026#39; Select Sketch 1 in opened part document boolStatus = swDoc.Extension.SelectByID2(\u0026#34;Sketch1\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Check if failed to select sketch 1 If boolStatus = False Then MsgBox (\u0026#34;Failed to select sketch 1.\u0026#34;) Exit Sub End If \u0026#39; Create Revolve Feature Set swFeature = swDoc.FeatureManager.FeatureRevolve2(True, True, False, False, False, True, swEndConditions_e.swEndCondBlind, swEndConditions_e.swEndCondBlind, AngleConversionFactor * 360, 0, False, False, 0, 0, swThinWallType_e.swThinWallOneDirection, 0, 0, True, False, True) \u0026#39; Check if Revolve Feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Revolve Feature.\u0026#34;) Exit Sub End If End Sub\rPrerequisite In this article there are some prerequisite.\nWe are not creating sketches from code but we use existing sketch to create Revolve feature.\nAlso, we will apply checks in this article, so that code we write should be error free.\nUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Creating variable for Solidworks Feature Dim swFeature As SldWorks.Feature\rIn this line, we Create a variable which we named as swFeature and the type of this swFeature variable is SldWorks.Feature.\nWe create variable swFeature for Solidworks Feature.\nTo see methods and properties related to Feature object, please visit this page of Solidworks API Help\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If\rIn above line of code, we use an IF statement to check if Solidworks application variable is successfully assigned to current Solidworks application.\n\u0026#39; Setting Solidworks document variable to opened part document Set swDoc = swApp.ActiveDoc\rIn above line of code, we set Solidwors document swDoc variable to currently open part document.\n\u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above line of code, we use an IF statement to check if Solidworks document swDoc is opened.\nIf Solidworks document is not opened then code execute inside the code and inform the user by a Message Window.\nAfter showing message our program exit from here itself.\n\u0026#39;-----------------------BELOW IS THE SOLUTION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;----------------------------------------------------------------\rIn above line of code, we get and update unit conversion variable as per document unit.\nFor more detail about why we are using this code sample, please visit Solidworks Macro - Fix Unit Issue article.\nIn this line, we set the value of our variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Select Sketch 1 in opened part document boolStatus = swDoc.Extension.SelectByID2(\u0026#34;Sketch1\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the Sketch1 by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Check if failed to select sketch 1 If boolStatus = False Then MsgBox (\u0026#34;Failed to select sketch 1.\u0026#34;) Exit Sub End If In above line of code, we use an IF statement to check if we able to select the Sketch1 or not.\nIf we failed to select then inform the user by a Message Window.\nAfter showing error message our program exit from here itself.\n\u0026#39; Create Revolve Feature Set swFeature = swDoc.FeatureManager.FeatureRevolve2(True, True, False, False, False, True, swEndConditions_e.swEndCondBlind, swEndConditions_e.swEndCondBlind, AngleConversionFactor * 360, 0, False, False, 0, 0, swThinWallType_e.swThinWallOneDirection, 0, 0, True, False, True)\rIn above line of code we set the value of variable swFeature by FeatureRevolve2 method.\nFeatureRevolve2 method is part of FeatureManager object.\nThis FeatureManager is again part of swDoc variable i.e. ModelDoc2 object.\nMethod Parameters Details This FeatureRevolve2 method takes following parameters as explained:\nSingleDir - True if the revolve is in one direction, False if in both directions.\nIsSolid - True if this is a Solid revolve feature, False if not.\nIsThin - True if this is a Thin revolve feature, False if not.\nIsCut - True if this is a Cut revolve feature, False if not.\nReverseDir - True reverses the angle of the revolution, False does not; only applies if Dir1Type is not swEndConditions_e.swEndCondMidPlane.\nBothDirectionUpToSameEntity - True if the revolve is up to the same entity in both directions, False if not; only applies if SingleDir is False and Dir1Type and Dir2Type are swEndConditions_e.swEndCondUpToVertex, swEndConditions_e.swEndCondUpToSurface, or swEndConditions_e.swEndCondOffsetFromSurface).\nDir1Type - Revolve end condition in direction 1 as defined in swEndConditions_e.\nEnd Conditions has following enumeration values:\nswEndCondBlind or 0\nswEndCondMidPlane or 6\nswEndCondOffsetFromSurface or 5\nswEndCondThroughAll or 1\nswEndCondThroughAllBoth or 9\nswEndCondThroughNext or 2\nswEndCondUpToBody or 7\nswEndCondUpToNext or 11\nswEndCondUpToSelection or 10\nswEndCondUpToSurface or 4 = Do not use; superseded by swEndCondUpToSelection\nswEndCondUpToVertex or 3 = Do not use; superseded by swEndCondUpToSelection\nDir2Type - Revolve end condition in direction 2; as defined in swEndConditions_e and only applies if Dir1Type is not swEndConditions_e.swEndCondMidPlane.\nDir1Angle - Angle in radians of revolution in direction 1; only applies if Dir1Type is swEndConditions_e.swEndCondBlind.\nDir2Angle - Angle in radians of revolution in direction 2; only applies if Dir2Type is swEndConditions_e.swEndCondBlind.\nOffsetReverse1 - True to reverse the offset direction in direction 1, False to not; only applies if Dir1Type is swEndConditions_e.swEndCondOffsetFromSurface.\nOffsetReverse2 - True to reverse the offset direction in direction 2, False to not; only applies if Dir2Type is swEndConditions_e.swEndCondOffsetFromSurface.\nOffsetDistance1 - Offset distance in direction 1; only applies if Dir1Type is swEndConditions_e.swEndCondOffsetFromSurface.\nOffsetDistance2 - Offset distance in direction 2; only applies if Dir2Type is swEndConditions_e.swEndCondOffsetFromSurface.\nThinType - Type and direction as defined in swThinWallType_e.\nThin wall types has following enumeration values:\nswThinWallMidPlane or 2\nswThinWallOneDirection or 0\nswThinWallOppDirection or 1\nswThinWallTwoDirection or 3\nThinThickness1 - Wall thickness in direction 1 (if ThinType is swThinWallType_e.swThinWallMidPlane, (ThinThickness1)/2 is used for each direction).\nThinThickness2 - Wall thickness in direction 2 (only applies if ThinType is swThinWallType_e.swThinWallTwoDirection).\nMerge - True to merge the results into a multi-body part, False to not.\nUseFeatScope - True if the feature only affects selected bodies, False if the feature affects all bodies.\nUseAutoSelect - True to automatically select all bodies and have the feature affect those bodies, False to select the bodies or components that the feature affects.\nReturn Value : This FeatureRevolve2 method retun Feature object.\nTo see methods and properties related to Feature object, please visit this page of Solidworks API Help.\nIn our code, I have used following values:\nSingleDir - I use True for revolve is in one direction.\nIsSolid - I use True for Solid revolve feature.\nIsThin - I use False for Thin revolve feature.\nIsCut - I use False for Cut revolve feature.\nReverseDir - I use False for reverses the angle of the revolution.\nBothDirectionUpToSameEntity - I use True for revolve is up to the same entity in both directions.\nSince SingleDir is True, setting the value to True is invalid. {: .notice\u0026ndash;warning}\nDir1Type - I use swEndConditions_e.swEndCondBlind for Revolve end condition in direction 1.\nDir2Type - I use swEndConditions_e.swEndCondBlind for Revolve end condition in direction 2.\nDir1Angle - I use AngleConversionFactor * 360 for Angle in radians of revolution in direction 1.\nDir2Angle - I use 0 for Angle in radians of revolution in direction 2.\nOffsetReverse1 - I use False for reverse the offset direction in direction 1.\nOffsetReverse2 - I use False for reverse the offset direction in direction 2.\nOffsetDistance1 - I use 0 for Offset distance in direction 1.\nOffsetDistance2 - I use 0 for Offset distance in direction 2.\nThinType - I use swThinWallType_e.swThinWallOneDirection for Type and direction.\nThinThickness1 - I use 0 for Wall thickness in direction 1.\nThinThickness2 - I use 0 for Wall thickness in direction 2.\nMerge - I use True for merge the results into a multi-body part.\nUseFeatScope - I use False for the feature affects all bodies.\nUseAutoSelect - I use True for automatically select all bodies and have the feature affect those bodies.\n\u0026#39; Check if Revolve Feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Revolve Feature.\u0026#34;) Exit Sub End If\rIn above line of code, we use an IF statement to check if we able to create Revolve Feature or not.\nIf we failed to select then inform the user by a Message Window.\nAfter showing error message our program exit from here itself.\nNow we run the macro and after running macro we get extrude as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Revolve Boss with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":133,"permalink":"/solidworks-macros/create-revolved-feature/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create Revolved Boss/Base through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create Revolved Boss/Base"},{"content":"Objective In this post, I tell you about how to create Sweep Base through Solidworks VBA Macros in a sketch.\nFrom Solidworks 2018, creating Sweep feature method is changed.\nIt is now done through creating Feature Definition and create feature from this Feature Definition.\nThis method is most updated method, so use this method if you want to create a new Sweep Base.\nVideo of Code on YouTube Please see below video on how to create Sweep Base from Solidworks VBA Macros.\nPlease note that there are no explaination in the video.\nExplaination of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating Sweep Base.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Sweep Feature Dim swFeature As SldWorks.Feature \u0026#39; Creating variable for Solidworks Sweep Feature data Dim swSweep As SldWorks.SweepFeatureData \u0026#39; Boolean Variable Dim boolStatus As Boolean \u0026#39; Sweep Base program Sub main() \u0026#39; Setting Solidworks variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Setting Solidworks document variable to opened part document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Select Sketch 1 as profile and Sketch 2 as path in opened part document boolStatus = swDoc.Extension.SelectByID2(\u0026#34;Sketch1\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, True, 1, Nothing, swSelectOption_e.swSelectOptionDefault) boolStatus = swDoc.Extension.SelectByID2(\u0026#34;Sketch2\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, True, 4, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Create feature definition Set swSweep = swDoc.FeatureManager.CreateDefinition(swFmSweep) \u0026#39; Create sweep feature Set swFeature = swDoc.FeatureManager.CreateFeature(swSweep) \u0026#39; Check if sweep Feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Sweep Feature.\u0026#34;) Exit Sub End If \u0026#39; Zoom to fit swDoc.ViewZoomtofit2 End Sub\rPrerequisite In this article there are some prerequisite.\nWe are not creating sketches from code but we use existing sketch to create Sweep Base feature as shown in below picture.\nAs shown in above image, there are 2 sketch in our part.\nSketch1 : This is our profile for Sweep feture.\nSketch2 : This is our path for Sweep feture.\nIf you want to create these 2 sketch programatically then please refer to below articles.\nFor Circle üëâ read Solidworks Macros - Create Circle article.\nFor Centerpoint Arc üëâ read Solidworks Macros - Create Centerpoint Arc article.\nAlso, we will apply checks in this article, so that code we write should be error free most of the time.\nUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Creating variable for Solidworks Feature Dim swFeature As SldWorks.Feature\rIn this line, we Create a variable which we named as swFeature and the type of this swFeature variable is SldWorks.Feature.\nWe create variable swFeature for Solidworks Feature.\nTo see methods and properties related to Feature object, please visit this page of Solidworks API Help\n\u0026#39; Creating variable for Solidworks Sweep Feature data Dim swSweep As SldWorks.SweepFeatureData\rIn this line, we Create a variable which we named as swSweep and the type of this swSweep variable is SldWorks.SweepFeatureData.\nWe create swSweep variable for Solidworks Sweep feature data before we create Sweep feature using CreateFeature method from Solidworks Feature Manager.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If\rIn above line of code, we use an IF statement to check if Solidworks application variable is successfully assigned to current Solidworks application.\n\u0026#39; Setting Solidworks document variable to opened part document Set swDoc = swApp.ActiveDoc\rIn above line of code, we set Solidwors document swDoc variable to currently open part document.\n\u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above line of code, we use an IF statement to check if Solidworks document swDoc is opened.\nIf Solidworks document is not opened then code execute inside the code and inform the user by a Message Window.\nAfter showing message our program exit from here itself.\n\u0026#39; Select Sketch 1 as profile and Sketch 2 as path in opened part document boolStatus = swDoc.Extension.SelectByID2(\u0026#34;Sketch1\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, True, 1, Nothing, swSelectOption_e.swSelectOptionDefault) boolStatus = swDoc.Extension.SelectByID2(\u0026#34;Sketch2\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, True, 4, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the Sketch1 and Sketch2 by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n‚ùó Please note that we need to define profile and path for Sweep feature, hence while selecting sketches we need to define which sketch is profile and path as describe below.\nProfile\nIf a sketch profile, use Mark = 1 to select a face, edge, or curve. For a swept-boss feature, the sketch profile must be closed ‚ùó. For a swept-surface feature, the sketch profile is open or closed ‚ùó.\nIf a circular profile, use Mark = 4 to select a sketch line, edge or curve. The circular profile is open or closed ‚ùó.\nIf a solid profile, use Mark = 1 to select the tool body to use to make the cut and use Mark = 2048 to select the solid body to cut ‚ùó. Solid profiles are used only in swept-cut features.\nSweep path using Mark = 4\n\u0026#39; Create Sweep feature definition Set swSweep = swDoc.FeatureManager.CreateDefinition(swFmSweep)\rIn above line of code we set the value of variable swSweep by CreateDefinition method.\nCreateDefinition method is part of FeatureManager object.\nThis FeatureManager is again part of swDoc variable i.e. ModelDoc2 object.\nFeature Definition Method CreateDefinition Parameters Details This CreateDefinition method takes following parameters as explained:\nType - Feature name ID as defined in swFeatureNameID_e.\nswFmBoundingBox (bounding box) swFmCirPattern (circular pattern) swFmCurvePattern (curve-driven pattern) swFmDerivedLPattern (derived-driven pattern) swFmDimPattern (variable/dimension pattern) swFmFillPattern (fill pattern) swFmGroundPlane (ground plane) swFmLibraryFeature (library) swFmLocalChainPattern (chain component pattern) swFmLocalCirPattern (circular component pattern) swFmLocalCurvePattern (curve-driven component pattern) swFmLocalLPattern (linear component pattern) swFmLocalSketchPattern (sketch-driven component pattern) swFmLPattern (linear pattern) swFmNormalCut (sheet metal normal cut) swFmRefCurve (projection curve) swFmRefSurface (surface sweep) swFmSketchPattern (sketch-driven pattern) swFmSweep (boss sweep) swFmSweepCut (cut sweep) swFmSweepThread (sweep thread) swFmTabAndSlot (tab and slot) swFmTablePattern (table pattern) Return Value : This CreateDefinition method retun feature or pattern-specific feature data object.\nTo see methods and properties related to FeatureManager object, please visit this page of Solidworks API Help.\nIn our code, I have used following values:\nType - I use swFmSweep as Feature name ID. If you want to know more information about Sweep Feature data then please visit this page of Solidworks API Help.\nThis page will give you information about various properties and methods of ISweepFeatureData Interface.\n\u0026#39; Create sweep feature Set swFeature = swDoc.FeatureManager.CreateFeature(swSweep)\rIn above line of code we set the value of variable swFeature by CreateFeature method.\nCreateFeature method is part of FeatureManager object.\nThis FeatureManager is again part of swDoc variable i.e. ModelDoc2 object.\nFeature Creation Method CreateFeature Parameters Details This CreateFeature method takes following parameters as explained:\nFeatureData - Feature or pattern-specific feature data object. Return Value : This CreateFeature method retun feature data object.\nTo see methods and properties related to FeatureManager object, please visit this page of Solidworks API Help.\nIn our code, I have used following values:\nFeatureData - I use swFmSweep as feature data object which we defined prevously. \u0026#39; Check if Sweep Feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Sweep Feature.\u0026#34;) Exit Sub End If\rIn above line of code, we use an IF statement to check if we able to create Revolve Feature or not.\nIf we failed to select then inform the user by a Message Window.\nAfter showing error message our program exit from here itself.\n\u0026#39; Zoom to fit swDoc.ViewZoomtofit2\rIn above line of code, ViewZoomtofit2 property to Zoom to fit current view.\nNow we run the macro and after running macro we get extrude as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Sweep Base with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":134,"permalink":"/solidworks-macros/create-sweep-feature/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create Sweep Base through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create Sweep Base"},{"content":"Objective In this post, I tell you about how to create Lofted Base/Boss through Solidworks VBA Macros in a sketch.\nThis method is most updated method, so use this method if you want to create a new Lofted Base/Boss.\nVideo of Code on YouTube Please see below video on how to create Lofted Base/Boss from Solidworks VBA Macros.\nPlease note that there are no explanation in the video.\nExplanation of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating Lofted Base/Boss.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Feature Dim swFeature As SldWorks.Feature \u0026#39; Boolean Variable Dim boolStatus As Boolean \u0026#39; Lofted Boss/Extrude program Sub main() \u0026#39; Setting Solidworks variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Setting Solidworks document variable to opened part document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Select Sketch 3 in opened part document boolStatus = swDoc.Extension.SelectByID2(\u0026#34;Sketch3\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, False, 1, Nothing, 0) \u0026#39; Check if select Sketch 3 selected or not If boolStatus = False Then MsgBox (\u0026#34;Fail to select Sketch 3 as profile for Loft.\u0026#34;) Exit Sub End If \u0026#39; Select Sketch 2 in opened part document boolStatus = swDoc.Extension.SelectByID2(\u0026#34;Sketch2\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, True, 1, Nothing, 0) \u0026#39; Check if select Sketch 2 selected or not If boolStatus = False Then MsgBox (\u0026#34;Fail to select Sketch 2 as profile for Loft.\u0026#34;) Exit Sub End If \u0026#39; Select Sketch 1 in opened part document boolStatus = swDoc.Extension.SelectByID2(\u0026#34;Sketch1\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, True, 1, Nothing, 0) \u0026#39; Check if select Sketch 1 selected or not If boolStatus = False Then MsgBox (\u0026#34;Fail to select Sketch 1 as profile for Loft.\u0026#34;) Exit Sub End If \u0026#39; Select 3DSketch1 in opened part document boolStatus = swDoc.Extension.SelectByID2(\u0026#34;3DSketch1\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, True, 2, Nothing, 0) \u0026#39; Check if select 3DSketch1 selected or not If boolStatus = False Then MsgBox (\u0026#34;Fail to select 3DSketch1 as Guide curve for Loft.\u0026#34;) Exit Sub End If \u0026#39; Create Lofted Boss feature Set swFeature = swDoc.FeatureManager.InsertProtrusionBlend2(False, True, True, 0, 0, 0, 0, 0, True, True, False, 0, 0, 0, True, True, True, swGuideCurveInfluence_e.swGuideCurveInfluenceNextGlobal) \u0026#39; Check if Loft boss feature is created or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Lofted boss.\u0026#34;) Exit Sub End If End Sub\rPrerequisite In this article there are some prerequisite.\nWe are not creating sketches from code but we use existing sketch to create Lofted Base/Boss feature as shown in below picture.\nAs shown in above image, there are 2 sketch in our part.\nSketch1 : This is our profile 1 for Lofted feature.\nSketch2 : This is our profile 2 for Lofted feature.\nSketch3 : This is our profile 3 for Lofted feature.\n3DSketch1 : This is our Guide Curve for Lofted feature.\nIf you want to create these 2 sketch programmatically then please refer to below articles.\nFor Circle üëâ read Solidworks Macros - Create Circle article.\nFor CenterPoint Arc üëâ read Solidworks Macros - Create Center Rectangle article.\nAlso, we will apply checks in this article, so that code we write should be error free most of the time.\nUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit üëâ Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Creating variable for Solidworks Feature Dim swFeature As SldWorks.Feature\rIn this line, we Create a variable which we named as swFeature and the type of this swFeature variable is SldWorks.Feature.\nWe create variable swFeature for Solidworks Feature.\nTo see methods and properties related to Feature object, please visit üëâ this page of Solidworks API Help\n\u0026#39; Boolean Variable Dim boolStatus As Boolean\rIn this line, we create a variable named boolStatus as Boolean object type.\nThese all are our global variables.\nThey are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because we use this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if Solidworks application variable is successfully assigned to current Solidworks application.\n\u0026#39; Setting Solidworks document variable to opened part document Set swDoc = swApp.ActiveDoc\rIn above line of code, we set Solidwors document swDoc variable to currently open part document.\n\u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if Solidworks document swDoc is opened.\nIf Solidworks document is not opened then code execute inside the code and inform the user by a üëâ Message Window.\nAfter showing message our program exit from here itself.\n\u0026#39; Select Sketch 3 as profile in opened part document boolStatus = swDoc.Extension.SelectByID2(\u0026#34;Sketch3\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, True, 1, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the Sketch3 by using SelectByID2 method from Extension object.\nPlease note that for selecting profile we need to Mark the selected entity as 1.\nFor more information about selection method please visit üëâ Solidworks Macros - Selection Methods post.\n\u0026#39; Check if Sketch 3 selected or not If boolStatus = False Then MsgBox (\u0026#34;Fail to select Sketch 3 as profile for Loft.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if Solidworks document swDoc is opened.\nIf Sketch 3 selected or not then code execute inside the code and inform the user by a üëâ Message Window.\nAfter showing message our program exit from here itself.\n\u0026#39; Select Sketch 2 as profile in opened part document boolStatus = swDoc.Extension.SelectByID2(\u0026#34;Sketch2\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, True, 1, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the Sketch2 by using SelectByID2 method from Extension object.\nPlease note that for selecting profile we need to Mark the selected entity as 1.\nFor more information about selection method please visit üëâ Solidworks Macros - Selection Methods post.\n\u0026#39; Check if Sketch 2 selected or not If boolStatus = False Then MsgBox (\u0026#34;Fail to select Sketch 2 as profile for Loft.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if Solidworks document swDoc is opened.\nIf Sketch 2 selected or not then code execute inside the code and inform the user by a üëâ Message Window.\nAfter showing message our program exit from here itself.\n\u0026#39; Select Sketch 1 as profile in opened part document boolStatus = swDoc.Extension.SelectByID2(\u0026#34;Sketch1\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, True, 1, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the Sketch1 by using SelectByID2 method from Extension object.\nPlease note that for selecting profile we need to Mark the selected entity as 1.\nFor more information about selection method please visit üëâ Solidworks Macros - Selection Methods post.\n\u0026#39; Check if Sketch 1 selected or not If boolStatus = False Then MsgBox (\u0026#34;Fail to select Sketch 1 as profile for Loft.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if Solidworks document swDoc is opened.\nIf Sketch 1 selected or not then code execute inside the code and inform the user by a üëâ Message Window.\nAfter showing message our program exit from here itself.\n\u0026#39; Select 3DSketch1 as Guide curve in opened part document boolStatus = swDoc.Extension.SelectByID2(\u0026#34;3DSketch1\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, True, 2, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the 3DSketch1 by using SelectByID2 method from Extension object.\nPlease note that for selecting profile we need to Mark the selected entity as 2.\nFor more information about selection method please visit üëâ Solidworks Macros - Selection Methods post.\n\u0026#39; Check if 3DSketch1 selected or not If boolStatus = False Then MsgBox (\u0026#34;Fail to select 3DSketch1 as Guide curve for Loft.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if Solidworks document swDoc is opened.\nIf 3DSketch1 selected or not then code execute inside the code and inform the user by a üëâ Message Window.\nAfter showing message our program exit from here itself.\n\u0026#39; Create Lofted feature Set swFeature = swDoc.FeatureManager.InsertProtrusionBlend2(False, True, True, 0, 0, 0, 0, 0, True, True, False, 0, 0, 0, True, True, True, swGuideCurveInfluence_e.swGuideCurveInfluenceNextGlobal)\rIn above line of code we set the value of variable swFeature by InsertProtrusionBlend2 method.\nInsertProtrusionBlend2 method is part of FeatureManager object.\nThis FeatureManager is again part of swDoc variable i.e. ModelDoc2 object.\nInsertProtrusionBlend2 Method Parameters Details This InsertProtrusionBlend2 method takes following parameters as explained:\nClosed - True closes the loft, False leaves the loft open. If True and less than three profiles are selected, then any selected guide curves must be closed curves.\nKeepTangency - True maintains the tangency as seen in the section curves, False does not.\nForceNonRational - True obtains smoother surfaces, False does not.\nTessToleranceFactor - Factor that controls the number of intermediate sections used for loft with centerline; the default value is 1.0; the greater the value, the more intermediate sections are created.\nStartMatchingType - Tangency type at the start profile as follows:\n0 = none. 1 = tangent to the normal of the profile. 2 = tangent to a selected vector. 3 = tangency to all the adjacent faces sharing an edge with the start profile. 4 = tangent to some of the selected faces sharing an edge with the start profile (not available). EndMatchingType - Tangency type at the end profile as follows:\n0 = none. 1 = tangent to the normal of the profile. 2 = tangent to a selected vector. 3 = tangency to all the adjacent faces sharing an edge with the start profile. 4 = tangent to some of the selected faces sharing an edge with the start profile (not available). StartTangentLength - Start tangent length.\nEndTangentLength - End tangent length.\nStartTangentDir - True is one direction, False is the opposite.\nEndTangentDir - True is one direction, False is the opposite.\nIsThinBody - True if this feature is a thin body, False if it is not.\nThickness1 - Thickness value for the first direction.\nThickness2 - Thickness value for the second direction.\nThinType - Thin wall type :\n0 = One direction 1 = One direction reverse 2 = Mid-plane 3 = Two direction Merge - True merges the results in a multibody part, False does not.\nUseFeatScope - True if the feature only affects selected bodies, False if the feature affects all bodies.\nUseAutoSelect - True to automatically select all bodies and have the feature affect those bodies, False to select the bodies the feature affects.\nGuideCurveInfluence - Guide curves influence as defined in swGuideCurveInfluence_e\n0 = swGuideCurveInfluenceNextGuide 1 = swGuideCurveInfluenceNextSharp 2 = swGuideCurveInfluenceNextEdge 3 = swGuideCurveInfluenceNextGlobal Return Value : This InsertProtrusionBlend2 method return feature data object.\nIn our code, I have used following values:\nClosed - I use False to leave the loft open.\nKeepTangency - I use True to maintains the tangency.\nForceNonRational - I use True to obtains smoother surfaces.\nTessToleranceFactor - I use 0 number of intermediate sections used for loft with centerline.\nStartMatchingType - I use 0 at the start profile.\nEndMatchingType - I use 0 at the start profile.\nStartTangentLength - I use 0 at the start tangent length.\nEndTangentLength - I use 0 at the end tangent length.\nStartTangentDir - I use True in one direction.\nEndTangentDir - I use True in one direction.\nIsThinBody - I use False for this feature is a thin body.\nThickness1 - I use 0 for the first direction.\nThickness2 - I use 0 for the second direction.\nThinType - I use 0 for Thin wall type.\nMerge - I use True for merges the results in a multibody part.\nUseFeatScope - I use True for the feature only affects selected bodies.\nUseAutoSelect - I use True for automatically select all bodies and have the feature affect those bodies.\nGuideCurveInfluence - I use swGuideCurveInfluence_e.swGuideCurveInfluenceNextGlobal for Guide curves influence.\nTo see methods and properties related to FeatureManager object, please visit üëâ this page of Solidworks API Help.\n\u0026#39; Check if Lofted boss creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Lofted boss.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if we able to create Lofted Boss/Base Feature or not.\nIf we failed to select then inform the user by a üëâ Message Window.\nAfter showing error message our program exit from here itself.\nNow we run the macro and after running macro we get extrude as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Lofted Base/Boss with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":135,"permalink":"/solidworks-macros/create-lofted-boss-feature/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create Lofted Base/Boss through Solidworks VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Create Lofted Base/Boss"},{"content":"Objective In this post, I tell you about how to create Extrude Cut through SOLIDWORKS VBA Macros in a sketch.\nThis method is most updated method, so use this method if you want to create a new Extrude Cut.\nVideo of Code on YouTube Please see below üé¨ video on how to create Extrude Cut from SOLIDWORKS VBA Macros.\nPlease note that there are no explanation in the video.\nExplanation of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating Extrude Cut.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Feature Dim swFeature As SldWorks.Feature \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Main function of our VBA program Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Selecting Sketch 2 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Sketch2\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Check if failed to select sketch 2 If BoolStatus = False Then MsgBox (\u0026#34;Failed to select sketch 2.\u0026#34;) Exit Sub End If \u0026#39; Create Extrude Cut Feature Set swFeature = swDoc.FeatureManager.FeatureCut4(True, False, False, swEndCondThroughAll, 0, 0.01, 0.01, False, False, False, False, 1, 1, False, False, False, False, False, True, True, True, True, False, swStartSketchPlane, 0, False, False) \u0026#39; Check if Extrude Cut Feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Extrude Cut Feature.\u0026#34;) Exit Sub End If End Sub\rPrerequisite In this article there are some prerequisite.\nWe are not creating sketches from code but we use existing sketch to create Extrude Cut feature as shown in below picture.\nAs shown in above image, there are 1 sketch and 1 Extrude feature in our part.\nExtrude Feature : This is our extrude part for Extrude Cut feature. Sketch2 : This is our profile of holes for Extrude Cut feature. If you want to create Sketch2 programmatically then please refer to below articles.\nFor Circle üëâ read SOLIDWORKS Macros - Create Circle article.\nFor CenterPoint Arc üëâ read SOLIDWORKS Macros - Create Center Rectangle article.\nIf you want to create Extrude feature programmatically then please refer to below article.\nüëâ SOLIDWORKS Macros - Create Extrude/Boss Also, we will apply checks in this article, so the code we write should be error free most of the time.\nUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some üìå links so that you can go through them if there are anything I explained in previous articles.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit üëâ SOLIDWORKS Macros - Open new Part document post.\n\u0026#39; Create variable for SOLIDWORKS application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for SOLIDWORKS document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Creating variable for SOLIDWORKS Feature Dim swFeature As SldWorks.Feature\rIn this line, we Create a variable which we named as swFeature and the type of this swFeature variable is SldWorks.Feature.\nWe create variable swFeature for SOLIDWORKS Feature.\nTo see methods and properties related to Feature object, please visit üëâ this page of SOLIDWORKS API Help\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\nThese all are our global variables.\nThey are SOLIDWORKS API Objects.\nSo basically I group all the SOLIDWORKS API Objects in one place.\nI have also place boolean type object at top also, because we use this variable frequently.\nThus, I have started placing it here.\n\u0026#39; Main function of our VBA program Sub main() End Sub\rNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set SOLIDWORKS variable to SOLIDWORKS application Set swApp = Application.SldWorks\rIn this line, we set the value of our SOLIDWORKS variable swApp; which we define earlier; to SOLIDWORKS application.\n\u0026#39; Check if SOLIDWORKS is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS application variable is successfully assigned to current SOLIDWORKS application.\n\u0026#39; Setting SOLIDWORKS document variable to opened part document Set swDoc = swApp.ActiveDoc\rIn above line of code, we set SOLIDWORKS document swDoc variable to currently open part document.\n\u0026#39; Check if SOLIDWORKS document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS document swDoc is opened.\nIf SOLIDWORKS document is not opened then code execute inside the code and inform the user by a üëâ Message Window.\nAfter showing message our program exit from here itself.\n\u0026#39; Selecting Sketch 2 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Sketch2\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the Sketch2 by using SelectByID2 method from Extension object.\nFor more information about selection method please visit üëâ SOLIDWORKS Macros - Selection Methods post.\n\u0026#39; Check if Sketch 2 selected or not If BoolStatus = False Then MsgBox (\u0026#34;Fail to select Sketch 2.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if Sketch 2 is selected or not .\nIf Sketch 2 not selected then we execute code inside the üëâ IF statement and inform the user by a üëâ Message Window.\nAfter showing message our program exit from here itself.\n\u0026#39; Create Extrude Cut Feature Set swFeature = swDoc.FeatureManager.FeatureCut4(True, False, False, swEndCondThroughAll, 0, 0.01, 0.01, False, False, False, False, 1, 1, False, False, False, False, False, True, True, True, True, False, swStartSketchPlane, 0, False, False)\rIn above line of code we create a Extrude Cut feature.\nWe create Extrude Cut by setting the value of variable swFeature by FeatureCut4 method.\nFeatureCut4 method is part of FeatureManager object.\nThis FeatureManager is again part of ModelDoc2 object.\nFeatureCut4 Method Parameters Details This FeatureCut4 takes following parameters as explained:\nSd - True for a single-ended cut, False for a doubled-ended cut.\nFlip- True to remove material outside of the profile of the flip side to cut, False to not.\nDir - True for Direction 1 to be opposite of the default direction.\nT1- Termination type for the first end as defined in swEndConditions_e.\nMember Description swEndCondBlind 0 swEndCondMidPlane 6 swEndCondOffsetFromSurface 5 swEndCondThroughAll 1 swEndCondThroughAllBoth 9 swEndCondThroughNext 2 swEndCondUpToBody 7 swEndCondUpToNext 11 swEndCondUpToSelection 10 swEndCondUpToSurface 4 = Do not use; swEndCondUpToVertex 3 = Do not use; T2- Termination type for the second end as defined in swEndConditions_e.\nMember Description swEndCondBlind 0 swEndCondMidPlane 6 swEndCondOffsetFromSurface 5 swEndCondThroughAll 1 swEndCondThroughAllBoth 9 swEndCondThroughNext 2 swEndCondUpToBody 7 swEndCondUpToNext 11 swEndCondUpToSelection 10 swEndCondUpToSurface 4 = Do not use; swEndCondUpToVertex 3 = Do not use; D1 - Depth of extrusion for the first end in meters.\nD2 - Depth of extrusion for the second end in meters.\nDchk1 - True allows a draft angle in the first direction, False does not allow drafting in the first direction.\nDchk2 - True allows a draft angle in the second direction, False does not allow drafting in the second direction\nDdir1 - True for the first draft angle to be inward, False to be outward; only valid when Dchk1 is true.\nDdir2 - True for the second draft angle to be inward, False to be outward; only valid when Dchk2 is true.\nDang1 - Draft angle for the first end; only valid when Dchk1 is True.\nDang2 - Draft angle for the second end; only valid when Dchk2 is True.\nOffsetReverse1 - True to specifies offset in direction away from the sketch, False specifies offset from the face or plane in a direction toward the sketch.\nOffsetReverse2 - True to specifies offset in direction away from the sketch, False specifies offset from the face or plane in a direction toward the sketch.\nTranslateSurface1 - True specifies that the end of the extrusion is a translation of the reference surface, False specifies to use a true offset.\nTranslateSurface2 - True specifies that the end of the extrusion is a translation of the reference surface, False specifies to use a true offset.\nNormalCut - True to create the cut normal to the sheet metal thickness, False to not.\nUseFeatScope - True if the feature only affects selected bodies or components, False if the feature affects all bodies or components.\nUseAutoSelect - True to automatically select all bodies or components and have the feature affect those bodies or components, False to only select the bodies or components the feature affects.\nAssemblyFeatureScope - True if the assembly feature only affects selected components in the assembly, False if the assembly feature affects all components in the assembly.\nAutoSelectComponents - True to automatically select all affected components, False to use only the selected components.\nPropagateFeatureToParts - True to propagate the assembly feature to the components in the model that it affects, False to not.\nT0 - Start conditions as defined in swStartConditions_e.\nMember Description swStartOffset 3 swStartSketchPlane 0 swStartSurface 1 swStartVertex 2 StartOffset - If T0 is swStartConditions_e.swStartOffset, then specify an offset value. FlipStartOffset - If T0 is swStartConditions_e.swStartOffset, then True to flip the direction of cut, False to not. OptimizeGeometry - True to optimize the normal cut in a sheet metal part, False to not; only valid for sheet metal parts and when NormalCut is true. Return Value : This InsertProtrusionBlend2 method return feature data object.\nIn our code, I have used following values:\nParameter Name Value Used Sd True Flip False Dir False T1 swEndCondThroughAll T2 0 D1 0.01 D2 0.01 Dchk1 False Dchk2 False Ddir1 False Ddir2 False Dang1 1 Dang2 1 OffsetReverse1 False OffsetReverse2 False TranslateSurface1 False TranslateSurface2 False NormalCut False UseFeatScope True UseAutoSelect True AssemblyFeatureScope True AutoSelectComponents True PropagateFeatureToParts False T0 swStartSketchPlane StartOffset 0 FlipStartOffset False OptimizeGeometry False To see methods and properties related to FeatureManager object, please visit üëâ this page of SOLIDWORKS API Help.\n\u0026#39; Check if Extrude Cut Feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Extrude Cut Feature.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if we able to create Extrude Cut Feature or not.\nIf we failed to select then inform the user by a üëâ Message Window.\nAfter showing error message our program exit from here itself.\nNow we run the macro and after running macro we get extrude as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Extrude Cut with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":136,"permalink":"/solidworks-macros/create-extrude-cut-feature/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create \u003cstrong\u003eExtrude Cut\u003c/strong\u003e through SOLIDWORKS VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e","tags":[],"title":"SOLIDWORKS Macro - Create Extrude Cut"},{"content":"Objective In this post, I tell you about how to create Revolve Cut through SOLIDWORKS VBA Macros in a sketch.\nThis method is most updated method, so use this method if you want to create a new Revolve Cut.\nVideo of Code on YouTube Please see below üé¨ video on how to create Revolve Cut from SOLIDWORKS VBA Macros.\nPlease note that there are no explanation in the video.\nExplanation of each line and why we write code this way is given in this post.\nCode Sample Below is the code sample for creating Revolve Cut.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Feature Dim swFeature As SldWorks.Feature \u0026#39; Boolean Variable Dim boolStatus As Boolean \u0026#39; Revolve Boss/Extrude program Sub main() \u0026#39; Setting Solidworks variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Setting Solidworks document variable to opened part document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39;-----------------------BELOW IS THE SOLUTION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;---------------------------------------------------------------- \u0026#39; Select Sketch 2 in opened part document boolStatus = swDoc.Extension.SelectByID2(\u0026#34;Sketch2\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Check if failed to select sketch 2 If boolStatus = False Then MsgBox (\u0026#34;Failed to select sketch 2.\u0026#34;) Exit Sub End If \u0026#39; Create Revolve Cut Feature Set swFeature = swDoc.FeatureManager.FeatureRevolve2(True, True, False, True, False, True, swEndConditions_e.swEndCondBlind, swEndConditions_e.swEndCondBlind, AngleConversionFactor * 360, 0, False, False, 0, 0, swThinWallType_e.swThinWallOneDirection, 0, 0, True, False, True) \u0026#39; Check if Revolve Feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Revolve Cut Feature.\u0026#34;) Exit Sub End If End Sub\rPrerequisite In this article there are some prerequisite.\nWe are not creating sketches from code but we use existing sketch to create Revolve Cut feature as shown in below picture.\nAs shown in above image, there are 1 sketch and 1 Revolve feature in our part.\nExtrude Feature : This is our Extrude part for Revolve Cut feature. Sketch2 : This is our profile for Revolve Cut feature. If you want to create Sketch2 programmatically then please refer to below articles.\nFor Circle üëâ read SOLIDWORKS Macros - Create Circle article. If you want to create Revolve feature programmatically then please refer to below article.\nüëâ SOLIDWORKS Macros - Create Extrude/Boss Also, we will apply checks in this article, so the code we write should be error free most of the time.\nUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some üìå links so that you can go through them if there are anything I explained in previous articles.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit üëâ SOLIDWORKS Macros - Open new Part document post.\n\u0026#39; Create variable for SOLIDWORKS application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for SOLIDWORKS document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Creating variable for SOLIDWORKS Feature Dim swFeature As SldWorks.Feature\rIn this line, we Create a variable which we named as swFeature and the type of this swFeature variable is SldWorks.Feature.\nWe create variable swFeature for SOLIDWORKS Feature.\nTo see methods and properties related to Feature object, please visit üëâ this page of SOLIDWORKS API Help\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\nThese all are our global variables.\nThey are SOLIDWORKS API Objects.\nSo basically I group all the SOLIDWORKS API Objects in one place.\nI have also place boolean type object at top also, because we use this variable frequently.\nThus, I have started placing it here.\n\u0026#39; Main function of our VBA program Sub main() End Sub\rNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set SOLIDWORKS variable to SOLIDWORKS application Set swApp = Application.SldWorks\rIn this line, we set the value of our SOLIDWORKS variable swApp; which we define earlier; to SOLIDWORKS application.\n\u0026#39; Check if SOLIDWORKS is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS application variable is successfully assigned to current SOLIDWORKS application.\n\u0026#39; Setting SOLIDWORKS document variable to opened part document Set swDoc = swApp.ActiveDoc\rIn above line of code, we set SOLIDWORKS document swDoc variable to currently open part document.\n\u0026#39; Check if SOLIDWORKS document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS document swDoc is opened.\nIf SOLIDWORKS document is not opened then code execute inside the code and inform the user by a üëâ Message Window.\nAfter showing message our program exit from here itself.\n\u0026#39;-----------------------BELOW IS THE SOLUTION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;----------------------------------------------------------------\rIn above line of code, we get and update unit conversion variable as per document unit.\nFor more detail about why we are using this code sample, please visit üëâ SOLIDWORKS Macro - Fix Unit Issue article.\n\u0026#39; Selecting Sketch 2 BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Sketch2\u0026#34;, \u0026#34;SKETCH\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the Sketch2 by using SelectByID2 method from Extension object.\nFor more information about selection method please visit üëâ SOLIDWORKS Macros - Selection Methods post.\n\u0026#39; Check if Sketch 2 selected or not If BoolStatus = False Then MsgBox (\u0026#34;Fail to select Sketch 2.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if Sketch 2 is selected or not .\nIf Sketch 2 not selected then we execute code inside the üëâ IF statement and inform the user by a üëâ Message Window.\nAfter showing message our program exit from here itself.\n\u0026#39; Create Revolve Cut Feature Set swFeature = swDoc.FeatureManager.FeatureRevolve2(True, True, False, True, False, True, swEndConditions_e.swEndCondBlind, swEndConditions_e.swEndCondBlind, AngleConversionFactor * 360, 0, False, False, 0, 0, swThinWallType_e.swThinWallOneDirection, 0, 0, True, False, True)\rIn above line of code we create a Revolve Cut feature.\nWe create Revolve Cut by setting the value of variable swFeature by FeatureRevolve method.\nFeatureRevolve method is part of FeatureManager object.\nThis FeatureManager is again part of ModelDoc2 object.\nFeatureRevolve2 Method Parameters Details This FeatureRevolve takes following parameters as explained:\nSingleDir - True if the revolve is in one direction, False if in both directions.\nIsSolid - True if this is a Solid revolve feature, False if not.\nIsCut - True if this is a Cut revolve feature, False if not.\nReverseDir - True reverses the angle of the revolution, False does not; only applies if Dir1Type is not swEndConditions_e.swEndCondMidPlane.\nBothDirectionUpToSameEntity - True if the revolve is up to the same entity in both directions, False if not; only applies if SingleDir is False and Dir1Type and Dir2Type are swEndConditions_e.swEndCondUpToVertex, swEndConditions_e.swEndCondUpToSurface, or swEndConditions_e.swEndCondOffsetFromSurface).\nDir1Type - Revolve end condition in direction 1 as defined in swEndConditions_e. as defined below.\nMember Description swEndCondBlind 0 swEndCondMidPlane 6 swEndCondOffsetFromSurface 5 swEndCondThroughAll 1 swEndCondThroughAllBoth 9 swEndCondThroughNext 2 swEndCondUpToBody 7 swEndCondUpToNext 11 swEndCondUpToSelection 10 swEndCondUpToSurface 4 = Do not use; swEndCondUpToVertex 3 = Do not use; Dir2Type - Revolve end condition in direction 2; as defined in swEndConditions_e and only applies if Dir1Type is not swEndConditions_e.swEndCondMidPlane as defined below.\nMember Description swEndCondBlind 0 swEndCondMidPlane 6 swEndCondOffsetFromSurface 5 swEndCondThroughAll 1 swEndCondThroughAllBoth 9 swEndCondThroughNext 2 swEndCondUpToBody 7 swEndCondUpToNext 11 swEndCondUpToSelection 10 swEndCondUpToSurface 4 = Do not use; swEndCondUpToVertex 3 = Do not use; Dir1Angle - Angle in radians of revolution in direction 1; only applies if Dir1Type is swEndConditions_e.swEndCondBlind.\nDir2Angle - Angle in radians of revolution in direction 2; only applies if Dir2Type is swEndConditions_e.swEndCondBlind.\nOffsetReverse1 - True to reverse the offset direction in direction 1, False to not; only applies if Dir1Type is swEndConditions_e.swEndCondOffsetFromSurface.\nOffsetReverse2 - True to reverse the offset direction in direction 2, False to not; only applies if Dir2Type is swEndConditions_e.swEndCondOffsetFromSurface.\nOffsetDistance1 - Offset distance in direction 1; only applies if Dir1Type is swEndConditions_e.swEndCondOffsetFromSurface.\nOffsetDistance2 - Offset distance in direction 2; only applies if Dir2Type is swEndConditions_e.swEndCondOffsetFromSurface.\nThinType - Type and direction as defined in swThinWallType_e.\nMember Description swThinWallMidPlan 2 swThinWallOneDirection 0 swThinWallOppDirection 1 swThinWallTwoDirection 3 ThinThickness1 - Wall thickness in direction 1 (if ThinType is swThinWallType_e.swThinWallMidPlane, (ThinThickness1)/2 is used for each direction). ThinThickness2 - Wall thickness in direction 2 (only applies if ThinType is swThinWallType_e.swThinWallTwoDirection). Merge - True to merge the results into a multi-body part, False to not. UseFeatScope - True if the feature only affects selected bodies, False if the feature affects all bodies. UseAutoSelect - True to automatically select all bodies and have the feature affect those bodies, False to select the bodies or components that the feature affects. Return Value : This FeatureRevolve2 method return feature data object.\nTo see methods and properties related to Feature object, please visit üëâ this page of SOLIDWORKS API Help.\nIn our code, I have used following values:\nParameter Name Value Used SingleDir True IsSolid True IsThin False IsCut True ReverseDir False BothDirectionUpToSameEntity True Dir1Type swEndConditions_e.swEndCondBlind Dir2Type swEndConditions_e.swEndCondBlind Dir1Angle AngleConversionFactor * 360 Dir2Angle 0 OffsetReverse1 False OffsetReverse2 False OffsetDistance1 0 OffsetDistance2 0 ThinType swThinWallType_e.swThinWallOneDirection ThinThickness1 0 ThinThickness2 0 Merge True UseFeatScope False UseAutoSelect True To see methods and properties related to FeatureManager object, please visit üëâ this page of SOLIDWORKS API Help.\n\u0026#39; Check if Revolve Cut Feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Revolve Cut Feature.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if we able to create Revolve Cut Feature or not.\nIf we failed to select then inform the user by a üëâ Message Window.\nAfter showing error message our program exit from here itself.\nNow we run the macro and after running macro we get Revolve as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Revolve Cut with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":137,"permalink":"/solidworks-macros/create-revolve-cut-feature/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this post, I tell you about \u003cem\u003ehow to create \u003cstrong\u003eRevolve Cut\u003c/strong\u003e through SOLIDWORKS VBA Macros\u003c/em\u003e in a sketch.\u003c/p\u003e","tags":[],"title":"SOLIDWORKS Macro - Create Revolve Cut"},{"content":"{% include article-notes/intermediate-initial-note.html %}\nObjective Objective of this article is to learn how to create Sweep Cut through SOLIDWORKS VBA Macros in SOLIDWORKS.\nWe create Sweep Cut through in 2 steps.\nCreate sweep cut feature definition Create sweep cut feature using above feature definition This method is most updated method, so use this method if you want to create a new Sweep Cut.\nSteps To Create Sweep Cut We use following steps to create Sweep Cut\nA. Select Profile for Sweep Cut.\nInform user to select Profile for Sweep Cut. User select the Profile for Sweep Cut. B. Select Path for Sweep Cut.\nInform user to select Path for Sweep Cut. User select the Path for Sweep Cut. Results We Can Get We either create Sweep Cut feature or failed to create the feature as a result.\nBoth cases are shown below.\nWhen user select correct Profile and Path, we will have result as shown in below image. When user select Incorrect Profile and Path, we will have result as shown in below image. To get the correct result please follow the steps correctly.\nVideo of Code on YouTube Please see below üé¨ video on how to create Sweep Cut from SOLIDWORKS VBA Macros.\nPlease note that there are no explanation in the video.\nExplanation of each line and why we write code this way is given in this post.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nCode Sample Below is the code for creating Sweep Cut feature in VBA is given.\nOption Explicit \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr \u0026#39; Array of Solidworks Entities Dim swObjects(1 To 2) As SldWorks.Entity \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity \u0026#39; Variable for Solidworks sweep feature Dim swFeature As SldWorks.Feature \u0026#39; Variable for Solidworks sweep feature data Dim swSweep As SldWorks.SweepFeatureData \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData \u0026#39; Sweep feature program Sub main() \u0026#39; Set Solidworks variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened.\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks document variable to currently opened part document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks part is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks part is not opened.\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks Selection Manager variable Set swSelMgr = swDoc.SelectionManager \u0026#39; Local variable for selection Dim selectItems As Integer selectItems = 1 \u0026#39; Loop till we select all entities While selectItems \u0026lt;= 2 \u0026#39; Message to show user Dim messageToUser As String \u0026#39; Update Messages Select Case selectItems Case 1 messageToUser = \u0026#34;Please select Profile Sketch from Feature tree for Sweep Cut.\u0026#34; Case 2 messageToUser = \u0026#34;Please select Path Sketch from Feature tree for Sweep Cut.\u0026#34; Case Else Exit Sub End Select \u0026#39; Show message to user MsgBox messageToUser \u0026#39; Loop until we complete our selection While swObjects(selectItems) Is Nothing \u0026#39; Local integer for loop Dim i As Integer \u0026#39; Loop until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) \u0026#39; If the profile sketch is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelSKETCHES Then \u0026#39; Set the Solidworks Entity object to profile sketch Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) \u0026#39; If the profile sketch is selected ElseIf swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEXTSKETCHSEGS Then \u0026#39; Inform user to select sketch from Tree MsgBox \u0026#34;Please select Profile/Path sketch from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If Next DoEvents Wend \u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Increase the selection count selectItems = selectItems + 1 Wend \u0026#39; Clear all selection swDoc.ClearSelection2 True \u0026#39; Local variable for counter Dim j As Integer j = 1 \u0026#39; Loop till counter is 2, since we have 2 selection While j \u0026lt; 3 \u0026#39; Set the current instance to Solidworks Entity variable Set swObject = swObjects(j) \u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData \u0026#39; Depend upon the entity we update the mark while selection Select Case j Case 1 \u0026#39; For profile, set mark to 1 swSelData.Mark = 1 \u0026#39; Select the profile swObject.Select4 True, swSelData Case 2 \u0026#39; For path, set mark to 4 swSelData.Mark = 4 \u0026#39; Select the profile swObject.Select4 True, swSelData End Select j = j + 1 Wend \u0026#39; Create sweep cut feature definition Set swSweep = swDoc.FeatureManager.CreateDefinition(swFmSweepCut) \u0026#39; Create sweep cut feature Set swFeature = swDoc.FeatureManager.CreateFeature(swSweep) \u0026#39; Check if Sweep cut feature is created or not If swFeature Is Nothing Then MsgBox (\u0026#34;Sweep cut feature is not created.\u0026#34;) \u0026#39; Erase array data Erase swObjects Exit Sub End If \u0026#39; Erase array data Erase swObjects \u0026#39; View zoom to fit swDoc.ViewZoomtofit2 \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this article.\nWe are not creating sketches from code but we use existing sketch to create Sweep Cut feature as shown in below picture.\nAs shown in above image, there are 2 sketches for Profile \u0026amp; Path and 1 Extrude feature in our part.\nExtrude Feature : This is our Extrude part for Sweep Cut feature. Sketch2 : This is our Profile for Sweep Cut feature. Sketch3 : This is our Path for Sweep Cut feature. If you want to create Sketch2 i.e. Profile programmatically then please refer to below articles.\nFor Circle üëâ read SOLIDWORKS Macros - Create Circle article. If you want to create Extrude feature programmatically then please refer to below article.\nüëâ SOLIDWORKS Macros - Create Extrude/Boss Also, we will apply checks in this article, so the code we write should be error free most of the time.\nSteps To Follow For creating Sweep Cut, there are following steps:\nCreating Global Variables Initializing required variables Ask user to select Profile and Path Mark selected Entities Create Sweep Cut Feature Final work Now let us walk through each step as given above, and understand every line.\nI also give some üìå links so that you can go through them if there are anything I explained in previous articles.\nCreating Global Variables Option Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit üëâ SOLIDWORKS Macros - Open new Part document post.\nWe create following variables.\nVariable for Solidworks application \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\nTo see methods and properties related to SldWorks.SldWorks object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks document \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nTo see methods and properties related to SldWorks.ModelDoc2 object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Selection Manager \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr\rIn this line, we create a variable which we named as swSelMgr and the type of this swSelMgr variable is SldWorks.SelectionMgr.\nTo see methods and properties related to SldWorks.SelectionMgr object, please visit üëâ this page of SOLIDWORKS API Help.\nArray of Solidworks Entities \u0026#39; Array of Solidworks Entities Dim swObjects(1 To 2) As SldWorks.Entity\rIn this line, we create an Array of SOLIDWORKS Entities which we named as swObjects and the type of this SldWorks.Entity variable is SldWorks.Entity.\nThis array consist two SldWorks.Entity variables.\nWe define the number of variable this array holds inside (1 To 2).\nFor more information about the Arrays in VBA please üëâ Array on this website.\nVariable for Solidworks Entity \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity\rIn this line, we Create a variable which we named as swObject and the type of this swObject variable is SldWorks.Entity.\nWe create variable swObject for SOLIDWORKS Entities (Profile and Path) we ask use to select.\nTo see methods and properties related to SldWorks.Entity object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks sweep feature \u0026#39; Variable for Solidworks sweep feature Dim swFeature As SldWorks.Feature\rIn this line, we Create a variable which we named as swFeature and the type of this swFeature variable is SldWorks.Feature.\nWe create variable swFeature for SOLIDWORKS Sweep Cut Feature.\nTo see methods and properties related to Feature object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks sweep feature data \u0026#39; Variable for Solidworks sweep feature data Dim swSweep As SldWorks.SweepFeatureData\rIn this line, we Create a variable which we named as swSweep and the type of this swSweep variable is SldWorks.SweepFeatureData.\nWe create variable swSweep for SOLIDWORKS Sweep Feature Data.\nTo see methods and properties related to SldWorks.SweepFeatureData object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Select Data \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData\rIn this line, we create a variable named swSelData as SldWorks.SelectData object type.\nWe create variable swSelData for SOLIDWORKS Select Data, which we use for Marking selected object.\nTo see methods and properties related to SldWorks.SelectData object, please visit üëâ this page of SOLIDWORKS API Help.\nThese all are our global variables.\nThey are SOLIDWORKS API Objects.\nSo basically I group all the SOLIDWORKS API Objects in one place.\n\u0026#39; Main function of our VBA program Sub main() End Sub\rNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\nTo know more about Sub Procedure you can check üëâ VBA Sub and Function Procedures article of this website.\nInitializing Required Variables Inside this procedure we first initialize required variables as given below.\nSet SOLIDWORKS variable to SOLIDWORKS application \u0026#39; Set SOLIDWORKS variable to SOLIDWORKS application Set swApp = Application.SldWorks\rIn this line, we set the value of our SOLIDWORKS variable swApp; which we define earlier; to SOLIDWORKS application.\n\u0026#39; Check if SOLIDWORKS is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS application variable is successfully assigned to current SOLIDWORKS application.\nSet SOLIDWORKS document variable to opened part document \u0026#39; Set SOLIDWORKS document variable to opened part document Set swDoc = swApp.ActiveDoc\rIn above line of code, we set SOLIDWORKS document swDoc variable to currently open part document.\n\u0026#39; Check if SOLIDWORKS document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS document swDoc is opened.\nIf SOLIDWORKS document is not opened then code execute inside the code and inform the user by a üëâ Message Window.\nSet SOLIDWORKS Selection Manager variable \u0026#39; Set SOLIDWORKS Selection Manager variable Set swSelMgr = swDoc.SelectionManager\rIn above line, we set SOLIDWORKS Selection ManagerswSelMgr variable to current document\u0026rsquo;s Selection Manager.\nLocal variable for User selection \u0026#39; Local variable for selection Dim selectItems As Integer selectItems = 1\rIn above line of code, we define a Local variable name selectItemsas Integer type.\nIn next line we assign a value of 1.\nAsk user to select Profile and Path Now we will ask user to select Profile and Path for Sweep Cut feature.\nPlease follow steps given below.\n\u0026#39; Loop till we select all entities While selectItems \u0026lt;= 2 Wend\rIn above line of code we start a While loop.\nFor more details about While loop, please see üëâ VBA Looping article from this website.\nWe want to loop until selectItems variable\u0026rsquo;s value is equal to 2.\n\u0026#39; Message to show user Dim messageToUser As String\rIn above line of code we create a variable named messageToUser of String type.\nThis variable holds the message we want to show before selection.\n\u0026#39; Update Messages Select Case selectItems Case 1 messageToUser = \u0026#34;Please select Profile Sketch from Feature tree for Sweep Cut.\u0026#34; Case 2 messageToUser = \u0026#34;Please select Path Sketch from Feature tree for Sweep Cut.\u0026#34; Case Else Exit Sub End Select\rIn above line of code, we use a Select statement to update message.\nWe use the case on selectItems\nWhen selectItems = 1 then value of messageToUser update to \u0026quot;Please select Profile Sketch from Feature tree for Sweep Cut.\u0026quot;\nSimilarly, when selectItems = 2 then value of messageToUser update to \u0026quot;Please select Path Sketch from Feature tree for Sweep Cut.\u0026quot;\n\u0026#39; Show message to user MsgBox messageToUser\rIn above line of code, we show the message to user.\nBelow image show the message to the user.\n\u0026#39; Loop until we complete our selection While swObjects(selectItems) Is Nothing Wend\rIn above line of code, we create another While loop.\nThis loops until we select the our Profile and Path.\nFor more details about While loop, please see üëâ VBA Looping article from this website.\n\u0026#39; Local integer for loop Dim i As Integer\rIn above line of code, we create a local integer name i as a counter.\n\u0026#39; Loop until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Next\rIn above line of code, we create a For loop.\nThis code loops from i = 1 to number of objects we select.\n\u0026#39; If the profile sketch is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelSKETCHES Then \u0026#39; Set the Solidworks Entity object to profile sketch Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) \u0026#39; If the profile sketch is selected ElseIf swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEXTSKETCHSEGS Then \u0026#39; Inform user to select sketch from Tree MsgBox \u0026#34;Please select Profile sketch from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If\rIn above line of code, we use üëâ IF/Else statement with conditions.\nThe üëâ IF statement is True when selected object is type of SOLIDWORKS Sketch.\nSimilarly, üëâ Else statement is True when select object is type of SOLIDWORKS External Sketch Segment.\nWhen we select the sketch from Model view, then selected object is SOLIDWORKS External Sketch Segment. When we select the sketch from Feature Tree, then select object is SOLIDWORKS Sketch. {: .notice}\nWhen üëâ IF statement is True we execute code given below.\n\u0026#39; Set the Solidworks Entity object to profile sketch Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1)\rIn above line, we set the indexed object inside array.\nArray of SOLIDWORKS Entities = swObjects Indexed Entity Object = swObjects[selectItems] We set the value of this Indexed Entity Object by GetSelectedObject6() method of SOLIDWORKS Selection Manager.\nWhen we set the Indexed Entity Object value as either Profile or Path, we exit the 2nd While loop.\nWhen we select both Profile and Path, then we exit all While loops.\nSimilarly, when üëâ Else statement is True we execute code given below.\n\u0026#39; Inform user to select sketch from Tree MsgBox \u0026#34;Please select Profile/Path sketch from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True\rWe show message to user to select Profile/Path Sketch from Feature Tree. After that we clear our selection. We do this because if selected object type is SOLIDWORKS External Sketch Segment then we can not assign this object as SOLIDWORKS Entity inside array.\nAfter For loop, we have a call for DoEvents function.\nThis function repeats the While loop until we select the Profile or Path.\n\u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Increase the selection count selectItems = selectItems + 1\rIn above line, when we finished with the Profile or Path selection, we clear previous selection and increment the selected count by 1.\nAfter increment the selected count we continue our while loop.\nMark selected Entities Till now we have completed our selection.\nNow we need to do following things.\nClear any previous selection Select and Mark entities correctly from our Array. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line of code we clear any previous selection.\n\u0026#39; Local variable for counter Dim j As Integer j = 1\rIn above line of code we create integer variable for counter.\n\u0026#39; Loop till counter is 2, since we have 2 selection While j \u0026lt; 3 Wend\rIn above line of code we create a while loop with condition that counter value of j should be less than 3.\n\u0026#39; Set the current instance to Solidworks Entity variable Set swObject = swObjects(j)\rIn above line of code, we set the SOLIDWORKS Entity variable to current object from array.\n\u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData\rIn above line of code, we create SOLIDWORKS Select Data for current SOLIDWORKS Entity object.\n\u0026#39; Depend upon the entity we update the mark while selection Select Case j Case 1 \u0026#39; For profile, set mark to 1 swSelData.Mark = 1 \u0026#39; Select the profile swObject.Select4 True, swSelData Case 2 \u0026#39; For path, set mark to 4 swSelData.Mark = 4 \u0026#39; Select the profile swObject.Select4 True, swSelData End Select\rIn above line of code, now use a Select statement on counter j.\nCase 1 indicate the first object which is our Profile.\nCase 2 indicate the second object which is our Path.\nIn Case 1, we apply following code.\n\u0026#39; For profile, set mark to 1 swSelData.Mark = 1\rIn above lines, we update the Mark to 1 for our SOLIDWORKS Select Data variable.\nFor Sweep Cut feature, Mark value for Profile can be follows:\nIf a sketch profile, use Mark = 1 to select a face, edge, or curve. For a swept-boss feature, the sketch profile must be closed. For a swept-surface feature, the sketch profile is open or closed. If a circular profile, use Mark = 4 to select a sketch line, edge or curve.\nThe circular profile is open or closed. If a solid profile, use Mark = 1 to select the tool body to use to make the cut and use Mark = 2048 to select the solid body to cut. Solid profiles are used only in swept-cut features. For more details about üëâ please visit this page of SOLIDWORKS API Help.\n\u0026#39; Select the profile swObject.Select4 True, swSelData\rIn above line of code, we select the Profile object.\nWe select it by using Select4 method of SOLIDWORKS Entity object.\nThis method takes 2 arguments.\nAppend - True appends the entity to the selection list, False replaces the selection list with this entity. Data - Pointer to the ISelectData object. We use following values as parameter.\nAppend - True Data - swSelData In Case 2, we apply following code.\n\u0026#39; For path, set mark to 4 swSelData.Mark = 4\rIn above lines, we update the Mark to 4 for our SOLIDWORKS Select Data variable.\nFor Sweep Cut feature, Mark value for Path can be follows:\nSelect a set of sketched curves contained in one sketch, a curve, or a set of model edges. The sweep path is open or closed. The starting point of the sweep path must lie on the plane of the profile for a 1-directional sweep. If the sweep path extends to both sides of the profile, you can create a bidirectional sweep. Sweep paths are not used with circular profiles. For more details about üëâ please visit this page of SOLIDWORKS API Help.\n\u0026#39; Select the path swObject.Select4 True, swSelData\rIn above line of code, we select the Profile object.\nWe select it by using Select4 method of SOLIDWORKS Entity object.\nThis method takes 2 arguments.\nAppend - True appends the entity to the selection list, False replaces the selection list with this entity. Data - Pointer to the ISelectData object. We use following values as parameter.\nAppend - True Data - swSelData j = j + 1\rAfter Select statement, we increment the counter variable j by 1.\nCreate Sweep Cut Feature We have completed our selection and Marking of SOLIDWORKS Entities.\nNow we create Sweep Cut Feature.\nFor this we use 2 steps as follows:\nCreate Sweep Cut Feature definition Create Sweep Cut Feature using the definition \u0026#39; Create sweep cut feature definition Set swSweep = swDoc.FeatureManager.CreateDefinition(swFmSweepCut)\rIn above line of code we set the value of variable swSweep by CreateDefinition method.\nCreateDefinition method is part of FeatureManager object.\nThis FeatureManager is again part of swDoc variable i.e. ModelDoc2 object.\nFor more detail about CreateDefinition method please visit üëâ Feature Definition Method CreateDefinition Parameters Details of üëâ Solidworks Macro - Create Sweep Base article.\n\u0026#39; Create Sweep cut feature Set swFeature = swDoc.FeatureManager.CreateFeature(swSweep)\rIn above line of code we set the value of variable swFeature by CreateFeature method.\nThis CreateFeature method takes following parameters as explained:\nFeatureData - Feature or pattern-specific feature data object. Return Value : This CreateFeature method retun feature data object.\nCreateFeature method is part of FeatureManager object.\nThis FeatureManager is again part of swDoc variable i.e. ModelDoc2 object.\nTo see methods and properties related to FeatureManager object, please visit üëâ this page of SOLIDWORKS API Help.\nIn our code, I have used following values:\nFeatureData - I use swSweep as feature data object which we defined prevously. \u0026#39; Check if Sweep Cut Feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Sweep Cut Feature.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if we able to create Sweep Cut Feature or not.\nIf we failed to select then inform the user by a üëâ Message Window.\nAfter showing error message our program exit from here itself.\nNow we run the macro and after running macro we get Revolve as shown in below image.\nFinal work After creating Sweep Cut feature, we have to do some cleaning work so that we can use this macro frequently.\nEmpty SOLIDWORKS Entity Array \u0026#39; Erase array data Erase swObjects\rIn above line, we erase data from SOLIDWORKS Entity array.\nFor this we use Erase function in-build in VBA.\nMake part Zoom to fit \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model.\nFor this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable.\nClear selection \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection.\nFor this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Sweep Cut with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":138,"permalink":"/solidworks-macros/create-sweep-cut-feature/","summary":"\u003cp\u003e{% include article-notes/intermediate-initial-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eObjective of this article is to learn \u003cem\u003ehow to create \u003cstrong\u003eSweep Cut\u003c/strong\u003e through SOLIDWORKS VBA Macros\u003c/em\u003e in SOLIDWORKS.\u003c/p\u003e","tags":[],"title":"SOLIDWORKS Macro - Create Sweep Cut"},{"content":"{% include article-notes/intermediate-initial-note.html %}\nObjective Objective of this article is to learn how to create Lofted Cut through SOLIDWORKS VBA Macros in SOLIDWORKS.\nWe create Lofted Cut in 2 steps.\nSelect profiles for Lofted cut. Create Lofted cut feature using InsertCutBlend method. This method is most updated method, so use this method if you want to create a new Lofted Cut.\nSteps To Create Lofted Cut We use following steps to create Lofted Cut\nA. Select Profile for Lofted Cut.\nInform user to select Profile for Lofted Cut. User select the Profile for Lofted Cut. B. Repeat the step A until we complete profile selection.\nResults We Can Get We successfully create Lofted Cut feature as a result.\nBelow image shows the result we get.\nTo get the correct result please follow the steps correctly.\nVideo of Code on YouTube Please see below üé¨ video on how to create Lofted Cut from SOLIDWORKS VBA Macros.\nPlease note that there are no explanation in the video.\nExplanation of each line and why we write code this way is given in this post.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nCode Sample Below is the code for creating Lofted Cut feature in VBA is given.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr \u0026#39; Array of Solidworks Entities Dim swObjects(1 To 2) As SldWorks.Entity \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity \u0026#39; Variable for Solidworks Lofted Cut feature Dim swFeature As SldWorks.Feature \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData \u0026#39; Lofted Cut program Sub main() \u0026#39; Setting Solidworks variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Setting Solidworks document variable to opened part document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks Selection Manager variable Set swSelMgr = swDoc.SelectionManager \u0026#39; Local variable for selection Dim selectItems As Integer selectItems = 1 \u0026#39; Loop till we select all entities While selectItems \u0026lt;= 2 \u0026#39; Message to show user Dim messageToUser As String \u0026#39; Update Messages Select Case selectItems Case 1 messageToUser = \u0026#34;Please select Profile 1 Sketch from Feature tree for Lofted Cut.\u0026#34; Case 2 messageToUser = \u0026#34;Please select Profile 2 Sketch from Feature tree for Lofted Cut.\u0026#34; Case Else Exit Sub End Select \u0026#39; Show message to user MsgBox messageToUser \u0026#39; Loop until we complete our selection While swObjects(selectItems) Is Nothing \u0026#39; Local integer for loop Dim i As Integer \u0026#39; Loop until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) \u0026#39; If the profile sketch is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelSKETCHES Then \u0026#39; Set the Solidworks Entity object to profile sketch Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) \u0026#39; If the profile sketch is selected ElseIf swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEXTSKETCHSEGS Then \u0026#39; Inform user to select sketch from Tree MsgBox \u0026#34;Please select Profile sketches from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If Next DoEvents Wend \u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Increase the selection count selectItems = selectItems + 1 Wend \u0026#39; Local variable for counter Dim j As Integer j = 1 \u0026#39; Loop till counter is 2, since we have 2 selection While j \u0026lt; 3 \u0026#39; Set the current instance to Solidworks Entity variable Set swObject = swObjects(j) \u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData \u0026#39; For profile, set mark to 1 swSelData.Mark = 1 \u0026#39; Select the profile swObject.Select4 True, swSelData j = j + 1 Wend \u0026#39; Create Lofted feature Set swFeature = swDoc.FeatureManager.InsertCutBlend(False, True, True, 0.01, 0, 0, False, 0, 0, 0, True, True) \u0026#39; Check if Lofted Cut Feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Lofted Cut Feature.\u0026#34;) Exit Sub End If \u0026#39; Erase array data Erase swObjects \u0026#39; View zoom to fit swDoc.ViewZoomtofit2 \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this article.\nWe are not creating sketches from code but we use existing sketch to create Lofted Cut feature as shown in below picture.\nAs shown in above image, there are 2 sketches for Profiles and 1 Extrude feature in our part.\nExtrude Feature : This is our Extrude part for Lofted Cut feature. Sketch2 : This is our Profile for Lofted Cut feature. Sketch3 : This is also our Profile for Lofted Cut feature. If you want to create Sketch2 i.e. Profile programmatically then please refer to below articles.\nFor Circle üëâ read SOLIDWORKS Macros - Create Circle article. For Corner Rectangle üëâ read SOLIDWORKS Macros - Create Corner Rectangle article. If you want to create Extrude feature programmatically then please refer to below article.\nüëâ SOLIDWORKS Macros - Create Extrude/Boss Also, we will apply checks in this article, so the code we write should be error free most of the time.\nSteps To Follow For creating Lofted Cut, there are following steps:\nCreating Global Variables Initializing required variables Ask user to select Profile and Path Mark selected Entities Create Lofted Cut Feature Final work Now let us walk through each step as given above, and understand every line.\nI also give some üìå links so that you can go through them if there are anything I explained in previous articles.\nCreating Global Variables Option Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit üëâ SOLIDWORKS Macros - Open new Part document post.\nWe create following variables.\nVariable for Solidworks application \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\nTo see methods and properties related to SldWorks.SldWorks object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks document \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nTo see methods and properties related to SldWorks.ModelDoc2 object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Selection Manager \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr\rIn this line, we create a variable which we named as swSelMgr and the type of this swSelMgr variable is SldWorks.SelectionMgr.\nTo see methods and properties related to SldWorks.SelectionMgr object, please visit üëâ this page of SOLIDWORKS API Help.\nArray of Solidworks Entities \u0026#39; Array of Solidworks Entities Dim swObjects(1 To 2) As SldWorks.Entity\rIn this line, we create an Array of SOLIDWORKS Entities which we named as swObjects and the type of this SldWorks.Entity variable is SldWorks.Entity.\nThis array consist two SldWorks.Entity variables.\nWe define the number of variable this array holds inside (1 To 2).\nFor more information about the Arrays in VBA please üëâ Array on this website.\nVariable for Solidworks Entity \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity\rIn this line, we Create a variable which we named as swObject and the type of this swObject variable is SldWorks.Entity.\nWe create variable swObject for SOLIDWORKS Entities (Profile and Path) we ask use to select.\nTo see methods and properties related to SldWorks.Entity object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Lofted feature \u0026#39; Variable for Solidworks Lofted Cut feature Dim swFeature As SldWorks.Feature\rIn this line, we Create a variable which we named as swFeature and the type of this swFeature variable is SldWorks.Feature.\nWe create variable swFeature for SOLIDWORKS Lofted Cut Feature.\nTo see methods and properties related to Feature object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Select Data \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData\rIn this line, we create a variable named swSelData as SldWorks.SelectData object type.\nWe create variable swSelData for SOLIDWORKS Select Data, which we use for Marking selected object.\nTo see methods and properties related to SldWorks.SelectData object, please visit üëâ this page of SOLIDWORKS API Help.\nThese all are our global variables.\nThey are SOLIDWORKS API Objects.\nSo basically I group all the SOLIDWORKS API Objects in one place.\n\u0026#39; Lofted Cut program Sub main() End Sub\rNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\nTo know more about Sub Procedure you can check üëâ VBA Sub and Function Procedures article of this website.\nInitializing Required Variables Inside this procedure we first initialize required variables as given below.\nSet SOLIDWORKS variable to SOLIDWORKS application \u0026#39; Set SOLIDWORKS variable to SOLIDWORKS application Set swApp = Application.SldWorks\rIn this line, we set the value of our SOLIDWORKS variable swApp; which we define earlier; to SOLIDWORKS application.\n\u0026#39; Check if SOLIDWORKS is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS application variable is successfully assigned to current SOLIDWORKS application.\nSet SOLIDWORKS document variable to opened part document \u0026#39; Set SOLIDWORKS document variable to opened part document Set swDoc = swApp.ActiveDoc\rIn above line of code, we set SOLIDWORKS document swDoc variable to currently open part document.\n\u0026#39; Check if SOLIDWORKS document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS document swDoc is opened.\nIf SOLIDWORKS document is not opened then code execute inside the code and inform the user by a üëâ Message Window.\nSet SOLIDWORKS Selection Manager variable \u0026#39; Set SOLIDWORKS Selection Manager variable Set swSelMgr = swDoc.SelectionManager\rIn above line, we set SOLIDWORKS Selection ManagerswSelMgr variable to current document\u0026rsquo;s Selection Manager.\nLocal variable for User selection \u0026#39; Local variable for selection Dim selectItems As Integer selectItems = 1\rIn above line of code, we define a Local variable name selectItemsas Integer type.\nIn next line we assign a value of 1.\nAsk user to select Profiles for Lofted Cut Now we will ask user to select Profiles for Lofted Cut feature.\nPlease follow steps given below.\n\u0026#39; Loop till we select all entities While selectItems \u0026lt;= 2 Wend\rIn above line of code we start a While loop.\nFor more details about While loop, please see üëâ VBA Looping article from this website.\nWe want to loop until selectItems variable\u0026rsquo;s value is equal to 2.\n\u0026#39; Message to show user Dim messageToUser As String\rIn above line of code we create a variable named messageToUser of String type.\nThis variable holds the message we want to show before selection.\n\u0026#39; Update Messages Select Case selectItems Case 1 messageToUser = \u0026#34;Please select Profile 1 Sketch from Feature tree for Lofted Cut.\u0026#34; Case 2 messageToUser = \u0026#34;Please select Profile 2 Sketch from Feature tree for Lofted Cut.\u0026#34; Case Else Exit Sub End Select\rIn above line of code, we use a Select statement to update message.\nWe use the case on selectItems\nWhen selectItems = 1 then value of messageToUser update to \u0026quot;Please select Profile 1 Sketch from Feature tree for Lofted Cut.\u0026quot;\nSimilarly, when selectItems = 2 then value of messageToUser update to \u0026quot;Please select Profile 2 Sketch from Feature tree for Lofted Cut.\u0026quot;\n\u0026#39; Show message to user MsgBox messageToUser\rIn above line of code, we show the message to user.\nBelow image show the message to the user.\n\u0026#39; Loop until we complete our selection While swObjects(selectItems) Is Nothing Wend\rIn above line of code, we create another While loop.\nThis loops until we select the our Profile and Path.\nFor more details about While loop, please see üëâ VBA Looping article from this website.\n\u0026#39; Local integer for loop Dim i As Integer\rIn above line of code, we create a local integer name i as a counter.\n\u0026#39; Loop until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Next\rIn above line of code, we create a For loop.\nThis code loops from i = 1 to number of objects we select.\n\u0026#39; If the profile sketch is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelSKETCHES Then \u0026#39; Set the Solidworks Entity object to profile sketch Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) \u0026#39; If the profile sketch is selected ElseIf swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEXTSKETCHSEGS Then \u0026#39; Inform user to select sketch from Tree MsgBox \u0026#34;Please select Profile sketch from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If\rIn above line of code, we use üëâ IF/Else statement with conditions.\nThe üëâ IF statement is True when selected object is type of SOLIDWORKS Sketch.\nSimilarly, üëâ Else statement is True when select object is type of SOLIDWORKS External Sketch Segment.\nWhen we select the sketch from Model view, then selected object is SOLIDWORKS External Sketch Segment. When we select the sketch from Feature Tree, then select object is SOLIDWORKS Sketch. {: .notice}\nWhen üëâ IF statement is True we execute code given below.\n\u0026#39; Set the Solidworks Entity object to profile sketch Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1)\rIn above line, we set the indexed object inside array.\nArray of SOLIDWORKS Entities = swObjects Indexed Entity Object = swObjects[selectItems] We set the value of this Indexed Entity Object by GetSelectedObject6() method of SOLIDWORKS Selection Manager.\nWhen we set the Indexed Entity Object value as Profiles, we exit the 2nd While loop.\nWhen we select both Profiles, then we exit all While loops also.\nSimilarly, when üëâ Else statement is True we execute code given below.\n\u0026#39; Inform user to select sketch from Tree MsgBox \u0026#34;Please select Profile sketches from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True\rWe show message to user to select Profile Sketch from Feature Tree. After that we clear our selection. We do this because if selected object type is SOLIDWORKS External Sketch Segment then we can not assign this object as SOLIDWORKS Entity inside array.\nAfter For loop, we have a call for DoEvents function.\nThis function repeats the While loop until we select the Profile or Path.\n\u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Increase the selection count selectItems = selectItems + 1\rIn above line, when we finished with the Profile or Path selection, we clear previous selection and increment the selected count by 1.\nAfter increment the selected count we continue our while loop.\nMark selected Entities Till now we have completed our selection.\nNow we need to do Select and Mark entities correctly from our Array.\n\u0026#39; Local variable for counter Dim j As Integer j = 1\rIn above line of code we create integer variable for counter.\n\u0026#39; Loop till counter is 2, since we have 2 selection While j \u0026lt; 3 Wend\rIn above line of code we create a while loop with condition that counter value of j should be less than 3.\n\u0026#39; Set the current instance to Solidworks Entity variable Set swObject = swObjects(j)\rIn above line of code, we set the SOLIDWORKS Entity variable to current object from array.\n\u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData\rIn above line of code, we create SOLIDWORKS Select Data for current SOLIDWORKS Entity object.\n\u0026#39; For profile, set mark to 1 swSelData.Mark = 1\rIn above lines, we update the Mark to 1 for our SOLIDWORKS Select Data variable.\nFor Lofted Cut feature, Mark values can be follows:\nIf a sketch profile, use Mark = 1 . If a guide curve is given, use Mark = 2 . If a centerline is given, use Mark = 4 . For more details about Mark values for Lofted Cut üëâ please visit this page of SOLIDWORKS API Help.\n\u0026#39; Select the profile swObject.Select4 True, swSelData\rIn above line of code, we select the Profile object.\nWe select it by using Select4 method of SOLIDWORKS Entity object.\nThis method takes 2 arguments.\nAppend - True appends the entity to the selection list, False replaces the selection list with this entity. Data - Pointer to the ISelectData object. We use following values as parameter.\nAppend - True Data - swSelData j = j + 1\rAfter Select statement, we increment the counter variable j by 1.\nCreate Lofted Cut Feature We have completed our selection and Marking of SOLIDWORKS Entities.\nNow we create Lofted Cut Feature.\n\u0026#39; Create Lofted feature Set swFeature = swDoc.FeatureManager.InsertCutBlend(False, True, True, 0.01, 0, 0, False, 0, 0, 0, True, True)\rIn above line of code we set the value of variable swFeature by InsertCutBlend method.\nThis CreateFeature method takes following parameters as explained:\nClosed - True if you want the loft to be closed, False to leave it open.\nKeepTangency - Controls whether the section curves are tangent.\nForceNonRational - True to force the resulting surface to be non-rational; False to not.\nTessToleranceFactor - A factor to control the number of intermediate sections used for loft with centerline; the default value is 1.0; the greater the variable, the more intermediate sections are created.\nStartMatchingType - Tangency type at the start profile.\nEndMatchingType - Tangency type at the end profile.\nIsThinBody - True if this feature is a thin body, False is not.\nThickness1 - Thickness value for the first direction.\nThickness2 - Thickness value for the second direction.\nThinType - Thin wall type are as follows.\nMember Description One direction 0 One direction reverse 1 Mid-plane 2 Two direction 3 UseFeatScope - True if the feature only affects selected bodies, False if the feature affects all bodies.\nUseAutoSelect - True to automatically select all bodies and have the feature affect those bodies, False to select the bodies the feature affects.\nReturn Value : This InsertCutBlend method return feature data object.\nTo see methods and properties related to Feature object, please visit üëâ this page of SOLIDWORKS API Help.\nIn our code, I have used following values:\nParameter Name Value Used Closed False KeepTangency True ForceNonRational True TessToleranceFactor 0.01 StartMatchingType 0 EndMatchingType 0 IsThinBody False Thickness1 0 Thickness2 0 ThinType 0 UseFeatScope True UseAutoSelect True InsertCutBlend method is part of FeatureManager object.\nThis FeatureManager is again part of swDoc variable i.e. ModelDoc2 object.\nTo see methods and properties related to FeatureManager object, please visit üëâ this page of SOLIDWORKS API Help.\n\u0026#39; Check if Lofted Cut Feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Lofted Cut Feature.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if we able to create Lofted Cut Feature or not.\nIf we failed to select then inform the user by a üëâ Message Window.\nAfter showing error message our program exit from here itself.\nNow we run the macro and after running macro we get Revolve as shown in below image.\nFinal work After creating Lofted Cut feature, we have to do some cleaning work so that we can use this macro frequently.\nEmpty SOLIDWORKS Entity Array \u0026#39; Erase array data Erase swObjects\rIn above line, we erase data from SOLIDWORKS Entity array.\nFor this we use Erase function in-build in VBA.\nMake part Zoom to fit \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model.\nFor this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable.\nClear selection \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection.\nFor this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Lofted Cut with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":139,"permalink":"/solidworks-macros/create-loft-cut-feature/","summary":"\u003cp\u003e{% include article-notes/intermediate-initial-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eObjective of this article is to learn \u003cem\u003ehow to create \u003cstrong\u003eLofted Cut\u003c/strong\u003e through SOLIDWORKS VBA Macros\u003c/em\u003e in SOLIDWORKS.\u003c/p\u003e","tags":[],"title":"SOLIDWORKS Macro - Create Lofted Cut"},{"content":"Well-thought-through product announcements will help increase feature awareness and engage users with new functionality. Just like sharing your public roadmap, it\u0026rsquo;s also a great way to let potential customers see that you\u0026rsquo;re constantly improving.\nFurther reading Read How to announce product updates and features ","date":"2023-09-07","id":140,"permalink":"/blog/example-post/","summary":"You can use blog posts for announcing product updates and features.","tags":[],"title":"Example Post"},{"content":"","date":"2023-09-07","id":141,"permalink":"/blog/","summary":"","tags":[],"title":"Blog"},{"content":"{% include article-notes/intermediate-initial-note.html %}\nObjective Objective of this article is to learn how to create Holes using üëâ Hole Wizard through SOLIDWORKS VBA Macros in SOLIDWORKS.\nWe create Holes in 3 steps in general.\nSelect a üëâ Sketch from we take the Holes location. Loop through each üëâ Sketch point. Create Holes using üëâ Hole Wizard feature using HoleWizard method. This method is not updated method, so use this method if you want to quickly create a new Holes using Hole Wizard.\nSteps To Create Holes using Hole Wizard We use following steps to create Holes using üëâ Hole Wizard while writing macro\nAsk user to select a üëâ Sketch from Feature tree. From this sketch we get üëâ Sketch point for Holes position. Loop through each üëâ Sketch point. Create Holes using üëâ Hole Wizard method from üëâ SOLIDWORKS Feature Manager. Results We Can Get After running our we successfully create Hole feature as a result.\nBelow image shows the result we get.\nTo get the correct result please follow the steps correctly.\nVideo of Code on YouTube Please see below üé¨ video on how to create Hole feature from SOLIDWORKS VBA Macros.\nPlease note that there are no explanation in the video.\nExplanation of each line and why we write code this way is given in this post.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nCode Sample Below is the code for creating Hole Feature feature in VBA is given.\nOption Explicit \u0026#39; Solidworks application variable Dim swApp As SldWorks.SldWorks \u0026#39; Solidworks document variable Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Solidworks Feature variable Dim swFeature As SldWorks.Feature \u0026#39; Solidworks Sketch variable Dim swSketch As SldWorks.Sketch \u0026#39; Solidworks Selection Manager variable Dim swSelMgr As SldWorks.SelectionMgr \u0026#39; Sketch point array Dim vSketchPointArray As Variant \u0026#39; Solidworks Sketch Point variable Dim sketchPoint As SldWorks.sketchPoint \u0026#39; Solidworks Hole Feature Dim swHoleFeature As SldWorks.Feature \u0026#39; Sketch Point inside point array Dim vpoint As Variant \u0026#39; Create Hole from Hole wizard program Sub main() \u0026#39; Set Solidworks application variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks document variable to open document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks Selection Manager variable Set swSelMgr = swDoc.SelectionManager \u0026#39; Message to show user Dim messageToUser As String \u0026#39; Update Messages messageToUser = \u0026#34;Please select Sketch from Feature tree for Hole location.\u0026#34; \u0026#39; Show message to user MsgBox messageToUser \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity \u0026#39; Loop until we complete our selection While swObject Is Nothing \u0026#39; Local integer for loop Dim i As Integer \u0026#39; Loop until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) \u0026#39; If the profile sketch is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelSKETCHES Then \u0026#39; Set the Solidworks Entity object to profile sketch Set swObject = swSelMgr.GetSelectedObject6(i, -1) \u0026#39; If the selected Sketch is externaly ElseIf swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEXTSKETCHPOINTS Then \u0026#39; Inform user to select sketch from Tree MsgBox \u0026#34;Please select Sketch from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If Next DoEvents Wend \u0026#39; Get and Set Solidworks Feature variable of Sketch2 Set swFeature = swObject \u0026#39; Get and Set Solidworks Sketch variable of Sketch2 Set swSketch = swFeature.GetSpecificFeature2 \u0026#39; Get all sketch points inside sketch2 vSketchPointArray = swSketch.GetSketchPoints2 \u0026#39;-----------------------Unit Conversion Factors---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;---------------------------------------------------------------- \u0026#39; Loop through each point For Each vpoint In vSketchPointArray \u0026#39; Set Solidworks Sketch point to current point in loop Set sketchPoint = vpoint \u0026#39; Select current sketch point sketchPoint.Select True \u0026#39; Create Counter Bore Hole at this point Set swHoleFeature = swDoc.FeatureManager.HoleWizard(swWzdCounterBore, swStandardISO, swStandardISOHexCapScrew, \u0026#34;M6\u0026#34;, swEndCondBlind, 5 * LengthConversionFactor, 6 * LengthConversionFactor, 10 * LengthConversionFactor, 5 * LengthConversionFactor, 0, 1 * LengthConversionFactor, 2 * LengthConversionFactor, 0, 0, 0, 0, 0, 0, 0) Next \u0026#39; Check if Holes from Hole Wizard creates or not If swHoleFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Holes from Hole Wizard.\u0026#34;) Exit Sub End If \u0026#39; View zoom to fit swDoc.ViewZoomtofit2 \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this article.\nWe are not creating sketches from code but we use existing sketch to create Holes using üëâ Hole Wizard feature as shown in below picture.\nAs shown in above image, there are 1 sketches and 1 Extrude feature in our part.\nExtrude Feature : This is our Extrude part for üëâ Hole Wizard feature. Sketch2 : This üëâ Sketch contains üëâ Sketch point. which work as location for Hole Feature. If you want to create Sketch2 programmatically then please refer to below article.\nFor creating a Sketch Point üëâ read SOLIDWORKS Macros - Create a Point article. If you want to create Extrude feature programmatically then please refer to below article.\nüëâ SOLIDWORKS Macros - Create Extrude/Boss Also, we will apply checks in this article, so the code we write should be error free most of the time.\nSteps To Follow To create Holes using üëâ Hole Wizard, there are following steps:\nCreating Global Variables Initializing required variables Ask user to select Sketch segment Get all Sketch Points from selected Sketch Get unit Conversion factors Create Hole feature at each Sketch Point Final work Now let us walk through each step as given above, and understand every line.\nI also give some links (see icon üëâ ) so that you can go through them if there are anything I explained in previous articles.\nCreating Global Variables Option Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit üëâ SOLIDWORKS Macros - Open new Part document post.\nWe create following variables.\nVariable for Solidworks application \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\nTo see methods and properties related to SldWorks.SldWorks object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks document \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nTo see methods and properties related to SldWorks.ModelDoc2 object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks feature \u0026#39; Variable for Solidworks feature Dim swFeature As SldWorks.Feature\rIn this line, we Create a variable which we named as swFeature and the type of this swFeature variable is SldWorks.Feature.\nWe create variable swFeature for SOLIDWORKS Feature.\nTo see methods and properties related to Feature object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Sketch \u0026#39; Solidworks Sketch variable Dim swSketch As SldWorks.Sketch\rIn this line, we create a variable which we named as swSketch and the type of this swSketch variable is SldWorks.Sketch.\nTo see methods and properties related to SldWorks.Sketch object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Selection Manager \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr\rIn this line, we create a variable which we named as swSelMgr and the type of this swSelMgr variable is SldWorks.SelectionMgr.\nTo see methods and properties related to SldWorks.SelectionMgr object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Sketch point array \u0026#39; Sketch point array Dim vSketchPointArray As Variant\rIn this line, we create a variable named vSketchPointArray as Variant object type.\nWe create variable vSketchPointArray for storing all the sketch points we get from selected Sketch.\nVariable for Solidworks Sketch Point \u0026#39; Solidworks Sketch Point variable Dim sketchPoint As SldWorks.sketchPoint\rIn this line, we create a variable which we named as sketchPoint and the type of this sketchPoint variable is SldWorks.sketchPoint.\nTo see methods and properties related to SldWorks.sketchPoint object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Hole Feature \u0026#39; Solidworks Hole Feature Dim swHoleFeature As SldWorks.Feature\rIn this line, we create a variable which we named as swHoleFeature and the type of this swHoleFeature variable is SldWorks.Feature.\nWe create variable swFeature for SOLIDWORKS Hole Feature.\nTo see methods and properties related to Feature object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Sketch point inside array \u0026#39; Sketch Point inside point array Dim vpoint As Variant\rIn this line, we create a variable named vpoint as Variant object type.\nWe create variable vpoint for each point inside vSketchPointArray.\nThese all are our global variables.\nThey are SOLIDWORKS API Objects.\nSo basically I group all the SOLIDWORKS API Objects in one place.\n\u0026#39; Create Hole from Hole wizard program Sub main() End Sub\rNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\nTo know more about Sub Procedure you can check üëâ VBA Sub and Function Procedures article of this website.\nInitializing Required Variables Inside this procedure we first initialize required variables as given below.\nSet SOLIDWORKS variable to SOLIDWORKS application \u0026#39; Set SOLIDWORKS variable to SOLIDWORKS application Set swApp = Application.SldWorks\rIn this line, we set the value of our SOLIDWORKS variable swApp; which we define earlier; to SOLIDWORKS application.\n\u0026#39; Check if SOLIDWORKS is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS application variable is successfully assigned to current SOLIDWORKS application.\nSet SOLIDWORKS document variable to opened part document \u0026#39; Set SOLIDWORKS document variable to opened part document Set swDoc = swApp.ActiveDoc\rIn above line of code, we set SOLIDWORKS document swDoc variable to currently open part document.\n\u0026#39; Check if SOLIDWORKS document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS document swDoc is opened.\nIf SOLIDWORKS document is not opened then code execute inside the code and inform the user by a üëâ Message Window.\nSet SOLIDWORKS Selection Manager variable \u0026#39; Set SOLIDWORKS Selection Manager variable Set swSelMgr = swDoc.SelectionManager\rIn above line, we set SOLIDWORKS Selection ManagerswSelMgr variable to current document\u0026rsquo;s Selection Manager.\nAsk user to select Sketch Now we will ask user to select a Sketch for üëâ Hole Wizard\nPlease follow steps given below.\nShow Message to user \u0026#39; Message to show Dim messageToUser As String\rIn above line of code we create a variable named messageToUser of String type.\nThis variable holds the message we want to show before selection.\n\u0026#39; Update Message messageToUser = \u0026#34;Please select Sketch from Feature tree for Hole location.\u0026#34;\rIn above line of code, we set the value of messageToUser update to \u0026quot;Please select Sketch from Feature tree for Hole location.\u0026quot;\n\u0026#39; Show message to user MsgBox messageToUser\rIn above line of code, we show the message to user.\nBelow image show the message to the user.\nComplete the selection \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity\rIn this line, we Create a variable which we named as swObject and the type of this swObject variable is SldWorks.Entity.\nWe create variable swObject for SOLIDWORKS Entities (Selected Sketch) we ask use to select.\nTo see methods and properties related to SldWorks.Entity object, please visit üëâ this page of SOLIDWORKS API Help.\n\u0026#39; Loop until we complete our selection While swObject Is Nothing Wend\rIn above line of code, we create another While loop.\nThis loop will continue until we select the our üëâSketch.\nFor more details about While loop, please see üëâ VBA Looping article from this website.\n\u0026#39; Local integer for loop Dim i As Integer\rIn above line of code, we create a local integer name i as a counter.\n\u0026#39; Loop until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Next\rIn above line of code, we create a For loop.\nThis code loops from i = 1 to number of objects we select.\n\u0026#39; If the sketch is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelSKETCHES Then \u0026#39; Set the Solidworks Entity object to sketch Set swObject = swSelMgr.GetSelectedObject6(i, -1) \u0026#39; If the selected Sketch is externaly ElseIf swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEXTSKETCHPOINTS Then \u0026#39; Inform user to select sketch from Tree MsgBox \u0026#34;Please select Sketch from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If\rIn above line of code, we use üëâ IF/Else statement with conditions.\nThe üëâ IF statement is True when selected object is type of SOLIDWORKS Sketch.\nSimilarly, üëâ Else statement is True when select object is type of SOLIDWORKS External Sketch Point.\nWhen we select the sketch from Model view, then selected object is SOLIDWORKS External Sketch Point. When we select the sketch from Feature Tree, then select object is SOLIDWORKS Sketch. {: .notice}\nWhen üëâ IF statement is True we execute code given below.\n\u0026#39; Set the Solidworks Entity object to sketch Set swObject = swSelMgr.GetSelectedObject6(i, -1)\rIn above line, we set the SOLIDWORKS Entities object swObject value by GetSelectedObject6() method of SOLIDWORKS Selection Manager.\nSimilarly, when üëâ Else statement is True we execute code given below.\n\u0026#39; Inform user to select sketch from Tree MsgBox \u0026#34;Please select Sketch from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True\rWe show message to user to select üëâSketch from Feature Tree. After that we clear our selection. We do this because if selected object type is SOLIDWORKS External Sketch Point then we can not assign this object as SOLIDWORKS Entity inside array.\nAfter For loop, we have a call for DoEvents function.\nThis function repeats the While loop until we select the üëâSketch for üëâ Hole Wizard.\nGet all Sketch Points from selected Sketch Now we need to get the all üëâ Sketch point from previously selected üëâSketch .\nWe do this by below code of lines.\n\u0026#39; Get and Set Solidworks Feature variable of Sketch2 Set swFeature = swObject\rIn above line of code we set the value of SOLIDWORKS Feature variable swFeature to swObject.\n\u0026#39; Get and Set Solidworks Sketch variable of Sketch2 Set swSketch = swFeature.GetSpecificFeature2\rIn above line of code we set the value of SOLIDWORKS Sketch variable swSketch by GetSpecificFeature2 method from SOLIDWORKS Feature variable.\n\u0026#39; Get all sketch points inside sketch2 vSketchPointArray = swSketch.GetSketchPoints2\rIn above line of code we get all üëâ Sketch point by GetSketchPoints2 from SOLIDWORKS Sketch variable swSketch and store them in vSketchPointArray variable.\nGet unit Conversion factors Now we need to get unit Conversion factors as shown in below code.\n\u0026#39;-----------------------Unit Conversion Factors---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;----------------------------------------------------------------\rI have already explained about this in previous üëâ Solidworks Macro - Fix Unit Issue article in this website.\nPlease visit üëâ Solidworks Macro - Fix Unit Issue article for more details.\nCreate Hole feature Now we create Hole feature at every Sketch Point.\nLoop through every Sketch Point \u0026#39; Loop through each point For Each vpoint In vSketchPointArray Next\rIn above line of code we create a üëâ For Each loop.\nSelect current Sketch Point \u0026#39; Set Solidworks Sketch point to current point in loop Set sketchPoint = vpoint\rIn above line of code we set SOLIDWORKS Sketch point variable sketchPoint to current point vpoint in loop\n\u0026#39; Create Counter Bore Hole at this point Set swHoleFeature = swDoc.FeatureManager.HoleWizard(swWzdCounterBore, swStandardISO, swStandardISOHexCapScrew, \u0026#34;M6\u0026#34;, swEndCondBlind, 5 * LengthConversionFactor, 6 * LengthConversionFactor, 10 * LengthConversionFactor, 5 * LengthConversionFactor, 0, 1 * LengthConversionFactor, 2 * LengthConversionFactor, 0, 0, 0, 0, 0, 0, 0)\rIn above line of code we set the value of variable swHoleFeature by HoleWizard method.\nThis HoleWizard method takes following parameters as explained:\nGenericHoleType - Type of hole or slot as defined in swWzdGeneralHoleTypes_e as given in below table\nMember Description swWzdCounterBore 0 swWzdCounterBoreSlot 6 swWzdCounterSink 1 swWzdCounterSinkSlot 7 swWzdHole 2 swWzdHoleSlot 8 swWzdLegacy 5 swWzdPipeTap 3 swWzdTap 4 StandardIndex - Hole or slot standard property as defined in swWzdHoleStandards_e as given in below table.\nMember Description swStandardAnsiInch 0 swStandardAnsiMetric 1 swStandardAS 16 = Australian swStandardBSI 2 swStandardDIN 4 swStandardDME 3 swStandardGB 13 swStandardHascoMetric 5 swStandardHelicoilInch 6 swStandardHelicoilMetric 7 swStandardIS 15 = Indian swStandardISO 8 swStandardJIS 9 swStandardKS 14 = Korean swStandardPCS 10 swStandardPEMInch 17 = PEM Inch swStandardPEMMetric 18 = PEM Metric swStandardProgressive 11 swStandardSuperior 12 FastenerTypeIndex - *Hole or slot fastener type as defined in swWzdHoleStandardFastenerTypes_e as given in üëâ this page of Solidworks API Help.\nSSize - Size of the hole or slot.\nEndType - Hole or slot end type as defined in swEndConditions_e as given in below table.\nMember Description swEndCondBlind 0 swEndCondMidPlane 6 swEndCondOffsetFromSurface 5 swEndCondThroughAll 1 swEndCondThroughAllBoth 9 swEndCondThroughNext 2 swEndCondUpToBody 7 swEndCondUpToNext 11 swEndCondUpToSelection 10 swEndCondUpToSurface 4 = Do not use; superseded by swEndCondUpToSelection swEndCondUpToVertex 3 = Do not use; superseded by swEndCondUpToSelection Diameter - Diameter of the hole or slot.\nDepth - Depth of the hole or slot.\nValue1 - Hole or slot parameter.\nValue2 - Hole or slot parameter.\nValue3 - Hole or slot parameter.\nValue4 - Hole or slot parameter.\nValue5 - Hole or slot parameter.\nValue6 - Hole or slot parameter.\nValue7 - Hole or slot parameter.\nValue8 - Hole or slot parameter.\nValue9 - Hole or slot parameter.\nValue10 - Hole or slot parameter.\nValue11 - Hole or slot parameter.\nValue12 - Hole or slot parameter.\nReturn Value : This HoleWizard method return feature data object.\nTo see methods and properties related to Feature object, please visit üëâ this page of SOLIDWORKS API Help.\nIn our code, I have used following values:\nParameter Name Value Used GenericHoleType swWzdCounterBore StandardIndex swStandardISO FastenerTypeIndex swStandardISOHexCapScrew SSize M6 EndType swEndCondBlind Diameter 5 * LengthConversionFactor Depth 6 * LengthConversionFactor Value1 10 * LengthConversionFactor Value2 5 * LengthConversionFactor Value3 0 Value4 1 * LengthConversionFactor Value5 2 * LengthConversionFactor Value6 0 Value7 0 Value8 0 Value9 0 Value10 0 Value11 0 Value12 0 HoleWizard method is part of FeatureManager object.\nThis FeatureManager is again part of swDoc variable i.e. ModelDoc2 object.\nTo see methods and properties related to FeatureManager object, please visit üëâ this page of SOLIDWORKS API Help.\nPlease see below image in which I have identity some value parameters.\n\u0026#39; Check if Holes from Hole Wizard creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Holes from Hole Wizard.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if we able to create Holes from üëâ Hole Wizard Feature or not.\nIf we failed to select then inform the user by a üëâ Message Window.\nAfter showing error message our program exit from here itself.\nNow we run the macro and after running macro we get Revolve as shown in below image.\nFinal work After creating Hole Cut feature, we have to do some cleaning work so that we can use this macro frequently.\nMake part Zoom to fit \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model.\nFor this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable.\nClear selection \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection.\nFor this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Hole Feature with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":142,"permalink":"/solidworks-macros/create-hole-from-hole-wizard/","summary":"\u003cp\u003e{% include article-notes/intermediate-initial-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eObjective of this article is to learn \u003cem\u003ehow to create \u003cstrong\u003eHoles using üëâ \u003ca href=\"https://help.solidworks.com/2019/english/api/sldworksapi/solidworks.interop.sldworks~solidworks.interop.sldworks.ifeaturemanager~holewizard.html\"\u003eHole Wizard\u003c/a\u003e\u003c/strong\u003e through SOLIDWORKS VBA Macros\u003c/em\u003e in SOLIDWORKS.\u003c/p\u003e","tags":[],"title":"SOLIDWORKS Macro - Create Holes from Hole Wizard"},{"content":"{% include article-notes/intermediate-initial-note.html %}\nObjective Objective of this article is to learn how to create üëâ Thread Feature through SOLIDWORKS VBA Macros in SOLIDWORKS.\nWe create Thread Feature in 3 steps in general.\nTraversing through Feature Tree. Programmatically select a üëâ Feature from Feature Tree named Cylinder. Get Cylinder surface of üëâ Feature. Create üëâ Thread Feature Definition. Create üëâ Thread Feature using üëâ Thread Feature Definition from method CreateFeature. This method is most updated method, so use this method if you want to create a new üëâ Thread Feature.\nSteps To Create Thread We use following steps to create üëâ Thread Feature while writing macro\nTraversing through Feature Tree. Programmatically select a üëâ Feature from Feature Tree named Cylinder. Get all Faces of Cylinder. Get Cylinder üëâ Surface of selected üëâ Feature. Select the top üëâ Edge of Cylinder üëâ Surface. Create üëâ Thread Feature Definition. Create üëâ Thread Feature using üëâ Thread Feature Definition from method CreateFeature. Results We Can Get After running our we successfully create Hole feature as a result.\nBelow image shows the result we get.\nTo get the correct result please follow the steps correctly.\nVideo of Code on YouTube Please see below üé¨ video on how to create Thread feature from SOLIDWORKS VBA Macros.\nPlease note that there are no explanation in the video.\nExplanation of each line and why we write code this way is given in this post.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nCode Sample Below is the code for creating Thread Feature feature in VBA is given.\nOption Explicit \u0026#39; Solidworks application variable Dim swApp As SldWorks.SldWorks \u0026#39; Solidworks document variable Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Solidworks Thread feature data variable Dim swThreadFeatData As SldWorks.ThreadFeatureData \u0026#39; Solidworks Thread Feature variable Dim swThreadFeature As SldWorks.Feature \u0026#39; Solidworks Feature variable Dim swFeature As SldWorks.Feature \u0026#39; Solidworks Face variable Dim swFace As SldWorks.Face2 \u0026#39; Solidworks Surface variable Dim swSurface As SldWorks.Surface \u0026#39; Solidworks Entity variable Dim swEnt As SldWorks.Entity \u0026#39; Variable for Solidworks Edges Dim swEdges As Variant \u0026#39; Solidworks Edge variable Dim swEdge As SldWorks.Edge \u0026#39; Array for Solidworks Faces Dim faceArray As Variant \u0026#39; Variable for Solidworks Face Dim eachFace As Variant \u0026#39; Boolean variable Dim boolStatus As Boolean \u0026#39; Main program for Thread Sub main() \u0026#39; Set Solidworks application variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks document variable to open document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Get First feature in Feature tree Set swFeature = swDoc.FirstFeature \u0026#39; Check if Solidworks document is selected or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to selected First feature in Feature Tree.\u0026#34;) Exit Sub End If \u0026#39; Traversing through the Feature Tree, \u0026#39; until Feature name is \u0026#34;Cylinder\u0026#34; While swFeature.Name \u0026lt;\u0026gt; \u0026#34;Cylinder\u0026#34; \u0026#39; Print current Feature name is Immediate window Debug.Print swFeature.Name \u0026#39; Get the next feature Set swFeature = swFeature.GetNextFeature Wend \u0026#39; Print current Feature name is Immediate window Debug.Print swFeature.Name \u0026#39; Get the faces of selected feature faceArray = swFeature.GetFaces \u0026#39; Loop through all Face array For Each eachFace In faceArray \u0026#39; Set Solidworks Face variable to current current Set swFace = eachFace \u0026#39; Get the Surface of from the Solidworks Face variable Set swSurface = swFace.GetSurface \u0026#39; If we have cylinder surface If swSurface.IsCylinder() Then \u0026#39; Get all edges of this face swEdges = swFace.GetEdges \u0026#39; Set Solidworks edge variable to 1st edge Set swEdge = swEdges(0) \u0026#39; Set Solidworks Entity variable to Solidworks Edge variable Set swEnt = swEdge \u0026#39; Select the current entity boolStatus = swEnt.Select(True) \u0026#39; If fail to select the edge then inform user If boolStatus = False Then MsgBox \u0026#34;Failed to select Edge of Cylinder.\u0026#34; Exit Sub End If End If Next \u0026#39; Create Thread feature data Set swThreadFeatData = swDoc.FeatureManager.CreateDefinition(swFeatureNameID_e.swFmSweepThread) \u0026#39; Create Thread Feature Set swThreadFeature = swDoc.FeatureManager.CreateFeature(swThreadFeatData) \u0026#39; Check if Thread Feature created or not If swThreadFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Thread Feature.\u0026#34;) Exit Sub End If \u0026#39; View zoom to fit swDoc.ViewZoomtofit2 \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this article.\nWe are not creating feature from code but we use existing feature to create üëâ Thread Feature as shown in below picture.\nAs shown in above image, there only 1 Extrude feature in our part.\nExtrude Feature : This is our Extrude part for üëâ Thread Feature. If you want to create Extrude feature programmatically then please refer to below article.\nüëâ SOLIDWORKS Macros - Create Extrude/Boss Also, we will apply checks in this article, so the code we write should be error free most of the time.\nSteps To Follow To create üëâ Thread Feature, there are following steps:\nCreating Global Variables Initializing required variables Get Cylinder Feature by Traversing Feature Tree Select top edge of Cylinder Feature Create Thread feature using Thread Feature Data Final work Now let us walk through each step as given above, and understand every line.\nI also give some links (see icon üëâ ) so that you can go through them if there are anything I explained in previous articles.\nCreating Global Variables Option Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit üëâ SOLIDWORKS Macros - Open new Part document post.\nWe create following variables.\nVariable for Solidworks application \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\nTo see methods and properties related to SldWorks.SldWorks object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks document \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nTo see methods and properties related to SldWorks.ModelDoc2 object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Thread feature data \u0026#39; Solidworks Thread feature data variable Dim swThreadFeatData As SldWorks.ThreadFeatureData\rIn this line, we create a variable which we named as swThreadFeatData and the type of this swThreadFeatData variable is SldWorks.ThreadFeatureData.\nTo see methods and properties related to SldWorks.ThreadFeatureData object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks feature \u0026#39; Solidworks Thread Feature variable Dim swThreadFeature As SldWorks.Feature\rIn this line, we Create a variable which we named as swThreadFeature and the type of this swThreadFeature variable is SldWorks.Feature.\nWe create variable swThreadFeature for SOLIDWORKS Feature.\nTo see methods and properties related to Feature object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Feature variable \u0026#39; Solidworks Feature variable Dim swFeature As SldWorks.Feature\rIn this line, we Create a variable which we named as swFeature and the type of this swFeature variable is SldWorks.Feature.\nWe create variable swFeature for SOLIDWORKS Feature.\nTo see methods and properties related to Feature object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Face variable \u0026#39; Solidworks Face variable Dim swFace As SldWorks.Face2\rIn this line, we Create a variable which we named as swFace and the type of this swFace variable is SldWorks.Face2.\nWe create variable swFace for SOLIDWORKS Face.\nTo see methods and properties related to Face2 object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Surface \u0026#39; Solidworks Surface variable Dim swSurface As SldWorks.Surface\rIn this line, we Create a variable which we named as swSurface and the type of this swSurface variable is SldWorks.Surface.\nWe create variable swSurface for SOLIDWORKS Surface.\nTo see methods and properties related to Surface object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Entity \u0026#39; Solidworks Entity variable Dim swEnt As SldWorks.Entity\rIn this line, we create a variable which we named as swEnt and the type of this swEnt variable is SldWorks.Entity.\nWe create variable swEnt for SOLIDWORKS Entity.\nTo see methods and properties related to Entity object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Edges \u0026#39; Variable for Solidworks Edges Dim swEdges As Variant\rIn this line, we create a variable named swEdges as Variant object type.\nWe create variable swEdges for to get all edges of a surface.\nVariable for Solidworks Edge \u0026#39; Solidworks Edge variable Dim swEdge As SldWorks.Edge\rIn this line, we create a variable which we named as swEdge and the type of this swEdge variable is SldWorks.Edge.\nWe create variable swEnt for SOLIDWORKS Edge.\nTo see methods and properties related to Edge object, please visit üëâ this page of SOLIDWORKS API Help.\nArray for Solidworks Faces \u0026#39; Array for Solidworks Faces Dim faceArray As Variant\rIn this line, we create a variable named faceArray as Variant object type.\nWe create variable faceArray for to get all face of Cylinder feature.\nVariable for Solidworks Face \u0026#39; Variable for Solidworks Face Dim eachFace As Variant\rIn this line, we create a variable named eachFace as Variant object type.\nWe create variable eachFace for to get each face inside faceArray array.\nBoolean variable \u0026#39; Boolean variable Dim boolStatus As Boolean\rIn this line, we create a variable named boolStatus as Boolean object type.\nWe create variable boolStatus to confirm method result.\nThese all are our global variables.\nThey are SOLIDWORKS API Objects.\nSo basically I group all the SOLIDWORKS API Objects in one place.\n\u0026#39; Main program for Thread Sub main() End Sub\rNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\nTo know more about Sub Procedure you can check üëâ VBA Sub and Function Procedures article of this website.\nInitializing Required Variables Inside this procedure we first initialize required variables as given below.\nSet SOLIDWORKS variable to SOLIDWORKS application \u0026#39; Set SOLIDWORKS variable to SOLIDWORKS application Set swApp = Application.SldWorks\rIn this line, we set the value of our SOLIDWORKS variable swApp; which we define earlier; to SOLIDWORKS application.\n\u0026#39; Check if SOLIDWORKS is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS application variable is successfully assigned to current SOLIDWORKS application.\nSet SOLIDWORKS document variable to opened part document \u0026#39; Set SOLIDWORKS document variable to opened part document Set swDoc = swApp.ActiveDoc\rIn above line of code, we set SOLIDWORKS document swDoc variable to currently open part document.\n\u0026#39; Check if SOLIDWORKS document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS document swDoc is opened.\nIf SOLIDWORKS document is not opened then code execute inside the code and inform the user by a üëâ Message Window.\nGet Cylinder Feature by Traversing Feature Tree Now we will get Cylinder feature by Traversing Feature Tree.\nPlease follow steps given below.\nGet First feature in Feature tree \u0026#39; Get First feature in Feature tree Set swFeature = swDoc.FirstFeature\rIn above line of code, we set SOLIDWORKS Feature swFeature variable to first feature in Feature Tree.\n\u0026#39; Check if Solidworks document is selected or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to selected First feature in Feature Tree.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if we get SOLIDWORKS Feature swFeature.\nIf we failed to get SOLIDWORKS Feature then code execute inside the code and inform the user by a üëâ Message Window.\n\u0026#39; Traversing through the Feature Tree, \u0026#39; until Feature name is \u0026#34;Cylinder\u0026#34; While swFeature.Name \u0026lt;\u0026gt; \u0026#34;Cylinder\u0026#34; Wend\rIn above line of code, we create another While loop.\nThis loop will continue until we select the our Cylinder üëâ Feature.\nFor more details about While loop, please see üëâ VBA Looping article from this website.\n\u0026#39; Print current Feature name is Immediate window Debug.Print swFeature.Name\rIn above line of code, we print üëâ Feature name into Immediate window.\n\u0026#39; Get the next feature Set swFeature = swFeature.GetNextFeature\rIn above line of code, we set swFeature variable to next üëâ Feature.\n\u0026#39; Print current Feature name is Immediate window Debug.Print swFeature.Name\rIn above line of code, we print üëâ Feature name into Immediate window.\nSince this line is outside of While loop, it means selected feature is Cylinder üëâ Feature.\nSelect top edge of Cylinder Feature Now we need to select top edge of previously selected Cylinder üëâ Feature.\nPlease follow steps given below.\nGet the faces of selected feature \u0026#39; Get the faces of selected feature faceArray = swFeature.GetFaces\rIn above line of code we get all faces of selected Cylinder üëâ Feature.\nLoop through all face array \u0026#39; Loop through all Face array For Each eachFace In faceArray Next\rIn above line of code we create a üëâ For Each loop.\nGet surface of current Face \u0026#39; Set Solidworks Face variable to current face Set swFace = eachFace\rIn above line of code, we Set üëâ SOLIDWORKS Face variable swFace to current face.\n\u0026#39; Get the Surface of from the Solidworks Face variable Set swSurface = swFace.GetSurface\rIn above line of code we get the üëâ Surface of from the üëâ SOLIDWORKS Face variable using GetSurface üëâ method.\nIf Statement for Cylindrical Surface \u0026#39; If we have cylinder surface If swSurface.IsCylinder() Then End If\rIn above line of code, we use an üëâ IF statement to check if üëâ SOLIDWORKS Surface swSurface is Cylindrical Surface or not.\nSelect first edge of Cylindrical Surface \u0026#39; Get all edges of this face swEdges = swFace.GetEdges\rIn above line of code we get all edges of current face.\n\u0026#39; Set Solidworks edge variable to 1st edge Set swEdge = swEdges(0)\rIn above line of code we set üëâ SOLIDWORKS edge variable swEdge to 1st edge.\n\u0026#39; Set Solidworks Entity variable to Solidworks Edge variable Set swEnt = swEdge\rIn above line of code we set üëâ SOLIDWORKS Entity variable to üëâ SOLIDWORKS edge variable.\n\u0026#39; Select the current entity boolStatus = swEnt.Select(True)\rIn above line of code we select the current entity.\n\u0026#39; If fail to select the edge then inform user If boolStatus = False Then MsgBox \u0026#34;Failed to select Edge of Cylinder.\u0026#34; Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if Boolean variable boolStatus is False.\nIf Boolean variable boolStatus is False. then code execute inside the code and inform the user by a üëâ Message Window.\nCreate Thread feature using Thread Feature Data We have completed our selection of üëâ SOLIDWORKS Entity.\nNow we create Thread Feature.\nFor this we use 2 steps as follows:\nCreate Thread Feature definition Create Thread Feature using the definition \u0026#39; Create Thread feature data Set swThreadFeatData = swDoc.FeatureManager.CreateDefinition(swFeatureNameID_e.swFmSweepThread)\rIn above line of code we set the value of variable swThreadFeatData by CreateDefinition method.\nCreateDefinition method is part of FeatureManager object.\nThis FeatureManager is again part of swDoc variable i.e. ModelDoc2 object.\nThis CreateDefinition method takes following parameters as explained:\nType - Feature name ID as defined in swFeatureNameID_e.\nswFmBoundingBox (bounding box) swFmCirPattern (circular pattern) swFmCurvePattern (curve-driven pattern) swFmDerivedLPattern (derived-driven pattern) swFmDimPattern (variable/dimension pattern) swFmFillPattern (fill pattern) swFmGroundPlane (ground plane) swFmLibraryFeature (library) swFmLocalChainPattern (chain component pattern) swFmLocalCirPattern (circular component pattern) swFmLocalCurvePattern (curve-driven component pattern) swFmLocalLPattern (linear component pattern) swFmLocalSketchPattern (sketch-driven component pattern) swFmLPattern (linear pattern) swFmNormalCut (sheet metal normal cut) swFmRefCurve (projection curve) swFmRefSurface (surface sweep) swFmSketchPattern (sketch-driven pattern) swFmSweep (boss sweep) swFmSweepCut (cut sweep) swFmSweepThread (Thread) swFmTabAndSlot (tab and slot) swFmTablePattern (table pattern) Return Value : This CreateDefinition method retun feature or pattern-specific feature data object.\nTo see methods and properties related to FeatureManager object, please visit üëâ this page of Solidworks API Help.\nIn our code, I have used following values:\nType - I use swFmSweepThread as Feature name ID. If you want to know more information about Sweep Feature data then please visit üëâ this page of Solidworks API Help.\nThis page will give you information about various properties and methods of IThreadFeatureData Interface.\n\u0026#39; Create Thread Feature Set swThreadFeature = swDoc.FeatureManager.CreateFeature(swThreadFeatData)\rIn above line of code we set the value of variable swThreadFeature by CreateFeature method.\nThis CreateFeature method takes following parameters as explained:\nFeatureData - Feature or pattern-specific feature data object. Return Value : This CreateFeature method return feature data object.\nCreateFeature method is part of FeatureManager object.\nThis FeatureManager is again part of swDoc variable i.e. ModelDoc2 object.\nTo see methods and properties related to FeatureManager object, please visit üëâ this page of SOLIDWORKS API Help.\nIn our code, I have used following values:\nFeatureData - I use swThreadFeatData as feature data object which we defined previously. \u0026#39; Check if Thread Feature created or not If swThreadFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Thread Feature.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if we able to create üëâ Thread Feature or not.\nIf we failed to select then inform the user by a üëâ Message Window.\nAfter showing error message our program exit from here itself.\nNow we run the macro and after running macro we get Revolve as shown in below image.\nFinal work After creating üëâ Thread Feature , we have to do some cleaning work so that we can use this macro frequently.\nMake part Zoom to fit \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model.\nFor this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable.\nClear selection \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection.\nFor this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Threads with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":143,"permalink":"/solidworks-macros/create-threads/","summary":"\u003cp\u003e{% include article-notes/intermediate-initial-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eObjective of this article is to learn \u003cem\u003ehow to create \u003cstrong\u003eüëâ \u003ca href=\"https://help.solidworks.com/2019/english/api/sldworksapi/SolidWorks.Interop.sldworks~SolidWorks.Interop.sldworks.IThreadFeatureData_members.html\"\u003eThread Feature\u003c/a\u003e\u003c/strong\u003e through SOLIDWORKS VBA Macros\u003c/em\u003e in SOLIDWORKS.\u003c/p\u003e","tags":[],"title":"SOLIDWORKS Macro - Create Threads"},{"content":"{% include article-notes/intermediate-initial-note.html %}\nObjective Objective of this article is to learn how to create Fillet feature through SOLIDWORKS VBA Macros in SOLIDWORKS.\nWe create Fillet Feature in following steps in general.\nAsk user to select an edge. Ask user to input the Radius of fillet feature. Create Fillet feature from method FeatureFillet3. This method is most updated method, so use this method if you want to create a new Fillet Feature.\nSteps To Create Fillet We use following steps to create Fillet Feature while writing macro.\nAsk user to select an edge. Update code for Unit Conversion. Ask user to input the Radius of fillet feature. Create parameters variables for FeatureFillet3 method. Create Fillet feature from method FeatureFillet3. Results We Can Get After running our macro we successfully create Fillet feature as a result.\nBelow image shows the result we get.\nTo get the correct result please follow the steps correctly.\nVideo of Code on YouTube Please see below üé¨ video on how to create Fillet feature from SOLIDWORKS VBA Macros.\nPlease note that there are no explanation in the video.\nExplanation of each line and why we write code this way is given in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nCode Sample Below is the code for creating Fillet Feature feature in VBA is given.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Fillet Feature Dim swFeature As SldWorks.Feature \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity \u0026#39; Program to create Fillet feature Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Check if SOLIDWORKS is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if SOLIDWORKS document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks Selection Manager variablt to opened document\u0026#39;s selection manager Set swSelMgr = swDoc.SelectionManager \u0026#39; Inform user to select an edge for Fillet feature. MsgBox \u0026#34;Please select an Edge for Fillet feature.\u0026#34; \u0026#39; Loop until Solidworks Entity variable is equal to selected edge While swObject Is Nothing \u0026#39; Local integer for loop Dim i As Integer \u0026#39; Looping until we select an edge For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) \u0026#39; If the selection type edge If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEDGES Then \u0026#39; Set the Solidworks Entity object to selected edge Set swObject = swSelMgr.GetSelectedObject6(i, -1) End If Next DoEvents Wend \u0026#39;-----------------------BELOW IS THE SOLUTION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;---------------------------------------------------------------- \u0026#39; Variable to store fillet radius Dim filletRadius As Double filletRadius = InputBox(\u0026#34;Please enter radius of Fillet.\u0026#34;) * LengthConversionFactor \u0026#39; Radius array for Fillet feature Dim radiiArray0 As Variant \u0026#39; Radius variable Dim radiis0 As Double \u0026#39; Distance array for Fillet feature Dim dist2Array0 As Variant \u0026#39; Distance variable Dim dists20 As Double \u0026#39; Conic Rhombus array for Fillet feature Dim conicRhosArray0 As Variant \u0026#39; Conic Rhombus variable Dim coniRhos0 As Double \u0026#39; Set back array for Fillet feature Dim setBackArray0 As Variant \u0026#39; Set back variable Dim setBacks0 As Double \u0026#39; Point array for Fillet feature Dim pointArray0 As Variant \u0026#39; Point variable Dim points0 As Double \u0026#39; Point Distance array for Fillet feature Dim pointDist2Array0 As Variant \u0026#39; Point distance variable Dim pointsDist20 As Double \u0026#39; Point Rhombus array for Fillet feature Dim pointRhoArray0 As Variant \u0026#39; Point Rhombus variable Dim pointsRhos0 As Double \u0026#39; Set 1st instance to respective variable radiiArray0 = radiis0 dist2Array0 = dists20 conicRhosArray0 = coniRhos0 setBackArray0 = setBacks0 pointArray0 = points0 pointDist2Array0 = pointsDist20 pointRhoArray0 = pointsRhos0 \u0026#39; Create Fillet feature Set swFeature = swDoc.FeatureManager.FeatureFillet3(195, filletRadius, filletRadius, 0, 0, 0, 0, (radiiArray0), (dist2Array0), (conicRhosArray0), (setBackArray0), (pointArray0), (pointDist2Array0), (pointRhoArray0)) \u0026#39; Check if Fillet Feature created or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Fillet Feature.\u0026#34;) Exit Sub End If \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this article.\nWe are not creating feature from code but we use existing üëâ Extrude feature to create Fillet feature as shown in below picture.\nAs shown in above image, there is only 1 Extrude feature in our part.\nExtrude Feature : This is our Extruded part for Fillet Feature. If you want to create Extrude feature programmatically then please refer to below article.\nüëâ SOLIDWORKS Macros - Create Extrude/Boss Also, we will apply checks in this article, so the code we write should be error free most of the time.\nSteps To Follow To create Fillet Feature, there are following steps:\nCreating Global Variables Initializing required variables Ask user to select an edge Get unit Conversion factors User input for Fillet radius Preparing parameters Create Fillet feature using parameters Now let us walk through each step as given above, and understand every line.\nI also give some links (see icon üëâ) so that you can go through them if there are anything I explained in previous articles.\nCreating Global Variables Option Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit üëâ SOLIDWORKS Macros - Open new Part document post.\nWe create following variables.\nVariable for Solidworks application \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\nTo see methods and properties related to SldWorks.SldWorks object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks document \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nTo see methods and properties related to SldWorks.ModelDoc2 object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Fillet Feature \u0026#39; Variable for Solidworks Fillet Feature Dim swFeature As SldWorks.Feature\rIn this line, we create a variable which we named as swFeature and the type of this swFeature variable is SldWorks.Feature.\nWe create variable swFeature for SOLIDWORKS Fillet Feature.\nTo see methods and properties related to Feature object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Selection Manager \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr\rIn this line, we create a variable which we named as swSelMgr and the type of this swSelMgr variable is SldWorks.SelectionMgr.\nTo see methods and properties related to SldWorks.SelectionMgr object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Entity \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity\rIn this line, we create a variable which we named as swObject and the type of this swObject variable is SldWorks.Entity.\nTo see methods and properties related to Entity object, please visit üëâ this page of SOLIDWORKS API Help.\nThese all are our global variables.\nThey are SOLIDWORKS API Objects.\nSo basically I group all the SOLIDWORKS API Objects in one place.\n\u0026#39; Program to create Fillet feature Sub main() End Sub\rNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\nTo know more about Sub Procedure you can check üëâ VBA Sub and Function Procedures article of this website.\nInitializing Required Variables Inside this procedure we first initialize required variables as given below.\nSet SOLIDWORKS variable to SOLIDWORKS application \u0026#39; Set SOLIDWORKS variable to SOLIDWORKS application Set swApp = Application.SldWorks\rIn this line, we set the value of our SOLIDWORKS variable swApp; which we define earlier; to SOLIDWORKS application.\n\u0026#39; Check if SOLIDWORKS is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS application variable is successfully assigned to current SOLIDWORKS application.\nSet SOLIDWORKS document variable to opened part document \u0026#39; Set SOLIDWORKS document variable to opened part document Set swDoc = swApp.ActiveDoc\rIn above line of code, we set SOLIDWORKS document swDoc variable to currently open part document.\n\u0026#39; Check if SOLIDWORKS document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS document swDoc is opened.\nIf SOLIDWORKS document is not opened then code execute inside the code and inform the user by a üëâ Message Window.\nSet SOLIDWORKS Selection Manager variable \u0026#39; Set SOLIDWORKS Selection Manager variable Set swSelMgr = swDoc.SelectionManager\rIn above line, we set SOLIDWORKS Selection ManagerswSelMgr variable to current document\u0026rsquo;s Selection Manager.\nAsk user to select an edge Now we will ask use to select an edge for Fillet.\n\u0026#39; Inform user to select an edge for Fillet feature. MsgBox \u0026#34;Please select an Edge for Fillet feature.\u0026#34;\rImage of above message is shown in below image.\nIn about line of code we show a Msgbox to use displaying message to select an Edge of extrude.\n\u0026#39; Loop until Solidworks Entity variable is equal to selected edge While swObject Is Nothing Wend\rIn above line of code, we create a While loop.\nThis loops until we select the our Edge for Fillet feature.\nFor more details about While loop, please see üëâ VBA Looping article from this website.\n\u0026#39; Local integer for loop Dim i As Integer\rIn above line of code, we create a local integer name i as a counter.\n\u0026#39; Loop until we select an edge For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Next\rIn above line of code, we create a For loop.\nThis code loops from i = 1 to number of objects we select.\n\u0026#39; If the selection type edge If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEDGES Then \u0026#39; Set the Solidworks Entity object to selected edge Set swObject = swSelMgr.GetSelectedObject6(i, -1) End If\rIn above line of code, we use üëâ IF statement with a condition.\nThe üëâ IF statement is True when selected object is type of SOLIDWORKS Edge.\nWhen üëâ IF statement is True we execute code given below.\n\u0026#39; Set the Solidworks Entity object to selected edge Set swObject = swSelMgr.GetSelectedObject6(i, -1)\rIn above line, we set the SOLIDWORKS Entity object to selected edge.\nAfter For loop, we have a call for DoEvents function.\nGet unit Conversion factors Now we need to get unit Conversion factors as shown in below code.\n\u0026#39;-----------------------Unit Conversion Factors---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;----------------------------------------------------------------\rI have already explained about this in previous üëâ Solidworks Macro - Fix Unit Issue article in this website.\nPlease visit üëâ Solidworks Macro - Fix Unit Issue article for more details.\nUser input for Fillet radius Now we ask user to input Fillet Radius as shown in below code.\n\u0026#39; Variable to store fillet radius Dim filletRadius As Double filletRadius = InputBox(\u0026#34;Please enter radius of Fillet.\u0026#34;) * LengthConversionFactor\rIn above code sample, we first create a variable.\nName of variable = filletRadius Type of variable = Double After that we show a input box to get the Fillet radius from user.\nImage of input box is shown below.\nAfter getting input value from InputBox, we first multiply it with LengthConversionFactor.\nBy doing this we set the input value to at fix with same unit system of part.\nAfter conversion we assign the final value to filletRadius variable.\nThis filletRadius variable is our 1st parameter value.\nPreparing parameters Now we need to prepare parameters for FeatureFillet3 method.\nPlease note that I found these parameter to use the way it shown here.\nIf you have another way to for FeatureFillet3 method please let me know.\n{: .notice\u0026ndash;warning}\n\u0026#39; Radius array for Fillet feature Dim radiiArray0 As Variant\rIn above code sample, we create a variable.\nName of variable = radiiArray0 Type of variable = Variant \u0026#39; Radius variable Dim radiis0 As Double\rIn above code sample, we create a variable.\nName of variable = radiis0 Type of variable = Double \u0026#39; Distance array for Fillet feature Dim dist2Array0 As Variant\rIn above code sample, we create a variable.\nName of variable = dist2Array0 Type of variable = Variant \u0026#39; Distance variable Dim dists20 As Double\rIn above code sample, we create a variable.\nName of variable = dists20 Type of variable = Double \u0026#39; Conic Rhombus array for Fillet feature Dim conicRhosArray0 As Variant\rIn above code sample, we create a variable.\nName of variable = conicRhosArray0 Type of variable = Variant \u0026#39; Conic Rhombus variable Dim coniRhos0 As Double\rIn above code sample, we create a variable.\nName of variable = coniRhos0 Type of variable = Double \u0026#39; Set back array for Fillet feature Dim setBackArray0 As Variant\rIn above code sample, we create a variable.\nName of variable = setBackArray0 Type of variable = Variant \u0026#39; Set back variable Dim setBacks0 As Double\rIn above code sample, we create a variable.\nName of variable = setBacks0 Type of variable = Double \u0026#39; Point array for Fillet feature Dim pointArray0 As Variant\rIn above code sample, we create a variable.\nName of variable = pointArray0 Type of variable = Variant \u0026#39; Point variable Dim points0 As Double\rIn above code sample, we create a variable.\nName of variable = points0 Type of variable = Double \u0026#39; Point Distance array for Fillet feature Dim pointDist2Array0 As Variant\rIn above code sample, we create a variable.\nName of variable = pointDist2Array0 Type of variable = Variant \u0026#39; Point distance variable Dim pointsDist20 As Double\rIn above code sample, we create a variable.\nName of variable = pointsDist20 Type of variable = Double \u0026#39; Point Rhombus array for Fillet feature Dim pointRhoArray0 As Variant\rIn above code sample, we create a variable.\nName of variable = pointRhoArray0 Type of variable = Variant \u0026#39; Point Rhombus variable Dim pointsRhos0 As Double\rIn above code sample, we create a variable.\nName of variable = pointsRhos0 Type of variable = Double \u0026#39; Set 1st instance to respective variable radiiArray0 = radiis0 dist2Array0 = dists20 conicRhosArray0 = coniRhos0 setBackArray0 = setBacks0 pointArray0 = points0 pointDist2Array0 = pointsDist20 pointRhoArray0 = pointsRhos0\rIn above line of code, we set 1st instance to respective variable.\nCreate Fillet feature using parameters Now we create Fillet feature using parameters we define previously.\n\u0026#39; Create Fillet feature Set swFeature = swDoc.FeatureManager.FeatureFillet3(195, filletRadius, filletRadius, 0, 0, 0, 0, (radiiArray0), (dist2Array0), (conicRhosArray0), (setBackArray0), (pointArray0), (pointDist2Array0), (pointRhoArray0))\rIn above line of code we set the value of variable swFeature by FeatureFillet3 method.\nThis FeatureFillet3 method takes following parameters as explained:\nOptions - Feature fillet options as defined in swFeatureFilletOptions_e and are as follows.\nMember Description swFeatureFilletAsymmetric 16384 or 0x4000 swFeatureFilletAttachEdges 64 or 0x40 swFeatureFilletConstantWidth 512 or 0x200 swFeatureFilletCornerType 32 or 0x20 swFeatureFilletCurvatureContinuous 256 or 0x100; applies to face fillets only swFeatureFilletKeepFeatures 128 or 0x80 swFeatureFilletNoTrimNoAttached 1024 or 0x400; set to trim and attach fillet; do not set otherwise swFeatureFilletPropagate 1 or 0x1 swFeatureFilletPropagateFeatToParts 8192 or 0x2000 swFeatureFilletReverseFace1Dir 2048 or 0x800 swFeatureFilletReverseFace2Dir 4096 or 0x1000 swFeatureFilletUniformRadius 2 or 0x2; set for a uniform radius; do not set for multiple radii swFeatureFilletUseHelpPoint 8 or 0x8 swFeatureFilletUseTangentHoldLine 16 or 0x10 swFeatureFilletVarRadiusType 4 or 0x4; set for a straight transition; do not set for a smooth transition R1 - Uniform radius of the symmetric fillet.\nR2 - Distance 2 radius of the asymmetric fillet.\nRho - Value that determines the conic shape of the fillet.\nConic rho value [0.05, 0.95], if ConicRhoType = swFeatureFilletProfileType_e.swFeatureFilletConicRho Conic radius value, if ConicRhoType = swFeatureFilletProfileType_e.swFeatureFilletConicRadius Ftyp - Type of fillet as defined in swFeatureFilletType_e as follows:\nMember Description swFeatureFilletType_Face 2 swFeatureFilletType_FullRound 3 swFeatureFilletType_Simple 0 swFeatureFilletType_VariableRadius 1 OverflowType - Control of fillet overflowing onto adjacent surfaces as defined in swFilletOverFlowType_e as follows:\nMember Description swFilletOverFlowType_Default 0 = Default; swFilletOverFlowType_KeepEdge 1 = Edges that are overflowed by the fillet are not modified; the fillet surface is trimmed by all the adjacent edges; as a result, an additional transition fillet surface might be needed to complete the fillet swFilletOverFlowType_KeepSurface 2 = Fillet surface is either merged with the adjacent surfaces smoothly or trimmed by the adjacent surfaces; as a result, it is unlikely that an additional transition fillet surface is created ConicRhoType - Fillet profile type as defined in swFeatureFilletProfileType_e as follows:\nMember Description swFeatureFilletCircular 0 = Circular for symmetric fillets; elliptical for asymmetric fillets swFeatureFilletConicRadius 2 swFeatureFilletConicRho 1 swFeatureFilletConicRhoZeroChamfer 3 = Chamfer cross section Radii - Array containing the radii for the symmetric fillet.\nDist2Arr - Array containing the Distance 2 radii for the asymmetric fillet.\nRhoArr - Array of Rho values for the specified ConicRhoType for the variable radius fillet.\nSetBackDistances - Array containing setback distances along the fillet edge.\nPointRadiusArray - Array containing radius control points along the length of the edge for symmetric fillets.\nPointDist2Array - Array containing Distance 2 radius control points along the length of the edge for asymmetric fillets.\nPointRhoArray - Array of Rho values for the specified ConicRhoType at various control points along the length of the edge.\nReturn Value : This FeatureFillet3 method return feature data object.\nTo see methods and properties related to Feature object, please visit üëâ this page of SOLIDWORKS API Help.\nIn our code, I have used following values:\nParameter Name Value Used Options 195 (now this what I get from recording and this works for me.) R1 filletRadius R2 filletRadius Rho 0 Ftyp 0 OverflowType 0 ConicRhoType 0 Radii (radiiArray0) Dist2Arr (dist2Array0) RhoArr (conicRhosArray0) SetBackDistances (setBackArray0) PointRadiusArray (pointArray0) PointDist2Array (pointDist2Array0) PointRhoArray (pointRhoArray0) FeatureFillet3 method is part of FeatureManager object.\nThis FeatureManager is again part of swDoc variable i.e. ModelDoc2 object.\nTo see methods and properties related to FeatureManager object, please visit üëâ this page of SOLIDWORKS API Help.\n\u0026#39; Check if Fillet Feature created or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Fillet Feature.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if we able to create **Fillet Feature ** or not.\nIf we failed to select then inform the user by a üëâ Message Window.\nAfter showing error message our program exit from here itself.\nNow we run the macro and after running macro we get Fillet as shown in below image.\n\u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection.\nFor this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Fillet Feature with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":144,"permalink":"/solidworks-macros/create-fillet/","summary":"\u003cp\u003e{% include article-notes/intermediate-initial-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eObjective of this article is to learn \u003cem\u003ehow to create \u003cstrong\u003eFillet\u003c/strong\u003e feature through SOLIDWORKS VBA Macros\u003c/em\u003e in SOLIDWORKS.\u003c/p\u003e","tags":[],"title":"SOLIDWORKS Macro - Create Fillet"},{"content":"{% include article-notes/intermediate-initial-note.html %}\nObjective Objective of this article is to learn how to create Chamfer feature through SOLIDWORKS VBA Macros in SOLIDWORKS.\nWe create Chamfer Feature in following steps in general.\nAsk user to select an edge. Ask user to input the Chamfer Width of Chamfer feature. Ask user to input the Chamfer Angle of Chamfer feature. Create Chamfer feature from method FeatureChamfer. This method is not updated method, so use this method if you want to create a new Chamfer Feature quickly.\nResults We Can Get After running our macro we successfully create Chamfer feature as a result.\nBelow image shows the result we get.\nTo get the correct result please follow the steps correctly.\nVideo of Code on YouTube Please see below üé¨ video on how to create Chamfer feature from SOLIDWORKS VBA Macros.\nPlease note that there are no explanation in the video.\nExplanation of each line and why we write code this way is given in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nCode Sample Below is the code for creating Fillet Feature feature in VBA is given.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Fillet Feature Dim swFeature As SldWorks.Feature \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr \u0026#39; Program to create Chamfer feature Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Check if SOLIDWORKS is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if SOLIDWORKS document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks Selection Manager variablt to opened document\u0026#39;s selection manager Set swSelMgr = swDoc.SelectionManager \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity \u0026#39; Inform user to select an edge for Chamfer feature. MsgBox \u0026#34;Please select an Edge for Chamfer feature.\u0026#34; \u0026#39; Loop until Solidworks Entity variable is equal to selected edge While swObject Is Nothing \u0026#39; Local integer for loop Dim i As Integer \u0026#39; Looping until we select an edge For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) \u0026#39; If the selection type edge If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEDGES Then \u0026#39; Set the Solidworks Entity object to selected edge Set swObject = swSelMgr.GetSelectedObject6(i, -1) End If Next DoEvents Wend \u0026#39;-----------------------BELOW IS THE SOLUTION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;---------------------------------------------------------------- \u0026#39; Variable to store Chamfer Width Dim chamferWidth As Double chamferWidth = InputBox(\u0026#34;Please enter Chamfer Width:\u0026#34;) * LengthConversionFactor \u0026#39; Variable to store Chamfer Angle Dim chamferAngle As Double chamferAngle = InputBox(\u0026#34;Please enter Chamfer Angle:\u0026#34;) * AngleConversionFactor \u0026#39; Create Chamfer Feature swDoc.FeatureChamfer chamferWidth, chamferAngle, False End Sub\rPrerequisite There are some prerequisite for this article.\nWe are not creating feature from code but we use existing üëâ Extrude feature to create Chamfer feature as shown in below picture.\nAs shown in above image, there is only 1 Extrude feature in our part.\nExtrude Feature : This is our Extruded part for Chamfer Feature. If you want to create Extrude feature programmatically then please refer to below article.\nüëâ SOLIDWORKS Macros - Create Extrude/Boss Also, we will apply checks in this article, so the code we write should be error free most of the time.\nSteps To Follow To create Chamfer Feature there are following steps:\nCreating Global Variables Initializing required variables Ask user to select an edge Get unit Conversion factors User input for Chamfer radius Create Chamfer feature Now let us walk through each step as given above, and understand every line.\nI also give some links (see icon üëâ) so that you can go through them if there are anything I explained in previous articles.\nCreating Global Variables Option Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit üëâ SOLIDWORKS Macros - Open new Part document post.\nWe create following variables.\nVariable for Solidworks application \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\nTo see methods and properties related to SldWorks.SldWorks object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks document \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nTo see methods and properties related to SldWorks.ModelDoc2 object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Chamfer Feature \u0026#39; Variable for Solidworks Chamfer Feature Dim swFeature As SldWorks.Feature\rIn this line, we create a variable which we named as swFeature and the type of this swFeature variable is SldWorks.Feature.\nWe create variable swFeature for SOLIDWORKS Chamfer Feature.\nTo see methods and properties related to Feature object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Selection Manager \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr\rIn this line, we create a variable which we named as swSelMgr and the type of this swSelMgr variable is SldWorks.SelectionMgr.\nTo see methods and properties related to SldWorks.SelectionMgr object, please visit üëâ this page of SOLIDWORKS API Help.\nThese all are our global variables.\nThey are SOLIDWORKS API Objects.\nSo basically I group all the SOLIDWORKS API Objects in one place.\n\u0026#39; Program to create Chamfer feature Sub main() End Sub\rNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\nTo know more about Sub Procedure you can check üëâ VBA Sub and Function Procedures article of this website.\nInitializing Required Variables Inside this procedure we first initialize required variables as given below.\nSet SOLIDWORKS variable to SOLIDWORKS application \u0026#39; Set SOLIDWORKS variable to SOLIDWORKS application Set swApp = Application.SldWorks\rIn this line, we set the value of our SOLIDWORKS variable swApp; which we define earlier; to SOLIDWORKS application.\n\u0026#39; Check if SOLIDWORKS is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS application variable is successfully assigned to current SOLIDWORKS application.\nSet SOLIDWORKS document variable to opened part document \u0026#39; Set SOLIDWORKS document variable to opened part document Set swDoc = swApp.ActiveDoc\rIn above line of code, we set SOLIDWORKS document swDoc variable to currently open part document.\n\u0026#39; Check if SOLIDWORKS document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS document swDoc is opened.\nIf SOLIDWORKS document is not opened then code execute inside the code and inform the user by a üëâ Message Window.\nSet SOLIDWORKS Selection Manager variable \u0026#39; Set SOLIDWORKS Selection Manager variable Set swSelMgr = swDoc.SelectionManager\rIn above line, we set SOLIDWORKS Selection ManagerswSelMgr variable to current document\u0026rsquo;s Selection Manager.\n\u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity\rIn this line, we create a variable which we named as swObject and the type of this swObject variable is SldWorks.Entity.\nTo see methods and properties related to Entity object, please visit üëâ this page of SOLIDWORKS API Help.\nAsk user to select an edge Now we will ask use to select an edge for Chamfer feature.\n\u0026#39; Inform user to select an edge for Chamfer feature. MsgBox \u0026#34;Please select an Edge for Chamfer feature.\u0026#34;\rImage of above message is shown in below image.\nIn about line of code we show a Msgbox to use displaying message to select an Edge of extrude.\n\u0026#39; Loop until Solidworks Entity variable is equal to selected edge While swObject Is Nothing Wend\rIn above line of code, we create a While loop.\nThis loops until we select the our Edge for Chamfer feature.\nFor more details about While loop, please see üëâ VBA Looping article from this website.\n\u0026#39; Local integer for loop Dim i As Integer\rIn above line of code, we create a local integer name i as a counter.\n\u0026#39; Loop until we select an edge For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Next\rIn above line of code, we create a For loop.\nThis code loops from i = 1 to number of objects we select.\n\u0026#39; If the selection type edge If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEDGES Then End If\rIn above line of code, we use üëâ IF statement with a condition.\nThe üëâ IF statement is True when selected object is type of SOLIDWORKS Edge.\nWhen üëâ IF statement is True we execute code given below.\n\u0026#39; Set the Solidworks Entity object to selected edge Set swObject = swSelMgr.GetSelectedObject6(i, -1)\rIn above line, we set the SOLIDWORKS Entity object to selected edge.\nAfter For loop, we have a call for DoEvents function.\nGet unit Conversion factors Now we need to get unit Conversion factors as shown in below code.\n\u0026#39;-----------------------Unit Conversion Factors---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;----------------------------------------------------------------\rI have already explained about this in previous üëâ Solidworks Macro - Fix Unit Issue article in this website.\nPlease visit üëâ Solidworks Macro - Fix Unit Issue article for more details.\nUser inputs for Chamfer feature Now we ask user to input following values:\nChamfer Width \u0026#39; Variable to store Chamfer Width Dim chamferWidth As Double chamferWidth = InputBox(\u0026#34;Please enter Chamfer Width:\u0026#34;) * LengthConversionFactor\rIn above code sample, we first create a variable.\nName of variable = chamferWidth Type of variable = Double After that we show a input box to get the Fillet radius from user.\nImage of input box is shown below.\nAfter getting input value from InputBox, we first multiply it with LengthConversionFactor.\nBy doing this we set the input value to at fix with same unit system of part.\nAfter conversion we assign the final value to chamferWidth variable.\nChamfer Angle \u0026#39; Variable to store Chamfer Angle Dim chamferAngle As Double chamferAngle = InputBox(\u0026#34;Please enter Chamfer Angle:\u0026#34;) * LengthConversionFactor\rIn above code sample, we first create a variable.\nName of variable = chamferAngle Type of variable = Double After that we show a input box to get the Fillet radius from user.\nImage of input box is shown below.\nAfter getting input value from InputBox, we first multiply it with LengthConversionFactor.\nBy doing this we set the input value to at fix with same unit system of part.\nAfter conversion we assign the final value to chamferAngle variable.\nCreate Chamfer feature Now we create Chamfer feature using above inputs.\n\u0026#39; Create Chamfer Feature swDoc.FeatureChamfer chamferWidth, chamferAngle, False\rIn above line of code we create Chamfer feature.\nThis FeatureChamfer method takes following parameters as explained:\nWidth - Width of the chamfer. Angle - Angle of the chamfer. Flip - Angle measures as follows: 0 if angle is to be measured from the right face 1 if angle is to be measured from the left face Return Value : There are no return value from this method.\nNow we run the macro and after running macro we get Fillet as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Chamfer Feature with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":145,"permalink":"/solidworks-macros/create-chamfer/","summary":"\u003cp\u003e{% include article-notes/intermediate-initial-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eObjective of this article is to learn \u003cem\u003ehow to create \u003cstrong\u003eChamfer\u003c/strong\u003e feature through SOLIDWORKS VBA Macros\u003c/em\u003e in SOLIDWORKS.\u003c/p\u003e","tags":[],"title":"SOLIDWORKS Macro - Create Chamfer"},{"content":"{% include article-notes/intermediate-initial-note.html %}\nObjective Objective of this article is to learn how to create Mirror feature through SOLIDWORKS VBA Macros in SOLIDWORKS.\nWe create Mirror Feature in following steps in general.\nAsk user to select a Feature to Mirror. Ask user to select a Plane for Mirror. Create Mirror feature from method InsertMirrorFeature2. This method is most updated method, so use this method if you want to create a new Mirror Feature quickly.\nResults We Can Get After running our macro we successfully create Mirror feature as a result.\nBelow image shows the result we get.\nTo get the correct result please follow the steps correctly.\nVideo of Code on YouTube Please see below üé¨ video on how to create Mirror feature from SOLIDWORKS VBA Macros.\nPlease note that there are no explanation in the video.\nExplanation of each line and why we write code this way is given in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nCode Sample Below is the code for creating Mirror Feature feature in VBA is given.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity \u0026#39; Variable for Solidworks Mirror feature Dim swFeature As SldWorks.Feature \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData \u0026#39; Mirror program Sub main() \u0026#39; Setting Solidworks variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Setting Solidworks document variable to opened part document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks Selection Manager variable Set swSelMgr = swDoc.SelectionManager \u0026#39; Array of Solidworks Entities Dim swObjects(1 To 2) As SldWorks.Entity \u0026#39; Local variable for selection Dim selectItems As Integer selectItems = 1 \u0026#39; Loop till we select all entities While selectItems \u0026lt;= 2 \u0026#39; Message to show user Dim messageToUser As String \u0026#39; Update Messages Select Case selectItems Case 1 messageToUser = \u0026#34;Please select a Feature for Mirror feature.\u0026#34; Case 2 messageToUser = \u0026#34;Please select a Plane for Mirror feature.\u0026#34; Case Else Exit Sub End Select \u0026#39; Show message to user MsgBox messageToUser \u0026#39; Loop until we complete our selection While swObjects(selectItems) Is Nothing \u0026#39; Local integer for loop Dim i As Integer \u0026#39; Loop until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Select Case selectItems Case 1 \u0026#39; If the feature is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelBODYFEATURES Then \u0026#39; Set the Solidworks Entity object to feature for mirror Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) \u0026#39; If the face is selected ElseIf swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelFACES Then \u0026#39; Inform user to select feature from Feature Tree MsgBox \u0026#34;Please select Feature from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If Case 2 \u0026#39; If the Plane is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelDATUMPLANES Then \u0026#39; Set the Solidworks Entity object to selected plane Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) Else \u0026#39; Inform user to select plane MsgBox \u0026#34;Please select a Plane.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If End Select Next DoEvents Wend \u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Increase the selection count selectItems = selectItems + 1 Wend \u0026#39; Local variable for counter Dim j As Integer j = 1 \u0026#39; Loop till counter is 2, since we have 2 selection While j \u0026lt; 3 \u0026#39; Set the current instance to Solidworks Entity variable Set swObject = swObjects(j) \u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData Select Case j Case 1 \u0026#39; For feature to mirror, set mark to 1 swSelData.Mark = 1 \u0026#39; Select the feature swObject.Select4 True, swSelData Case 2 \u0026#39; For plane, set mark to 2 swSelData.Mark = 2 \u0026#39; Select the plane swObject.Select4 True, swSelData End Select j = j + 1 Wend \u0026#39; Create Mirror feature Set swFeature = swDoc.FeatureManager.InsertMirrorFeature2(False, False, False, False, swFeatureScope_e.swFeatureScope_AllBodies) \u0026#39; Check if Mirror Feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Mirror Feature.\u0026#34;) Exit Sub End If \u0026#39; Erase array data Erase swObjects \u0026#39; View zoom to fit swDoc.ViewZoomtofit2 \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this article.\nWe are not creating feature from code but we use existing üëâ Extrude feature to create Mirror feature as shown in below picture.\nAs shown in above image, there are only 2 Extrude feature in our part.\nBase Extrude Feature : This is our Base Extruded feature. Mirror Extrude Feature : This is our Extruded feature for mirror. If you want to create Extrude feature programmatically then please refer to below article.\nüëâ SOLIDWORKS Macros - Create Extrude/Boss We will apply checks in this article, so the code we write should be error free most of the time.\nSteps To Follow To create Mirror Feature there are following steps:\nCreating Global Variables Initializing required variables Ask user to select feature and plane Mark selected entities Create Mirror feature Final work Now let us walk through each step as given above, and understand every line.\nI also give some links (see icon üëâ) so that you can go through them if there are anything I explained in previous articles.\nCreating Global Variables Option Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit üëâ SOLIDWORKS Macros - Open new Part document post.\nWe create following variables.\nVariable for Solidworks application \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\nTo see methods and properties related to SldWorks.SldWorks object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks document \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nTo see methods and properties related to SldWorks.ModelDoc2 object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Selection Manager \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr\rIn this line, we create a variable which we named as swSelMgr and the type of this swSelMgr variable is SldWorks.SelectionMgr.\nTo see methods and properties related to SldWorks.SelectionMgr object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Entity \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity\rIn this line, we Create a variable which we named as swObject and the type of this swObject variable is SldWorks.Entity.\nWe create variable swObject for SOLIDWORKS Entities (Profile and Path) we ask use to select.\nTo see methods and properties related to SldWorks.Entity object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Mirror feature \u0026#39; Variable for Solidworks Mirror feature Dim swFeature As SldWorks.Feature\rIn this line, we Create a variable which we named as swFeature and the type of this swFeature variable is SldWorks.Feature.\nWe create variable swFeature for SOLIDWORKS Mirror Feature.\nTo see methods and properties related to Feature object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Select Data \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData\rIn this line, we create a variable named swSelData as SldWorks.SelectData object type.\nWe create variable swSelData for SOLIDWORKS Select Data, which we use for Marking selected object.\nTo see methods and properties related to SldWorks.SelectData object, please visit üëâ this page of SOLIDWORKS API Help.\nThese all are our global variables.\nThey are SOLIDWORKS API Objects.\nSo basically I group all the SOLIDWORKS API Objects in one place.\n\u0026#39; Mirror program Sub main() End Sub\rNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\nTo know more about Sub Procedure you can check üëâ VBA Sub and Function Procedures article of this website.\nInitializing Required Variables Inside this procedure we first initialize required variables as given below.\nSet SOLIDWORKS variable to SOLIDWORKS application \u0026#39; Set SOLIDWORKS variable to SOLIDWORKS application Set swApp = Application.SldWorks\rIn this line, we set the value of our SOLIDWORKS variable swApp; which we define earlier; to SOLIDWORKS application.\n\u0026#39; Check if SOLIDWORKS is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS application variable is successfully assigned to current SOLIDWORKS application.\nSet SOLIDWORKS document variable to opened part document \u0026#39; Set SOLIDWORKS document variable to opened part document Set swDoc = swApp.ActiveDoc\rIn above line of code, we set SOLIDWORKS document swDoc variable to currently open part document.\n\u0026#39; Check if SOLIDWORKS document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS document swDoc is opened.\nIf SOLIDWORKS document is not opened then code execute inside the code and inform the user by a üëâ Message Window.\nSet SOLIDWORKS Selection Manager variable \u0026#39; Set SOLIDWORKS Selection Manager variable Set swSelMgr = swDoc.SelectionManager\rIn above line, we set SOLIDWORKS Selection ManagerswSelMgr variable to current document\u0026rsquo;s Selection Manager.\nArray of SOLIDWORKS Entities \u0026#39; Array of Solidworks Entities Dim swObjects(1 To 2) As SldWorks.Entity\rIn this line, we create an Array of SOLIDWORKS Entities which we named as swObjects and the type of this SldWorks.Entity variable is SldWorks.Entity.\nThis array consist two SldWorks.Entity variables.\nWe define the number of variable this array holds inside (1 To 2).\nFor more information about the Arrays in VBA please üëâ Array on this website.\nLocal variable for User selection \u0026#39; Local variable for selection Dim selectItems As Integer selectItems = 1\rIn above line of code, we define a Local variable name selectItemsas Integer type.\nIn next line we assign a value of 1.\nAsk user to select feature and plane Now we will ask user to select feature and plane for Mirror feature.\nPlease follow steps given below.\n\u0026#39; Loop till we select all entities While selectItems \u0026lt;= 2 Wend\rIn above line of code we start a While loop.\nFor more details about While loop, please see üëâ VBA Looping article from this website.\nWe want to loop until selectItems variable\u0026rsquo;s value is equal to 2.\n\u0026#39; Message to show user Dim messageToUser As String\rIn above line of code we create a variable named messageToUser of String type.\nThis variable holds the message we want to show before selection.\n\u0026#39; Update Messages Select Case selectItems Case 1 messageToUser = \u0026#34;Please select a Feature for Mirror feature.\u0026#34; Case 2 messageToUser = \u0026#34;Please select a Plane for Mirror feature.\u0026#34; Case Else Exit Sub End Select\rIn above line of code, we use a Select statement to update message.\nWe use the case on selectItems.\nWhen selectItems = 1 then value of messageToUser update to \u0026quot;Please select a Feature for Mirror feature.\u0026quot;\nSimilarly, when selectItems = 2 then value of messageToUser update to \u0026quot;Please select a Plane for Mirror feature.\u0026quot;\n\u0026#39; Show message to user MsgBox messageToUser\rIn above line of code, we show the message to user.\nBelow image shows the message for Feature selection to the user.\nBelow image shows the message for Plane selection to the user.\n\u0026#39; Loop until we complete our selection While swObjects(selectItems) Is Nothing Wend\rIn above line of code, we create another While loop.\nThis loops until we select the our Profile and Path.\nFor more details about While loop, please see üëâ VBA Looping article from this website.\n\u0026#39; Local integer for loop Dim i As Integer\rIn above line of code, we create a local integer name i as a counter.\n\u0026#39; Loop until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Next\rIn above line of code, we create a For loop.\nThis code loops from i = 1 to number of objects we select.\n\u0026#39; Update Messages Select Case selectItems End Select\rIn above line of code, we use a Select statement for selection entities.\nWe use the case on selectItems.\nCase 1 \u0026#39; If the profile sketch is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelBODYFEATURES Then \u0026#39; Set the Solidworks Entity object to feature for mirror Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) \u0026#39; If the face is selected ElseIf swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelFACES Then \u0026#39; Inform user to select feature from Feature Tree MsgBox \u0026#34;Please select Feature from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If\rAbove code sample we use for Case 1.\nIn above line of code, we use üëâ IF/Else statement with conditions.\nThe üëâ IF statement is True when selected object is type of SOLIDWORKS Body Feature.\nSimilarly, üëâ Else statement is True when select object is type of SOLIDWORKS Face.\nWhen we select the sketch from Model view, then selected object is SOLIDWORKS Face. When we select the sketch from Feature Tree, then select object is SOLIDWORKS Body Feature. {: .notice}\nWhen üëâ IF statement is True we execute code given below.\n\u0026#39; Set the Solidworks Entity object to feature for mirror Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1)\rIn above line, we set the indexed object inside array.\nArray of SOLIDWORKS Entities = swObjects Indexed Entity Object = swObjects[selectItems] We set the value of this Indexed Entity Object by GetSelectedObject6() method of SOLIDWORKS Selection Manager.\nWhen we set the Indexed Entity Object value as feature to mirror, we exit the 2nd While loop.\nSimilarly, when üëâ Else statement is True we execute code given below.\n\u0026#39; Inform user to select feature from Feature Tree MsgBox \u0026#34;Please select feature from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True\rWe show message to user to select Feature from Feature Tree. After that we clear our selection. We do this because if selected object type is SOLIDWORKS Face then we can not assign this object as SOLIDWORKS Entity inside array.\nCase 2 \u0026#39; If the Plane is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelDATUMPLANES Then \u0026#39; Set the Solidworks Entity object to selected plane Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) Else \u0026#39; Inform user to select plane MsgBox \u0026#34;Please select a Plane.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If\rAbove code sample we use for Case 2.\nIn above line of code, we use üëâ IF/Else statement with conditions.\nThe üëâ IF statement is True when selected object is type of SOLIDWORKS Datum Plane.\nIf we the selected object is not type of SOLIDWORKS Datum Plane then üëâ Else statement code runs.\nWhen üëâ IF statement is True we execute code given below.\n\u0026#39; Set the Solidworks Entity object to selected plane Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1)\rIn above line, we set the indexed object inside array.\nArray of SOLIDWORKS Entities = swObjects Indexed Entity Object = swObjects[selectItems] We set the value of this Indexed Entity Object by GetSelectedObject6() method of SOLIDWORKS Selection Manager.\nWhen we set the Indexed Entity Object value as feature to mirror, we exit the 2nd While loop.\nSimilarly, when üëâ Else statement is True we execute code given below.\n\u0026#39; Inform user to select plane MsgBox \u0026#34;Please select a Plane.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True\rWe show message to user to select Plane from Feature Tree. After that we clear our selection. After For loop, we have a call for DoEvents function.\nThis function repeats the While loop until we select the Profile or Path.\n\u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Increase the selection count selectItems = selectItems + 1\rIn above line, when we finished with the Profile or Path selection, we clear previous selection and increment the selected count by 1.\nAfter increment the selected count we continue our while loop.\nMark selected Entities Till now we have completed our selection.\nNow we need to do Select and Mark entities correctly from our Array.\n\u0026#39; Local variable for counter Dim j As Integer j = 1\rIn above line of code we create integer variable for counter.\n\u0026#39; Loop till counter is 2, since we have 2 selection While j \u0026lt; 3 Wend\rIn above line of code we create a while loop with condition that counter value of j should be less than 3.\n\u0026#39; Set the current instance to Solidworks Entity variable Set swObject = swObjects(j)\rIn above line of code, we set the SOLIDWORKS Entity variable to current object from array.\n\u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData\rIn above line of code, we create SOLIDWORKS Select Data for current SOLIDWORKS Entity object.\n\u0026#39; Update Messages Select Case j End Select\rIn above line of code, we use a Select statement for selection entities.\nWe use the case on j.\nCase 1 \u0026#39; For feature to mirror, set mark to 1 swSelData.Mark = 1 \u0026#39; Select the feature swObject.Select4 True, swSelData\rAbove code sample we use for Case 1.\nIn above lines, we update the Mark to 1 for our SOLIDWORKS Select Data variable.\nFor Mirror feature, Mark values can be follows:\nAny\u0026hellip; Must be preselected and marked with a value of\u0026hellip; Features to be mirrored 1 Faces to be mirrored 128 Bodies to be mirrored 256 Plane or planar face 2 For more details about Mark please visit üëâ [Mirror Feature](InsertMirrorFeature2 Method (IFeatureManager) - 2019 - SOLIDWORKS API Help) in SOLIDWORS API Help.\n\u0026#39; Select the feature swObject.Select4 True, swSelData\rIn above line of code, we select the Feature object.\nWe select it by using Select4 method of SOLIDWORKS Entity object.\nThis method takes 2 arguments.\nAppend - True appends the entity to the selection list, False replaces the selection list with this entity. Data - Pointer to the ISelectData object. We use following values as parameter.\nAppend - True Data - swSelData Case 2 \u0026#39; For plane, set mark to 2 swSelData.Mark = 2 \u0026#39; Select the plane swObject.Select4 True, swSelData\rAbove code sample we use for Case 2.\nIn above lines, we update the Mark to 2 for our SOLIDWORKS Select Data variable.\nFor Mirror feature, Mark values can be follows:\nAny\u0026hellip; Must be preselected and marked with a value of\u0026hellip; Features to be mirrored 1 Faces to be mirrored 128 Bodies to be mirrored 256 Plane or planar face 2 For more details about Mark please visit üëâ [Mirror Feature](InsertMirrorFeature2 Method (IFeatureManager) - 2019 - SOLIDWORKS API Help) in SOLIDWORS API Help.\n\u0026#39; Select the feature swObject.Select4 True, swSelData\rIn above line of code, we select the Feature object.\nWe select it by using Select4 method of SOLIDWORKS Entity object.\nThis method takes 2 arguments.\nAppend - True appends the entity to the selection list, False replaces the selection list with this entity. Data - Pointer to the ISelectData object. We use following values as parameter.\nAppend - True Data - swSelData j = j + 1\rAfter Select statement, we increment the counter variable j by 1.\nCreate Mirror Feature We have completed our selection and Marking of SOLIDWORKS Entities.\nNow we create Mirror Feature.\n\u0026#39; Create Mirror feature Set swFeature = swDoc.FeatureManager.InsertMirrorFeature2(False, False, False, False, swFeatureScope_e.swFeatureScope_AllBodies)\rIn above line of code we set the value of variable swFeature by InsertCutBlend method.\nThis CreateFeature method takes following parameters as explained:\nBMirrorBody - True to mirror solid bodies; False to mirror a feature or face.\nBGeometryPattern - True to mirror only the feature geometry, False to solve the entire feature; applies to mirroring features only.\nBMerge - True to merge any mirrored solid bodies, False to not; applies to mirroring solid bodies only.\nBKnit - True to knit surfaces, False to not; applies to mirroring surfaces only.\nScopeOptions - Feature scope as defined by swFeatureScope_e as follows.\nMember Description swFeatureScope_AllBodies 0 = All of the bodies in the multibody part are affected by the Mirror feature. swFeatureScope_SelectedBodiesWithAutoSelect 1 = Only the specified bodies in the multibody part are affected by the Mirror feature when AutoSelect is true. swFeatureScope_SelectedBodiesWithOutAutoSelect 2 = Only the specified bodies in the multibody part are affected by the Mirror feature when AuotSelect is false. Return Value : This InsertMirrorFeature2 method return feature data object.\nTo see methods and properties related to Feature object, please visit üëâ this page of SOLIDWORKS API Help.\nIn our code, I have used following values:\nParameter Name Value Used BMirrorBody False BGeometryPattern False BMerge False BKnit False ScopeOptions swFeatureScope_e.swFeatureScope_AllBodies InsertMirrorFeature2 method is part of FeatureManager object.\nThis FeatureManager is again part of swDoc variable i.e. ModelDoc2 object.\nTo see methods and properties related to FeatureManager object, please visit üëâ this page of SOLIDWORKS API Help.\n\u0026#39; Check if Mirror Feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Mirror Feature.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if we able to create Mirror Feature or not.\nIf we failed to select then inform the user by a üëâ Message Window.\nAfter showing error message our program exit from here itself.\nNow we run the macro and after running macro we get Revolve as shown in below image.\nFinal work After creating Mirror feature, we have to do some cleaning work so that we can use this macro frequently.\nEmpty SOLIDWORKS Entity Array \u0026#39; Erase array data Erase swObjects\rIn above line, we erase data from SOLIDWORKS Entity array.\nFor this we use Erase function in-build in VBA.\nMake part Zoom to fit \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model.\nFor this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable.\nClear selection \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection.\nFor this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Mirror feature with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":146,"permalink":"/solidworks-macros/create-mirror/","summary":"\u003cp\u003e{% include article-notes/intermediate-initial-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eObjective of this article is to learn \u003cem\u003ehow to create \u003cstrong\u003eMirror\u003c/strong\u003e feature through SOLIDWORKS VBA Macros\u003c/em\u003e in SOLIDWORKS.\u003c/p\u003e","tags":[],"title":"SOLIDWORKS Macro - Create Mirror"},{"content":"{% include article-notes/intermediate-initial-note.html %}\nObjective Objective of this article is to learn how to create Linear pattern feature through SOLIDWORKS VBA Macros in SOLIDWORKS.\nWe create Linear pattern Feature in following steps in general.\nAsk user to select a Feature to Linear pattern. Ask user to select an edge for Linear pattern in direction 1. Ask user to select an edge for Linear pattern in direction 2. Create Linear pattern feature data. Create Linear pattern feature. This method is most updated method, so use this method if you want to create a new Linear pattern Feature quickly.\nResults We Can Get After running our macro we successfully create Linear pattern feature as a result.\nBelow image shows the result we get.\nTo get the correct result please follow the steps correctly.\nVideo of Code on YouTube Please see below üé¨ video on how to create Linear pattern feature from SOLIDWORKS VBA Macros.\nPlease note that there are no explanation in the video.\nExplanation of each line and why we write code this way is given in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nCode Sample Below is the code for creating Linear pattern Feature feature in VBA is given.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Linear pattern Feature Dim swFeature As SldWorks.Feature \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData \u0026#39; Variable for Linear pattern feature data Dim swLinearPatternFeatureData As SldWorks.LinearPatternFeatureData \u0026#39; Main program for Linear pattern Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks Selection Manager variable Set swSelMgr = swDoc.SelectionManager \u0026#39; Array of Solidworks Entities Dim swObjects(1 To 3) As SldWorks.Entity \u0026#39; Local variable for selection Dim selectItems As Integer selectItems = 1 \u0026#39; Loop till we select all entities While selectItems \u0026lt;= 3 \u0026#39; Message to show user Dim messageToUser As String \u0026#39; Update Messages Select Case selectItems Case 1 messageToUser = \u0026#34;Please select a Feature for Linear Pattern.\u0026#34; Case 2 messageToUser = \u0026#34;Please select first Edge for Direction 1.\u0026#34; Case 3 messageToUser = \u0026#34;Please select second Edge for Direction 2.\u0026#34; Case Else Exit Sub End Select \u0026#39; Show message to user MsgBox messageToUser \u0026#39; Loop until Solidworks Entity variable is equal to selected edge While swObjects(selectItems) Is Nothing \u0026#39; Local integer for loop Dim i As Integer \u0026#39; Looping until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) \u0026#39; Update Selection Select Case selectItems Case 1 \u0026#39; If the selection type body feature If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelBODYFEATURES Then \u0026#39; Set the Solidworks Entity object to feature for Linear pattern Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) \u0026#39; If the face is selected ElseIf swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelFACES Then \u0026#39; Inform user to select feature from Feature Tree MsgBox \u0026#34;Please select Feature from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If Case 2, 3 \u0026#39; If the edge is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEDGES Then \u0026#39; Set the Solidworks Entity object to selected edge Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) Else \u0026#39; Inform user to select edge MsgBox \u0026#34;Please select an Edge.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If End Select Next DoEvents Wend \u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Increase the selection count selectItems = selectItems + 1 Wend \u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Local variable for counter Dim j As Integer j = 1 \u0026#39; Loop till counter is 3, since we have 3 selection While j \u0026lt; 4 \u0026#39; Set the current instance to Solidworks Entity variable Set swObject = swObjects(j) \u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData \u0026#39; Update Marking as per selected entity Select Case j Case 1 \u0026#39; For feature to pattern, set mark to 4 swSelData.Mark = 4 Case 2 \u0026#39; For direction 1, set mark to 1 swSelData.Mark = 1 Case 3 \u0026#39; For direction 1, set mark to 2 swSelData.Mark = 2 End Select \u0026#39; Select the current entity swObject.Select4 True, swSelData j = j + 1 Wend \u0026#39;-----------------------BELOW IS THE SOLUTION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;---------------------------------------------------------------- \u0026#39;Create linear pattern feature data Set swLinearPatternFeatureData = swDoc.FeatureManager.CreateDefinition(swFmLPattern) \u0026#39; Set Linear pattern feature data values swLinearPatternFeatureData.D1EndCondition = swPatternEndCondition_e.swPatternEndCondition_SpacingAndInstances swLinearPatternFeatureData.D1ReverseDirection = False swLinearPatternFeatureData.D1Spacing = InputBox(\u0026#34;Please select spacing in direction 1\u0026#34;) * LengthConversionFactor swLinearPatternFeatureData.D1TotalInstances = InputBox(\u0026#34;Number of instances in direction 1\u0026#34;) swLinearPatternFeatureData.D2EndCondition = swPatternEndCondition_e.swPatternEndCondition_SpacingAndInstances swLinearPatternFeatureData.D2PatternSeedOnly = False swLinearPatternFeatureData.D2ReverseDirection = False swLinearPatternFeatureData.D2Spacing = InputBox(\u0026#34;Please select spacing in direction 2\u0026#34;) * LengthConversionFactor swLinearPatternFeatureData.D2TotalInstances = InputBox(\u0026#34;Number of instances in direction 2\u0026#34;) swLinearPatternFeatureData.GeometryPattern = False swLinearPatternFeatureData.VarySketch = False \u0026#39; Create Linear pattern Set swFeature = swDoc.FeatureManager.CreateFeature(swLinearPatternFeatureData) \u0026#39; Check if Linear Pattern creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Linear Pattern.\u0026#34;) Exit Sub End If \u0026#39; Erase array data Erase swObjects \u0026#39; View zoom to fit swDoc.ViewZoomtofit2 \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this article.\nWe are not creating feature from code but we use existing üëâ Extrude feature and üëâ Hole feature to create Linear pattern feature as shown in below picture.\nAs shown in above image, there are 1 Extrude and 1 Hole feature in our part.\nExtrude Feature : This is our Extruded feature. Hole Feature : This is our Hole feature for Linear pattern. If you want to create Extrude feature programmatically then please refer to below article.\nüëâ SOLIDWORKS Macros - Create Extrude/Boss If you want to create Hole feature programmatically then please refer to below article.\nüëâ SOLIDWORKS Macros - Create Holes from Hole Wizard We will apply checks in this article, so the code we write should be error free most of the time.\nSteps To Follow To create Linear pattern Feature there are following steps:\nCreating Global Variables Initializing required variables Ask user to select feature and directions Mark selected entities Get unit Conversion factors Create üëâ Linear Pattern feature Definition Create Linear Pattern feature using üëâ Linear Pattern feature definition. Final work Now let us walk through each step as given above, and understand every line.\nI also give some links (see icon üëâ) so that you can go through them if there are anything I explained in previous articles.\nCreating Global Variables Option Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit üëâ SOLIDWORKS Macros - Open new Part document post.\nWe create following variables.\nVariable for Solidworks application \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\nTo see methods and properties related to SldWorks.SldWorks object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks document \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\nTo see methods and properties related to SldWorks.ModelDoc2 object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Linear pattern Feature \u0026#39; Variable for Solidworks Linear pattern Feature Dim swFeature As SldWorks.Feature\rIn this line, we Create a variable which we named as swFeature and the type of this swFeature variable is SldWorks.Feature.\nWe create variable swFeature for SOLIDWORKS Linear pattern Feature.\nTo see methods and properties related to Feature object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Selection Manager \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr\rIn this line, we create a variable which we named as swSelMgr and the type of this swSelMgr variable is SldWorks.SelectionMgr.\nTo see methods and properties related to SldWorks.SelectionMgr object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Entity \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity\rIn this line, we Create a variable which we named as swObject and the type of this swObject variable is SldWorks.Entity.\nWe create variable swObject for SOLIDWORKS Entities (Profile and Path) we ask use to select.\nTo see methods and properties related to SldWorks.Entity object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Select Data \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData\rIn this line, we create a variable named swSelData as SldWorks.SelectData object type.\nWe create variable swSelData for SOLIDWORKS Select Data, which we use for Marking selected object.\nTo see methods and properties related to SldWorks.SelectData object, please visit üëâ this page of SOLIDWORKS API Help.\nVariable for Solidworks Thread feature data \u0026#39; Variable for Linear pattern feature data Dim swLinearPatternFeatureData As SldWorks.LinearPatternFeatureData\rIn this line, we create a variable which we named as swThreadFeatData and the type of this swThreadFeatData variable is SldWorks.ThreadFeatureData.\nTo see methods and properties related to SldWorks.ThreadFeatureData object, please visit üëâ [this page of SOLIDWORKS API Help](ILinearPatternFeatureData Interface - 2019 - SOLIDWORKS API Help).\nThese all are our global variables.\nThey are SOLIDWORKS API Objects.\nSo basically I group all the SOLIDWORKS API Objects in one place.\n\u0026#39; Main program for Linear pattern Sub main() End Sub\rNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\nTo know more about Sub Procedure you can check üëâ VBA Sub and Function Procedures article of this website.\nInitializing Required Variables Inside this procedure we first initialize required variables as given below.\nSet SOLIDWORKS variable to SOLIDWORKS application \u0026#39; Set SOLIDWORKS variable to SOLIDWORKS application Set swApp = Application.SldWorks\rIn this line, we set the value of our SOLIDWORKS variable swApp; which we define earlier; to SOLIDWORKS application.\n\u0026#39; Check if SOLIDWORKS is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS application variable is successfully assigned to current SOLIDWORKS application.\nSet SOLIDWORKS document variable to opened part document \u0026#39; Set SOLIDWORKS document variable to opened part document Set swDoc = swApp.ActiveDoc\rIn above line of code, we set SOLIDWORKS document swDoc variable to currently open part document.\n\u0026#39; Check if SOLIDWORKS document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if SOLIDWORKS document swDoc is opened.\nIf SOLIDWORKS document is not opened then code execute inside the code and inform the user by a üëâ Message Window.\nSet SOLIDWORKS Selection Manager variable \u0026#39; Set SOLIDWORKS Selection Manager variable Set swSelMgr = swDoc.SelectionManager\rIn above line, we set SOLIDWORKS Selection ManagerswSelMgr variable to current document\u0026rsquo;s Selection Manager.\nArray of SOLIDWORKS Entities \u0026#39; Array of Solidworks Entities Dim swObjects(1 To 3) As SldWorks.Entity\rIn this line, we create an Array of SOLIDWORKS Entities which we named as swObjects and the type of this SldWorks.Entity variable is SldWorks.Entity.\nThis array consist two SldWorks.Entity variables.\nWe define the number of variable this array holds inside (1 To 3).\nFor more information about the Arrays in VBA please üëâ Array on this website.\nLocal variable for User selection \u0026#39; Local variable for selection Dim selectItems As Integer selectItems = 1\rIn above line of code, we define a Local variable name selectItemsas Integer type.\nIn next line we assign a value of 1.\nAsk user to select feature and directions Now we will ask user to select feature and directions for Linear Pattern feature.\nPlease follow steps given below.\n\u0026#39; Loop till we select all entities While selectItems \u0026lt;= 3 Wend\rIn above line of code we start a While loop.\nFor more details about While loop, please see üëâ VBA Looping article from this website.\nWe want to loop until selectItems variable\u0026rsquo;s value is equal to 3.\n\u0026#39; Message to show user Dim messageToUser As String\rIn above line of code we create a variable named messageToUser of String type.\nThis variable holds the message we want to show before selection.\n\u0026#39; Update Messages Select Case selectItems Case 1 messageToUser = \u0026#34;Please select a Feature for Linear Pattern.\u0026#34; Case 2 messageToUser = \u0026#34;Please select first Edge for Direction 1.\u0026#34; Case 3 messageToUser = \u0026#34;Please select second Edge for Direction 2.\u0026#34; Case Else Exit Sub End Select\rIn above line of code, we use a Select statement to update message.\nWe use the case on selectItems.\nWhen selectItems = 1 then value of messageToUser update to \u0026quot;Please select a Feature for Linear Pattern.\u0026quot;\nWhen selectItems = 2 then value of messageToUser update to \u0026quot;Please select first Edge for Direction 1.\u0026quot;\nSimilarly, when selectItems = 3 then value of messageToUser upda te to \u0026quot;Please select second Edge for Direction 2.\u0026quot;\n\u0026#39; Show message to user MsgBox messageToUser\rIn above line of code, we show the message to user.\nBelow image shows the message for Feature selection to the user.\nBelow image shows the message for first Edge for Direction 1 to the user.\nBelow image shows the message for second Edge for Direction 2 to the user.\n\u0026#39; Loop until we complete our selection While swObjects(selectItems) Is Nothing Wend\rIn above line of code, we create another While loop.\nThis loops until we select the our Profile and Path.\nFor more details about While loop, please see üëâ VBA Looping article from this website.\n\u0026#39; Local integer for loop Dim i As Integer\rIn above line of code, we create a local integer name i as a counter.\n\u0026#39; Loop until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Next\rIn above line of code, we create a For loop.\nThis code loops from i = 1 to number of objects we select.\n\u0026#39; Update Messages Select Case selectItems End Select\rIn above line of code, we use a Select statement for selection entities.\nWe use the case on selectItems.\nCase 1 \u0026#39; If the profile sketch is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelBODYFEATURES Then \u0026#39; Set the Solidworks Entity object to feature for Linear pattern Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) \u0026#39; If the face is selected ElseIf swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelFACES Then \u0026#39; Inform user to select feature from Feature Tree MsgBox \u0026#34;Please select Feature from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If\rAbove code sample we use for Case 1.\nIn above line of code, we use üëâ IF/Else statement with conditions.\nThe üëâ IF statement is True when selected object is type of SOLIDWORKS Body Feature.\nSimilarly, üëâ Else statement is True when select object is type of SOLIDWORKS Face.\nWhen we select the sketch from Model view, then selected object is SOLIDWORKS Face. When we select the sketch from Feature Tree, then select object is SOLIDWORKS Body Feature. {: .notice}\nWhen üëâ IF statement is True we execute code given below.\n\u0026#39; Set the Solidworks Entity object to feature for Linear pattern Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1)\rIn above line, we set the indexed object inside array.\nArray of SOLIDWORKS Entities = swObjects Indexed Entity Object = swObjects[selectItems] We set the value of this Indexed Entity Object by GetSelectedObject6() method of SOLIDWORKS Selection Manager.\nWhen we set the Indexed Entity Object value as feature to mirror, we exit the 2nd While loop.\nSimilarly, when üëâ Else statement is True we execute code given below.\n\u0026#39; Inform user to select feature from Feature Tree MsgBox \u0026#34;Please select feature from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True\rWe show message to user to select Feature from Feature Tree. After that we clear our selection. We do this because if selected object type is SOLIDWORKS Face then we can not assign this object as SOLIDWORKS Entity inside array.\nCase 2, 3 \u0026#39; If the edge is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEDGES Then \u0026#39; Set the Solidworks Entity object to selected edge Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) Else \u0026#39; Inform user to select edge MsgBox \u0026#34;Please select a Edge.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If\rAbove code sample we use for Case 2 and Case 3.\nIn above line of code, we use üëâ IF/Else statement with conditions.\nThe üëâ IF statement is True when selected object is type of SOLIDWORKS Edge.\nIf we the selected object is not type of SOLIDWORKS Edge then üëâ Else statement code runs.\nWhen üëâ IF statement is True we execute code given below.\n\u0026#39; Set the Solidworks Entity object to selected Edge Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1)\rIn above line, we set the indexed object inside array.\nArray of SOLIDWORKS Entities = swObjects Indexed Entity Object = swObjects[selectItems] We set the value of this Indexed Entity Object by GetSelectedObject6() method of SOLIDWORKS Selection Manager.\nWhen we set the Indexed Entity Object value as feature to mirror, we exit the 2nd While loop.\nSimilarly, when üëâ Else statement is True we execute code given below.\n\u0026#39; Inform user to select edge MsgBox \u0026#34;Please select a Edge.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True\rWe show message to user to select Edge. After that we clear our selection. After For loop, we have a call for DoEvents function.\nThis function repeats the While loop until we select the Feature or Edge.\n\u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Increase the selection count selectItems = selectItems + 1\rIn above line, when we finished with the Profile or Path selection, we clear previous selection and increment the selected count by 1.\nAfter increment the selected count we continue our while loop.\nMark selected Entities Till now we have completed our selection.\nNow we need to do Select and Mark entities correctly from our Array.\n\u0026#39; Local variable for counter Dim j As Integer j = 1\rIn above line of code we create integer variable for counter.\n\u0026#39; Loop till counter is 3, since we have 3 selection While j \u0026lt; 4 Wend\rIn above line of code we create a while loop with condition that counter value of j should be less than 4.\n\u0026#39; Set the current instance to Solidworks Entity variable Set swObject = swObjects(j)\rIn above line of code, we set the SOLIDWORKS Entity variable to current object from array.\n\u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData\rIn above line of code, we create SOLIDWORKS Select Data for current SOLIDWORKS Entity object.\n\u0026#39; Update Messages Select Case j End Select\rIn above line of code, we use a Select statement for selection entities.\nWe use the case on j.\nCase 1 \u0026#39; For feature to pattern, set mark to 4 swSelData.Mark = 4\rAbove code sample we use for Case 1.\nIn above lines, we update the Mark to 4 for our SOLIDWORKS Select Data variable.\nFor Linear Pattern feature, Mark values can be follows:\nAny\u0026hellip; Must be preselected and marked with a value of\u0026hellip; Direction 1 1 Direction 2 2 Feature to pattern 4 For more details about Mark please visit üëâ Linear Pattern Feature in SOLIDWORS API Help.\nCase 2 \u0026#39; For direction 1, set mark to 1 swSelData.Mark = 1\rAbove code sample we use for Case 2.\nIn above lines, we update the Mark to 1 for our SOLIDWORKS Select Data variable.\nFor Linear Pattern feature, Mark values can be follows:\nAny\u0026hellip; Must be preselected and marked with a value of\u0026hellip; Direction 1 1 Direction 2 2 Feature to pattern 4 For more details about Mark please visit üëâ Linear Pattern Feature in SOLIDWORS API Help.\nCase 3 \u0026#39; For plane, set mark to 2 swSelData.Mark = 2\tAbove code sample we use for Case 3.\nIn above lines, we update the Mark to 3 for our SOLIDWORKS Select Data variable.\nFor Linear Pattern feature, Mark values can be follows:\nAny\u0026hellip; Must be preselected and marked with a value of\u0026hellip; Direction 1 1 Direction 2 2 Feature to pattern 4 For more details about Mark please visit üëâ Linear Pattern Feature in SOLIDWORS API Help.\n\u0026#39; Select the current entity swObject.Select4 True, swSelData\rIn above line of code, we select the Feature object.\nWe select it by using Select4 method of SOLIDWORKS Entity object.\nThis method takes 2 arguments.\nAppend - True appends the entity to the selection list, False replaces the selection list with this entity. Data - Pointer to the ISelectData object. We use following values as parameter.\nAppend - True Data - swSelData j = j + 1\rAfter Select statement, we increment the counter variable j by 1.\nGet unit Conversion factors Now we need to get unit Conversion factors as shown in below code.\n\u0026#39;-----------------------Unit Conversion Factors---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;----------------------------------------------------------------\rI have already explained about this in previous üëâ Solidworks Macro - Fix Unit Issue article in this website.\nPlease visit üëâ Solidworks Macro - Fix Unit Issue article for more details.\nCreate Linear Pattern Feature Definition We have completed our selection of üëâ SOLIDWORKS Entity.\nNow we create üëâ Linear Pattern feature Definition and set its properties for Linear Pattern.\n\u0026#39;Create linear pattern feature data Set swLinearPatternFeatureData = swDoc.FeatureManager.CreateDefinition(swFmLPattern)\rIn above line of code we set the value of variable swLinearPatternFeatureData by CreateDefinition method.\nCreateDefinition method is part of FeatureManager object.\nThis FeatureManager is again part of swDoc variable i.e. ModelDoc2 object.\nThis CreateDefinition method takes following parameters as explained:\nType - Feature name ID as defined in swFeatureNameID_e.\nswFmBoundingBox (bounding box) swFmCirPattern (circular pattern) swFmCurvePattern (curve-driven pattern) swFmDerivedLPattern (derived-driven pattern) swFmDimPattern (variable/dimension pattern) swFmFillPattern (fill pattern) swFmGroundPlane (ground plane) swFmLibraryFeature (library) swFmLocalChainPattern (chain component pattern) swFmLocalCirPattern (circular component pattern) swFmLocalCurvePattern (curve-driven component pattern) swFmLocalLPattern (linear component pattern) swFmLocalSketchPattern (sketch-driven component pattern) swFmLPattern (linear pattern) swFmNormalCut (sheet metal normal cut) swFmRefCurve (projection curve) swFmRefSurface (surface sweep) swFmSketchPattern (sketch-driven pattern) swFmSweep (boss sweep) swFmSweepCut (cut sweep) swFmSweepThread (Thread) swFmTabAndSlot (tab and slot) swFmTablePattern (table pattern) Return Value : This CreateDefinition method return feature or pattern-specific feature data object.\nTo see methods and properties related to FeatureManager object, please visit üëâ this page of Solidworks API Help.\nIn our code, I have used following values:\nType - I use swFmLPattern as Feature name ID. If you want to know more information about Linear Pattern Feature data then please visit üëâ this page of Solidworks API Help.\nThis page will give you information about various properties and methods of ILinearPatternFeatureData Interface.\n\u0026#39; Set Linear pattern feature data values swLinearPatternFeatureData.D1EndCondition = swPatternEndCondition_e.swPatternEndCondition_SpacingAndInstances swLinearPatternFeatureData.D1ReverseDirection = False swLinearPatternFeatureData.D1Spacing = InputBox(\u0026#34;Please select spacing in direction 1\u0026#34;) * LengthConversionFactor swLinearPatternFeatureData.D1TotalInstances = InputBox(\u0026#34;Number of instances in direction 1\u0026#34;) swLinearPatternFeatureData.D2EndCondition = swPatternEndCondition_e.swPatternEndCondition_SpacingAndInstances swLinearPatternFeatureData.D2PatternSeedOnly = False swLinearPatternFeatureData.D2ReverseDirection = False swLinearPatternFeatureData.D2Spacing = InputBox(\u0026#34;Please select spacing in direction 2\u0026#34;) * LengthConversionFactor swLinearPatternFeatureData.D2TotalInstances = InputBox(\u0026#34;Number of instances in direction 2\u0026#34;) swLinearPatternFeatureData.GeometryPattern = False swLinearPatternFeatureData.VarySketch = False\rIn above lines, we set various properties of Linear Pattern feature definition.\nswLinearPatternFeatureData.D1EndCondition = swPatternEndCondition_e.swPatternEndCondition_SpacingAndInstances\rIn above line of code we set how to specify the spacing of pattern instances for Direction 1 as defined in below table.\nMember Description swPatternEndCondition_SpacingAndInstances 0 = Independently set the pattern instance number and spacing swPatternEndCondition_UpToReference 1 = Pattern instance number and spacing is based on a selected up-to-reference geometry and an offset swLinearPatternFeatureData.D1ReverseDirection = False\rIn above line code code, we set value of D1ReverseDirection to False.\nThis means we did not want to reverse direction 1.\nswLinearPatternFeatureData.D1Spacing = InputBox(\u0026#34;Please select spacing in direction 1\u0026#34;) * LengthConversionFactor\rIn above line of code we are doing 3 steps in one line.\nThose 3 steps are explained below.\nStep 1 - Getting direction 1 spacing from user. Below image shows the message for direction 1 spacing to the user.\nStep 2 - Convert input spacing as per document unit system. Step 3 - Assigned converted value to swLinearPatternFeatureData.D1Spacing property. swLinearPatternFeatureData.D1Spacing property gets or sets the spacing between pattern instances in Direction 1 of this linear pattern feature.\nswLinearPatternFeatureData.D1TotalInstances = InputBox(\u0026#34;Number of instances in direction 1\u0026#34;)\rIn above line of code we are doing 2 steps in one line.\nThose 2 steps are explained below.\nStep 1 - Getting number of instances in direction 1 from user. Below image shows the message for number of instances 1 spacing to the user.\nStep 2 - Assigned input value to swLinearPatternFeatureData.D1TotalInstances property. swLinearPatternFeatureData.D1TotalInstances property gets or sets the total number of pattern instances in Direction 1 for this linear pattern feature.\nswLinearPatternFeatureData.D2EndCondition = swPatternEndCondition_e.swPatternEndCondition_SpacingAndInstances\rIn above line of code we set how to specify the spacing of pattern instances for Direction 2 as defined in below table.\nMember Description swPatternEndCondition_SpacingAndInstances 0 = Independently set the pattern instance number and spacing swPatternEndCondition_UpToReference 1 = Pattern instance number and spacing is based on a selected up-to-reference geometry and an offset swLinearPatternFeatureData.D2PatternSeedOnly = False\rIn above line code code, we set value of D2PatternSeedOnly to False.\nswLinearPatternFeatureData.D2PatternSeedOnly property gets or sets whether to create a pattern in Direction 2 using the seed features only.\nswLinearPatternFeatureData.D2EndCondition = swPatternEndCondition_e.swPatternEndCondition_SpacingAndInstances\rswLinearPatternFeatureData.D2ReverseDirection = False\rIn above line code code, we set value of D2ReverseDirection to False.\nswLinearPatternFeatureData.D2ReverseDirection property gets or sets whether to reverse Direction 2 in this linear pattern feature.\nswLinearPatternFeatureData.D2Spacing = InputBox(\u0026#34;Please select spacing in direction 2\u0026#34;) * LengthConversionFactor\rIn above line of code we are doing 3 steps in one line.\nThose 3 steps are explained below.\nStep 1 - Getting direction 1 spacing from user. Below image shows the message for direction 2 spacing to the user.\nStep 2 - Convert input spacing as per document unit system. Step 3 - Assigned converted value to swLinearPatternFeatureData.D2Spacing property. swLinearPatternFeatureData.D2Spacing property gets or sets the spacing between pattern instances in Direction 2 of this linear pattern feature.\nswLinearPatternFeatureData.D2TotalInstances = InputBox(\u0026#34;Number of instances in direction 2\u0026#34;)\rIn above line of code we are doing 2 steps in one line.\nThose 2 steps are explained below.\nStep 1 - Getting number of instances in direction 2 from user. Below image shows the message for number of instances 2 spacing to the user.\nStep 2 - Assigned input value to swLinearPatternFeatureData.D2TotalInstances property. swLinearPatternFeatureData.D2TotalInstances property gets or sets the total number of pattern instances in Direction 2 for this linear pattern feature.\nswLinearPatternFeatureData.GeometryPattern = False\rIn above line code we set the value of swLinearPatternFeatureData.GeometryPattern to False.\nswLinearPatternFeatureData.GeometryPattern property gets or sets Geometry Pattern option for this linear pattern feature.\nswLinearPatternFeatureData.VarySketch = False\rIn above line code we set the value of swLinearPatternFeatureData.VarySketch to False.\nswLinearPatternFeatureData.VarySketch property gets or sets whether to allow the pattern to vary as it repeats in this linear pattern feature.\nCreate Linear Pattern \u0026#39; Create Linear pattern Set swFeature = swDoc.FeatureManager.CreateFeature(swLinearPatternFeatureData)\rIn above line of code we set the value of variable swFeature by CreateFeature method.\nThis CreateFeature method takes following parameters as explained:\nFeatureData - Feature or pattern-specific feature data object. Return Value : This CreateFeature method return feature data object.\nCreateFeature method is part of FeatureManager object.\nThis FeatureManager is again part of swDoc variable i.e. ModelDoc2 object.\nTo see methods and properties related to FeatureManager object, please visit üëâ this page of SOLIDWORKS API Help.\nIn our code, I have used following values:\nFeatureData - I use swLinearPatternFeatureData as feature data object which we defined previously. \u0026#39; Check if Linear Pattern creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Linear Pattern.\u0026#34;) Exit Sub End If\rIn above line of code, we use an üëâ IF statement to check if we able to create üëâ Linear Pattern Feature or not.\nIf we failed to select then inform the user by a üëâ Message Window.\nAfter showing error message our program exit from here itself.\nNow we run the macro and after running macro we get Revolve as shown in below image.\nFinal work After creating Linear Pattern feature, we have to do some cleaning work so that we can use this macro frequently.\nEmpty SOLIDWORKS Entity Array \u0026#39; Erase array data Erase swObjects\rIn above line, we erase data from SOLIDWORKS Entity array.\nFor this we use Erase function in-build in VBA.\nMake part Zoom to fit \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model.\nFor this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable.\nClear selection \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection.\nFor this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Linear Pattern feature with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":147,"permalink":"/solidworks-macros/create-linear-patterns/","summary":"\u003cp\u003e{% include article-notes/intermediate-initial-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eObjective of this article is to learn \u003cem\u003ehow to create \u003cstrong\u003eLinear pattern\u003c/strong\u003e feature through SOLIDWORKS VBA Macros\u003c/em\u003e in SOLIDWORKS.\u003c/p\u003e","tags":[],"title":"SOLIDWORKS Macro - Create Linear Pattern"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of Circular pattern feature in SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to create a new Circular pattern Feature quickly.\nResults We Can Get After running our macro we successfully create Circular pattern feature as a result.\nBelow image shows the result we get.\nWe create Circular pattern Feature in following steps in general.\nAsk user to select a Feature. Ask user to select an edge in direction 1. Ask for spacing in direction 1. Ask for spacing in direction 2. Number of instances in direction 1. Number of instances in direction 2. To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Circular pattern feature from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for creating Circular pattern Feature.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData \u0026#39; Variable for Circular pattern feature data Dim swCircularPatternFeatureData As SldWorks.CircularPatternFeatureData \u0026#39; Variable for Solidworks Circular pattern Feature Dim swFeature As SldWorks.Feature \u0026#39; Main program for Circular pattern Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks Selection Manager variable Set swSelMgr = swDoc.SelectionManager \u0026#39; Array of Solidworks Entities Dim swObjects(1 To 2) As SldWorks.Entity \u0026#39; Local variable for selection Dim selectItems As Integer selectItems = 1 \u0026#39; Loop till we select all entities While selectItems \u0026lt;= 2 \u0026#39; Message to show user Dim messageToUser As String \u0026#39; Update Messages Select Case selectItems Case 1 messageToUser = \u0026#34;Please select a Feature for Circular Pattern.\u0026#34; Case 2 messageToUser = \u0026#34;Please select Edge for Direction 1.\u0026#34; Case Else Exit Sub End Select \u0026#39; Show message to user MsgBox messageToUser \u0026#39; Loop until we complete our selection While swObjects(selectItems) Is Nothing \u0026#39; Local integer for loop Dim i As Integer \u0026#39; Looping until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) \u0026#39; Update Selection Select Case selectItems Case 1 \u0026#39; If the selection type body feature If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelBODYFEATURES Then \u0026#39; Set the Solidworks Entity object to feature for Linear pattern Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) \u0026#39; If the face is selected ElseIf swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelFACES Then \u0026#39; Inform user to select feature from Feature Tree MsgBox \u0026#34;Please select Feature from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If Case 2 \u0026#39; If the edge is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEDGES Then \u0026#39; Set the Solidworks Entity object to selected edge Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) Else \u0026#39; Inform user to select edge MsgBox \u0026#34;Please select an Edge.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If End Select Next DoEvents Wend \u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Increase the selection count selectItems = selectItems + 1 Wend \u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Local variable for counter Dim j As Integer j = 1 \u0026#39; Loop till counter is 2, since we have 2 selection While j \u0026lt; 3 \u0026#39; Set the current instance to Solidworks Entity variable Set swObject = swObjects(j) \u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData \u0026#39; Update Marking as per selected entity Select Case j Case 1 \u0026#39; For feature to pattern, set mark to 4 swSelData.Mark = 4 Case 2 \u0026#39; For axis 1, set mark to 1 swSelData.Mark = 1 End Select \u0026#39; Select the current entity swObject.Select4 True, swSelData j = j + 1 Wend \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39; Create Circular pattern feature data Set swCircularPatternFeatureData = swDoc.FeatureManager.CreateDefinition(swFmCirPattern) \u0026#39; Set Linear pattern feature data values swCircularPatternFeatureData.BodyPattern = False swCircularPatternFeatureData.Direction2 = True swCircularPatternFeatureData.EqualSpacing = True swCircularPatternFeatureData.EqualSpacing2 = True swCircularPatternFeatureData.Spacing = InputBox(\u0026#34;Please select spacing in direction 1\u0026#34;) * AngleConversionFactor swCircularPatternFeatureData.Spacing2 = InputBox(\u0026#34;Please select spacing in direction 2\u0026#34;) * AngleConversionFactor swCircularPatternFeatureData.TotalInstances = InputBox(\u0026#34;Number of instances in direction 1 including seed.\u0026#34;) swCircularPatternFeatureData.TotalInstances2 = InputBox(\u0026#34;Number of instances in direction 2 including seed.\u0026#34;) \u0026#39; Create Circular pattern Set swFeature = swDoc.FeatureManager.CreateFeature(swCircularPatternFeatureData) \u0026#39; Check if Circular Pattern creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Circular Pattern.\u0026#34;) Exit Sub End If \u0026#39; Erase array data Erase swObjects \u0026#39; View zoom to fit swDoc.ViewZoomtofit2 \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired. We are not creating feature from code but we use existing üöÄ Extrude feature and üöÄ Hole feature to create Circular pattern feature. Below image shown prerequisite 3D model for our demo.\nAs shown in above image, there are 2 Extrude features in our part.\nBase Feature : This is our Base Extrude feature. Feature To Pattern : This is our feature for pattern. If you want to create these Extrude features programmatically then please refer to below article.\nüöÄ SOLIDWORKS Macros - Create Extrude/Boss We will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This Circular pattern Feature VBA macro can be divided into following sections:\nCreating Global Variables Initializing required variables Ask user to select feature and directions Mark selected entities Get unit Conversion factors Create üöÄ Circular Pattern feature Definition Create Circular Pattern feature using üöÄ Circular Pattern feature definition. Final work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreating Global Variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr\rPurpose: In above line, we create a variable for Solidworks Selection Manager. Variable Name: swSelMgr Type: SldWorks.SelectionMgr. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity\rPurpose: In above line, we create a variable for selection and marking of Solidworks Entity. Variable Name: swObject Type: SldWorks.Entity Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData\rPurpose: In above line, we create a variable for Marking of Solidworks Select Data. Variable Name: swSelData Type: SldWorks.SelectData Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Circular pattern feature data Dim swCircularPatternFeatureData As SldWorks.CircularPatternFeatureData\rPurpose: In above line, we create a variable for üöÄ Circular Pattern feature Definition. Variable Name: swCircularPatternFeatureData Type: SldWorks.CircularPatternFeatureData Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Circular pattern Feature Dim swFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Circular pattern Feature. Variable Name: swFeature Type: SldWorks.Feature Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Main program for Circular pattern Sub main() End Sub\rIn above line, we create main program for Circular pattern feature. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initializing Required Variables Inside this section we initialize required variables.\n\u0026#39; Set SOLIDWORKS variable to SOLIDWORKS application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Check if SOLIDWORKS is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swApp variable. We use üöÄ IF statement for checking. Condition: swApp Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS is not opened Then we stop our macro here. \u0026#39; Set SOLIDWORKS document variable to opened part document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if SOLIDWORKS document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Please open a document. Then we stop our macro here. \u0026#39; Set SOLIDWORKS Selection Manager variable Set swSelMgr = swDoc.SelectionManager\rIn above line, we set value of swSelMgr variable. This value is current document\u0026rsquo;s Selection Manager. \u0026#39; Array of Solidworks Entities Dim swObjects(1 To 2) As SldWorks.Entity\rIn above line, we create an üöÄ Array of Solidworks Entities. Variable Name: swObjects Type: SldWorks.Entity Length of Array: (1 To 2) Reference: Please visit For Solidworks Entities: üöÄ online SOLIDWORKS API Help. For Arrays in VBA : üöÄ Array on this website. \u0026#39; Local variable for selection Dim selectItems As Integer selectItems = 1\rIn above line, we create a variable for selection and set its value. Variable Name: selectItems Type: Integer Value: 1 Ask user to select feature and directions In this section, we ask user to select feature and directions for Circular Pattern feature.\n\u0026#39; Loop till we select all entities While selectItems \u0026lt;= 2 Wend\rIn above line of code we start a While loop. We loop until selectItems variable\u0026rsquo;s value is equal to 2. Reference: üöÄ VBA Looping article from this website. \u0026#39; Message to show user Dim messageToUser As String\rIn above line, we create a variable to show a messages we want to show before selection. Variable Name: messageToUser Type: String \u0026#39; Update Messages Select Case selectItems Case 1 messageToUser = \u0026#34;Please select a Feature for Circular Pattern.\u0026#34; Case 2 messageToUser = \u0026#34;Please select Edge for Direction 1.\u0026#34; Case Else Exit Sub End Select\rIn above code block, we use a Select statement to update message. We use the case on selectItems. Case 1: messageToUser update to \u0026quot;Please select a Feature for Circular Pattern.\u0026quot; Case 2: messageToUser update to \u0026quot;Please select Edge for Direction 1.\u0026quot; Reference: üöÄ Select statement article of this website. \u0026#39; Show message to user MsgBox messageToUser\rIn above line, we show the message to user. Below image shows the message for Feature selection to the user. Below image shows the message for Edge for Direction 1 to the user. \u0026#39; Loop until we complete our selection While swObjects(selectItems) Is Nothing Wend\rIn above line, we create another While loop. This loops continues to run until we select the our Feature and Edge for circular pattern. Reference: üöÄ VBA Looping article from this website. \u0026#39; Local integer for loop Dim i As Integer\rIn above line, we create a variable as a counter. Variable Name: i Type: Integer \u0026#39; Loop until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Next\rIn above line, we create a For loop. This loops start from i = 1 to number of objects we select. \u0026#39; Update Messages Select Case selectItems End Select\rIn above line, we use a Select statement for selection entities. We use the case on selectItems. Reference: üöÄ Select statement article of this website. Case 1 \u0026#39; If the profile sketch is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelBODYFEATURES Then \u0026#39; Set the Solidworks Entity object to feature for Linear pattern Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) \u0026#39; If the face is selected ElseIf swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelFACES Then \u0026#39; Inform user to select feature from Feature Tree MsgBox \u0026#34;Please select Feature from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If\rAbove code block we use for Case 1. In above code block, we use üöÄ IF/ElseIf statement with conditions. The üöÄ IF statement is True when selected object is type of SOLIDWORKS Body Feature. Similarly, üöÄ ElseIf statement is True when select object is type of SOLIDWORKS Face. When we select the sketch from Model view, then selected object is SOLIDWORKS Face. When we select the sketch from Feature Tree, then select object is SOLIDWORKS Body Feature. {: .notice}\n\u0026#39; Set the Solidworks Entity object to feature for Linear pattern Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1)\rWhen üöÄ IF statement is True we run above line. In above line, we set the object inside array. Array of SOLIDWORKS Entities = swObjects Indexed Entity Object = swObjects[selectItems] Indexed Entity Object value set by GetSelectedObject6() method. GetSelectedObject6() method is part of SOLIDWORKS Selection Manager. Reference: Please visit üöÄ online Solidworks API Help. \u0026#39; Inform user to select feature from Feature Tree MsgBox \u0026#34;Please select feature from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True\rWhen üöÄ ElseIf statement is True we execute run above lines. 1st Line: We show a message to user to select Feature from Feature Tree. 2nd Line: After that we clear our selection. We do this because if selected object type is SOLIDWORKS Face then we can not assign this object as SOLIDWORKS Entity inside array. {: .notice}\nCase 2 \u0026#39; If the edge is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEDGES Then \u0026#39; Set the Solidworks Entity object to selected edge Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) Else \u0026#39; Inform user to select edge MsgBox \u0026#34;Please select a Edge.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If\rAbove code block we use for Case 2. In above line, we use üöÄ IF/Else statement with conditions. üöÄ IF statement is True when selected object is type of SOLIDWORKS Edge. If selected object is not type of SOLIDWORKS Edge then üöÄ Else statement code runs. \u0026#39; Set the Solidworks Entity object to selected Edge Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1)\rWhen üöÄ IF statement is True we execute code given below. In above line, we set the indexed object inside array. Array of SOLIDWORKS Entities = swObjects Indexed Entity Object = swObjects[selectItems] Indexed Entity Object value set by GetSelectedObject6() method. GetSelectedObject6() method is part of SOLIDWORKS Selection Manager. Reference: Please visit üöÄ online Solidworks API Help. \u0026#39; Inform user to select edge MsgBox \u0026#34;Please select a Edge.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True\rWhen üöÄ Else statement is True we execute code given below. 1st Line: We show a message to user to select Edge. 2nd Line: We clear our selection. DoEvents\rAfter For loop end, we have a call for DoEvents function. This function repeats the While loop until we complete Feature or Edge selection. \u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Increase the selection count selectItems = selectItems + 1\r1st Line: We clear previous selection. 2nd Line: Increment the selectItems count by 1. After increment the selected count we continue our while loop.\nMark selected Entities In previous section, we complete our selection.\nIn this section, we complete Select and Mark entities correctly from our Array.\n\u0026#39; Local variable for counter Dim j As Integer j = 1\rIn above line, we create a variable as a counter. Variable Name: j Type: Integer Value: 1 \u0026#39; Loop till counter is 2, since we have 2 selection While j \u0026lt; 3 Wend\rIn above line, we create a while loop. Condition: that counter value of j should be less than 3. Reference: üöÄ VBA Looping article from this website. \u0026#39; Set the current instance to Solidworks Entity variable Set swObject = swObjects(j)\rIn above line, we set the SOLIDWORKS Entity variable to current object from array. \u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData\rIn above line, we create SOLIDWORKS Select Data for current SOLIDWORKS Entity object. \u0026#39; Update Messages Select Case j End Select\rIn above line of code, we use a Select statement for selection entities. We use the case on j. Reference: üöÄ Select statement article of this website. Case 1 \u0026#39; For feature to pattern, set mark to 4 swSelData.Mark = 4\rAbove code block, we use for Case 1. In above lines, we set Mark to 4. For Circular Pattern feature, Mark values can be follows: Any\u0026hellip; Must be preselected and marked with a value of\u0026hellip; Direction 1 1 Feature to pattern 4 Reference: Please visit üöÄ Circular Pattern Feature in SOLIDWORS API Help. Case 2 \u0026#39; For direction 1, set mark to 1 swSelData.Mark = 1\rAbove code sample we use for Case 2. In above lines, we update the Mark to 1. For Circular Pattern feature, Mark values can be follows: Any\u0026hellip; Must be preselected and marked with a value of\u0026hellip; Direction 1 1 Feature to pattern 4 Reference: Please visit üöÄ Circular Pattern Feature in SOLIDWORS API Help. \u0026#39; Select the current entity swObject.Select4 True, swSelData\rIn above line, we select the object. We select it by using Select4 method of SOLIDWORKS Entity object. This method takes 2 arguments. Append - True appends the entity to the selection list, False replaces the selection list with this entity. Data - Pointer to the ISelectData object. We use following values as parameter. Append - True Data - swSelData j = j + 1\rAfter Select statement, we increment the counter variable j by 1.\nGet unit Conversion factors In this section we get unit Conversion factors.\n\u0026#39;-----------------------Unit Conversion Factors---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;----------------------------------------------------------------\rI have already explained about this in previous üöÄ Solidworks Macro - Fix Unit Issue article in this website. Please visit üöÄ Solidworks Macro - Fix Unit Issue article for more details. Create Circular Pattern Feature Definition In this section we create üöÄ Circular Pattern feature Definition and set its properties for Circular Pattern.\n\u0026#39; Create Circular pattern feature data Set swCircularPatternFeatureData = swDoc.FeatureManager.CreateDefinition(swFmCirPattern)\rIn above line of code we set the value of variable swCircularPatternFeatureData by CreateDefinition method.\nCreateDefinition method is part of FeatureManager object.\nFeatureManager is again part of swDoc variable i.e. ModelDoc2 object. This CreateDefinition method takes following parameters as explained:\nType - Feature name ID as defined in swFeatureNameID_e. swFmBoundingBox (bounding box) swFmCirPattern (circular pattern) swFmCurvePattern (curve-driven pattern) swFmDerivedLPattern (derived-driven pattern) swFmDimPattern (variable/dimension pattern) swFmFillPattern (fill pattern) swFmGroundPlane (ground plane) swFmLibraryFeature (library) swFmLocalChainPattern (chain component pattern) swFmLocalCirPattern (circular component pattern) swFmLocalCurvePattern (curve-driven component pattern) swFmLocalLPattern (linear component pattern) swFmLocalSketchPattern (sketch-driven component pattern) swFmLPattern (linear pattern) swFmNormalCut (sheet metal normal cut) swFmRefCurve (projection curve) swFmRefSurface (surface sweep) swFmSketchPattern (sketch-driven pattern) swFmSweep (boss sweep) swFmSweepCut (cut sweep) swFmSweepThread (Thread) swFmTabAndSlot (tab and slot) swFmTablePattern (table pattern) Return Value : This CreateDefinition method return feature or pattern-specific feature data object.\nIn our code, I have used following values:\nType - I use swFmCirPattern as Feature name ID. Reference: For more details about\nSolidworks Feature Manager details: üöÄ online Solidworks API Help for Solidworks Feature Manager. Circular Pattern Feature data: üöÄ online Solidworks API Help for Circular Pattern Feature data. swCircularPatternFeatureData.BodyPattern = False\rIn above line, we set value of BodyPattern to False. swCircularPatternFeatureData.Direction2 = True\rIn above line code, we set value of D1ReverseDirection to True. This allows us to pattern in second direction also. swCircularPatternFeatureData.EqualSpacing = True\rIn above line code, we set value of EqualSpacing to True. This allows us to set pattern instances at equal spacing in direction 1. swCircularPatternFeatureData.EqualSpacing2 = True\rIn above line code, we set value of EqualSpacing2 to True. This allows us to set pattern instances at equal spacing in direction 2. swCircularPatternFeatureData.Spacing = InputBox(\u0026#34;Please select spacing in direction 1\u0026#34;) * AngleConversionFactor\rIn above line of code we are doing 3 steps in one line. Those 3 steps are explained below.\nStep 1 - Getting direction 1 spacing from user. Below image shows the message for direction 1 spacing to the user. Step 2 - Convert input spacing as per document unit system. Step 3 - Assigned converted value to swCircularPatternFeatureData.Spacing property. swCircularPatternFeatureData.Spacing2 = InputBox(\u0026#34;Please select spacing in direction 2\u0026#34;) * AngleConversionFactor\rIn above line of code we are doing 3 steps in one line.\nThose 3 steps are explained below.\nStep 1 - Getting direction 2 spacing from user. Below image shows the message for direction 2 spacing to the user. Step 2 - Convert input spacing as per document unit system. Step 3 - Assigned converted value to swCircularPatternFeatureData.Spacing2 property. swCircularPatternFeatureData.TotalInstances = InputBox(\u0026#34;Number of instances in direction 1 including seed.\u0026#34;)\rIn above line of code we are doing 2 steps in one line. Those 2 steps are explained below.\nStep 1 - Getting number of instances in direction 1 from user. Below image shows the message for number of instances 1 spacing to the user. Step 2 - Assigned input value to swCircularPatternFeatureData.TotalInstances property. swCircularPatternFeatureData.TotalInstances2 = InputBox(\u0026#34;Number of instances in direction 2 including seed.\u0026#34;)\rIn above line of code we are doing 2 steps in one line. Those 2 steps are explained below.\nStep 1 - Getting number of instances in direction 2 from user. Below image shows the message for number of instances 2 spacing to the user.\nStep 2 - Assigned input value to swCircularPatternFeatureData.TotalInstances2 property. Create Circular Pattern In this section, we create Circular Pattern.\n\u0026#39; Create Circular pattern Set swFeature = swDoc.FeatureManager.CreateFeature(swCircularPatternFeatureData)\rIn above line, we set the value of variable swFeature by CreateFeature method.\nThis CreateFeature method takes following parameters as explained:\nFeatureData - Feature or pattern-specific feature data object. Return Value : This CreateFeature method return feature data object.\nCreateFeature method is part of FeatureManager object. This FeatureManager is again part of swDoc variable i.e. ModelDoc2 object. Reference: üöÄ online Solidworks API Help for Solidworks Feature Manager FeatureManager.\nIn our code, I have used following values:\nFeatureData - I use swCircularPatternFeatureData as feature data object which we defined previously. \u0026#39; Check if Circular Pattern creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Circular Pattern.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully create üöÄ Circular Pattern Feature or not. We use üöÄ IF statement for checking. Condition: swFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to create Circular Pattern. Then we stop our macro here. Final work In this section, after creating Circular Pattern feature, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; Erase array data Erase swObjects\rIn above line, we erase data from SOLIDWORKS Entity array. For this we use Erase function in-build in VBA. \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Circular Pattern feature with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":148,"permalink":"/solidworks-vba-macros/create-circular-patterns/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of \u003cstrong\u003eCircular pattern feature\u003c/strong\u003e in \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Create Circular Pattern"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of Sketch Driven pattern feature in SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to create a new Sketch Driven pattern Feature quickly.\nResults We Can Get After running our macro we successfully create Sketch Driven pattern feature as a result.\nBelow image shows the result we get.\nWe create Sketch Driven pattern Feature in following steps in general.\nAsk user to select a Feature. Ask user to select a Sketch. To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Sketch Driven pattern feature from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for creating Sketch Driven pattern Feature.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData \u0026#39; Variable for Solidworks Sketch Pattern Feature data Dim swLocalSketchPatternFeat As SldWorks.SketchPatternFeatureData \u0026#39; Variable for Solidworks Sketch Driven Pattern feature Dim swFeature As SldWorks.Feature \u0026#39; Sketch Driven Pattern program Sub main() \u0026#39; Setting Solidworks variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Setting Solidworks document variable to opened part document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks Selection Manager variable Set swSelMgr = swDoc.SelectionManager \u0026#39; Array of Solidworks Entities Dim swObjects(1 To 2) As SldWorks.Entity \u0026#39; Local variable for selection Dim selectItems As Integer selectItems = 1 \u0026#39; Loop till we select all entities While selectItems \u0026lt;= 2 \u0026#39; Message to show user Dim messageToUser As String \u0026#39; Update Messages Select Case selectItems Case 1 messageToUser = \u0026#34;Please select a Feature for Pattern.\u0026#34; Case 2 messageToUser = \u0026#34;Please select a sketch for Pattern.\u0026#34; Case Else Exit Sub End Select \u0026#39; Show message to user MsgBox messageToUser \u0026#39; Loop until we complete our selection While swObjects(selectItems) Is Nothing \u0026#39; Local integer for loop Dim i As Integer \u0026#39; Loop until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Select Case selectItems Case 1 \u0026#39; If the feature is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelBODYFEATURES Then \u0026#39; Set the Solidworks Entity object to profile sketch Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) \u0026#39; If the profile sketch is selected ElseIf swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelFACES Then \u0026#39; Inform user to select sketch from Tree MsgBox \u0026#34;Please select Feature from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If Case 2 \u0026#39; If the sketch is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelSKETCHES Then \u0026#39; Set the Solidworks Entity object to sketch Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) \u0026#39; If the feature is selected ElseIf swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelBODYFEATURES Then \u0026#39; Inform user to select sketch from Tree MsgBox \u0026#34;Please select Sketch from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If End Select Next DoEvents Wend \u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Increase the selection count selectItems = selectItems + 1 Wend \u0026#39; Local variable for counter Dim j As Integer j = 1 \u0026#39; Loop till counter is 2, since we have 2 selection While j \u0026lt; 3 \u0026#39; Set the current instance to Solidworks Entity variable Set swObject = swObjects(j) \u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData Select Case j Case 1 \u0026#39; For feature to mirror, set mark to 1 swSelData.Mark = 4 Case 2 \u0026#39; For sketch, set mark to 64 swSelData.Mark = 64 End Select \u0026#39; Select the current entity swObject.Select4 True, swSelData j = j + 1 Wend \u0026#39; Create Sketch pattern feature data Set swLocalSketchPatternFeat = swDoc.FeatureManager.CreateDefinition(swFmSketchPattern) \u0026#39; Create Sketch pattern feature Set swFeature = swDoc.FeatureManager.CreateFeature(swLocalSketchPatternFeat) \u0026#39; Check if Sketch pattern Feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Sketch pattern Feature.\u0026#34;) Exit Sub End If \u0026#39; Erase array data Erase swObjects \u0026#39; View zoom to fit swDoc.ViewZoomtofit2 \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired. We are not creating feature from code but we use existing üöÄ Extrude feature and üöÄ Sketch Points to create Sketch Driven pattern feature. Below image shown prerequisite 3D model for our demo.\nAs shown in above image, there are 2 Extrude features in our part.\nBase Feature : This is our Base Extrude feature. Feature To Pattern : This is our feature for pattern. If you want to create these Extrude features and Sketch Points programmatically then please refer to below article.\nüöÄ SOLIDWORKS Macros - Create Extrude/Boss üöÄSolidworks Macro - Create a Point We will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This Sketch Driven pattern Feature VBA macro can be divided into following sections:\nCreating Global Variables Initializing required variables Ask user to select feature and directions Mark selected entities Create üöÄ Sketch Driven Pattern feature Definition Create Sketch Driven Pattern feature using üöÄ Sketch Driven Pattern feature Definition. Final work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreating Global Variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr\rPurpose: In above line, we create a variable for Solidworks Selection Manager. Variable Name: swSelMgr Type: SldWorks.SelectionMgr. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity\rPurpose: In above line, we create a variable for selection and marking of Solidworks Entity. Variable Name: swObject Type: SldWorks.Entity Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData\rPurpose: In above line, we create a variable for Marking of Solidworks Select Data. Variable Name: swSelData Type: SldWorks.SelectData Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Sketch Driven Pattern Feature data Dim swLocalSketchPatternFeat As SldWorks.SketchPatternFeatureData\rPurpose: In above line, we create a variable for üöÄ Sketch Driven Pattern feature Definition. Variable Name: swLocalSketchPatternFeat Type: SldWorks.SketchPatternFeatureData Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Sketch Driven pattern Feature Dim swFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Sketch Driven pattern Feature. Variable Name: swFeature Type: SldWorks.Feature Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Sketch Driven Pattern program Sub main() End Sub\rIn above line, we create main program for Sketch Driven pattern feature. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initializing Required Variables Inside this section we initialize required variables.\n\u0026#39; Setting Solidworks variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swApp variable. We use üöÄ IF statement for checking. Condition: swApp Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS is not opened Then we stop our macro here. \u0026#39; Setting Solidworks document variable to opened part document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Solidworks document is not opened. Please open a document. Then we stop our macro here. \u0026#39; Set Solidworks Selection Manager variable Set swSelMgr = swDoc.SelectionManager\rIn above line, we set value of swSelMgr variable. This value is current document\u0026rsquo;s Selection Manager. \u0026#39; Array of Solidworks Entities Dim swObjects(1 To 2) As SldWorks.Entity\rIn above line, we create an üöÄ Array of Solidworks Entities. Variable Name: swObjects Type: SldWorks.Entity Length of Array: (1 To 2) Reference: Please visit For Solidworks Entities: üöÄ online SOLIDWORKS API Help. For Arrays in VBA : üöÄ Array on this website. \u0026#39; Local variable for selection Dim selectItems As Integer selectItems = 1\rIn above line, we create a variable for selection and set its value. Variable Name: selectItems Type: Integer Value: 1 Ask user to select feature and directions In this section, we ask user to select Feature and Sketch for Sketch Driven Pattern feature.\n\u0026#39; Loop till we select all entities While selectItems \u0026lt;= 2 Wend\rIn above line of code we start a While loop. We loop until selectItems variable\u0026rsquo;s value is equal to 2. Reference: üöÄ VBA Looping article from this website. \u0026#39; Message to show user Dim messageToUser As String\rIn above line, we create a variable to show a messages we want to show before selection. Variable Name: messageToUser Type: String \u0026#39; Update Messages Select Case selectItems Case 1 messageToUser = \u0026#34;Please select a Feature for Pattern.\u0026#34; Case 2 messageToUser = \u0026#34;Please select a sketch for Pattern.\u0026#34; Case Else Exit Sub End Select\rIn above code block, we use a Select statement to update message. We use the case on selectItems. Case 1: messageToUser update to \u0026quot;Please select a Feature for Pattern.\u0026quot; Case 2: messageToUser update to \u0026quot;Please select a sketch for Pattern.\u0026quot; Reference: üöÄ Select statement article of this website. \u0026#39; Show message to user MsgBox messageToUser\rIn above line, we show the message to user. Below image shows the message for Feature selection to the user. Below image shows the message for Sketch selection to the user. \u0026#39; Loop until we complete our selection While swObjects(selectItems) Is Nothing Wend\rIn above line, we create another While loop. This loops continues to run until we select the our Feature and Edge for circular pattern. Reference: üöÄ VBA Looping article from this website. \u0026#39; Local integer for loop Dim i As Integer\rIn above line, we create a variable as a counter. Variable Name: i Type: Integer \u0026#39; Loop until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Next\rIn above line, we create a For loop. This loops start from i = 1 to number of objects we select. \u0026#39; Update Messages Select Case selectItems End Select\rIn above line, we use a Select statement for selection entities. We use the case on selectItems. Reference: üöÄ Select statement article of this website. Case 1 \u0026#39; If the profile sketch is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelBODYFEATURES Then \u0026#39; Set the Solidworks Entity object to feature for Linear pattern Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) \u0026#39; If the face is selected ElseIf swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelFACES Then \u0026#39; Inform user to select feature from Feature Tree MsgBox \u0026#34;Please select Feature from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If\rAbove code block we use for Case 1. In above code block, we use üöÄ IF/ElseIf statement with conditions. The üöÄ IF statement is True when selected object is type of SOLIDWORKS Body Feature. Similarly, üöÄ ElseIf statement is True when select object is type of SOLIDWORKS Face. When we select the sketch from Model view, then selected object is SOLIDWORKS Face. When we select the sketch from Feature Tree, then select object is SOLIDWORKS Body Feature. {: .notice}\n\u0026#39; Set the Solidworks Entity object to feature for Linear pattern Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1)\rWhen üöÄ IF statement is True we run above line. In above line, we set the object inside array. Array of SOLIDWORKS Entities = swObjects Indexed Entity Object = swObjects[selectItems] Indexed Entity Object value set by GetSelectedObject6() method. GetSelectedObject6() method is part of SOLIDWORKS Selection Manager. Reference: Please visit üöÄ online Solidworks API Help. \u0026#39; Inform user to select feature from Feature Tree MsgBox \u0026#34;Please select feature from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True\rWhen üöÄ ElseIf statement is True we execute run above lines. 1st Line: We show a message to user to select Feature from Feature Tree. 2nd Line: After that we clear our selection. We do this because if selected object type is SOLIDWORKS Face then we can not assign this object as SOLIDWORKS Entity inside array. {: .notice}\nCase 2 \u0026#39; If the sketch is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelSKETCHES Then \u0026#39; Set the Solidworks Entity object to sketch Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) \u0026#39; If the feature is selected ElseIf swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelBODYFEATURES Then \u0026#39; Inform user to select sketch from Tree MsgBox \u0026#34;Please select Sketch from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If\rAbove code block we use for Case 2. In above line, we use üöÄ IF/ElseIf statement with conditions. üöÄ IF statement is True when selected object is type of SOLIDWORKS Sketch. Similarly, üöÄ ElseIf statement is True when select object is type of SOLIDWORKS Body. \u0026#39; Set the Solidworks Entity object to selected sketch Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1)\rWhen üöÄ IF statement is True we execute code given below. In above line, we set the indexed object inside array. Array of SOLIDWORKS Entities = swObjects Indexed Entity Object = swObjects[selectItems] Indexed Entity Object value set by GetSelectedObject6() method. GetSelectedObject6() method is part of SOLIDWORKS Selection Manager. Reference: Please visit üöÄ online Solidworks API Help. \u0026#39; Inform user to select sketch from Tree MsgBox \u0026#34;Please select Sketch from Feature Tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True\rWhen üöÄ ElseIf statement is True we execute code given below. 1st Line: We show a message to user to select Sketch. 2nd Line: We clear our selection. DoEvents\rAfter For loop end, we have a call for DoEvents function. This function repeats the While loop until we complete Feature or Sketch selection. \u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Increase the selection count selectItems = selectItems + 1\r1st Line: We clear previous selection. 2nd Line: Increment the selectItems count by 1. After increment the selected count we continue our while loop.\nMark selected Entities In previous section, we complete our selection.\nIn this section, we complete Select and Mark entities correctly from our Array.\n\u0026#39; Local variable for counter Dim j As Integer j = 1\rIn above line, we create a variable as a counter. Variable Name: j Type: Integer Value: 1 \u0026#39; Loop till counter is 2, since we have 2 selection While j \u0026lt; 3 Wend\rIn above line, we create a while loop. Condition: that counter value of j should be less than 3. Reference: üöÄ VBA Looping article from this website. \u0026#39; Set the current instance to Solidworks Entity variable Set swObject = swObjects(j)\rIn above line, we set the SOLIDWORKS Entity variable to current object from array. \u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData\rIn above line, we create SOLIDWORKS Select Data for current SOLIDWORKS Entity object. \u0026#39; Update Messages Select Case j End Select\rIn above line of code, we use a Select statement for selection entities. We use the case on j. Reference: üöÄ Select statement article of this website. Case 1 \u0026#39; For feature to pattern, set mark to 4 swSelData.Mark = 4\rAbove code block, we use for Case 1. In above lines, we set Mark to 4. For Sketch Driven Pattern feature, Mark values can be follows: Any\u0026hellip; Must be preselected and marked with a value of\u0026hellip; Feature 4 Points 32 Sketches 64 Faces 128 Bodies 256 Reference: Please visit üöÄ Sketch Driven Pattern feature in SOLIDWORS API Help. Case 2 \u0026#39; For sketch, set mark to 64 swSelData.Mark = 64\rAbove code sample we use for Case 2. In above lines, we update the Mark to 64. For Sketch Driven Pattern feature, Mark values can be follows: Any\u0026hellip; Must be preselected and marked with a value of\u0026hellip; Feature 4 Points 32 Sketches 64 Faces 128 Bodies 256 Reference: Please visit üöÄ Sketch Driven Pattern feature in SOLIDWORS API Help. \u0026#39; Select the current entity swObject.Select4 True, swSelData\rIn above line, we select the object. We select it by using Select4 method of SOLIDWORKS Entity object. This method takes 2 arguments. Append - True appends the entity to the selection list, False replaces the selection list with this entity. Data - Pointer to the ISelectData object. We use following values as parameter. Append - True Data - swSelData j = j + 1\rAfter Select statement, we increment the counter variable j by 1.\nCreate Sketch Driven Pattern Feature Definition In this section we create üöÄ Sketch Driven Pattern feature Definition and set its properties for Sketch Driven Pattern.\n\u0026#39; Create Sketch pattern feature data Set swLocalSketchPatternFeat = swDoc.FeatureManager.CreateDefinition(swFmSketchPattern)\rIn above line of code we set the value of variable swLocalSketchPatternFeat by CreateDefinition method.\nCreateDefinition method is part of FeatureManager object.\nFeatureManager is again part of swDoc variable i.e. ModelDoc2 object. This CreateDefinition method takes following parameters as explained:\nType - Feature name ID as defined in swFeatureNameID_e. swFmBoundingBox (bounding box) swFmCirPattern (circular pattern) swFmCurvePattern (curve-driven pattern) swFmDerivedLPattern (derived-driven pattern) swFmDimPattern (variable/dimension pattern) swFmFillPattern (fill pattern) swFmGroundPlane (ground plane) swFmLibraryFeature (library) swFmLocalChainPattern (chain component pattern) swFmLocalCirPattern (circular component pattern) swFmLocalCurvePattern (curve-driven component pattern) swFmLocalLPattern (linear component pattern) swFmLocalSketchPattern (sketch-driven component pattern) swFmLPattern (linear pattern) swFmNormalCut (sheet metal normal cut) swFmRefCurve (projection curve) swFmRefSurface (surface sweep) swFmSketchPattern (sketch-driven pattern) swFmSweep (boss sweep) swFmSweepCut (cut sweep) swFmSweepThread (Thread) swFmTabAndSlot (tab and slot) swFmTablePattern (table pattern) Return Value : This CreateDefinition method return feature or pattern-specific feature data object.\nIn our code, I have used following values:\nType - I use swFmSketchPattern as Feature name ID. Reference: For more details about\nSolidworks Feature Manager details: üöÄ online Solidworks API Help for Solidworks Feature Manager. Sketch Driven Pattern Feature data: üöÄ online Solidworks API Help for Sketch Driven Pattern Feature data. Create Sketch Driven Pattern In this section, we create Sketch Driven Pattern.\n\u0026#39; Create Sketch pattern feature Set swFeature = swDoc.FeatureManager.CreateFeature(swLocalSketchPatternFeat)\rIn above line, we set the value of variable swFeature by CreateFeature method.\nThis CreateFeature method takes following parameters as explained:\nFeatureData - Feature or pattern-specific feature data object. Return Value : This CreateFeature method return üëâ Feature data object.\nCreateFeature method is part of FeatureManager object. This FeatureManager is again part of swDoc variable i.e. ModelDoc2 object. Reference: üöÄ online Solidworks API Help for Solidworks Feature Manager FeatureManager.\nIn our code, I have used following values:\nFeatureData - I use swLocalSketchPatternFeat as feature data object which we defined previously. \u0026#39; Check if Sketch pattern Feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Sketch pattern Feature.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully create üöÄ Sketch Driven Pattern Feature or not. We use üöÄ IF statement for checking. Condition: swFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to create Circular Pattern. Then we stop our macro here. Final work In this section, after creating Sketch Driven Pattern feature, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; Erase array data Erase swObjects\rIn above line, we erase data from SOLIDWORKS Entity array. For this we use Erase function in-build in VBA. \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Sketch Driven Pattern feature with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":149,"permalink":"/solidworks-vba-macros/create-sketch-driven-pattern/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of \u003cstrong\u003eSketch Driven pattern feature\u003c/strong\u003e in \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Create Sketch Driven Pattern"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of Rib feature in SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to create a new Rib Feature quickly.\nResults We Can Get After running our macro we successfully create Rib feature as a result.\nBelow GIF shows the result we get.\nWe create Rib Feature in following steps in general.\nAsk user to input Rib Thickness. Create Rib thickness. To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Rib feature from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for creating Rib Feature.\nOption Explicit \u0026#39; Solidworks application variable Dim swApp As SldWorks.SldWorks \u0026#39; Solidworks document variable Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Solidwors Feature variable Dim swFeature As SldWorks.Feature \u0026#39; Main program for Rib Sub main() \u0026#39; Set Solidworks application variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks document variable to open document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Get First feature in Feature tree Set swFeature = swDoc.FirstFeature \u0026#39; Check if Solidworks document is selected or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to selected First feature in Feature Tree.\u0026#34;) Exit Sub End If \u0026#39; Traversing through the Feature Tree, \u0026#39; until Feature name is \u0026#34;Rib-Sketch\u0026#34; While swFeature.Name \u0026lt;\u0026gt; \u0026#34;Rib-Sketch\u0026#34; \u0026#39; Print current Feature name is Immediate window Debug.Print swFeature.Name \u0026#39; Get the next feature Set swFeature = swFeature.GetNextFeature Wend \u0026#39; Print current Feature name is Immediate window Debug.Print swFeature.Name \u0026#39; Get the faces of selected feature swFeature.Select True \u0026#39;-----------------------BELOW IS THE SOLUTION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;---------------------------------------------------------------- \u0026#39; Variable to store user response Dim response As String response = InputBox(\u0026#34;Please input Rib Thickness:\u0026#34;, \u0026#34;Rib Thickness\u0026#34;) \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; Exit Sub End If \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; Exit Sub End If \u0026#39; Variable to store Rib Thickness Dim RibThickness As Double RibThickness = CDbl(response) * LengthConversionFactor \u0026#39; This will handle case for 0 thickness If RibThickness = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; Exit Sub End If \u0026#39; Create Rib Feature swDoc.FeatureManager.InsertRib True, False, RibThickness, 0, False, False, False, 0, False, False \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired. We are not creating feature from code but we use existing üöÄ Extrude feature and üöÄ Sketch Line to create Sketch Driven pattern feature. Below image shown prerequisite 3D model for our demo.\nAs shown in above image, there are 1 Extrude features and 1 Sketch Line in our part.\nBase Feature : This is our Base Extrude feature. Sketch Line : This is our Sketch for Rib feature. If you want to create these Extrude features and Sketch Line programmatically then please refer to below article.\nüöÄ SOLIDWORKS Macros - Create Extrude/Boss üöÄSolidworks Macro - Create Line We will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This Rib Feature VBA macro can be divided into following sections:\nCreating Global Variables Initializing required variables Select Rib Sketch Get unit Conversion factors Get Rib Thickness And Validation Create Rib Feature Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreating Global Variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Solidwors Feature variable Dim swFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for looping through Feature Tree and feature selection. Variable Name: swFeature Type: SldWorks.Feature Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Main program for Rib Sub main() End Sub\rIn above line, we create Main program for Rib. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initializing Required Variables Inside this section we initialize required variables.\n\u0026#39; Setting Solidworks variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swApp variable. We use üöÄ IF statement for checking. Condition: swApp Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS is not opened Then we stop our macro here. \u0026#39; Setting Solidworks document variable to opened part document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Solidworks document is not opened. Please open a document. Then we stop our macro here. \u0026#39; Get First feature in Feature tree Set swFeature = swDoc.FirstFeature\rIn above line, we set value of swFeature variable. We set swFeature variable\u0026rsquo;s value to 1st feature in Feature Tree. \u0026#39; Check if Solidworks document is selected or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to selected First feature in Feature Tree.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swFeature variable. We use üöÄ IF statement for checking. Condition: swFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to selected First feature in Feature Tree. Then we stop our macro here. Select Rib Sketch In this section, we select Rib-Sketch Feature for Rib feature.\n\u0026#39; Traversing through the Feature Tree, \u0026#39; until Feature name is \u0026#34;Rib-Sketch\u0026#34; While swFeature.Name \u0026lt;\u0026gt; \u0026#34;Rib-Sketch\u0026#34; Wend\rIn above line of code we start a While loop. We loop until swFeature.Name variable\u0026rsquo;s value is not equal to Rib-Sketch. Reference: üöÄ VBA Looping article from this website. \u0026#39; Print current Feature name is Immediate window Debug.Print swFeature.Name\rIn above line, we print current Feature name is Immediate window. \u0026#39; Get the next feature Set swFeature = swFeature.GetNextFeature\rIn above line, we again set value of swFeature variable. We set swFeature variable\u0026rsquo;s value to next feature in Feature Tree. \u0026#39; Print current Feature name is Immediate window Debug.Print swFeature.Name\rIn above line, we print current Feature name is Immediate window. \u0026#39; Select the current feature swFeature.Select True\rIn above line, we select the current feature. Get unit Conversion factors In this section we get unit Conversion factors.\n\u0026#39;-----------------------Unit Conversion Factors---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;----------------------------------------------------------------\rI have already explained about this in previous üöÄ Solidworks Macro - Fix Unit Issue article in this website. Please visit üöÄ Solidworks Macro - Fix Unit Issue article for more details. Get Rib Thickness And Validation In this section, we get get the Rib Thickness from user and apply some validation on Rib Thickness.\n\u0026#39; Variable to store user response Dim response As String\rIn above line, we create a variable as a counter. Variable Name: response Type: String response = InputBox(\u0026#34;Please input Rib Thickness:\u0026#34;, \u0026#34;Rib Thickness\u0026#34;)\rIn above line of code we are doing 2 steps in one line.\nThose 3 steps are explained below.\nStep 1 - Getting Rib Thickness from user. Below image shows the message for Rib Thickness to the user.\nStep 2 - Assigned input value to response variable. \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; Exit Sub End If\rIn above code block, we check the length of input value. This check will handle case for empty value or cancel operation case. We use üöÄ IF statement for checking. Condition: Len(response) = 0 Len() is pre-build VBA function which check the length of a object. In above cases, we will get 0 value. When this condition is True, We show and üöÄ message window to user. Message: Empty or no value. Please try again. Then we stop our macro here. \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; Exit Sub End If\rIn above code block, we check if the input value is Non-numeric. This check will handle case for Non-numeric values. We use üöÄ IF statement for checking. Condition: IsNumeric(response) = False IsNumeric() is pre-build VBA function which check if passing object is Numeric or not. In above cases, we will get False value. When this condition is True, We show and üöÄ message window to user. Message: Entered value is Non-numeric. Please try again. Then we stop our macro here. \u0026#39; Variable to store Rib Thickness Dim RibThickness As Double\rIn above line, we create a variable to store Rib Thickness. Variable Name: RibThickness Type: Double RibThickness = CDbl(response) * LengthConversionFactor\rIn above line of code we are doing 3 steps in one line.\nThose 3 steps are explained below.\nStep 1 - Converting Rib Thickness from user to Double type.\nStep 2 - Updating converted Rib Thickness as per document unit system.\nStep 3 - Assigned input value to RibThickness variable.\n\u0026#39; This will handle case for 0 thickness If RibThickness = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; Exit Sub End If\rIn above code block, we check if the input value is zero (0). This check will handle case for 0 thickness. We use üöÄ IF statement for checking. Condition: RibThickness = 0 When this condition is True, We show and üöÄ message window to user. Message: Entered value must be greater than 0. Please try again. Then we stop our macro here. Create Rib Feature In this section we create Rib Feature.\n\u0026#39; Create Rib Feature swDoc.FeatureManager.InsertRib True, False, RibThickness, 0, False, False, False, 0, False, False\rIn above line of code we create Rib Feature by InsertRib method.\nInsertRib method is part of FeatureManager object.\nFeatureManager is again part of swDoc variable i.e. ModelDoc2 object.\nThis InsertRib method takes following parameters as explained:\nIs2Sided - True if the rib is double-sided, False if the rib is single sided. ReverseThicknessDir - True to thicken the opposite side of the sketch normal, False to not. Thickness - Rib thickness. ReferenceEdgeIndex - Edge in the sketch to use to determine the material direction and for draft reference. ReverseMaterialDir - True to flip the direction of the extrusion, False to not. IsDrafted - True to draft the rib, False to not. DraftOutward - True to draft the rib outward, False to not. only valid if IsDrafted is True. DraftAngle - Draft angle of the rib; only valid if IsDrafted is True. IsNormToSketch - True if extrusion direction is normal to sketch, False if parallel to sketch. IsDraftedFromWall - True if draft is from wall, False if not; only valid if IsDrafted is True. Return Value : This InsertRib method did not return any value.\nIn our code, I have used following values:\nParameter Name Value Used Is2Sided True ReverseThicknessDir False Thickness RibThickness ReferenceEdgeIndex 0 ReverseMaterialDir False IsDrafted False DraftOutward False DraftAngle 0 IsNormToSketch False IsDraftedFromWall False Reference: For more details about\nSolidworks Feature Manager details: üöÄ online Solidworks API Help for Solidworks Feature Manager. InsertRib Method: üöÄ online Solidworks API Help for InsertRib Method. Now we run the macro and after running macro we get Rib feature as shown in below image.\n\u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Rib feature with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":150,"permalink":"/solidworks-vba-macros/create-rib/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of \u003cstrong\u003eRib feature\u003c/strong\u003e in \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Create Rib"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of Draft feature in SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to create a new Draft Feature quickly.\nResults We Can Get After running our macro we successfully create Draft feature as a result.\nBelow image shows the result we get.\nWe create Draft Feature in following steps in general.\nAsk user to select Neutral Face. Ask user to select Faces to draft. Ask for Draft Angle. To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Draft feature from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for creating Draft Feature.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData \u0026#39; Variable for Solidworks Draft Feature Dim swFeature As SldWorks.Feature \u0026#39; Main program for Draft Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks Selection Manager variable Set swSelMgr = swDoc.SelectionManager \u0026#39; Array of Solidworks Entities Dim swObjects(1 To 5) As SldWorks.Entity \u0026#39; Local variable for selection Dim selectItems As Integer selectItems = 1 \u0026#39; Loop till we select all entities While selectItems \u0026lt;= 5 \u0026#39; Message to show user Dim messageToUser As String \u0026#39; Update Messages Select Case selectItems Case 1 messageToUser = \u0026#34;Please select a Neutral Face.\u0026#34; Case 2, 3, 4, 5 messageToUser = \u0026#34;Please select Faces for Draft.\u0026#34; End Select \u0026#39; Show message to user MsgBox messageToUser \u0026#39; Loop until we complete our selection While swObjects(selectItems) Is Nothing \u0026#39; Local integer for loop Dim i As Integer \u0026#39; Looping until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Select Case selectItems Case 1 \u0026#39; If the selection type is face If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelFACES Then \u0026#39; Set the Solidworks Entity object to feature Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) Else \u0026#39; Inform user to select a Face MsgBox \u0026#34;Please select a Face.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If Case 2, 3, 4, 5 \u0026#39; If face is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelFACES Then Dim previousSelection As SldWorks.Entity Set previousSelection = swObjects(selectItems - 1) Dim currentSelection As SldWorks.Entity Set currentSelection = swSelMgr.GetSelectedObject6(i, -1) If Not previousSelection Is currentSelection Then \u0026#39; Set the Solidworks Entity object to feature Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) End If Else \u0026#39; Inform user to select a Face MsgBox \u0026#34;Please select a Face.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If End Select Next DoEvents Wend \u0026#39; Increase the selection count selectItems = selectItems + 1 Wend \u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Local variable for counter Dim j As Integer j = 1 \u0026#39; Loop till counter is 6, since we have 5 selection While j \u0026lt; 6 \u0026#39; Set the current instance to Solidworks Entity variable Set swObject = swObjects(j) \u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData \u0026#39; Update Marking as per selected entity Select Case j Case 1 \u0026#39; For neutral face, set mark to 1 swSelData.Mark = 1 Case 2, 3, 4, 5 \u0026#39; For draft faces, set mark to 2 swSelData.Mark = 2 End Select \u0026#39; Select the current entity swObject.Select4 True, swSelData j = j + 1 Wend \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39; Variable to hold draft angle Dim response As String \u0026#39; Getting draft angle from user. response = InputBox(\u0026#34;Please Enter [Draft Angle]:\u0026#34;, \u0026#34;Draft Fetaure\u0026#34;) \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; Exit Sub End If \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; Exit Sub End If \u0026#39; Variable to store validate draft angle Dim draftAngle As Double draftAngle = CDbl(response) * AngleConversionFactor \u0026#39; This will handle case for 0 draft angle If draftAngle = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; Exit Sub End If \u0026#39; Create Draft feature Set swFeature = swDoc.FeatureManager.InsertMultiFaceDraft(draftAngle, False, False, 0, False, False) \u0026#39; Check if Draft feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Draft feature.\u0026#34;) Exit Sub End If \u0026#39; Erase array data Erase swObjects \u0026#39; View zoom to fit swDoc.ViewZoomtofit2 \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired. We are not creating feature from code but we use existing üöÄ Extrude feature to create Draft feature. Below image shown prerequisite 3D model for our demo.\nAs shown in above image, there is one Extrude features in our part.\nBase Feature : This is our Base Extrude feature. If you want to create this Extrude features programmatically then please refer to below article.\nüöÄ SOLIDWORKS Macros - Create Extrude/Boss We will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This Draft Feature VBA macro can be divided into following sections:\nCreating Global Variables Initializing required variables Ask user to select faces Mark selected entities Get unit Conversion factors Get Draft Angle And Validation Create Draft feature Final work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreating Global Variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr\rPurpose: In above line, we create a variable for Solidworks Selection Manager. Variable Name: swSelMgr Type: SldWorks.SelectionMgr. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity\rPurpose: In above line, we create a variable for selection and marking of Solidworks Entity. Variable Name: swObject Type: SldWorks.Entity Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData\rPurpose: In above line, we create a variable for Marking of Solidworks Select Data. Variable Name: swSelData Type: SldWorks.SelectData Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Draft Feature Dim swFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Draft Feature. Variable Name: swFeature Type: SldWorks.Feature Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Main program for Draft Sub main() End Sub\rIn above line, we create main program for Draft Feature. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initializing Required Variables Inside this section we initialize required variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swApp variable. We use üöÄ IF statement for checking. Condition: swApp Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS is not opened Then we stop our macro here. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Please open a document. Then we stop our macro here. \u0026#39; Set Solidworks Selection Manager variable Set swSelMgr = swDoc.SelectionManager\rIn above line, we set value of swSelMgr variable. This value is current document\u0026rsquo;s Selection Manager. \u0026#39; Array of Solidworks Entities Dim swObjects(1 To 5) As SldWorks.Entity\rIn above line, we create an üöÄ Array of Solidworks Entities. Variable Name: swObjects Type: SldWorks.Entity Length of Array: (1 To 5) Reference: Please visit For Solidworks Entities: üöÄ online SOLIDWORKS API Help. For Arrays in VBA : üöÄ Array on this website. \u0026#39; Local variable for selection Dim selectItems As Integer selectItems = 1\rIn above line, we create a variable for selection and set its value. Variable Name: selectItems Type: Integer Value: 1 Ask user to select faces In this section, we ask user to select faces for Draft feature.\n\u0026#39; Loop till we select all entities While selectItems \u0026lt;= 5 Wend\rIn above line of code we start a While loop. We loop until selectItems variable\u0026rsquo;s value is equal to 5. Reference: üöÄ VBA Looping article from this website. \u0026#39; Message to show user Dim messageToUser As String\rIn above line, we create a variable to show a messages we want to show before selection. Variable Name: messageToUser Type: String \u0026#39; Update Messages Select Case selectItems Case 1 messageToUser = \u0026#34;Please select a Neutral Face.\u0026#34; Case 2, 3, 4, 5 messageToUser = \u0026#34;Please select Faces for Draft.\u0026#34; End Select\rIn above code block, we use a Select statement to update message. We use the case on selectItems. Case 1: messageToUser update to \u0026quot;Please select a Neutral Face.\u0026quot; Case 2: messageToUser update to \u0026quot;Please select Faces for Draft.\u0026quot; Reference: üöÄ Select statement article of this website. \u0026#39; Show message to user MsgBox messageToUser\rIn above line, we show the message to user. Below image shows the message for Neutral Face to the user. Below image shows the message for Faces for Draft to the user. \u0026#39; Loop until we complete our selection While swObjects(selectItems) Is Nothing Wend\rIn above line, we create another While loop. This loops continues to run until we select the our Feature and Edge for circular pattern. Reference: üöÄ VBA Looping article from this website. \u0026#39; Local integer for loop Dim i As Integer\rIn above line, we create a variable as a counter. Variable Name: i Type: Integer \u0026#39; Loop until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Next\rIn above line, we create a For loop. This loops start from i = 1 to number of objects we select. \u0026#39; Update Messages Select Case selectItems End Select\rIn above line, we use a Select statement for selection entities. We use the case on selectItems. Reference: üöÄ Select statement article of this website. Case 1 \u0026#39; If the selection type is face If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelFACES Then \u0026#39; Set the Solidworks Entity object to feature Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) Else \u0026#39; Inform user to select a Face MsgBox \u0026#34;Please select a Face.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If\rAbove code block we use for Case 1. In above code block, we use üöÄ IF/ElseIf statement with conditions. The üöÄ IF statement is True when selected object is type of SOLIDWORKS Face. If selected object is not type of SOLIDWORKS Face then üöÄ Else statement code runs. When we select the sketch from Model view, then selected object is SOLIDWORKS Face. When we select the sketch from Feature Tree, then select object is SOLIDWORKS Body Feature. {: .notice}\n\u0026#39; Set the Solidworks Entity object to feature Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1)\rWhen üöÄ IF statement is True we run above line. In above line, we set the object inside array. Array of SOLIDWORKS Entities = swObjects Indexed Entity Object = swObjects[selectItems] Indexed Entity Object value set by GetSelectedObject6() method. GetSelectedObject6() method is part of SOLIDWORKS Selection Manager. Reference: Please visit üöÄ online Solidworks API Help. \u0026#39; Inform user to select a Face MsgBox \u0026#34;Please select a Face.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True\rWhen üöÄ Else statement is True we execute run above lines. 1st Line: We show a message to user to select Feature from Feature Tree. 2nd Line: After that we clear our selection. Case 2, 3, 4, 5 \u0026#39; If face is selected If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelFACES Then Dim previousSelection As SldWorks.Entity Set previousSelection = swObjects(selectItems - 1) Dim currentSelection As SldWorks.Entity Set currentSelection = swSelMgr.GetSelectedObject6(i, -1) If Not previousSelection Is currentSelection Then \u0026#39; Set the Solidworks Entity object to feature Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) End If Else \u0026#39; Inform user to select a Face MsgBox \u0026#34;Please select a Face.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If\rAbove code block we use for Case 2, 3, 4, 5. In above line, we use üöÄ IF/Else statement with conditions. üöÄ IF statement is True when selected object is type of SOLIDWORKS Face. If selected object is not type of SOLIDWORKS Face then üöÄ Else statement code runs. Dim previousSelection As SldWorks.Entity\rPurpose: In above line, we create a variable for previously selected Solidworks Entity. Variable Name: previousSelection Type: SldWorks.Entity Set previousSelection = swObjects(selectItems - 1)\rIn above line, we set the value of previousSelection variable to previously selected entity. Dim currentSelection As SldWorks.Entity\rPurpose: In above line, we create a variable for currently selected Solidworks Entity. Variable Name: currentSelection Type: SldWorks.Entity Set currentSelection = swSelMgr.GetSelectedObject6(i, -1)\rIn above line, we set the value of currentSelection variable to currently selected entity. If Not previousSelection Is currentSelection Then End If\rIn above code, we check if previous and currently selected entities are different. So, we can select different faces. When üöÄ IF statement is True we execute code given below. \u0026#39; Set the Solidworks Entity object to feature Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1)\rIn above line, we set the indexed object inside array. Array of SOLIDWORKS Entities = swObjects Indexed Entity Object = swObjects[selectItems] Indexed Entity Object value set by GetSelectedObject6() method. GetSelectedObject6() method is part of SOLIDWORKS Selection Manager. Reference: Please visit üöÄ online Solidworks API Help. \u0026#39; Inform user to select Face MsgBox \u0026#34;Please select a Face.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True\rWhen üöÄ Else statement is True we execute code given below. 1st Line: We show a message to user to select Face. 2nd Line: We clear our selection. DoEvents\rAfter For loop end, we have a call for DoEvents function. This function repeats the While loop until we complete Feature or Edge selection. \u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Increase the selection count selectItems = selectItems + 1\r1st Line: We clear previous selection. 2nd Line: Increment the selectItems count by 1. After increment the selected count we continue our while loop.\nMark selected Entities In previous section, we complete our selection.\nIn this section, we complete Select and Mark entities correctly from our Array.\n\u0026#39; Local variable for counter Dim j As Integerj = 1\rIn above line, we create a variable as a counter. Variable Name: j Type: Integer Value: 1 \u0026#39; Loop till counter is 6, since we have 5 selection While j \u0026lt; 6 Wend\rIn above line, we create a while loop. Condition: that counter value of j should be less than 6. Reference: üöÄ VBA Looping article from this website. \u0026#39; Set the current instance to Solidworks Entity variable Set swObject = swObjects(j)\rIn above line, we set the SOLIDWORKS Entity variable to current object from array. \u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData\rIn above line, we create SOLIDWORKS Select Data for current SOLIDWORKS Entity object. \u0026#39; Update Marking as per selected entity Select Case j End Select\rIn above line of code, we use a Select statement for selection entities. We use the case on j. Reference: üöÄ Select statement article of this website. Case 1 \u0026#39; For neutral face, set mark to 1 swSelData.Mark = 1\rAbove code block, we use for Case 1. In above lines, we set Mark to 1. For Draft feature, Mark values can be follows: Any\u0026hellip; Must be preselected and marked with a value of\u0026hellip; Neutral face 1 Draft faces 2 Draft Edges 4 Reference: Please visit üöÄ InsertMultiFaceDraft Method in SOLIDWORS API Help. Case 2, 3, 4, 5 \u0026#39; For draft faces, set mark to 2 swSelData.Mark = 2\rAbove code sample we use for Case 2, 3, 4, 5. In above lines, we update the Mark to 2. For Draft feature, Mark values can be follows: Any\u0026hellip; Must be preselected and marked with a value of\u0026hellip; Neutral face 1 Draft faces 2 Draft Edges 4 Reference: Please visit üöÄ InsertMultiFaceDraft Method in SOLIDWORS API Help. \u0026#39; Select the current entity swObject.Select4 True, swSelData\rIn above line, we select the object. We select it by using Select4 method of SOLIDWORKS Entity object. This method takes 2 arguments. Append - True appends the entity to the selection list, False replaces the selection list with this entity. Data - Pointer to the ISelectData object. We use following values as parameter. Append - True Data - swSelData j = j + 1\rAfter Select statement, we increment the counter variable j by 1.\nGet unit Conversion factors In this section we get unit Conversion factors.\n\u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select\rI have already explained about this in previous üöÄ Solidworks Macro - Fix Unit Issue article in this website. Please visit üöÄ Solidworks Macro - Fix Unit Issue article for more details. Get Draft Angle And Validation In this section, we get get the Draft Angle from user and apply some validation on Draft Angle.\n\u0026#39; Variable to hold draft angle Dim response As String\rIn above line, we create a variable as a counter. Variable Name: response Type: String \u0026#39; Getting draft angle from user response = InputBox(\u0026#34;Please Enter [Draft Angle]:\u0026#34;, \u0026#34;Draft Fetaure\u0026#34;)\rIn above line of code we are doing 2 steps in one line.\nThose 3 steps are explained below.\nStep 1 - Getting Draft Angle from user. Below image shows the message for Draft Angle to the user.\nStep 2 - Assigned input value to response variable. \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; Exit Sub End If\rIn above code block, we check the length of input value. This check will handle case for empty value or cancel operation case. We use üöÄ IF statement for checking. Condition: Len(response) = 0 Len() is pre-build VBA function which check the length of a object. In above cases, we will get 0 value. When this condition is True, We show and üöÄ message window to user. Message: Empty or no value. Please try again. Then we stop our macro here. \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; Exit Sub End If\rIn above code block, we check if the input value is Non-numeric. This check will handle case for Non-numeric values. We use üöÄ IF statement for checking. Condition: IsNumeric(response) = False IsNumeric() is pre-build VBA function which check if passing object is Numeric or not. In above cases, we will get False value. When this condition is True, We show and üöÄ message window to user. Message: Entered value is Non-numeric. Please try again. Then we stop our macro here. \u0026#39; Variable to store validate draft angle Dim draftAngle As Double\rIn above line, we create a variable to store Rib Thickness. Variable Name: draftAngle Type: Double draftAngle = CDbl(response) * AngleConversionFactor\rIn above line of code we are doing 3 steps in one line.\nThose 3 steps are explained below.\nStep 1 - Converting Draft Angle from user to Double type.\nStep 2 - Updating converted Rib Thickness as per document unit system.\nStep 3 - Assigned input value to draftAngle variable.\n\u0026#39; This will handle case for 0 draft angle If RibThickness = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; Exit Sub End If\rIn above code block, we check if the input value is zero (0). This check will handle case for 0 Draft Angle. We use üöÄ IF statement for checking. Condition: draftAngle = 0 When this condition is True, We show and üöÄ message window to user. Message: Entered value must be greater than 0. Please try again. Then we stop our macro here. Create Draft feature In this section, we create Draft feature.\n\u0026#39; Create Draft feature Set swFeature = swDoc.FeatureManager.InsertMultiFaceDraft(draftAngle, False, False, 0, False, False)\rIn above line, we set the value of variable swFeature by InsertMultiFaceDraft method.\nThis InsertMultiFaceDraft method takes following parameters as explained:\nAngle - Draft angle in radians. FlipDir - True to flip the direction of the draft. EdgeDraft - True if this is an edge draft and the user selects edges to draft, False if this is a face draft and the user selects faces to draft. PropType - Propagation type: 0 = No propagation 1 = Propagate to the next tangent faces that share the base neutral plane; valid for edge draft or neutral plane draft 2 = Propagate to all faces that are a neighbor of the neutral plane 3 = Propagate to all faces that a neighbor of the neutral plane on all inner loops 4 = Propagate to all faces that are a neighbor of the neutral plane on the outer loop IsStepDraft - True if the draft is a step draft, False to not. IsBodyDraft - True if the draft is a body draft, False to not. Return Value : This InsertMultiFaceDraft method return üëâ Feature data object.\nIn our code, I have used following values:\nParameter Name Value Used Angle draftAngle FlipDir False EdgeDraft False PropType 0 IsStepDraft False IsBodyDraft False Reference: For more details about\nSolidworks Feature Manager details: üöÄ online Solidworks API Help for Solidworks Feature Manager. InsertMultiFaceDraft Method: üöÄ online Solidworks API Help for InsertMultiFaceDraft Method. \u0026#39; Check if Draft feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Draft feature.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully create Draft Feature or not. We use üöÄ IF statement for checking. Condition: swFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to create Draft Feature. Then we stop our macro here. Now we run the macro and after running macro we get Draft feature as shown in below image.\nFinal work In this section, after creating Draft Feature, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; Erase array data Erase swObjects\rIn above line, we erase data from SOLIDWORKS Entity array. For this we use Erase function in-build in VBA. \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Circular Pattern feature with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":151,"permalink":"/solidworks-vba-macros/create-draft/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of \u003cstrong\u003eDraft feature\u003c/strong\u003e in \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Create Draft"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article I want to:\nCreate Shell feature From VBA Macro Without using Userforms. This method is most updated method, so use this method if you want to create a new Shell Feature quickly.\nResults We Can Get After running our macro we successfully create Shell feature as a result.\nBelow image shows the result we get.\nWe create Shell Feature in following steps in general.\n*Ask user to select **Faces to Shell *. Ask for Shell Thickness. To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Shell feature from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for creating Shell Feature.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData \u0026#39; Main program for Shell Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks Selection Manager variable Set swSelMgr = swDoc.SelectionManager \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity \u0026#39; Message to show user Dim messageToUser As String \u0026#39; Update Messages messageToUser = \u0026#34;Please select a Face.\u0026#34; \u0026#39; Show message to user MsgBox messageToUser \u0026#39; Loop until we complete our selection While swObject Is Nothing \u0026#39; Local integer for loop Dim i As Integer \u0026#39; Looping until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) \u0026#39; If the selection type is face If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelFACES Then \u0026#39; Set the Solidworks Entity object to feature Set swObject = swSelMgr.GetSelectedObject6(i, -1) Else \u0026#39; Inform user to select a Face MsgBox \u0026#34;Please select a Face.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If Next DoEvents Wend \u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData \u0026#39; For shell face, set mark to 1 swSelData.Mark = 1 \u0026#39; Select the current entity swObject.Select4 True, swSelData \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39; Variable for Shell thickness Dim shellThickness As Double \u0026#39; Getting Shell thickness from user. shellThickness = InputBox(\u0026#34;Please select Shell Thickness.\u0026#34;) * LengthConversionFactor \u0026#39; Create Shell feature swDoc.InsertFeatureShell shellThickness, False \u0026#39; View zoom to fit swDoc.ViewZoomtofit2 \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this macro.\nKnowledge of VBA programming language is ‚ùórequired. We are not creating feature from code but we use existing üöÄ Extrude feature to create Shell feature. Below image shown prerequisite 3D model for our demo.\nAs shown in above image, there is one Extrude features in our part.\nBase Feature : This is our Base Extrude feature. If you want to create this Extrude features programmatically then please refer to below article.\nüöÄ SOLIDWORKS Macros - Create Extrude/Boss We will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This Shell Feature VBA macro can be divided into following sections:\nCreating Global Variables Initializing required variables Ask user to select faces Mark selected entities Get unit Conversion factors Get Shell Thickness Create Shell feature Final work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreating Global Variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr\rPurpose: In above line, we create a variable for Solidworks Selection Manager. Variable Name: swSelMgr Type: SldWorks.SelectionMgr. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData\rPurpose: In above line, we create a variable for Marking of Solidworks Select Data. Variable Name: swSelData Type: SldWorks.SelectData Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Main program for Shell Sub main() End Sub\rIn above line, we create main program for Shell Feature. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initializing Required Variables Inside this section we initialize required variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swApp variable. We use üöÄ IF statement for checking. Condition: swApp Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS is not opened Then we stop our macro here. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Please open a document. Then we stop our macro here. \u0026#39; Set Solidworks Selection Manager variable Set swSelMgr = swDoc.SelectionManager\rIn above line, we set value of swSelMgr variable. This value is current document\u0026rsquo;s Selection Manager. \u0026#39; Variable for Solidworks Entity Dim swObjects As SldWorks.Entity\rPurpose: In above line, we create a variable for selection and marking of Solidworks Entity. Variable Name: swObject Type: SldWorks.Entity Reference: Please visit üöÄ online SOLIDWORKS API Help. Ask user to select face In this section, we ask user to select face for Shell feature.\n\u0026#39; Message to show user Dim messageToUser As String\rIn above line, we create a variable to show a messages we want to show before selection. Variable Name: messageToUser Type: String \u0026#39; Update Messages messageToUser = \u0026#34;Please select a Faces.\u0026#34;\rIn above code block, we set value of messageToUser variable. We set messageToUser to \u0026quot;Please select a Faces.\u0026quot; \u0026#39; Show message to user MsgBox messageToUser\rIn above line, we show the message to user. Below image shows the message for Face selection to the user. \u0026#39; Loop until we complete our selection While swObject Is Nothing Wend\rIn above line, we create another While loop. This loops continues to run until we select the our Face for Shell feature. Reference: üöÄ VBA Looping article from this website. \u0026#39; Local integer for loop Dim i As Integer\rIn above line, we create a variable as a counter. Variable Name: i Type: Integer \u0026#39; Loop until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Next\rIn above line, we create a For loop. This loops start from i = 1 to number of objects we select. \u0026#39; If the selection type is face If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelFACES Then \u0026#39; Set the Solidworks Entity object to feature Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) Else \u0026#39; Inform user to select a Face MsgBox \u0026#34;Please select a Face.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If\rIn above code block, we use üöÄ IF/ElseIf statement with conditions. The üöÄ IF statement is True when selected object is type of SOLIDWORKS Face. If selected object is not type of SOLIDWORKS Face then üöÄ Else statement code runs. When we select Model view, then selected object is SOLIDWORKS Face. When we select from Feature Tree, then select object is SOLIDWORKS Body Feature. {: .notice}\n\u0026#39; Set the Solidworks Entity object to feature Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1)\rWhen üöÄ IF statement is True we run above line. In above line, we set the object inside array. Array of SOLIDWORKS Entities = swObjects Indexed Entity Object = swObjects[selectItems] Indexed Entity Object value set by GetSelectedObject6() method. GetSelectedObject6() method is part of SOLIDWORKS Selection Manager. Reference: Please visit üöÄ online Solidworks API Help. \u0026#39; Inform user to select a Face MsgBox \u0026#34;Please select a Face.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True\rWhen üöÄ Else statement is True we execute run above lines. 1st Line: We show a message to user to select Feature from Feature Tree. 2nd Line: After that we clear our selection. DoEvents\rAfter For loop end, we have a call for DoEvents function. This function repeats the While loop until we complete Face selection. \u0026#39; Clear previous selection swDoc.ClearSelection2 True\rIn above line. we clear previous selection. Mark selected Entities In previous section, we complete our selection.\nIn this section, we complete Select and Mark entities correctly our Face.\n\u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData\rIn above line, we create SOLIDWORKS Select Data for current SOLIDWORKS Entity object. \u0026#39; For shell face, set mark to 1 swSelData.Mark = 1\rIn above lines, we set Mark to 1.\nFor Shell feature, Mark values will be 1.\nReference: Please visit üöÄ InsertFeatureShell Method in SOLIDWORS API Help.\n\u0026#39; Select the current entity swObject.Select4 True, swSelData\rIn above line, we select the object. We select it by using Select4 method of SOLIDWORKS Entity object. This method takes 2 arguments. Append - True appends the entity to the selection list, False replaces the selection list with this entity. Data - Pointer to the ISelectData object. We use following values as parameter. Append - True Data - swSelData Get unit Conversion factors In this section we get unit Conversion factors.\n\u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select\rI have already explained about this in previous üöÄ Solidworks Macro - Fix Unit Issue article in this website. Please visit üöÄ Solidworks Macro - Fix Unit Issue article for more details. Get Shell Thickness In this section, we get get the Shell Thickness from user.\n\u0026#39; Variable to Shell thickness Dim shellThickness As String\rIn above line, we create a variable as a counter. Variable Name: shellThickness Type: String \u0026#39; Getting Shell thickness from user shellThickness = InputBox(\u0026#34;Please select Shell Thickness.\u0026#34;) * LengthConversionFactor\rIn above line of code we are doing 3 steps in one line. Those 3 steps are explained below.\nStep 1 - Getting Shell Thickness from user. Below image shows the message for Shell Thickness to the user. Step 2 - Convert input spacing as per document unit system. Step 3 - Assigned converted value to shellThickness property. Create Shell feature In this section, we create Shell feature.\n\u0026#39; Create Shell feature swDoc.InsertFeatureShell shellThickness, False\rIn above line of code we create Shel Feature by InsertFeatureShell method.\nInsertFeatureShell method is part of swDoc variable i.e. ModelDoc2 object.\nThis InsertFeatureShell method takes following parameters as explained:\nThickness - Shell thickness in meters. Outward - True for outside, False for inside. Return Value : This InsertFeatureShell method did not return any value.\nIn our code, I have used following values:\nParameter Name Value Used Thickness shellThickness Outward False Reference: For more details about InsertFeatureShell Method: üöÄ online Solidworks API Help for InsertFeatureShell Method.\nFinal work In this section, after creating Shell Feature, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Shell Feature with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":152,"permalink":"/solidworks-vba-macros/create-shell/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article I want to:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCreate Shell feature\u003c/li\u003e\n\u003cli\u003eFrom VBA Macro\u003c/li\u003e\n\u003cli\u003eWithout using Userforms.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThis method is \u003cem\u003e\u003cstrong\u003emost updated\u003c/strong\u003e\u003c/em\u003e method, so \u003cem\u003e\u003cstrong\u003euse this method\u003c/strong\u003e\u003c/em\u003e if you want to create a new \u003cstrong\u003eShell Feature\u003c/strong\u003e quickly.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Create Shell"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of Wrap feature in SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to create a new Wrap Feature quickly.\nResults We Can Get After running our macro we successfully create Wrap feature as a result.\nBelow image shows the result we get.\nWe create Wrap Feature in following steps in general.\nAsk user to select Sketch. Ask user to select Faces. Ask for Wrap Thickness. To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Wrap feature from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for creating Wrap Feature.\nOption Explicit \u0026#39; Main program for Wrap Sub main() \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr \u0026#39; Set Solidworks Selection Manager variable Set swSelMgr = swDoc.SelectionManager \u0026#39; Array of Solidworks Entities Dim swObjects(1 To 2) As SldWorks.Entity \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity \u0026#39; Local variable for selection Dim selectItems As Integer selectItems = 1 \u0026#39; Loop till we select all entities While selectItems \u0026lt;= 2 \u0026#39; Message to show user Dim messageToUser As String \u0026#39; Update Messages Select Case selectItems Case 1 messageToUser = \u0026#34;Please select a Sketch.\u0026#34; Case 2 messageToUser = \u0026#34;Please select a Face.\u0026#34; End Select \u0026#39; Show message to user MsgBox messageToUser \u0026#39; Loop until we complete our selection While swObjects(selectItems) Is Nothing \u0026#39; Local integer for loop Dim i As Integer \u0026#39; Looping until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Select Case selectItems Case 1 \u0026#39; If the selection type Sketch If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelSKETCHES Then \u0026#39; Set the Solidworks Entity object to Sketch Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) Else \u0026#39; Inform user to select a sketch MsgBox \u0026#34;Please select sketch from Feature tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If Case 2 \u0026#39; If the selection type is face If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelFACES Then \u0026#39; Set the Solidworks Entity object to face Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) Else \u0026#39; Inform user to select a Face MsgBox \u0026#34;Please select a Face.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If End Select Next DoEvents Wend \u0026#39; Clear selection swDoc.ClearSelection2 True \u0026#39; Increase the selection count selectItems = selectItems + 1 Wend \u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData \u0026#39; Local variable for counter Dim j As Integer j = 1 \u0026#39; Loop till counter is 2 While j \u0026lt; 3 \u0026#39; Set the current instance to Solidworks Entity variable Set swObject = swObjects(j) \u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData \u0026#39; Update Marking as per selected entity Select Case j Case 1 \u0026#39; For sketch, set mark to 4 swSelData.Mark = 4 Case 2 \u0026#39; For face, set mark to 1 swSelData.Mark = 1 End Select \u0026#39; Select the current entity swObject.Select4 True, swSelData j = j + 1 Wend \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39; Variable to hold user input Dim response As String \u0026#39; Getting Wrap thickness from user. response = InputBox(\u0026#34;Please Enter [Wrap thickness]:\u0026#34;) \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; \u0026#39; Clear all selection swDoc.ClearSelection2 True Exit Sub End If \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; \u0026#39; Clear all selection swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Variable for Wrap thickness Dim wrapThickness As Double \u0026#39; Set Wrap thickness wrapThickness = CDbl(response) * LengthConversionFactor \u0026#39; This will handle case for 0 Wrap thickness If wrapThickness = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; \u0026#39; Clear all selection swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Variable for Solidworks Wrap Feature Dim swFeature As SldWorks.Feature \u0026#39; Create Wrap feature Set swFeature = swDoc.FeatureManager.InsertWrapFeature2(swWrapSketchType_e.swWrapSketchType_Engrave, wrapThickness, False, 0, 1) \u0026#39; Check if Wrap feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Wrap feature.\u0026#34;) \u0026#39; Clear all selection swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Erase array data Erase swObjects \u0026#39; View zoom to fit swDoc.ViewZoomtofit2 \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired. We are not creating feature from code but we use existing üöÄ Extrude feature to create Wrap feature. Below image shown prerequisite 3D model for our demo.\nAs shown in above image, there is one Extrude features in our part.\nBase Feature : This is our Base Extrude feature. If you want to create this Extrude features programmatically then please refer to below article.\nüöÄ SOLIDWORKS Macros - Create Extrude/Boss We will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This Wrap Feature VBA macro can be divided into following sections:\nCreate and Initialize required variables Ask user to select entities Mark selected entities Get unit Conversion factors Get Wrap thickness And Validation Create Wrap feature Final work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate and Initialize required variables In this section we create and initialize required variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Main program for Wrap Sub main() End Sub\rIn above line, we create main program for Wrap Feature. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. Inside this section we initialize required variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swApp variable. We use üöÄ IF statement for checking. Condition: swApp Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS is not opened Then we stop our macro here. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Please open a document. Then we stop our macro here. \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr\rPurpose: In above line, we create a variable for Solidworks Selection Manager. Variable Name: swSelMgr Type: SldWorks.SelectionMgr. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Set Solidworks Selection Manager variable Set swSelMgr = swDoc.SelectionManager\rIn above line, we set value of swSelMgr variable. This value is current document\u0026rsquo;s Selection Manager. \u0026#39; Array of Solidworks Entities Dim swObjects(1 To 2) As SldWorks.Entity\rIn above line, we create an üöÄ Array of Solidworks Entities. Variable Name: swObjects Type: SldWorks.Entity Length of Array: (1 To 2) Reference: Please visit For Solidworks Entities: üöÄ online SOLIDWORKS API Help. For Arrays in VBA : üöÄ Array on this website. \u0026#39; Variable for Solidworks Entity Dim swObject As SldWorks.Entity\rPurpose: In above line, we create a variable for selection and marking of Solidworks Entity. Variable Name: swObject Type: SldWorks.Entity Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Local variable for selection Dim selectItems As Integer selectItems = 1\rIn above line, we create a variable for selection and set its value. Variable Name: selectItems Type: Integer Value: 1 Ask user to select Entities In this section, we ask user to select Sketch and Face for Wrap feature.\n\u0026#39; Loop till we select all entities While selectItems \u0026lt;= 2 Wend\rIn above line of code we start a While loop. We loop until selectItems variable\u0026rsquo;s value is equal to 2. Reference: üöÄ VBA Looping article from this website. \u0026#39; Message to show user Dim messageToUser As String\rIn above line, we create a variable to show a messages we want to show before selection. Variable Name: messageToUser Type: String \u0026#39; Update Messages Select Case selectItems Case 1 messageToUser = \u0026#34;Please select a Sketch.\u0026#34; Case 2 messageToUser = \u0026#34;Please select a Face.\u0026#34; End Select\rIn above code block, we use a Select statement to update message. We use the case on selectItems. Case 1: messageToUser update to \u0026quot;Please select a Sketch.\u0026quot; Case 2: messageToUser update to \u0026quot;Please select a Face.\u0026quot; Reference: üöÄ Select statement article of this website. \u0026#39; Show message to user MsgBox messageToUser\rIn above line, we show the message to user. Below image shows the message for Sketch selection to the user. Below image shows the message for Face selection to the user. \u0026#39; Loop until we complete our selection While swObjects(selectItems) Is Nothing Wend\rIn above line, we create another While loop. This loops continues to run until we select the our Sketch and Face for Wrap feature. Reference: üöÄ VBA Looping article from this website. \u0026#39; Local integer for loop Dim i As Integer\rIn above line, we create a variable as a counter. Variable Name: i Type: Integer \u0026#39; Loop until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Next\rIn above line, we create a For loop. This loops start from i = 1 to number of objects we select. \u0026#39; Update Messages Select Case selectItems End Select\rIn above line, we use a Select statement for selection entities. We use the case on selectItems. Reference: üöÄ Select statement article of this website. Case 1 \u0026#39; If the selection type is Sketch If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelSKETCHES Then \u0026#39; Set the Solidworks Entity object to Sketch Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) Else \u0026#39; Inform user to select a Sketch MsgBox \u0026#34;Please select sketch from Feature tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If\rAbove code block we use for Case 1. In above code block, we use üöÄ IF/ElseIf statement with conditions. The üöÄ IF statement is True when selected object is type of SOLIDWORKS Sketch. If selected object is not type of SOLIDWORKS Sketch then üöÄ Else statement code runs. When we select the sketch from Model view, then selected object is SOLIDWORKS Face. When we select the sketch from Feature Tree, then select object is SOLIDWORKS Sketch. {: .notice}\n\u0026#39; Set the Solidworks Entity object to Sketch Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1)\rWhen üöÄ IF statement is True we run above line. In above line, we set the object inside array. Array of SOLIDWORKS Entities = swObjects Indexed Entity Object = swObjects[selectItems] Indexed Entity Object value set by GetSelectedObject6() method. GetSelectedObject6() method is part of SOLIDWORKS Selection Manager. Reference: Please visit üöÄ online Solidworks API Help. \u0026#39; Inform user to select a Sketch MsgBox \u0026#34;Please select sketch from Feature tree.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True\rWhen üöÄ Else statement is True we execute run above lines. 1st Line: We show a message to user to select Sketch from Feature Tree. 2nd Line: After that we clear our selection. Case 2 \u0026#39; If the selection type is face If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelFACES Then \u0026#39; Set the Solidworks Entity object to feature Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1) Else \u0026#39; Inform user to select a Face MsgBox \u0026#34;Please select a Face.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True End If\rAbove code block we use for Case 2. In above line, we use üöÄ IF/Else statement with conditions. üöÄ IF statement is True when selected object is type of SOLIDWORKS Face. If selected object is not type of SOLIDWORKS Face then üöÄ Else statement code runs. \u0026#39; Set the Solidworks Entity object to feature Set swObjects(selectItems) = swSelMgr.GetSelectedObject6(i, -1)\rIn above line, we set the indexed object inside array. Array of SOLIDWORKS Entities = swObjects Indexed Entity Object = swObjects[selectItems] Indexed Entity Object value set by GetSelectedObject6() method. GetSelectedObject6() method is part of SOLIDWORKS Selection Manager. Reference: Please visit üöÄ online Solidworks API Help. \u0026#39; Inform user to select Face MsgBox \u0026#34;Please select a Face.\u0026#34; \u0026#39; Clear selection swDoc.ClearSelection2 True\rWhen üöÄ Else statement is True we execute code given below. 1st Line: We show a message to user to select Face. 2nd Line: We clear our selection. DoEvents\rAfter For loop end, we have a call for DoEvents function. This function repeats the While loop until we complete Sketch and Face selection. \u0026#39; Clear previous selection swDoc.ClearSelection2 True \u0026#39; Increase the selection count selectItems = selectItems + 1\r1st Line: We clear previous selection. 2nd Line: Increment the selectItems count by 1. After increment the selected count we continue our while loop.\nMark selected Entities In previous section, we complete our selection.\nIn this section, we complete Select and Mark entities correctly from our Array.\n\u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData\rPurpose: In above line, we create a variable for Marking of Solidworks Select Data. Variable Name: swSelData Type: SldWorks.SelectData Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Local variable for counter Dim j As Integerj = 1\rIn above line, we create a variable as a counter. Variable Name: j Type: Integer Value: 1 \u0026#39; Loop till counter is 2 While j \u0026lt; 2 Wend\rIn above line, we create a while loop. Condition: that counter value of j should be less than 2. Reference: üöÄ VBA Looping article from this website. \u0026#39; Set the current instance to Solidworks Entity variable Set swObject = swObjects(j)\rIn above line, we set the SOLIDWORKS Entity variable to current object from array. \u0026#39; Create Select data for this entity Set swSelData = swSelMgr.CreateSelectData\rIn above line, we create SOLIDWORKS Select Data for current SOLIDWORKS Entity object. \u0026#39; Update Marking as per selected entity Select Case j End Select\rIn above line of code, we use a Select statement for selection entities. We use the case on j. Reference: üöÄ Select statement article of this website. Case 1 \u0026#39; For sketch, set mark to 4 swSelData.Mark = 4\rAbove code block, we use for Case 4. In above lines, we set Mark to 4. For Wrap feature, Mark values can be follows: Any\u0026hellip; Must be preselected and marked with a value of\u0026hellip; One or more faces on which to place the wrap feature 1 Pull direction entity. 2 2D sketch containing no open contours 4 Reference: Please visit üöÄ InsertWrapFeature2 Method in SOLIDWORS API Help. Case 2 \u0026#39; For face, set mark to 1 swSelData.Mark = 1\rAbove code sample we use for Case 2. In above lines, we update the Mark to 1. For Wrap feature, Mark values can be follows: Any\u0026hellip; Must be preselected and marked with a value of\u0026hellip; One or more faces on which to place the wrap feature 1 Pull direction entity. 2 2D sketch containing no open contours 4 Reference: Please visit üöÄ InsertWrapFeature2 Method in SOLIDWORS API Help. \u0026#39; Select the current entity swObject.Select4 True, swSelData\rIn above line, we select the object. We select it by using Select4 method of SOLIDWORKS Entity object. This method takes 2 arguments. Append - True appends the entity to the selection list, False replaces the selection list with this entity. Data - Pointer to the ISelectData object. We use following values as parameter. Append - True Data - swSelData j = j + 1\rAfter Select statement, we increment the counter variable j by 1.\nGet unit Conversion factors In this section we get unit Conversion factors.\n\u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select\rI have already explained about this in previous üöÄ Solidworks Macro - Fix Unit Issue article in this website. Please visit üöÄ Solidworks Macro - Fix Unit Issue article for more details. Get Wrap thickness And Validation In this section, we get get the Wrap thickness from user and apply some validation on Wrap thickness.\n\u0026#39; Variable to hold user input Dim response As String\rIn above line, we create a variable hold user input. Variable Name: response Type: String \u0026#39; Getting Wrap thickness from user response = InputBox(\u0026#34;Please Enter [Wrap thickness]:\u0026#34;)\rIn above line of code we are doing 2 steps in one line.\nThose 3 steps are explained below.\nStep 1 - Getting Wrap thickness from user. Below image shows the message for Wrap thickness to the user.\nStep 2 - Assigned input value to response variable. \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; \u0026#39; Clear all selection swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check the length of input value. This check will handle case for empty value or cancel operation case. We use üöÄ IF statement for checking.\nCondition: Len(response) = 0\nLen() is pre-build VBA function which check the length of a object. In above cases, we will get 0 value. When this condition is True,\nWe show and üöÄ message window to user. Message: Empty or no value. Please try again. Then we stop our macro here. \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; \u0026#39; Clear all selection swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if the input value is Non-numeric.\nThis check will handle case for Non-numeric values.\nWe use üöÄ IF statement for checking.\nCondition: IsNumeric(response) = False\nIsNumeric() is pre-build VBA function which check if passing object is Numeric or not. In above cases, we will get False value. When this condition is True,\nWe show and üöÄ message window to user. Message: Entered value is Non-numeric. Please try again. Then we stop our macro here. \u0026#39; Variable for Wrap thickness Dim wrapThickness As Double\rIn above line, we create a variable to store Wrap thickness. Variable Name: wrapThickness Type: Double wrapThickness = CDbl(response) * LengthConversionFactor\rIn above line of code we are doing 3 steps in one line.\nThose 3 steps are explained below.\nStep 1 - Converting Wrap thickness from user to Double type.\nStep 2 - Updating converted Wrap thickness as per document unit system.\nStep 3 - Assigned input value to wrapThickness variable.\n\u0026#39; This will handle case for 0 Wrap thickness If wrapThickness = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; \u0026#39; Clear all selection swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if the input value is zero (0). This check will handle case for 0 Wrap thickness. We use üöÄ IF statement for checking. Condition: wrapThickness = 0 When this condition is True,\nWe show and üöÄ message window to user. Message: Entered value must be greater than 0. Please try again. Then we stop our macro here. Create Wrap feature In this section, we create Wrap feature.\n\u0026#39; Variable for Solidworks Wrap Feature Dim swFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Wrap Feature. Variable Name: swFeature Type: SldWorks.Feature Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Create Wrap feature Set swFeature = swDoc.FeatureManager.InsertWrapFeature2(swWrapSketchType_e.swWrapSketchType_Engrave, wrapThickness, False, 0, 1)\rIn above line, we set the value of variable swFeature by InsertWrapFeature2 method.\nThis InsertWrapFeature2 method takes following parameters as explained:\nType - Type of wrap as defined in swWrapSketchType_e:\nMember Description swWrapSketchType_Emboss 0 = Emboss creates a raised feature on the selected face or faces swWrapSketchType_Engrave 1 = Engrave, which appears as Deboss in the user interface, creates an indented feature on the selected face or faces swWrapSketchType_Scribe 2 = Scribe creates an imprint of the sketch contours on the selected face or faces Thickness - Thickness; 0.00001 (thinnest) - 10000 (thickest).\nReverseDir - True to reverse the direction of the wrap, False to not\nMethod - Type of wrap method as defined in swWrapMethods_e:\nMember Description swWrapMethods_Analytical 0 swWrapMethods_SplineSurface 1 MeshFactor - Accuracy of flattened triangle mesh; 1 (lowest) - 10 (highest).\nReturn Value : This InsertWrapFeature2 method return üëâ Feature data object.\nIn our code, I have used following values:\nParameter Name Value Used Type swWrapSketchType_Engrave Thickness wrapThickness ReverseDir False Method 0 MeshFactor 1 Reference: For more details about\nSolidworks Feature Manager details: üöÄ online Solidworks API Help for Solidworks Feature Manager. InsertWrapFeature2 Method: üöÄ online Solidworks API Help for InsertWrapFeature2 Method. \u0026#39; Check if Wrap feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Wrap feature.\u0026#34;) \u0026#39; Clear all selection swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully create *WrapFeature or not. We use üöÄ IF statement for checking. Condition: swFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to create Draft Feature. Then we clear all selection and stop our macro here. Now we run the macro and after running macro we get Wrap feature as shown in below image.\nFinal work In this section, after creating Wrap Feature, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; Erase array data Erase swObjects\rIn above line, we erase data from SOLIDWORKS Entity array. For this we use Erase function in-build in VBA. \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Wrap feature with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":153,"permalink":"/solidworks-vba-macros/create-wrap/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of \u003cstrong\u003eWrap feature\u003c/strong\u003e in \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Create Wrap"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of Scale feature in SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to create a new Scale Feature quickly.\nResults We Can Get After running our macro we successfully create Scale feature as a result.\nBelow image shows the result we get.\nWe create Scale Feature in following steps in general.\nAsk for Scale Factor. To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Scale feature from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for creating Scale Feature.\nOption Explicit \u0026#39; Main program for Scale Feature Sub main() \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Variable to hold user input Dim response As String \u0026#39; Getting Scale Factor from user. response = InputBox(\u0026#34;Please Enter [Scale Factor]:\u0026#34;, \u0026#34;Scale Feature\u0026#34;) \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Variable for Scale Factor Dim scaleFactor As Integer \u0026#39; Set Scale Factor scaleFactor = CInt(response) \u0026#39; This will handle case for 0 Scale Factor If scaleFactor = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Variable for Solidworks Scale feature Dim swFeature As SldWorks.Feature \u0026#39; Create Scale feature Set swFeature = swDoc.FeatureManager.InsertScale(swScaleType_e.swScaleAboutCentroid, True, scaleFactor, 0, 0) \u0026#39; Check if Scale Feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Scale Feature.\u0026#34;) swDoc.ClearSelection2 True Exit Sub End If \u0026#39; View zoom to fit swDoc.ViewZoomtofit2 \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired. We are not creating feature from code but we use existing üöÄ Extrude feature to create Scale feature. Below image shown prerequisite 3D model for our demo.\nAs shown in above image, there is one Extrude features in our part.\nBase Feature : This is our Base Extrude feature. If you want to create this Extrude features programmatically then please refer to below article.\nüöÄ SOLIDWORKS Macros - Create Extrude/Boss We will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This Scale Feature VBA macro can be divided into following sections:\nCreate and Initialize required variables Get Scale Factor And Validation Create Scale feature Final work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate and Initialize required variables In this section we create and initialize required variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Main program for Scale Feature Sub main() End Sub\rIn above line, we create main program for Scale Feature. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. Inside this section we initialize required variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swApp variable. We use üöÄ IF statement for checking. Condition: swApp Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS is not opened Then we stop our macro here. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Please open a document. Then we stop our macro here. Get Scale Factor And Validation In this section, we get get the Scale Factor from user and apply some validation on Scale Factor.\n\u0026#39; Variable to hold user input Dim response As String\rIn above line, we create a variable hold user input. Variable Name: response Type: String \u0026#39; Getting Scale Factor from user response = InputBox(\u0026#34;Please Enter [Scale Factor]:\u0026#34;, \u0026#34;Scale Feature\u0026#34;)\rIn above line of code we are doing 2 steps in one line.\nThose 3 steps are explained below.\nStep 1 - Getting Scale Factor from user. Below image shows the message for Scale Factor to the user.\nStep 2 - Assigned input value to response variable. \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check the length of input value. This check will handle case for empty value or cancel operation case. We use üöÄ IF statement for checking.\nCondition: Len(response) = 0\nLen() is pre-build VBA function which check the length of a object. In above cases, we will get 0 value. When this condition is True,\nWe show and üöÄ message window to user. Message: Empty or no value. Please try again. Then we stop our macro here. \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if the input value is Non-numeric.\nThis check will handle case for Non-numeric values.\nWe use üöÄ IF statement for checking.\nCondition: IsNumeric(response) = False\nIsNumeric() is pre-build VBA function which check if passing object is Numeric or not. In above cases, we will get False value. When this condition is True,\nWe show and üöÄ message window to user. Message: Entered value is Non-numeric. Please try again. Then we stop our macro here. \u0026#39; Variable for Scale Factor Dim scaleFactor As Integer\rIn above line, we create a variable to store Scale Factor. Variable Name: scaleFactor Type: Integer \u0026#39; Set Scale Factor scaleFactor = CInt(response)\rIn above line of code we are doing 2 steps in one line.\nThose 2 steps are explained below.\nStep 1 - Converting Scale Factor from user to Integer type. Step 2 - Assigned input value to scaleFactor variable. \u0026#39; This will handle case for 0 Scale Factor If scaleFactor = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if the input value is zero (0). This check will handle case for 0 Scale Factor. We use üöÄ IF statement for checking. Condition: scaleFactor = 0 When this condition is True,\nWe show and üöÄ message window to user. Message: Entered value must be greater than 0. Please try again. Then we stop our macro here. Create Scale feature In this section, we create Scale feature.\n\u0026#39; Variable for Solidworks Scale Feature Dim swFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Scale Feature. Variable Name: swFeature Type: SldWorks.Feature Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Create Scale feature Set swFeature = swDoc.FeatureManager.InsertScale(swScaleType_e.swScaleAboutCentroid, True, scaleFactor, 0, 0)\rIn above line, we set the value of variable swFeature by InsertScale method.\nThis InsertScale method takes following parameters as explained:\nType - Type of Scale as defined in swScaleType_e:\nMember Description swScaleAboutCentroid 0 swScaleAboutCoordinateSystem 2 swScaleAboutOrigin 1 Uniform - True if scaling should be uniform, False to not\nXscale - X direction scale factor.\nYscale - Y direction scale factor; valid only if Uniform is False.\nZscale - Z direction scale factor; valid only if Uniform is False.\nReturn Value : This InsertScale method return üöÄ Feature data object.\nIn our code, I have used following values:\nParameter Name Value Used Type swScaleType_e.swScaleAboutCentroid Uniform True Xscale scaleFactor Yscale 0 Zscale 0 Reference: For more details about\nSolidworks Feature Manager details: üöÄ online Solidworks API Help for Solidworks Feature Manager. InsertScale Method: üöÄ online Solidworks API Help for InsertScale Method. \u0026#39; Check if Scale Feature creates or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Scale Feature.\u0026#34;) swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully create Scale Feature or not. We use üöÄ IF statement for checking. Condition: swFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to create Scale Feature. Then we clear all selection and stop our macro here. Now we run the macro and after running macro we get Scale feature as shown in below image.\nFinal work In this section, after creating Scale Feature, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Scale feature with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":154,"permalink":"/solidworks-vba-macros/create-scale/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of \u003cstrong\u003eScale feature\u003c/strong\u003e in \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Create Scale"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of Reference Plane in SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to create a new Reference Plane quickly.\nResults We Can Get After running our macro we successfully create Reference Plane as a result.\nBelow image shows the result we get.\nWe create Reference Plane in following steps in general.\nAsk for Distance. To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Reference Plane from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for creating Reference Plane.\nOption Explicit \u0026#39; Main program for Reference Plane Sub main() \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39; Variable to hold user input Dim response As String \u0026#39; Getting Distance from user. response = InputBox(\u0026#34;Please Enter [Distance] from Front Plane:\u0026#34;) \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Variable for Distance Dim distance As Double \u0026#39; Set Distance distance = CDbl(response) * LengthConversionFactor \u0026#39; This will handle case for 0 Distance If distance = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Variable for Solidworks Reference Plane Dim swRefPlane As SldWorks.RefPlane \u0026#39; Create Reference Plane Set swRefPlane = swDoc.FeatureManager.InsertRefPlane(swRefPlaneReferenceConstraints_e.swRefPlaneReferenceConstraint_Distance, distance, 0, 0, 0, 0) \u0026#39; Check if Reference Plane creates or not If swRefPlane Is Nothing Then MsgBox (\u0026#34;Failed to create Reference Plane.\u0026#34;) swDoc.ClearSelection2 True Exit Sub End If \u0026#39; View zoom to fit swDoc.ViewZoomtofit2 \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired. Since we are creating new part, there are no feature to create.\nWe will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This Reference Plane VBA macro can be divided into following sections:\nCreate and Initialize required variables Get Distance And Validation Get Distance And Validation Create Reference Plane Final work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate and Initialize required variables In this section we create and initialize required variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Main program for Scale Feature Sub main() End Sub\rIn above line, we create main program for Scale Feature. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. Inside this section we initialize required variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swApp variable. We use üöÄ IF statement for checking. Condition: swApp Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS is not opened Then we stop our macro here. \u0026#39; Variable for storing default part location Dim defaultTemplate As String\rPurpose: In above line, we create a variable for storing default part location. Variable Name: defaultTemplate Type: String \u0026#39; Setting value of variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn above line, we set value of defaultTemplate variable. This value is set to \u0026ldquo;Default part template\u0026rdquo;. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Set Solidworks document variable to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn above line, we set value of swDoc variable. This value is new part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened. Please open a document.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Please open a document. Then we stop our macro here. Get unit Conversion factors In this section we get unit Conversion factors.\n\u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select\rI have already explained about this in previous üöÄ Solidworks Macro - Fix Unit Issue article in this website. Please visit üöÄ Solidworks Macro - Fix Unit Issue article for more details. Get Distance And Validation In this section, we get get the Distance from user and apply some validation on Distance.\n\u0026#39; Variable to hold user input Dim response As String\rIn above line, we create a variable hold user input. Variable Name: response Type: String \u0026#39; Getting Distance from user response = InputBox(\u0026#34;Please Enter [Distance] from Front Plane:\u0026#34;)\rIn above line of code we are doing 2 steps in one line.\nThose 2 steps are explained below.\nStep 1 - Getting Distance from user. Below image shows the message for Distance to the user.\nStep 2 - Assigned input value to response variable. \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check the length of input value. This check will handle case for empty value or cancel operation case. We use üöÄ IF statement for checking.\nCondition: Len(response) = 0\nLen() is pre-build VBA function which check the length of a object. In above cases, we will get 0 value. When this condition is True,\nWe show and üöÄ message window to user. Message: Empty or no value. Please try again. Then we stop our macro here. \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if the input value is Non-numeric.\nThis check will handle case for Non-numeric values.\nWe use üöÄ IF statement for checking.\nCondition: IsNumeric(response) = False\nIsNumeric() is pre-build VBA function which check if passing object is Numeric or not. In above cases, we will get False value. When this condition is True,\nWe show and üöÄ message window to user. Message: Entered value is Non-numeric. Please try again. Then we stop our macro here. \u0026#39; Variable for distance Dim distance As Double\rIn above line, we create a variable to store Distance. Variable Name: distance Type: Double \u0026#39; Set Distance distance = CDbl(response)\rIn above line of code we are doing 2 steps in one line.\nThose 3 steps are explained below.\nStep 1 - Converting Distance from user to Double type. Step 2 - Assigned input value to distance variable. \u0026#39; This will handle case for 0 Distance If scaleFactor = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if the input value is zero (0). This check will handle case for 0 Distance. We use üöÄ IF statement for checking. Condition: distance = 0 When this condition is True,\nWe show and üöÄ message window to user. Message: Entered value must be greater than 0. Please try again. Then we stop our macro here. Create Reference Plane In this section, we create Reference Plane.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rPurpose: In above line, we create a variable Boolean values or function. Variable Name: BoolStatus Type: Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select Front plane by SelectByID2 method. If we succeed in selecting Front plane, we get True otherwise we get False. \u0026#39; Variable for Solidworks Reference Plane Dim swRefPlane As SldWorks.RefPlane\rPurpose: In above line, we create a variable for Solidworks Reference Plane. Variable Name: swRefPlane Type: SldWorks.RefPlane Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Create Reference Plane Set swRefPlane = swDoc.FeatureManager.InsertRefPlane(swRefPlaneReferenceConstraints_e.swRefPlaneReferenceConstraint_Distance, distance, 0, 0, 0, 0)\rIn above line, we set the value of variable swRefPlane by InsertRefPlane method.\nThis InsertRefPlane method takes following parameters as explained:\nFirstConstraint - First constraint as defined in swRefPlaneReferenceConstraints_e:\nMember Description swRefPlaneReferenceConstraint_Angle 16 swRefPlaneReferenceConstraint_Coincident 4 swRefPlaneReferenceConstraint_Distance 8 swRefPlaneReferenceConstraint_MidPlane 128 swRefPlaneReferenceConstraint_OptionFlip 256 swRefPlaneReferenceConstraint_OptionOriginOnCurve 512 swRefPlaneReferenceConstraint_OptionProjectAlongSketchNormal 2056 swRefPlaneReferenceConstraint_OptionProjectToNearestLocation 1028 swRefPlaneReferenceConstraint_OptionReferenceFlip 8192 swRefPlaneReferenceConstraint_Parallel 1 swRefPlaneReferenceConstraint_ParallelToScreen 4096 swRefPlaneReferenceConstraint_Perpendicular 2 swRefPlaneReferenceConstraint_Project 64 swRefPlaneReferenceConstraint_Tangent 32 FirstConstraintAngleOrDistance - Angle or distance of the first constraint.\nSecondConstraint - Second constraint as defined in swRefPlaneReferenceConstraints_e:\nMember Description swRefPlaneReferenceConstraint_Angle 16 swRefPlaneReferenceConstraint_Coincident 4 swRefPlaneReferenceConstraint_Distance 8 swRefPlaneReferenceConstraint_MidPlane 128 swRefPlaneReferenceConstraint_OptionFlip 256 swRefPlaneReferenceConstraint_OptionOriginOnCurve 512 swRefPlaneReferenceConstraint_OptionProjectAlongSketchNormal 2056 swRefPlaneReferenceConstraint_OptionProjectToNearestLocation 1028 swRefPlaneReferenceConstraint_OptionReferenceFlip 8192 swRefPlaneReferenceConstraint_Parallel 1 swRefPlaneReferenceConstraint_ParallelToScreen 4096 swRefPlaneReferenceConstraint_Perpendicular 2 swRefPlaneReferenceConstraint_Project 64 swRefPlaneReferenceConstraint_Tangent 32 SecondConstraintAngleOrDistance - Angle or distance of the second constraint.\nThirdConstraint - Third constraint as defined in swRefPlaneReferenceConstraints_e:\nMember Description swRefPlaneReferenceConstraint_Angle 16 swRefPlaneReferenceConstraint_Coincident 4 swRefPlaneReferenceConstraint_Distance 8 swRefPlaneReferenceConstraint_MidPlane 128 swRefPlaneReferenceConstraint_OptionFlip 256 swRefPlaneReferenceConstraint_OptionOriginOnCurve 512 swRefPlaneReferenceConstraint_OptionProjectAlongSketchNormal 2056 swRefPlaneReferenceConstraint_OptionProjectToNearestLocation 1028 swRefPlaneReferenceConstraint_OptionReferenceFlip 8192 swRefPlaneReferenceConstraint_Parallel 1 swRefPlaneReferenceConstraint_ParallelToScreen 4096 swRefPlaneReferenceConstraint_Perpendicular 2 swRefPlaneReferenceConstraint_Project 64 swRefPlaneReferenceConstraint_Tangent 32 ThirdConstraintAngleOrDistance - Angle or distance of the third constraint.\nReturn Value : This InsertRefPlane method return üöÄ Reference Plane data object.\nIn our code, I have used following values:\nParameter Name Value Used FirstConstraint swRefPlaneReferenceConstraints_e.swRefPlaneReferenceConstraint_Distance FirstConstraintAngleOrDistance distance SecondConstraint 0 SecondConstraintAngleOrDistance 0 ThirdConstraint 0 ThirdConstraintAngleOrDistance 0 Reference: For more details about\nSolidworks Feature Manager details: üöÄ online Solidworks API Help for Solidworks Feature Manager. InsertRefPlane Method: üöÄ online Solidworks API Help for InsertRefPlane Method. \u0026#39; Check if Reference Plane creates or not If swRefPlane Is Nothing Then MsgBox (\u0026#34;Failed to create Reference Plane.\u0026#34;) swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully create Reference Plane or not. We use üöÄ IF statement for checking. Condition: swRefPlane Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to create Reference Plane. Then we clear all selection and stop our macro here. Now we run the macro and after running macro we get Reference Plane as shown in below image.\nFinal work In this section, after creating Reference Plane, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. Error-Solutions After posting this article, I got to know that code sample is not working for already opened document.\nI thought writing a section for these error will be a better idea or future.\nBelow I list out the error message we got and their probable solution(s).\nError Message 1 Solidworks document is opened error message. Image of this error is shown below.\nCause: Cause of this error is not setting File Location setting for Document Templates.\nPlease see below image for detail.\nAfter setting Document Templates path, this message will not come.\nError Message 2 Failed to create Reference Plane error message. Image of this error is shown below.\nCause: There might be 2 causes for this error.\nCode for getting Distance from user is commented. Name of selected plane is different. In case of reason 1, I can\u0026rsquo;t do anything. Commented code did not executed\nIn case of reason 2, you need to confirm plane name first, as I shown in below image.\nAs shown in above image, in my default part, plane name is \u0026ldquo;Front\u0026rdquo;.\nHence for selecting this plane, I use below code.\n\u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIf your default part have plane name as shown in below image.\nThen you need to use below code for selecting Front Plane.\n\u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rError 3 If you are using code sample provided in this article into an already open document.\nAnd hoping that you will get the result of new Reference Plane in opened document.\nThen I suggest you to know few things:\nThis code sample, create new part and in that new part it create reference plane. If you are in this error section, I seriously want you to read all articles I had written. Then you will understand the code and change it to fit your need. If you still want to create new Reference plane in already opened document, do following.\n\u0026#39; Variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rReplace above code, with below code in your macro.\n\u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rI hope this will work.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Reference Plane with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":155,"permalink":"/solidworks-vba-macros/create-reference-plane/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of \u003cstrong\u003eReference Plane\u003c/strong\u003e in \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Create Reference Plane"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of Reference Axis in SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to create a new Reference Axis quickly.\nResults We Can Get After running our macro we successfully create Reference Axis as a result.\nBelow image shows the result we get.\nWe create Reference Axis in following steps in general.\nCreate and Initialize required variables Create Reference Axis Final Work To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Reference Axis from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for creating Reference Axis.\nOption Explicit \u0026#39; Main program for Reference Axis Sub main() \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;Solidworks is not opened\u0026#34;) Exit Sub End If \u0026#39; Variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Check if Front Plane is selected or not If BoolStatus = False Then MsgBox (\u0026#34;Failed to select [Front Plane].\u0026#34;) Exit Sub End If \u0026#39; Selecting Top Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Top Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Check if Top Plane is selected or not If BoolStatus = False Then MsgBox (\u0026#34;Failed to select [Top Plane].\u0026#34;) Exit Sub End If \u0026#39; Create Reference Axis BoolStatus = swDoc.InsertAxis2(True) \u0026#39; Check if Reference Axis creates or not If BoolStatus = False Then MsgBox (\u0026#34;Failed to create Reference Axis.\u0026#34;) swDoc.ClearSelection2 True Exit Sub End If \u0026#39; View zoom to fit swDoc.ViewZoomtofit2 \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired. Since we are creating new part, there are no feature to create.\nWe will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This Reference Axis VBA macro can be divided into following sections:\nCreate and Initialize required variables Create Reference Axis Final work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate and Initialize required variables In this section we create and initialize required variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Main program for Scale Feature Sub main() End Sub\rIn above line, we create main program for Scale Feature. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. Inside this section we initialize required variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swApp variable. We use üöÄ IF statement for checking. Condition: swApp Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS is not opened Then we stop our macro here. \u0026#39; Variable for storing default part location Dim defaultTemplate As String\rPurpose: In above line, we create a variable for storing default part location. Variable Name: defaultTemplate Type: String \u0026#39; Setting value of variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn above line, we set value of defaultTemplate variable. This value is set to \u0026ldquo;Default part template\u0026rdquo;. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Set Solidworks document variable to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn above line, we set value of swDoc variable. This value is new part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. Create Reference Axis In this section, we create Reference Axis.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rPurpose: In above line, we create a variable Boolean values or function. Variable Name: BoolStatus Type: Boolean \u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select Front plane by SelectByID2 method. If we succeed in selecting Front plane, we get True otherwise we get False. \u0026#39; Check if Front Plane is selected or not If BoolStatus = False Then MsgBox (\u0026#34;Failed to select [Front Plane].\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully selected Front Plane or not. We use üöÄ IF statement for checking. Condition: BoolStatus = False When this condition is True, We show and üöÄ message window to user. Message: Failed to select [Front Plane]. Then we stop our macro here. \u0026#39; Selecting Top Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Top Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select Top plane by SelectByID2 method. If we succeed in selecting Top plane, we get True otherwise we get False. \u0026#39; Check if Top Plane is selected or not If BoolStatus = False Then MsgBox (\u0026#34;Failed to select [Top Plane].\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully selected Top Plane or not. We use üöÄ IF statement for checking. Condition: BoolStatus = False When this condition is True, We show and üöÄ message window to user. Message: Failed to select [Top Plane]. Then we stop our macro here. \u0026#39; Create Reference Axis BoolStatus = swDoc.InsertAxis2(True)\rIn above line, we insert Reference Axis by InsertAxis2 method from Solidworks Document Object.\nThis InsertAxis2 method takes following parameters as explained:\nAutoSize - True if axis is to be automatically sized, False if not. Return Value : This InsertAxis2 method return True if the Reference Axis is created successfully, False if not.\nIn our code, I have used following values:\nParameter Name Value Used AutoSize True Reference: For more details about\nSolidworks Feature Manager details: üöÄ online Solidworks API Help for Solidworks Feature Manager. InsertAxis2 Method: üöÄ online Solidworks API Help for InsertAxis2 Method. \u0026#39; Check if Reference Axis creates or not If BoolStatus = False Then MsgBox (\u0026#34;Failed to create Reference Axis.\u0026#34;) swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully create Reference Axis or not. We use üöÄ IF statement for checking. Condition: BoolStatus = False When this condition is True, We show and üöÄ message window to user. Message: Failed to create Reference Axis. Then we clear all selection and stop our macro here. Now we run the macro and after running macro we get Reference Axis as shown in below image.\nFinal work In this section, after creating Reference Axis, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. Error-Solutions After posting this article, I got to know that code sample is not working for already opened document.\nI thought writing a section for these error will be a better idea or future.\nBelow I list out the error message we got and their probable solution(s).\nError Message 1 Solidworks document is opened error message. Image of this error is shown below.\nCause: Cause of this error is not setting File Location setting for Document Templates.\nPlease see below image for detail.\nAfter setting Document Templates path, this message will not come.\nError Message 2 Failed to create Reference Axis error message. Image of this error is shown below.\nCause: There might be following case for this error.\nName of selected plane is different. You need to confirm plane name first, as I shown in below image.\nAs shown in above image, plane name is \u0026ldquo;Front\u0026rdquo;.\nHence for selecting this plane, I use below code.\n\u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIf your default part have plane name as shown in below image.\nThen you need to use below code for selecting Front Plane.\n\u0026#39; Selecting Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rError 3 If you are using code sample provided in this article into an already open document.\nAnd hoping that you will get the result of new Reference Plane in opened document.\nThen I suggest you to know few things:\nThis code sample, create new part and in that new part it create Reference Axis. If you are in this error section, I seriously want you to read all articles I had written. Then you will understand the code and change it to fit your need. If you still want to create new Reference Axis in already opened document, do following.\n\u0026#39; Variable for storing default part location Dim defaultTemplate As String \u0026#39; Setting value of variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Setting Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rReplace above code, with below code in your macro.\n\u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rI hope this will work.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Reference Axis with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":156,"permalink":"/solidworks-vba-macros/create-reference-axis/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of \u003cstrong\u003eReference Axis\u003c/strong\u003e in \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Create Reference Axis"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of Reference Co-Ordinate in SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to create a new Reference Co-Ordinate quickly.\nResults We Can Get After running our macro we successfully create Reference Co-Ordinate as a result.\nBelow image shows the result we get.\nWe create Reference Co-Ordinate in following steps in general.\nAsk User to select an Entity in Model. Create Reference Co-Ordinate on selected Entity. To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Reference Co-Ordinate from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for creating Reference Co-Ordinate.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Reference Co-ordinate Dim swFeature As SldWorks.Feature \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr \u0026#39; Variable for Solidworks Object Dim swObject As Object \u0026#39; Program to create Reference Co-ordinate Sub main() \u0026#39; Set Solidworks Application variable Set swApp = Application.SldWorks \u0026#39; Check if SOLIDWORKS is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks document variable Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks Selection Manager Set swSelMgr = swDoc.SelectionManager \u0026#39; Inform user to select a Point for Reference Co-ordinate. MsgBox \u0026#34;Please select a Point for Reference Co-ordinate.\u0026#34; \u0026#39; Loop until we select an Object While swObject Is Nothing \u0026#39; Local integer for loop Dim i As Integer \u0026#39; Looping until we select an Object For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) \u0026#39; If the selection type is a Sketch If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEXTSKETCHPOINTS Then \u0026#39; Set the Solidworks Entity object to selected point Set swObject = swSelMgr.GetSelectedObject6(i, -1) End If Next DoEvents Wend \u0026#39; Create Reference CoOrdinate feature Set swFeature = swDoc.FeatureManager.CreateCoordinateSystem(swObject, Nothing, Nothing, Nothing) \u0026#39; Check if Reference Co-ordinate created or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Reference Co-ordinate.\u0026#34;) Exit Sub End If \u0026#39; View zoom to fit swDoc.ViewZoomtofit2 \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired. Since we are creating new part, there are no feature to create.\nWe will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This Reference Co-Ordinate VBA macro can be divided into following sections:\nCreate and Initialize required variables Ask user to select a Point Create Reference Co-Ordinate Final work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate and Initialize required variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Reference Co-ordinate Dim swFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Reference Co-ordinate. Variable Name: swFeature Type: SldWorks.Feature Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr\rPurpose: In above line, we create a variable for Solidworks Selection Manager. Variable Name: swSelMgr Type: SldWorks.SelectionMgr. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Object Dim swObject As Object\rPurpose: In above line, we create a variable for Object. Variable Name: swObject Type: Object These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Main program for Reference Co-ordinate Sub main() End Sub\rIn above line, we create main program for Reference Co-ordinate. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swApp variable. We use üöÄ IF statement for checking. Condition: swApp Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS is not opened Then we stop our macro here. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Selection Manager variable Set swSelMgr = swDoc.SelectionManager\rIn above line, we set value of swSelMgr variable. This value is current document\u0026rsquo;s Selection Manager. Ask user to select a Point Inside this section we ask user to select a Point and.\n\u0026#39; Inform user to select an Object for Co-Ordinate feature. MsgBox \u0026#34;Please select an Point for Co-Ordinate feature.\u0026#34;\rIn above line, we show a messages to user. Below image shows the message for select an Object to the user. \u0026#39; Loop until we complete our selection While swObjects(selectItems) Is Nothing Wend\rIn above line, we create another While loop. This loops continues to run until we select the our Feature and Edge for circular pattern. Reference: üöÄ VBA Looping article from this website. \u0026#39; Local integer for loop Dim i As Integer\rIn above line, we create a variable as a counter. Variable Name: i Type: Integer \u0026#39; Loop until we select For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Next\rIn above line, we create a For loop. This loops start from i = 1 to number of objects we select. \u0026#39; If the selection type is a Sketch If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEXTSKETCHPOINTS Then \u0026#39; Set the Solidworks Entity object to selected point Set swObject = swSelMgr.GetSelectedObject6(i, -1) End If\rIn above code block, we use üöÄ IF statement with conditions. The üöÄ IF statement is True when selected object is type of SOLIDWORKS Pount. DoEvents\rAfter For loop end, we have a call for DoEvents function. This function repeats the While loop until we complete Feature or Edge selection. Create Reference Co-Ordinate In this section, we create Reference Co-Ordinate.\n\u0026#39; Create Reference CoOrdinate feature Set swFeature = swDoc.FeatureManager.CreateCoordinateSystem(swObject, Nothing, Nothing, Nothing\rIn above line, we set the value of variable swFeature by CreateCoordinateSystem method.\nThis CreateCoordinateSystem method takes following parameters as explained:\nOriginPointEntity - Entity for the coordinate system origin. XAxisEntities - Array of entities for the X axis. YAxisEntities - Array of entities for the Y axis. ZAxisEntities - Array of entities for the Z axis. Return Value : This CreateCoordinateSystem method return üëâ Feature data object.\nIn our code, I have used following values:\nParameter Name Value Used OriginPointEntity swObject XAxisEntities Nothing YAxisEntities Nothing ZAxisEntities Nothing Reference: For more details about\nSolidworks Feature Manager details: üöÄ online Solidworks API Help for Solidworks Feature Manager. CreateCoordinateSystem Method: üöÄ online Solidworks API Help for CreateCoordinateSystem Method. \u0026#39; Check if Reference Co-ordinate created or not If swFeature Is Nothing Then MsgBox (\u0026#34;Failed to create Reference Co-ordinate.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully create Reference Co-ordinate or not. We use üöÄ IF statement for checking. Condition: swFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to create Reference Co-ordinate. Then we stop our macro here. Now we run the macro and after running macro we get Reference Co-ordinate as shown in below image.\nFinal work In this section, after creating Reference Co-ordinate, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Reference Co-ordinate with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":157,"permalink":"/solidworks-vba-macros/create-reference-coordinate/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of \u003cstrong\u003eReference Co-Ordinate\u003c/strong\u003e in \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Create Reference Co-Ordinate"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of Reference Point in SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to create a new Reference Point quickly.\nResults We Can Get After running our macro we successfully create Reference Point as a result.\nBelow image shows the result we get.\nWe create Reference Point in following steps in general.\nAsk User to select an Entity in Model. Ask User for Number of Point. Create Reference Point on selected Entity. To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Reference Point from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for creating Reference Point.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Reference Point Dim swFeature As Variant \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr \u0026#39; Variable for Solidworks Object Dim swObject As Object \u0026#39; Program to create Reference Point Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Check if SOLIDWORKS is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if SOLIDWORKS document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS document is not opened.\u0026#34;) Exit Sub End If \u0026#39; Set Solidworks Selection Manager variable Set swSelMgr = swDoc.SelectionManager \u0026#39; Inform user to select a Sketch for Reference Point MsgBox \u0026#34;Please select a Sketch for Reference Point.\u0026#34; \u0026#39; Loop until we select an object While swObject Is Nothing \u0026#39; Local integer for loop Dim i As Integer \u0026#39; Looping until we select an Object For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) \u0026#39; If the selection type Object If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEXTSKETCHSEGS Then \u0026#39; Set the Solidworks object Set swObject = swSelMgr.GetSelectedObject6(i, -1) End If Next DoEvents Wend \u0026#39; Variable to store Number of Points Dim response As String response = InputBox(\u0026#34;Number of Points:\u0026#34;, \u0026#34;Reference Point\u0026#34;, \u0026#34;1\u0026#34;) \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; Exit Sub End If \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; Exit Sub End If \u0026#39; Variable to store Number of Points Dim numberOfPoints As Double numberOfPoints = CDbl(response) \u0026#39; This will handle case for 0 points If numberOfPoints = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; Exit Sub End If \u0026#39; Create Reference Point swFeature = swDoc.FeatureManager.InsertReferencePoint(swRefPointAlongCurve, swRefPointAlongCurveEvenlyDistributed, 0, numberOfPoints) \u0026#39; Check if Reference Point created or not If swFeature(0) Is Nothing Then MsgBox (\u0026#34;Failed to create Reference Point.\u0026#34;) Exit Sub End If \u0026#39; View zoom to fit swDoc.ViewZoomtofit2 \u0026#39; Clear all selection swDoc.ClearSelection2 True End Sub\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired. Since we are creating new part, there are no feature to create.\nWe will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This Reference Point VBA macro can be divided into following sections:\nCreate and Initialize required variables Ask user to select an Entity Get Number of Point And Validation Create Reference Point Final work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate and Initialize required variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Reference Point Dim swFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Reference Point. Variable Name: swFeature Type: SldWorks.Feature Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Selection Manager Dim swSelMgr As SldWorks.SelectionMgr\rPurpose: In above line, we create a variable for Solidworks Selection Manager. Variable Name: swSelMgr Type: SldWorks.SelectionMgr. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Object Dim swObject As Object\rPurpose: In above line, we create a variable for Object. Variable Name: swObject Type: Object These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Main program for Reference Point Sub main() End Sub\rIn above line, we create main program for Reference Point. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Check if Solidworks is opened or not If swApp Is Nothing Then MsgBox (\u0026#34;SOLIDWORKS is not opened\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swApp variable. We use üöÄ IF statement for checking. Condition: swApp Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS is not opened Then we stop our macro here. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Selection Manager variable Set swSelMgr = swDoc.SelectionManager\rIn above line, we set value of swSelMgr variable. This value is current document\u0026rsquo;s Selection Manager. Ask user to select an Entity Inside this section we ask user to select an Entity.\n\u0026#39; Inform user to select an Object for Point feature. MsgBox \u0026#34;Please select a Sketch for Reference Point.\u0026#34;\rIn above line, we show a messages to user. Below image shows the message for select an Object to the user. \u0026#39; Loop until we complete our selection While swObjects(selectItems) Is Nothing Wend\rIn above line, we create another While loop. This loops continues to run until we select the our Feature and Edge for circular pattern. Reference: üöÄ VBA Looping article from this website. \u0026#39; Local integer for loop Dim i As Integer\rIn above line, we create a variable as a counter. Variable Name: i Type: Integer \u0026#39; Looping until we select an Object For i = 1 To swSelMgr.GetSelectedObjectCount2(-1) Next\rIn above line, we create a For loop. This loops start from i = 1 to number of objects we select. \u0026#39; If the selection type Object If swSelMgr.GetSelectedObjectType3(i, -1) = swSelectType_e.swSelEXTSKETCHSEGS Then \u0026#39; Set the Solidworks object Set swObject = swSelMgr.GetSelectedObject6(i, -1) End If\rIn above code block, we use üöÄ IF statement with conditions. The üöÄ IF statement is True when selected object is type of SOLIDWORKS Pount. DoEvents\rAfter For loop end, we have a call for DoEvents function. This function repeats the While loop until we complete Feature or Edge selection. Get Number of Point And Validation In this section, ask user for Number of Point.\n\u0026#39; Variable to hold user input Dim response As String\rIn above line, we create a variable hold user input. Variable Name: response Type: String \u0026#39; Getting Number of Points from user response = InputBox(\u0026#34;Number of Points:\u0026#34;, \u0026#34;Reference Point\u0026#34;, \u0026#34;1\u0026#34;)\rIn above line of code we are doing 2 steps in one line.\nThose 3 steps are explained below.\nStep 1 - Getting Number of Points from user. Below image shows the message for Number of Points to the user.\nStep 2 - Assigned input value to response variable. \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check the length of input value. This check will handle case for empty value or cancel operation case. We use üöÄ IF statement for checking.\nCondition: Len(response) = 0\nLen() is pre-build VBA function which check the length of a object. In above cases, we will get 0 value. When this condition is True,\nWe show and üöÄ message window to user. Message: Empty or no value. Please try again. Then we stop our macro here. \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if the input value is Non-numeric.\nThis check will handle case for Non-numeric values.\nWe use üöÄ IF statement for checking.\nCondition: IsNumeric(response) = False\nIsNumeric() is pre-build VBA function which check if passing object is Numeric or not. In above cases, we will get False value. When this condition is True,\nWe show and üöÄ message window to user. Message: Entered value is Non-numeric. Please try again. Then we stop our macro here. \u0026#39; Variable for Number of Points Dim numberOfPoints As Double\rIn above line, we create a variable to store Number of Points. Variable Name: numberOfPoints Type: Double \u0026#39; Set Number of Points numberOfPoints = CDbl(response)\rIn above line of code we are doing 2 steps in one line.\nThose 2 steps are explained below.\nStep 1 - Converting Number of Points from user to Double type. Step 2 - Assigned input value to numberOfPoints variable. \u0026#39; This will handle case for 0 points If numberOfPoints = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if the input value is zero (0). This check will handle case for 0 Number of Points. We use üöÄ IF statement for checking. Condition: numberOfPoints = 0 When this condition is True,\nWe show and üöÄ message window to user. Message: Entered value must be greater than 0. Please try again. Then we stop our macro here. Create Reference Point In this section, we create Reference Point.\n\u0026#39; Create Reference Point swFeature = swDoc.FeatureManager.InsertReferencePoint(swRefPointAlongCurve, swRefPointAlongCurveEvenlyDistributed, 0, numberOfPoints)\rIn above line, we set the value of variable swFeature by InsertReferencePoint method.\nThis InsertReferencePoint method takes following parameters as explained:\nNRefPointType - Type of Scale as defined in swRefPointType_e:\nMember Description swRefPointAlongCurve 2 swRefPointCenterEdge 3 swRefPointFaceCenter 4 swRefPointFaceVertexProjection 5 swRefPointIntersection 6 swRefPointInvalid 0 swRefPointSketchPoint 7 swRefPointUndefined 1 NRefPointAlongCurveType - Distance, percentage, or evenly distributed as defined by swRefPointAlongCurveType_e:\nMember Description swRefPointAlongCurveDistance 0 swRefPointAlongCurveEvenlyDistributed 2 swRefPointAlongCurvePercentage 1 DDistance_or_Percent - Distance at which to create the reference point on the selected entities or percentage of the length of the selected entities at which to create the reference point if NRefPointAlongCurveType is swRefPointAlongCurveDistance or swRefPointAlongCurvePercentage, respectively.\nNumberOfRefPoints - Number of reference points to create and evenly distribute on the selected entities if swRefPointAlongCurveType is swRefPointAlongCurveEvenlyDistributed.\nReturn Value : This InsertReferencePoint method return üëâ Feature data object.\nIn our code, I have used following values:\nParameter Name Value Used NRefPointType swRefPointAlongCurve NRefPointAlongCurveType swRefPointAlongCurveEvenlyDistributed DDistance_or_Percent 0 NumberOfRefPoints numberOfPoints Reference: For more details about\nSolidworks Feature Manager details: üöÄ online Solidworks API Help for Solidworks Feature Manager. InsertReferencePoint Method: üöÄ online Solidworks API Help for InsertReferencePoint Method. \u0026#39; Check if Reference Point created or not If swFeature(0) Is Nothing Then MsgBox (\u0026#34;Failed to create Reference Point.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully create Reference Point or not. We use üöÄ IF statement for checking. Condition: swFeature(0) Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to create Reference Point. Then we stop our macro here. Now we run the macro and after running macro we get Reference Point as shown in below image.\nFinal work In this section, after creating Reference Point, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to create Reference Point with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":158,"permalink":"/solidworks-vba-macros/create-reference-point/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of \u003cstrong\u003eReference Point\u003c/strong\u003e in \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Create Reference Point"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of Insert Component in Assembly document of SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to Insert Component in Assembly document.\nResults We Can Get After running our macro we successfully Insert Component in Assembly document as a result.\nBelow image shows the result we get.\nWe Insert Component in following steps in general.\nInsert an open Part in new Assembly document. To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Insert Component from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Insert Component.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Open part file name Dim partName As String \u0026#39; Program to insert a Component in assembly Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Get open part file name partName = swDoc.GetTitle \u0026#39; Check if we get the file name or not If Len(partName) = 0 Then MsgBox \u0026#34;Fail to get Part title.\u0026#34; Exit Sub End If \u0026#39; Variable for storing default Assembly Template Dim defaultAssemblyTemplate As String \u0026#39; Setting value of variable to \u0026#34;Default Assembly template\u0026#34; defaultAssemblyTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateAssembly) \u0026#39; Check if we get the default Assembly template or not If Len(defaultAssemblyTemplate) = 0 Then MsgBox \u0026#34;Fail to get default Assembly template.\u0026#34; Exit Sub End If \u0026#39; Setting Solidworks document to new Assembly document Set swDoc = swApp.NewDocument(defaultAssemblyTemplate, 0, 0, 0) \u0026#39; Check if Solidworks Assembly is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks Assembly is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Insert new component Set swComponent = swAssembly.AddComponent5(partName, swAddComponentConfigOptions_CurrentSelectedConfig, \u0026#34;\u0026#34;, False, \u0026#34;\u0026#34;, 0, 0, 0) \u0026#39; Check new Component inserted or not If swComponent Is Nothing Then MsgBox \u0026#34;Failed to insert component in assembly.\u0026#34; Exit Sub End If \u0026#39; View zoom to fit swDoc.ViewZoomtofit2 End Sub\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired. Since we are creating new part, there are no feature to create.\nWe will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This Reference Point VBA macro can be divided into following sections:\nCreate and Initialize required variables Insert Component Final work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate and Initialize required variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Open part file name Dim partName As String\rPurpose: In above line, we create a variable for Open part file name. Variable Name: partName Type: String These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to insert a Component in assembly Sub main() End Sub\rIn above line, we create main Program to insert a Component in assembly. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Get open part file name partName = swDoc.GetTitle\rIn above line, we set value of partName variable. This value is Title or File Name of opened part. \u0026#39; Check if we get the file name or not If Len(partName) = 0 Then MsgBox \u0026#34;Fail to get Part title.\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully set the value of partName variable. We use üöÄ IF statement for checking. Condition: Len(partName) = 0 When this condition is True, We show and üöÄ message window to user. Message: Fail to get Part title. Then we stop our macro here. \u0026#39; Variable for storing default Assembly Template Dim defaultAssemblyTemplate As String\rPurpose: In above line, we create a variable for storing default Assembly Template path. Variable Name: defaultAssemblyTemplate Type: String \u0026#39; Setting value of variable to \u0026#34;Default Assembly template\u0026#34; defaultAssemblyTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplateAssembly)\rIn above line, we set value of defaultAssemblyTemplate variable. This value is set by GetUserPreferenceStringValue() method from swApp object. \u0026#39; Check if we get the default Assembly template or not If Len(defaultAssemblyTemplate) = 0 Then MsgBox \u0026#34;Fail to get default Assembly template.\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully set the value of defaultAssemblyTemplate variable. We use üöÄ IF statement for checking. Condition: Len(defaultAssemblyTemplate) = 0 When this condition is True, We show and üöÄ message window to user. Message: Fail to get default Assembly template. Then we stop our macro here. \u0026#39; Set Solidworks document variable to new Assembly document Set swDoc = swApp.NewDocument(defaultAssemblyTemplate, 0, 0, 0)\rIn above line, we set value of swDoc variable. This value is new Assembly document. \u0026#39; Check if Solidworks Assembly is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks Assembly is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. Insert Component In this section, we Insert Component.\n\u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. \u0026#39; Insert new component Set swComponent = swAssembly.AddComponent5(partName, swAddComponentConfigOptions_CurrentSelectedConfig, \u0026#34;\u0026#34;, False, \u0026#34;\u0026#34;, 0, 0, 0)\rIn above line, we set the value of variable swComponent by AddComponent5 method.\nThis AddComponent5 method takes following parameters as explained:\nCompName - Path name of a pre-loaded part or assembly to add as a component.\nConfigOption - Type of Scale as defined in swAddComponentConfigOptions_e:\nMember Description swAddComponentConfigOptions_CurrentSelectedConfig 2 swAddComponentConfigOptions_NewConfigWithAllReferenceModels 3 swAddComponentConfigOptions_NewConfigWithAsmStructure 4 NewConfigName - Name for the new assembly configuration.\nUseConfigForPartReferences - If true, the configuration specified in ExistingConfigName is used.\nExistingConfigName - Name of the configuration of the loaded component.\nX - X coordinate of the component center.\nY - Y coordinate of the component center.\nZ - Z coordinate of the component center.\nReturn Value : This AddComponent5 method return üëâ Component2 data object.\nIn our code, I have used following values:\nParameter Name Value Used CompName partName ConfigOption swAddComponentConfigOptions_CurrentSelectedConfig NewConfigName \u0026quot;\u0026quot; UseConfigForPartReferences False ExistingConfigName \u0026quot;\u0026quot; X 0 Y 0 Z 0 Reference: For more details about\nSolidworks Assembly document details: üöÄ online Solidworks API Help for Solidworks Feature Manager. AddComponent5 Method: üöÄ online Solidworks API Help for AddComponent5 Method. \u0026#39; Check new Component inserted or not If swComponent Is Nothing Then MsgBox \u0026#34;Failed to insert component in assembly.\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully insert component in assembly or not. We use üöÄ IF statement for checking. Condition: swComponent Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to insert component in assembly. Then we stop our macro here. Now we run the macro and after running macro we Insert component as shown in below image.\nFinal work In this section, after Insert component, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Insert component with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":159,"permalink":"/solidworks-vba-macros/assembly-insert-component/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of \u003cstrong\u003eInsert Component\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e of \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Insert Component"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of Unfix Component(s) in Assembly document of SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to Unfix Component(s) quickly.\nResults We Can Get After running our macro we successfully Unfix Component(s) a Component in an Assembly as a result.\nBelow image shows the result we get.\nWe Unfix Component in following steps in general.\nUnfix an open Part in new Assembly document. To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Unfix Component from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Unfix Component.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Program to Unfix Component in assembly Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Variable for Top Level components List Dim vComponents As Variant \u0026#39; Get Components list in opened assembly vComponents = swAssembly.GetComponents(True) \u0026#39; Variable for Looping Dim index As Integer \u0026#39; Loop through Components List For index = 0 To UBound(vComponents) \u0026#39; Set Solidworks Component variable Set swComponent = vComponents(index) \u0026#39; Check if this component is fixed or not If swComponent.IsFixed Then \u0026#39; Select this component swComponent.Select True \u0026#39; Unfix this component swAssembly.UnfixComponent \u0026#39; Clear all selection swDoc.ClearSelection2 True End If Next End Sub\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired.\nWe use an existing part in Assembly document.\nThis component is Fixed as shown in below image.\nWe will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This Reference Point VBA macro can be divided into following sections:\nCreate and Initialize required variables Unfix Component Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate and Initialize required variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Unfix a Component in assembly Sub main() End Sub\rIn above line, we create main Program to Unfix a Component in assembly. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Unfix Component In this section, we Unfix Component.\n\u0026#39; Variable for Top Level components List Dim vComponents As Variant\rPurpose: In above line, we create a variable for Top Level components List. Variable Name: vComponents Type: Variant \u0026#39; Get Components list in opened assembly vComponents = swAssembly.GetComponents(True)\rIn above line, we set the value of vComponents variable. We set value by GetComponents method of swAssembly variable. \u0026#39; Variable for Looping Dim index As Integer\rPurpose: In above line, we create a variable for Looping. Variable Name: index Type: Integer \u0026#39; Loop through Components List For index = 0 To UBound(vComponents) Next\rIn above line, we create a For loop. This loops start from index = 0 to number of UBound(vComponents). UBound(vComponents) : Maximum number of component in this variable. \u0026#39; Set Solidworks Component variable Set swComponent = vComponents(index)\rIn above line, we set value of swComponent variable. This value is current component inside vComponents variable. We get current component by Indexing vComponents variable. \u0026#39; Check if this component is fixed or not If swComponent.IsFixed Then \u0026#39; Select this component swComponent.Select True \u0026#39; Unfix this component swAssembly.UnfixComponent \u0026#39; Clear all selection swDoc.ClearSelection2 True End If\rIn above code block, we check if this component is fixed or not. We use üöÄ IF statement for checking. Condition: swComponent.IsFixed When this condition is True, We select current component. Unfix current component. Then Clear all selection. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Unfix component with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":160,"permalink":"/solidworks-vba-macros/assembly-unfix-component/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of \u003cstrong\u003eUnfix Component(s)\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e of \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Unfix Component"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of adding Coincident Mate in Assembly document of SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to add Coincident Mate quickly.\nResults We Can Get After running our macro we successfully add Coincident Mate a Component in an Assembly as a result.\nBelow image shows the result we get.\nWe Coincident Mate in following steps in general.\nGet Assembly Name without extension. Loop through each plane. Get Plane names for selection. Select Both Planes. Add Coincident Mate. Final Work To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Adding Coincident Mate from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Coincident Mate.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature \u0026#39; Boolean Variable Dim boolStatus As Boolean \u0026#39; Program to add Coincident Mate Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; variable for Assembly Title Dim assemblyTitle As String \u0026#39; Get assembly title assemblyTitle = swDoc.GetTitle \u0026#39; Variable for List of elements Dim vArray As Variant \u0026#39; Using this variable for getting Assembly name without extension vArray = Split(assemblyTitle, \u0026#34;.\u0026#34;) \u0026#39; Update Assembly Title assemblyTitle = vArray(0) \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True) \u0026#39; Set Solidworks Component variable Set swComponent = vArray(0) \u0026#39; Redefine array variable ReDim vArray(1 To 3) As String \u0026#39; Update Array list vArray(1) = \u0026#34;Front Plane\u0026#34; vArray(2) = \u0026#34;Right Plane\u0026#34; vArray(3) = \u0026#34;Top Plane\u0026#34; \u0026#39; Variable for loop Dim i As Integer \u0026#39; Loop Plane List For i = 1 To UBound(vArray) \u0026#39; Variable for Current Plane Dim currentPlane As String \u0026#39; Set current plane currentPlane = vArray(i) \u0026#39; Variable for First Plane name Dim firstSelection As String \u0026#39; Set First Plane Name firstSelection = currentPlane + \u0026#34;@\u0026#34; + assemblyTitle \u0026#39; Variable for Second Plane name Dim secondSelection As String \u0026#39; Set Second Plane name secondSelection = currentPlane + \u0026#34;@\u0026#34; + swComponent.Name + \u0026#34;@\u0026#34; + assemblyTitle \u0026#39; Select First Plane boolStatus = swDoc.Extension.SelectByID2(firstSelection, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 1, Nothing, swSelectOptionDefault) \u0026#39; Select Second Plane boolStatus = swDoc.Extension.SelectByID2(secondSelection, \u0026#34;PLANE\u0026#34;, 0, 0, 0, True, 1, Nothing, swSelectOptionDefault) \u0026#39; Add Coincident Mate Set swMateFeature = swAssembly.AddMate5(swMateCOINCIDENT, swMateAlignALIGNED, False, 0, 0, 0, 0, 0, 0, 0, 0, False, False, 0, swAddMateError_ErrorUknown) \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If Next \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True \u0026#39; Zoom to fit swDoc.ViewZoomtofit2 End Sub\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired.\nWe use an existing part in Assembly document.\nThis component is Float as shown in below image.\nWe will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate and Initialize required variables Get Assembly Title First Component and Plane List Get Plane names Select Planes Add Coincident Mate Final Work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate and Initialize required variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Mate Feature. Variable Name: swMateFeature Type: SldWorks.Feature. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Boolean Variable Dim boolStatus As Boolean\rPurpose: In above line, we create a variable for Boolean selection. Variable Name: boolStatus Type: Boolean These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to add Coincident Mate Sub main() End Sub\rIn above line, we create main Program to add Coincident Mate in assembly. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Get Assembly Title In this section, we Get Assembly Title without extension.\n\u0026#39; variable for Assembly Title Dim assemblyTitle As String\rPurpose: In above line, we create a variable for Assembly Title. Variable Name: assemblyTitle Type: String \u0026#39; Get assembly title assemblyTitle = swDoc.GetTitle\rIn above line, we set the value of assemblyTitle variable. We set value by GetTitle method of swDoc variable. \u0026#39; Variable for List of elements Dim vArray As Variant\rPurpose: In above line, we create a variable for List of elements. Variable Name: vArray Type: Variant \u0026#39; Using this variable for getting Assembly name without extension vArray = Split(assemblyTitle, \u0026#34;.\u0026#34;)\rIn above line, we set the value of vArray variable. We set value by Split method. Split method takes 2 arguments. Input String which we want to split. Delimiter, by which we want to split the Input String. \u0026#39; Update Assembly Title assemblyTitle = vArray(0)\rIn above line, we set the value of assemblyTitle variable. We set value to First instance vArray variable. First Component and Plane List In this section, we Get First Component and update Plane List.\n\u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True)\rIn above line, we set the value of vArray variable. We set value by GetComponents method of swAssembly variable. \u0026#39; Set Solidworks Component variable Set swComponent = vArray(0)\rIn above line, we set value of swComponent variable. This value is First component inside vArray variable. We get current component by Indexing vArray variable. \u0026#39; Redefine array variable ReDim vArray(1 To 3) As String\rIn above line, we Redefine üöÄ Array of String. Variable Name: vArray Type: String Length of Array: (1 To 3) Reference: Please visit For Arrays in VBA : üöÄ Array on this website. \u0026#39; Update Array list vArray(1) = \u0026#34;Front Plane\u0026#34; vArray(2) = \u0026#34;Right Plane\u0026#34; vArray(3) = \u0026#34;Top Plane\u0026#34;\rIn above code, we update Array list by adding Plane names.\n\u0026#39; Variable for loop Dim i As Integer\rIn above line, we create a variable as a counter. Variable Name: i Type: Integer \u0026#39; Loop Plane List For i = 1 To UBound(vArray) Next\rIn above line, we create a For loop. This loops start from i = 1 to maximum of vArray we select. Get Plane names In this section, we Get Plane names.\n\u0026#39; Variable for Current Plane Dim currentPlane As String\rIn above line, we create a variable for Current Plane. Variable Name: currentPlane Type: String \u0026#39; Set current plane currentPlane = vArray(i)\rIn above line, we set value of currentPlane variable. This value is plane inside vArray variable. We get current component by Indexing vArray variable. \u0026#39; Variable for First Plane name Dim firstSelection As String\rIn above line, we create a variable for First Plane name. Variable Name: firstSelection Type: String \u0026#39; Set First Plane Name firstSelection = currentPlane + \u0026#34;@\u0026#34; + assemblyTitle\rIn above line, we set value of firstSelection variable. This value is combinations of currentPlane \u0026amp; assemblyTitle variables. \u0026#39; Variable for Second Plane name Dim secondSelection As String\rIn above line, we create a variable for Second Plane name. Variable Name: secondSelection Type: String \u0026#39; Set Second Plane name secondSelection = currentPlane + \u0026#34;@\u0026#34; + swComponent.Name + \u0026#34;@\u0026#34; + assemblyTitle\rIn above line, we set value of secondSelection variable. This value is combinations of currentPlane, swComponent.Name \u0026amp; assemblyTitle variables. Select Planes In this section, we Select Planes.\n\u0026#39; Select First Plane boolStatus = swDoc.Extension.SelectByID2(firstSelection, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 1, Nothing, swSelectOptionDefault)\rIn above line, we select First Plane. \u0026#39; Select Second Plane boolStatus = swDoc.Extension.SelectByID2(secondSelection, \u0026#34;PLANE\u0026#34;, 0, 0, 0, True, 1, Nothing, swSelectOptionDefault)\rIn above line, we select Second Plane. Add Coincident Mate In this section, we add Coincident Mate.\n\u0026#39; Add Coincident Mate Set swMateFeature = swAssembly.AddMate5(swMateCOINCIDENT, swMateAlignALIGNED, False, 0, 0, 0, 0, 0, 0, 0, 0, False, False, 0, swAddMateError_ErrorUknown)\rIn above line, we set the value of variable swMateFeature by AddMate5 method.\nThis AddMate5 method takes following parameters as explained:\nMateTypeFromEnum - Type of mate as defined in swMateType_e:\nMember Description swMateANGLE 6 swMateCAMFOLLOWER 9 swMateCOINCIDENT 0 swMateCONCENTRIC 1 swMateCOORDINATE 20 swMateDISTANCE 5 swMateGEAR 10 swMateHINGE 22 swMateLINEARCOUPLER 18 swMateLOCK 16 swMateLOCKTOSKETCH 12 swMateMAGNETIC 25 swMateMAXMATES 14 swMatePARALLEL 3 swMatePATH 15 swMatePERPENDICULAR 2 swMatePROFILECENTER 24 swMateRACKPINION 13 swMateSCREW 17 swMateSLIDER 23 swMateSLOT 21 swMateSYMMETRIC 8 swMateTANGENT 4 swMateUNIVERSALJOINT 19 swMateUNKNOWN 7 swMateWIDTH 11 AlignFromEnum - Type of mate as defined in swMateAlign_e:\nMember Description swAlignAGAINST Obsolete. Do not use. swAlignNONE Obsolete. Do not use. swAlignSAME Obsolete. Do not use. swMateAlignALIGNED 0 swMateAlignANTI_ALIGNED 1 swMateAlignCLOSEST 2 Flip - True to flip the mate entities, False to not; valid only if MateTypeFromEnum is swMatetype_e.swMateDISTANCE.\nDistance - Distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nDistanceAbsUpperLimit - Absolute maximum distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nDistanceAbsLowerLimit - Absolute minimum distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nGearRatioNumerator - Gear ratio numerator value; valid only if MateTypeFromEnum is swMateType_e.swMateGEAR.\nGearRatioDenominator - Gear ratio denominator value; valid only if MateTypeFromEnum is swMateType_e.swMateGEAR.\nAngle - Angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nAngleAbsUpperLimit - Absolute maximum angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nAngleAbsLowerLimit - Absolute minimum angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nForPositioningOnly - True to only position the components according to the mating relationship and not return a mate, False to return a mate.\nLockRotation - True to lock component rotation, False to not.\nWidthMateOption - Width mate options as defined in swMateWidthOptions_e; valid only if MateTypeFromEnum is swMateType_e.swMateWIDTH.\nMember Description swMateWidth_Centered 0 swMateWidth_Dimension 2 swMateWidth_Free 1 swMateWidth_Percent 3 ErrorStatus - Success or error as defined by swAddMateError_e as follows.\nMember Description swAddMateError_ErrorUknown 0 swAddMateError_IncorrectAlignment 3 swAddMateError_IncorrectGearRatios 6 swAddMateError_IncorrectMateType 2 swAddMateError_IncorrectSelections 4 swAddMateError_NoError 1 swAddMateError_OverDefinedAssembly 5 Return Value : This AddMate5 method return üëâ Mate2 data object.\nIn our code, I have used following values:\nParameter Name Value Used MateTypeFromEnum swMateCOINCIDENT AlignFromEnum swMateAlignALIGNED Flip false Distance 0 DistanceAbsUpperLimit 0 DistanceAbsLowerLimit 0 GearRatioNumerator 0 GearRatioDenominator 0 Angle 0 AngleAbsUpperLimit 0 AngleAbsLowerLimit 0 ForPositioningOnly False LockRotation False WidthMateOption 0 ErrorStatus swAddMateError_ErrorUknown Reference: For more details about\nSolidworks AssemblyDoc details: üöÄ online Solidworks API Help for Solidworks Feature Manager. AddMate5 Method: üöÄ online Solidworks API Help for AddMate5 Method. \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully added Coincident Mate or not. We use üöÄ IF statement for checking. Condition: swMateFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: *Failed to Add Mate. After that we clear the selection. Then we stop our macro here. Now we run the macro and after running macro we get Coincident Mate as shown in below image.\nFinal work In this section, after adding Coincident Mate, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; Rebuild assembly swDoc.ForceRebuild3 True\rIn above line, we Rebuild assembly. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Coincident Mate with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":161,"permalink":"/solidworks-vba-macros/assembly-conicident-mate/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of adding \u003cstrong\u003eCoincident Mate\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e of \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Add Coincident Mate"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of adding Parallel Mate in Assembly document of SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to add Parallel Mate quickly.\nResults We Can Get After running our macro we successfully add Parallel Mate a Component in an Assembly as a result.\nBelow image shows the result we get.\nWe Parallel Mate in following steps in general.\nGet Assembly Name without extension. Loop through each plane. Get Plane names for selection. Select Both Planes. Add Parallel Mate. Final Work To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Adding Parallel Mate from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Parallel Mate.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature \u0026#39; Boolean Variable Dim boolStatus As Boolean \u0026#39; Program to add Parallel Mate Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; variable for Assembly Title Dim assemblyTitle As String \u0026#39; Get assembly title assemblyTitle = swDoc.GetTitle \u0026#39; Variable for List of elements Dim vArray As Variant \u0026#39; Using this variable for getting Assembly name without extension vArray = Split(assemblyTitle, \u0026#34;.\u0026#34;) \u0026#39; Update Assembly Title assemblyTitle = vArray(0) \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True) \u0026#39; Set Solidworks Component variable Set swComponent = vArray(0) \u0026#39; Redefine array variable ReDim vArray(1 To 3) As String \u0026#39; Update Array list vArray(1) = \u0026#34;Front Plane\u0026#34; vArray(2) = \u0026#34;Right Plane\u0026#34; vArray(3) = \u0026#34;Top Plane\u0026#34; \u0026#39; Variable for loop Dim i As Integer \u0026#39; Loop Plane List For i = 1 To UBound(vArray) \u0026#39; Variable for Current Plane Dim currentPlane As String \u0026#39; Set current plane currentPlane = vArray(i) \u0026#39; Variable for First Plane name Dim firstSelection As String \u0026#39; Set First Plane Name firstSelection = currentPlane + \u0026#34;@\u0026#34; + assemblyTitle \u0026#39; Variable for Second Plane name Dim secondSelection As String \u0026#39; Set Second Plane name secondSelection = currentPlane + \u0026#34;@\u0026#34; + swComponent.Name + \u0026#34;@\u0026#34; + assemblyTitle \u0026#39; Select First Plane boolStatus = swDoc.Extension.SelectByID2(firstSelection, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 1, Nothing, swSelectOptionDefault) \u0026#39; Select Second Plane boolStatus = swDoc.Extension.SelectByID2(secondSelection, \u0026#34;PLANE\u0026#34;, 0, 0, 0, True, 1, Nothing, swSelectOptionDefault) \u0026#39; Add Parallel Mate Set swMateFeature = swAssembly.AddMate5(swMatePARALLEL, swMateAlignALIGNED, False, 0, 0, 0, 0, 0, 0, 0, 0, False, False, 0, swAddMateError_ErrorUknown) \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If Next \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True \u0026#39; Zoom to fit swDoc.ViewZoomtofit2 End Sub\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired.\nWe use an existing part in Assembly document.\nThis component is Float as shown in below image.\nWe will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate and Initialize required variables Get Assembly Title First Component and Plane List Get Plane names Select Planes Add Parallel Mate Final Work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate and Initialize required variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Mate Feature. Variable Name: swMateFeature Type: SldWorks.Feature. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Boolean Variable Dim boolStatus As Boolean\rPurpose: In above line, we create a variable for Boolean selection. Variable Name: boolStatus Type: Boolean These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to add Parallel Mate Sub main() End Sub\rIn above line, we create main Program to add Parallel Mate in assembly. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Get Assembly Title In this section, we Get Assembly Title without extension.\n\u0026#39; variable for Assembly Title Dim assemblyTitle As String\rPurpose: In above line, we create a variable for Assembly Title. Variable Name: assemblyTitle Type: String \u0026#39; Get assembly title assemblyTitle = swDoc.GetTitle\rIn above line, we set the value of assemblyTitle variable. We set value by GetTitle method of swDoc variable. \u0026#39; Variable for List of elements Dim vArray As Variant\rPurpose: In above line, we create a variable for List of elements. Variable Name: vArray Type: Variant \u0026#39; Using this variable for getting Assembly name without extension vArray = Split(assemblyTitle, \u0026#34;.\u0026#34;)\rIn above line, we set the value of vArray variable. We set value by Split method. Split method takes 2 arguments. Input String which we want to split. Delimiter, by which we want to split the Input String. \u0026#39; Update Assembly Title assemblyTitle = vArray(0)\rIn above line, we set the value of assemblyTitle variable. We set value to First instance vArray variable. First Component and Plane List In this section, we Get First Component and update Plane List.\n\u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True)\rIn above line, we set the value of vArray variable. We set value by GetComponents method of swAssembly variable. \u0026#39; Set Solidworks Component variable Set swComponent = vArray(0)\rIn above line, we set value of swComponent variable. This value is First component inside vArray variable. We get current component by Indexing vArray variable. \u0026#39; Redefine array variable ReDim vArray(1 To 3) As String\rIn above line, we Redefine üöÄ Array of String. Variable Name: vArray Type: String Length of Array: (1 To 3) Reference: Please visit For Arrays in VBA : üöÄ Array on this website. \u0026#39; Update Array list vArray(1) = \u0026#34;Front Plane\u0026#34; vArray(2) = \u0026#34;Right Plane\u0026#34; vArray(3) = \u0026#34;Top Plane\u0026#34;\rIn above code, we update Array list by adding Plane names.\n\u0026#39; Variable for loop Dim i As Integer\rIn above line, we create a variable as a counter. Variable Name: i Type: Integer \u0026#39; Loop Plane List For i = 1 To UBound(vArray) Next\rIn above line, we create a For loop. This loops start from i = 1 to maximum of vArray we select. Get Plane names In this section, we Get Plane names.\n\u0026#39; Variable for Current Plane Dim currentPlane As String\rIn above line, we create a variable for Current Plane. Variable Name: currentPlane Type: String \u0026#39; Set current plane currentPlane = vArray(i)\rIn above line, we set value of currentPlane variable. This value is plane inside vArray variable. We get current component by Indexing vArray variable. \u0026#39; Variable for First Plane name Dim firstSelection As String\rIn above line, we create a variable for First Plane name. Variable Name: firstSelection Type: String \u0026#39; Set First Plane Name firstSelection = currentPlane + \u0026#34;@\u0026#34; + assemblyTitle\rIn above line, we set value of firstSelection variable. This value is combinations of currentPlane \u0026amp; assemblyTitle variables. \u0026#39; Variable for Second Plane name Dim secondSelection As String\rIn above line, we create a variable for Second Plane name. Variable Name: secondSelection Type: String \u0026#39; Set Second Plane name secondSelection = currentPlane + \u0026#34;@\u0026#34; + swComponent.Name + \u0026#34;@\u0026#34; + assemblyTitle\rIn above line, we set value of secondSelection variable. This value is combinations of currentPlane, swComponent.Name \u0026amp; assemblyTitle variables. Select Planes In this section, we Select Planes.\n\u0026#39; Select First Plane boolStatus = swDoc.Extension.SelectByID2(firstSelection, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 1, Nothing, swSelectOptionDefault)\rIn above line, we select First Plane. \u0026#39; Select Second Plane boolStatus = swDoc.Extension.SelectByID2(secondSelection, \u0026#34;PLANE\u0026#34;, 0, 0, 0, True, 1, Nothing, swSelectOptionDefault)\rIn above line, we select Second Plane. Add Parallel Mate In this section, we add Parallel Mate.\n\u0026#39; Add Parallel Mate Set swMateFeature = swAssembly.AddMate5(swMatePARALLEL, swMateAlignALIGNED, False, 0, 0, 0, 0, 0, 0, 0, 0, False, False, 0, swAddMateError_ErrorUknown)\rIn above line, we set the value of variable swMateFeature by AddMate5 method.\nThis AddMate5 method takes following parameters as explained:\nMateTypeFromEnum - Type of mate as defined in swMateType_e:\nMember Description swMateANGLE 6 swMateCAMFOLLOWER 9 swMateCOINCIDENT 0 swMateCONCENTRIC 1 swMateCOORDINATE 20 swMateDISTANCE 5 swMateGEAR 10 swMateHINGE 22 swMateLINEARCOUPLER 18 swMateLOCK 16 swMateLOCKTOSKETCH 12 swMateMAGNETIC 25 swMateMAXMATES 14 swMatePARALLEL 3 swMatePATH 15 swMatePERPENDICULAR 2 swMatePROFILECENTER 24 swMateRACKPINION 13 swMateSCREW 17 swMateSLIDER 23 swMateSLOT 21 swMateSYMMETRIC 8 swMateTANGENT 4 swMateUNIVERSALJOINT 19 swMateUNKNOWN 7 swMateWIDTH 11 AlignFromEnum - Type of mate as defined in swMateAlign_e:\nMember Description swAlignAGAINST Obsolete. Do not use. swAlignNONE Obsolete. Do not use. swAlignSAME Obsolete. Do not use. swMateAlignALIGNED 0 swMateAlignANTI_ALIGNED 1 swMateAlignCLOSEST 2 Flip - True to flip the mate entities, False to not; valid only if MateTypeFromEnum is swMatetype_e.swMateDISTANCE.\nDistance - Distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nDistanceAbsUpperLimit - Absolute maximum distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nDistanceAbsLowerLimit - Absolute minimum distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nGearRatioNumerator - Gear ratio numerator value; valid only if MateTypeFromEnum is swMateType_e.swMateGEAR.\nGearRatioDenominator - Gear ratio denominator value; valid only if MateTypeFromEnum is swMateType_e.swMateGEAR.\nAngle - Angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nAngleAbsUpperLimit - Absolute maximum angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nAngleAbsLowerLimit - Absolute minimum angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nForPositioningOnly - True to only position the components according to the mating relationship and not return a mate, False to return a mate.\nLockRotation - True to lock component rotation, False to not.\nWidthMateOption - Width mate options as defined in swMateWidthOptions_e; valid only if MateTypeFromEnum is swMateType_e.swMateWIDTH.\nMember Description swMateWidth_Centered 0 swMateWidth_Dimension 2 swMateWidth_Free 1 swMateWidth_Percent 3 ErrorStatus - Success or error as defined by swAddMateError_e as follows.\nMember Description swAddMateError_ErrorUknown 0 swAddMateError_IncorrectAlignment 3 swAddMateError_IncorrectGearRatios 6 swAddMateError_IncorrectMateType 2 swAddMateError_IncorrectSelections 4 swAddMateError_NoError 1 swAddMateError_OverDefinedAssembly 5 Return Value : This AddMate5 method return üëâ Mate2 data object.\nIn our code, I have used following values:\nParameter Name Value Used MateTypeFromEnum swMatePARALLEL AlignFromEnum swMateAlignALIGNED Flip false Distance 0 DistanceAbsUpperLimit 0 DistanceAbsLowerLimit 0 GearRatioNumerator 0 GearRatioDenominator 0 Angle 0 AngleAbsUpperLimit 0 AngleAbsLowerLimit 0 ForPositioningOnly False LockRotation False WidthMateOption 0 ErrorStatus swAddMateError_ErrorUknown Reference: For more details about\nSolidworks AssemblyDoc details: üöÄ online Solidworks API Help for Solidworks Feature Manager. AddMate5 Method: üöÄ online Solidworks API Help for AddMate5 Method. \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully added Parallel Mate or not. We use üöÄ IF statement for checking. Condition: swMateFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: *Failed to Add Mate. After that we clear the selection. Then we stop our macro here. Now we run the macro and after running macro we get Parallel Mate as shown in below image.\nFinal work In this section, after adding Parallel Mate, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; Rebuild assembly swDoc.ForceRebuild3 True\rIn above line, we Rebuild assembly. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Parallel Mate with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":162,"permalink":"/solidworks-vba-macros/assembly-parallel-mate/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of adding \u003cstrong\u003eParallel Mate\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e of \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Add Parallel Mate"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of adding Perpendicular Mate in Assembly document of SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to add Perpendicular Mate quickly.\nResults We Can Get After running our macro we successfully add Perpendicular Mate a Component in an Assembly as a result.\nBelow image shows the result we get.\nWe add Perpendicular Mate in following steps in general.\nloop through each component in current assembly. Loop through each face. Get desired face from user confirmation. Select required faces for mate. Add Perpendicular Mate. Final Work To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Adding Perpendicular Mate from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Perpendicular Mate.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Variable for Solidworks Body Dim swBody As SldWorks.Body2 \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature \u0026#39; Variable for Solidworks Face Dim swFace As SldWorks.Face2 \u0026#39; Variable for Solidworks Face List Dim vFaces(1 To 2) As SldWorks.Face2 \u0026#39; Program to add Perpendicular Mate Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Variable for List of elements Dim vArray As Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True) \u0026#39; Variable for component Index Dim componentIndex As Integer \u0026#39; Loop Components List For componentIndex = 0 To UBound(vArray) \u0026#39; Set Solidworks Component variable Set swComponent = vArray(componentIndex) \u0026#39; Calling this function SelectFace swComponent, componentIndex Next \u0026#39; Loop selected Face List For componentIndex = 1 To UBound(vFaces) \u0026#39; Get and Set current Face Set swFace = vFaces(componentIndex) \u0026#39; Select current Face swFace.Select True Next \u0026#39; Add Perpendicular Mate Set swMateFeature = swAssembly.AddMate5(swMatePERPENDICULAR, swMateAlignALIGNED, False, 0, 0, 0, 0, 0, 0, 0, 0, False, False, 0, swAddMateError_ErrorUknown) \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Clear all selection swDoc.ClearSelection2 True \u0026#39; Zoom view to fit swDoc.ViewZoomtofit2 \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True End Sub \u0026#39; Function to select required face for Perpendicular mate Function SelectFace(component As SldWorks.Component2, componentIndex As Integer) \u0026#39; Get body of current component Set swBody = component.GetBody \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData \u0026#39; Set value of Solidworks Select Data variable Set swSelData = swDoc.SelectionManager.CreateSelectData \u0026#39; Set Mark of Solidworks Select Data swSelData.Mark = 1 \u0026#39; Get First face Set swFace = swBody.GetFirstFace \u0026#39; Variable to store Message Box result Dim resp As VbMsgBoxResult \u0026#39; Loop through all Faces Do While Not swFace Is Nothing \u0026#39; Select current face swFace.Select4 False, swSelData \u0026#39; Ask user to confirm this selection resp = MsgBox(\u0026#34;Is this correct Face?\u0026#34;, vbYesNo, \u0026#34;Select Face\u0026#34;) \u0026#39; Check if user response if Yes If resp = vbYes Then \u0026#39; Add current face to List of Faces Set vFaces(componentIndex + 1) = swFace Exit Function End If \u0026#39; Get next face Set swFace = swFace.GetNextFace Loop End Function\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired.\nWe use an existing part in Assembly document.\nThis component is Float as shown in below image.\nWe will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate and Initialize required variables Get Components and Loop through them Get desired face Select faces Add Perpendicular Mate Final Work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate and Initialize required variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Body Dim swBody As SldWorks.Body2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swBody Type: SldWorks.Body2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Mate Feature. Variable Name: swMateFeature Type: SldWorks.Feature. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Face Dim swFace As SldWorks.Face2\rPurpose: In above line, we create a variable for Solidworks Face. Variable Name: swFace Type: SldWorks.Face2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Face List Dim vFaces(1 To 2) As SldWorks.Face2\rPurpose: Define üöÄ Array of Face2. Variable Name: vFaces Type: Face2 Length of Array: (1 To 2) Reference: Please visit For Arrays in VBA : üöÄ Array on this website. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to add Perpendicular Mate Sub main() End Sub\rIn above line, we create main Program to add Perpendicular Mate in assembly. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Get Components and Loop through them In this section, we Get Components and Loop through them.\n\u0026#39; Variable for List of elements Dim vArray As Variant\rPurpose: In above line, we create a variable for List of elements. Variable Name: vArray Type: Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True)\rIn above line, we set the value of vArray variable. We set value by GetComponents method of swAssembly variable. \u0026#39; Variable for component Index Dim componentIndex As Integer\rIn above line, we create a variable for component Index as a counter. Variable Name: componentIndex Type: Integer \u0026#39; Loop Components List For componentIndex = 0 To UBound(vArray) Next\rIn above line, we create a For loop. This loops start from i = 0 to maximum of vArray we select. \u0026#39; Set Solidworks Component variable Set swComponent = vArray(componentIndex)\rIn above line, we set value of swComponent variable. This value is current value of array vArray. Get desired face In this section we get desired face for Perpendicular mate.\n\u0026#39; Calling this function SelectFace swComponent, componentIndex\rIn above line, we call a function. Function Name: SelectFace Function Parameters: They are swComponent componentIndex \u0026#39; Function to select required face for Perpendicular mate Function SelectFace(component As SldWorks.Component2, componentIndex As Integer) End Function\rIn above line, we create a Function to select required face for Perpendicular mate. This is a Function procedure which has name of SelectFace. This procedure hold all the statements (instructions) for select required face for Perpendicular mate. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. This function has 2 parameters as follows:\ncomponent As SldWorks.Component2 componentIndex As Integer \u0026#39; Get body of current component Set swBody = component.GetBody\rIn above line, we set value of swBody variable. Value of swBody variable is set by GetBody method of component variable. \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData\rPurpose: In above line, we create a variable for Solidworks Select Data. Variable Name: swSelData Type: SldWorks.SelectData Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Set value of Solidworks Select Data variable Set swSelData = swDoc.SelectionManager.CreateSelectData\rIn above line, we set value of swSelData variable. Value of swSelData variable is set by CreateSelectData, which is part of SelectionManager. This SelectionManager is part of swDoc variable. \u0026#39; Set Mark of Solidworks Select Data swSelData.Mark = 1\rIn above line, we set Mark of swSelData variable to 1. \u0026#39; Get First face Set swFace = swBody.GetFirstFace\rIn above line, we set value of swFace variable. Value of swFace variable is set by GetFirstFace, which is part of swBody variable. \u0026#39; Variable to store Message Box result Dim resp As VbMsgBoxResult\rPurpose: In above line, we create a variable to store Message Box result. Variable Name: resp Type: VbMsgBoxResult \u0026#39; Loop through all Faces Do While Not swFace Is Nothing Loop\rIn above line, we loop through all Faces. \u0026#39; Select current face swFace.Select4 False, swSelData\rIn above line, we select current face. \u0026#39; Ask user to confirm this selection resp = MsgBox(\u0026#34;Is this correct Face?\u0026#34;, vbYesNo, \u0026#34;Select Face\u0026#34;)\rIn above line, we ask user to confirm this selection.\nWe do this in following steps.\nShow a Message Box to user as shown below. Store user response in resp variable. \u0026#39; Check if user response if Yes If resp = vbYes Then End If\rIn above code block, we check if user response if Yes. We use üöÄ IF statement for checking. Condition: resp = vbYes \u0026#39; Add current face to List of Faces Set vFaces(componentIndex + 1) = swFace Exit Function\rWhen user response if Yes, then above code execute. In above line, 1st we add current face to List of Faces. 2nd, we exit this SelectFace function. \u0026#39; Get next face Set swFace = swFace.GetNextFace\rIn above line, we set the value of swFace variable. This is done by GetNextFace method of swFace variable. Select Faces In this section, we Select Faces.\n\u0026#39; Loop selected Face List For componentIndex = 1 To UBound(vFaces) Next\rIn above line, we Loop selected Face List. \u0026#39; Get and Set current Face Set swFace = vFaces(componentIndex)\rIn above line, we set the value of swFace variable to current face of list. \u0026#39; Select current Face swFace.Select True\rIn above line, we select current Face. Add Perpendicular Mate In this section, we add Perpendicular Mate.\n\u0026#39; Add Perpendicular Mate Set swMateFeature = swAssembly.AddMate5(swMatePERPENDICULAR, swMateAlignALIGNED, False, 0, 0, 0, 0, 0, 0, 0, 0, False, False, 0, swAddMateError_ErrorUknown)\rIn above line, we set the value of variable swMateFeature by AddMate5 method.\nThis AddMate5 method takes following parameters as explained:\nMateTypeFromEnum - Type of mate as defined in swMateType_e:\nMember Description swMateANGLE 6 swMateCAMFOLLOWER 9 swMateCOINCIDENT 0 swMateCONCENTRIC 1 swMateCOORDINATE 20 swMateDISTANCE 5 swMateGEAR 10 swMateHINGE 22 swMateLINEARCOUPLER 18 swMateLOCK 16 swMateLOCKTOSKETCH 12 swMateMAGNETIC 25 swMateMAXMATES 14 swMatePARALLEL 3 swMatePATH 15 swMatePERPENDICULAR 2 swMatePROFILECENTER 24 swMateRACKPINION 13 swMateSCREW 17 swMateSLIDER 23 swMateSLOT 21 swMateSYMMETRIC 8 swMateTANGENT 4 swMateUNIVERSALJOINT 19 swMateUNKNOWN 7 swMateWIDTH 11 AlignFromEnum - Type of mate as defined in swMateAlign_e:\nMember Description swAlignAGAINST Obsolete. Do not use. swAlignNONE Obsolete. Do not use. swAlignSAME Obsolete. Do not use. swMateAlignALIGNED 0 swMateAlignANTI_ALIGNED 1 swMateAlignCLOSEST 2 Flip - True to flip the mate entities, False to not; valid only if MateTypeFromEnum is swMatetype_e.swMateDISTANCE.\nDistance - Distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nDistanceAbsUpperLimit - Absolute maximum distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nDistanceAbsLowerLimit - Absolute minimum distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nGearRatioNumerator - Gear ratio numerator value; valid only if MateTypeFromEnum is swMateType_e.swMateGEAR.\nGearRatioDenominator - Gear ratio denominator value; valid only if MateTypeFromEnum is swMateType_e.swMateGEAR.\nAngle - Angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nAngleAbsUpperLimit - Absolute maximum angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nAngleAbsLowerLimit - Absolute minimum angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nForPositioningOnly - True to only position the components according to the mating relationship and not return a mate, False to return a mate.\nLockRotation - True to lock component rotation, False to not.\nWidthMateOption - Width mate options as defined in swMateWidthOptions_e; valid only if MateTypeFromEnum is swMateType_e.swMateWIDTH.\nMember Description swMateWidth_Centered 0 swMateWidth_Dimension 2 swMateWidth_Free 1 swMateWidth_Percent 3 ErrorStatus - Success or error as defined by swAddMateError_e as follows.\nMember Description swAddMateError_ErrorUknown 0 swAddMateError_IncorrectAlignment 3 swAddMateError_IncorrectGearRatios 6 swAddMateError_IncorrectMateType 2 swAddMateError_IncorrectSelections 4 swAddMateError_NoError 1 swAddMateError_OverDefinedAssembly 5 Return Value : This AddMate5 method return üëâ Mate2 data object.\nIn our code, I have used following values:\nParameter Name Value Used MateTypeFromEnum swMatePERPENDICULAR AlignFromEnum swMateAlignALIGNED Flip false Distance 0 DistanceAbsUpperLimit 0 DistanceAbsLowerLimit 0 GearRatioNumerator 0 GearRatioDenominator 0 Angle 0 AngleAbsUpperLimit 0 AngleAbsLowerLimit 0 ForPositioningOnly False LockRotation False WidthMateOption 0 ErrorStatus swAddMateError_ErrorUknown Reference: For more details about\nSolidworks AssemblyDoc details: üöÄ online Solidworks API Help for Solidworks Feature Manager. AddMate5 Method: üöÄ online Solidworks API Help for AddMate5 Method. \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully added Perpendicular Mate or not. We use üöÄ IF statement for checking. Condition: swMateFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: *Failed to Add Mate. After that we clear the selection. Then we stop our macro here. Now we run the macro and after running macro we get Perpendicular Mate as shown in below image.\nFinal work In this section, after adding Perpendicular Mate, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True\rIn above line, we Rebuild assembly. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Perpendicular Mate with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":163,"permalink":"/solidworks-vba-macros/assembly-perpendicular-mate/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of adding \u003cstrong\u003ePerpendicular Mate\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e of \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Add Perpendicular Mate"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of adding Tangent Mate in Assembly document of SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to add Tangent Mate quickly.\nResults We Can Get After running our macro we successfully add Tangent Mate a Component in an Assembly as a result.\nBelow image shows the result we get.\nWe add Tangent Mate in following steps in general.\nloop through each component in current assembly. Loop through each face. Get desired face from user confirmation. Select required faces for mate. Add Tangent Mate. Final Work To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Adding Tangent Mate from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Tangent Mate.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Variable for Solidworks Body Dim swBody As SldWorks.Body2 \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature \u0026#39; Variable for Solidworks Face Dim swFace As SldWorks.Face2 \u0026#39; Variable for Solidworks Face List Dim vFaces(1 To 2) As SldWorks.Face2 \u0026#39; Program to add Tangent Mate Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Variable for List of elements Dim vArray As Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True) \u0026#39; Variable for component Index Dim componentIndex As Integer \u0026#39; Loop Components List For componentIndex = 0 To UBound(vArray) \u0026#39; Set Solidworks Component variable Set swComponent = vArray(componentIndex) \u0026#39; Calling this function SelectFace swComponent, componentIndex Next \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData \u0026#39; Set value of Solidworks Select Data variable Set swSelData = swDoc.SelectionManager.CreateSelectData \u0026#39; Set Mark of Solidworks Select Data swSelData.Mark = 1 \u0026#39; Boolean variable Dim boolStatus As Boolean \u0026#39; Select faces for Tangent mate boolStatus = swDoc.Extension.MultiSelect2(vFaces, False, swSelData) \u0026#39; Check if faces are selected If boolStatus = False Then MsgBox \u0026#34;Failed to select faces.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Add Tangent Mate Set swMateFeature = swAssembly.AddMate5(swMateTANGENT, swMateAlignALIGNED, False, 0, 0, 0, 0, 0, 0, 0, 0, False, False, 0, swAddMateError_ErrorUknown) \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Clear all selection swDoc.ClearSelection2 True \u0026#39; Zoom view to fit swDoc.ViewZoomtofit2 \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True End Sub \u0026#39; Function to select required face for Tangent mate Function SelectFace(component As SldWorks.Component2, componentIndex As Integer) \u0026#39; Get body of current component Set swBody = component.GetBody \u0026#39; Get First face Set swFace = swBody.GetFirstFace \u0026#39; Variable to store Message Box result Dim resp As VbMsgBoxResult \u0026#39; Loop through all Faces Do While Not swFace Is Nothing \u0026#39; Clear selection swDoc.ClearSelection2 True \u0026#39; Select current face swFace.Select True \u0026#39; Ask user to confirm this selection resp = MsgBox(\u0026#34;Is this correct Face?\u0026#34;, vbYesNo, \u0026#34;Select Face\u0026#34;) \u0026#39; Check if user response if Yes If resp = vbYes Then \u0026#39; Add current face to List of Faces Set vFaces(componentIndex + 1) = swFace Exit Function End If \u0026#39; Get next face Set swFace = swFace.GetNextFace Loop End Function\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired.\nWe use existing partss in Assembly document.\nOne component is fully constraint and other one component is Float as shown in below image.\nWe will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate and Initialize required variables Get Components and Loop through them Get desired face Select faces Add Tangent Mate Final Work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate and Initialize required variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Body Dim swBody As SldWorks.Body2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swBody Type: SldWorks.Body2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Mate Feature. Variable Name: swMateFeature Type: SldWorks.Feature. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Face Dim swFace As SldWorks.Face2\rPurpose: In above line, we create a variable for Solidworks Face. Variable Name: swFace Type: SldWorks.Face2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Face List Dim vFaces(1 To 2) As SldWorks.Face2\rPurpose: Define üöÄ Array of Face2. Variable Name: vFaces Type: Face2 Length of Array: (1 To 2) Reference: Please visit For Arrays in VBA : üöÄ Array on this website. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to add Tangent Mate Sub main() End Sub\rIn above line, we create main Program to add Tangent Mate in assembly. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Get Components and Loop through them In this section, we Get Components and Loop through them.\n\u0026#39; Variable for List of elements Dim vArray As Variant\rPurpose: In above line, we create a variable for List of elements. Variable Name: vArray Type: Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True)\rIn above line, we set the value of vArray variable. We set value by GetComponents method of swAssembly variable. \u0026#39; Variable for component Index Dim componentIndex As Integer\rIn above line, we create a variable for component Index as a counter. Variable Name: componentIndex Type: Integer \u0026#39; Loop Components List For componentIndex = 0 To UBound(vArray) Next\rIn above line, we create a For loop. This loops start from i = 0 to maximum number of items in vArray we select. \u0026#39; Set Solidworks Component variable Set swComponent = vArray(componentIndex)\rIn above line, we set value of swComponent variable. This value is current value of array vArray. Get desired face In this section we get desired face for Tangent mate.\n\u0026#39; Calling this function SelectFace swComponent, componentIndex\rIn above line, we call a function. Function Name: SelectFace Function Parameters: They are swComponent componentIndex \u0026#39; Function to select required face for Tangent mate Function SelectFace(component As SldWorks.Component2, componentIndex As Integer) End Function\rIn above line, we create a Function to select required face for Tangent mate. This is a Function procedure which has name of SelectFace. This procedure hold all the statements (instructions) for select required face for Tangent mate. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. This function has 2 parameters as follows:\ncomponent As SldWorks.Component2 componentIndex As Integer \u0026#39; Get body of current component Set swBody = component.GetBody\rIn above line, we set value of swBody variable. Value of swBody variable is set by GetBody method of component variable. \u0026#39; Get First face Set swFace = swBody.GetFirstFace\rIn above line, we set value of swFace variable. Value of swFace variable is set by GetFirstFace, which is part of swBody variable. \u0026#39; Variable to store Message Box result Dim resp As VbMsgBoxResult\rPurpose: In above line, we create a variable to store Message Box result. Variable Name: resp Type: VbMsgBoxResult \u0026#39; Loop through all Faces Do While Not swFace Is Nothing Loop\rIn above line, we loop through all Faces. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Select current face swFace.Select4 False, swSelData\rIn above line, we select current face. This function is not available in üöÄ Solidworks Face object.\nSince üöÄ Solidworks Face object is also an üöÄ Solidworks Entity object, we can use methods from üöÄ Solidworks Entity object. {: .notice\u0026ndash;information}\n\u0026#39; Ask user to confirm this selection resp = MsgBox(\u0026#34;Is this correct Face?\u0026#34;, vbYesNo, \u0026#34;Select Face\u0026#34;)\rIn above line, we ask user to confirm this selection.\nWe do this in following steps.\nShow a Message Box to user as shown below. Store user response in resp variable. \u0026#39; Check if user response if Yes If resp = vbYes Then End If\rIn above code block, we check if user response if Yes. We use üöÄ IF statement for checking. Condition: resp = vbYes \u0026#39; Add current face to List of Faces Set vFaces(componentIndex + 1) = swFace Exit Function\rWhen user response if Yes, then above code execute. In above line, 1st we add current face to List of Faces. 2nd, we exit this SelectFace function. \u0026#39; Get next face Set swFace = swFace.GetNextFace\rIn above line, we set the value of swFace variable. This is done by GetNextFace method of swFace variable. Select Faces In this section, we Select Faces.\n\u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData\rPurpose: In above line, we create a variable for Solidworks Select Data. Variable Name: swSelData Type: SldWorks.SelectData Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Set value of Solidworks Select Data variable Set swSelData = swDoc.SelectionManager.CreateSelectData\rIn above line, we set value of swSelData variable. Value of swSelData variable is set by CreateSelectData, which is part of SelectionManager. This SelectionManager is part of swDoc variable. \u0026#39; Set Mark of Solidworks Select Data swSelData.Mark = 1\rIn above line, we set Mark of swSelData variable to 1. \u0026#39; Boolean variable Dim boolStatus As Boolean\rPurpose: In above line, we create a Boolean variable. Variable Name: boolStatus Type: Boolean \u0026#39; Select faces for Tangent mate boolStatus = swDoc.Extension.MultiSelect2(vFaces, False, swSelData)\rIn above line, we select Faces by MultiSelect2 method. This MultiSelect2 method takes following parameter. Objects: Array of selectable objects. AppendFlag: True to append the objects to the selection list, False to replace the current selection list with these objects. Data: üöÄ ISelectData object, Nothing, or null \u0026#39; Check if faces are selected If boolStatus = False Then MsgBox \u0026#34;Failed to select faces.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully selected the faces. We use üöÄ IF statement for checking. Condition: boolStatus = False When this condition is True, We show and üöÄ message window to user. Message: Failed to select faces. Then we stop our macro here. Add Tangent Mate In this section, we add Tangent Mate.\n\u0026#39; Add Tangent Mate Set swMateFeature = swAssembly.AddMate5(swMateTANGENT, swMateAlignALIGNED, False, 0, 0, 0, 0, 0, 0, 0, 0, False, False, 0, swAddMateError_ErrorUknown)\rIn above line, we set the value of variable swMateFeature by AddMate5 method.\nThis AddMate5 method takes following parameters as explained:\nMateTypeFromEnum - Type of mate as defined in swMateType_e:\nMember Description swMateANGLE 6 swMateCAMFOLLOWER 9 swMateCOINCIDENT 0 swMateCONCENTRIC 1 swMateCOORDINATE 20 swMateDISTANCE 5 swMateGEAR 10 swMateHINGE 22 swMateLINEARCOUPLER 18 swMateLOCK 16 swMateLOCKTOSKETCH 12 swMateMAGNETIC 25 swMateMAXMATES 14 swMatePARALLEL 3 swMatePATH 15 swMatePERPENDICULAR 2 swMatePROFILECENTER 24 swMateRACKPINION 13 swMateSCREW 17 swMateSLIDER 23 swMateSLOT 21 swMateSYMMETRIC 8 swMateTANGENT 4 swMateUNIVERSALJOINT 19 swMateUNKNOWN 7 swMateWIDTH 11 AlignFromEnum - Type of mate as defined in swMateAlign_e:\nMember Description swAlignAGAINST Obsolete. Do not use. swAlignNONE Obsolete. Do not use. swAlignSAME Obsolete. Do not use. swMateAlignALIGNED 0 swMateAlignANTI_ALIGNED 1 swMateAlignCLOSEST 2 Flip - True to flip the mate entities, False to not; valid only if MateTypeFromEnum is swMatetype_e.swMateDISTANCE.\nDistance - Distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nDistanceAbsUpperLimit - Absolute maximum distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nDistanceAbsLowerLimit - Absolute minimum distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nGearRatioNumerator - Gear ratio numerator value; valid only if MateTypeFromEnum is swMateType_e.swMateGEAR.\nGearRatioDenominator - Gear ratio denominator value; valid only if MateTypeFromEnum is swMateType_e.swMateGEAR.\nAngle - Angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nAngleAbsUpperLimit - Absolute maximum angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nAngleAbsLowerLimit - Absolute minimum angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nForPositioningOnly - True to only position the components according to the mating relationship and not return a mate, False to return a mate.\nLockRotation - True to lock component rotation, False to not.\nWidthMateOption - Width mate options as defined in swMateWidthOptions_e; valid only if MateTypeFromEnum is swMateType_e.swMateWIDTH.\nMember Description swMateWidth_Centered 0 swMateWidth_Dimension 2 swMateWidth_Free 1 swMateWidth_Percent 3 ErrorStatus - Success or error as defined by swAddMateError_e as follows.\nMember Description swAddMateError_ErrorUknown 0 swAddMateError_IncorrectAlignment 3 swAddMateError_IncorrectGearRatios 6 swAddMateError_IncorrectMateType 2 swAddMateError_IncorrectSelections 4 swAddMateError_NoError 1 swAddMateError_OverDefinedAssembly 5 Return Value : This AddMate5 method return üëâ Mate2 data object.\nIn our code, I have used following values:\nParameter Name Value Used MateTypeFromEnum swMateTANGENT AlignFromEnum swMateAlignALIGNED Flip false Distance 0 DistanceAbsUpperLimit 0 DistanceAbsLowerLimit 0 GearRatioNumerator 0 GearRatioDenominator 0 Angle 0 AngleAbsUpperLimit 0 AngleAbsLowerLimit 0 ForPositioningOnly False LockRotation False WidthMateOption 0 ErrorStatus swAddMateError_ErrorUknown Reference: For more details about\nSolidworks AssemblyDoc details: üöÄ online Solidworks API Help for Solidworks Feature Manager. AddMate5 Method: üöÄ online Solidworks API Help for AddMate5 Method. \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully added Tangent Mate or not. We use üöÄ IF statement for checking. Condition: swMateFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: *Failed to Add Mate. After that we clear the selection. Then we stop our macro here. Now we run the macro and after running macro we get Tangent Mate as shown in below image.\nFinal work In this section, after adding Tangent Mate, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True\rIn above line, we Rebuild assembly. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Tangent Mate with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":164,"permalink":"/solidworks-vba-macros/assembly-tangent-mate/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of adding \u003cstrong\u003eTangent Mate\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e of \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Add Tangent Mate"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of adding Concentric Mate in Assembly document of SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to add Concentric Mate quickly.\nResults We Can Get After running our macro we successfully add Concentric Mate a Component in an Assembly as a result.\nBelow image shows the result we get.\nWe add Concentric Mate in following steps in general.\nloop through each component in current assembly. Loop through each face. Get desired cylindrical face. Select required faces for mate. Add Concentric Mate. Final Work To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Adding Concentric Mate from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Concentric Mate.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Variable for Solidworks Body Dim swBody As SldWorks.Body2 \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature \u0026#39; Variable for Solidworks Face Dim swFace As SldWorks.Face2 \u0026#39; Variable for Solidworks Face List Dim vFaces(1 To 2) As SldWorks.Face2 \u0026#39; Program to add Concentric Mate Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Variable for List of elements Dim vArray As Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True) \u0026#39; Variable for component Index Dim componentIndex As Integer \u0026#39; Loop Components List For componentIndex = 0 To UBound(vArray) \u0026#39; Set Solidworks Component variable Set swComponent = vArray(componentIndex) \u0026#39; Calling this function SelectFace swComponent, componentIndex Next \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData \u0026#39; Set value of Solidworks Select Data variable Set swSelData = swDoc.SelectionManager.CreateSelectData \u0026#39; Set Mark of Solidworks Select Data swSelData.Mark = 1 \u0026#39; Boolean variable Dim boolStatus As Boolean \u0026#39; Select faces for Concentric mate boolStatus = swDoc.Extension.MultiSelect2(vFaces, False, swSelData) \u0026#39; Check if faces are selected If boolStatus = False Then MsgBox \u0026#34;Failed to select faces.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Add Concentric Mate Set swMateFeature = swAssembly.AddMate5(swMateCONCENTRIC, swMateAlignALIGNED, False, 0, 0, 0, 0, 0, 0, 0, 0, False, False, 0, swAddMateError_ErrorUknown) \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Clear all selection swDoc.ClearSelection2 True \u0026#39; Zoom view to fit swDoc.ViewZoomtofit2 \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True End Sub \u0026#39; Function to select required face for Concentric mate Function SelectFace(component As SldWorks.Component2, componentIndex As Integer) \u0026#39; Get body of current component Set swBody = component.GetBody \u0026#39; Array for Solidworks Faces Dim faceArray As Variant \u0026#39; Variable for Solidworks Face Dim eachFace As Variant \u0026#39; Get all faces faceArray = swBody.GetFaces \u0026#39; Loop through all faces For Each eachFace In faceArray \u0026#39; Get current face Set swFace = eachFace \u0026#39; Solidworks Surface variable Dim swSurface As SldWorks.Surface \u0026#39; Get the Surface from the Solidworks Face variable Set swSurface = swFace.GetSurface \u0026#39; If we have cylinder surface If swSurface.IsCylinder() Then \u0026#39; Add current face to List of Faces Set vFaces(componentIndex + 1) = swFace \u0026#39; Clear current selection swDoc.ClearSelection2 True Exit Function End If \u0026#39; Clear current selection swDoc.ClearSelection2 True Next End Function\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired.\nWe use existing parts in Assembly document.\nOne component is fully constraint and other component is Float as shown in below image.\nWe will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate and Initialize required variables Get Components and Loop through them Get desired face Select faces Add Concentric Mate Final Work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate and Initialize required variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Body Dim swBody As SldWorks.Body2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swBody Type: SldWorks.Body2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Mate Feature. Variable Name: swMateFeature Type: SldWorks.Feature. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Face Dim swFace As SldWorks.Face2\rPurpose: In above line, we create a variable for Solidworks Face. Variable Name: swFace Type: SldWorks.Face2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Face List Dim vFaces(1 To 2) As SldWorks.Face2\rPurpose: Define üöÄ Array of Face2. Variable Name: vFaces Type: Face2 Length of Array: (1 To 2) Reference: Please visit For Arrays in VBA : üöÄ Array on this website. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to add Concentric Mate Sub main() End Sub\rIn above line, we create main Program to add Concentric Mate in assembly. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Get Components and Loop through them In this section, we Get Components and Loop through them.\n\u0026#39; Variable for List of elements Dim vArray As Variant\rPurpose: In above line, we create a variable for List of elements. Variable Name: vArray Type: Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True)\rIn above line, we set the value of vArray variable. We set value by GetComponents method of swAssembly variable. \u0026#39; Variable for component Index Dim componentIndex As Integer\rIn above line, we create a variable for component Index as a counter. Variable Name: componentIndex Type: Integer \u0026#39; Loop Components List For componentIndex = 0 To UBound(vArray) Next\rIn above line, we create a For loop. This loops start from i = 0 to maximum number of items in vArray we select. \u0026#39; Set Solidworks Component variable Set swComponent = vArray(componentIndex)\rIn above line, we set value of swComponent variable. This value is current value of array vArray. Get desired face In this section we get desired face for Concentric mate.\n\u0026#39; Calling this function SelectFace swComponent, componentIndex\rIn above line, we call a function. Function Name: SelectFace Function Parameters: They are swComponent componentIndex \u0026#39; Function to select required face for Concentric mate Function SelectFace(component As SldWorks.Component2, componentIndex As Integer) End Function\rIn above line, we create a Function to select required face for Concentric mate. This is a Function procedure which has name of SelectFace. This procedure hold all the statements (instructions) for select required face for Concentric mate. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. This function has 2 parameters as follows:\ncomponent As SldWorks.Component2 componentIndex As Integer \u0026#39; Get body of current component Set swBody = component.GetBody\rIn above line, we set value of swBody variable. Value of swBody variable is set by GetBody method of component variable. \u0026#39; Array for Solidworks Faces Dim faceArray As Variant\rPurpose: In above line, we create a variable for üöÄ Solidworks Faces. Variable Name: faceArray Type: Variant \u0026#39; Variable for Solidworks Face Dim eachFace As Variant\rPurpose: In above line, we create a variable for each üöÄ Solidworks Face from Solidworks Faces array. Variable Name: eachFace Type: Variant \u0026#39; Get all faces faceArray = swBody.GetFaces\rIn above line, we set value of faceArray variable. Value of faceArray variable is set by GetFaces method, which is part of swBody variable. \u0026#39; Loop through all faces For Each eachFace In faceArray Next\rPurpose: In above line, we loop through all Faces. faceArray: Array of üöÄ Solidworks Faces. eachFace: Solidworks Face variable inside faceArray array. \u0026#39; Get current face Set swFace = eachFace\rIn above line, we set value of swFace variable. Value of swFace variable is set to eachFace variable of Solidworks array. \u0026#39; Solidworks Surface variable Dim swSurface As SldWorks.Surface\rPurpose: In above line, we create a variable for Solidworks Surface. Variable Name: swSurface Type: SldWorks.Surface. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Get the Surface from the Solidworks Face variable Set swSurface = swFace.GetSurface\rIn above line, we set value of swSurface variable. Value of swSurface variable is set by GetSurface method, which is part of swFace variable. \u0026#39; If we have cylinder surface If swSurface.IsCylinder() Then End If\rIn above code block, we check if user response if Yes. We use üöÄ IF statement for checking. Condition: swSurface.IsCylinder() \u0026#39; Add current face to List of Faces Set vFaces(componentIndex + 1) = swFace\rWhen user response if Yes, then above code execute. In above line, 1st we add current face to List of Faces. \u0026#39; Clear current selection swDoc.ClearSelection2 True Exit Function\rIn above line, we clear current selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. After this we exit function. \u0026#39; Clear current selection swDoc.ClearSelection2 True\rIn above line, we clear current selection inside For loop. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. Select Faces In this section, we Select Faces.\n\u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData\rPurpose: In above line, we create a variable for Solidworks Select Data. Variable Name: swSelData Type: SldWorks.SelectData Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Set value of Solidworks Select Data variable Set swSelData = swDoc.SelectionManager.CreateSelectData\rIn above line, we set value of swSelData variable. Value of swSelData variable is set by CreateSelectData, which is part of SelectionManager. This SelectionManager is part of swDoc variable. \u0026#39; Set Mark of Solidworks Select Data swSelData.Mark = 1\rIn above line, we set Mark of swSelData variable to 1. \u0026#39; Boolean variable Dim boolStatus As Boolean\rPurpose: In above line, we create a Boolean variable. Variable Name: boolStatus Type: Boolean \u0026#39; Select faces for Concentric mate boolStatus = swDoc.Extension.MultiSelect2(vFaces, False, swSelData)\rIn above line, we select Faces by MultiSelect2 method. This MultiSelect2 method takes following parameter. Objects: Array of selectable objects. AppendFlag: True to append the objects to the selection list, False to replace the current selection list with these objects. Data: üöÄ ISelectData object, Nothing, or null \u0026#39; Check if faces are selected If boolStatus = False Then MsgBox \u0026#34;Failed to select faces.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully selected the faces. We use üöÄ IF statement for checking. Condition: boolStatus = False When this condition is True, We show and üöÄ message window to user. Message: Failed to select faces. Then we stop our macro here. Add Concentric Mate In this section, we add Concentric Mate.\n\u0026#39; Add Concentric Mate Set swMateFeature = swAssembly.AddMate5(swMateCONCENTRIC, swMateAlignALIGNED, False, 0, 0, 0, 0, 0, 0, 0, 0, False, False, 0, swAddMateError_ErrorUknown)\rIn above line, we set the value of variable swMateFeature by AddMate5 method.\nThis AddMate5 method takes following parameters as explained:\nMateTypeFromEnum - Type of mate as defined in swMateType_e:\nMember Description swMateANGLE 6 swMateCAMFOLLOWER 9 swMateCOINCIDENT 0 swMateCONCENTRIC 1 swMateCOORDINATE 20 swMateDISTANCE 5 swMateGEAR 10 swMateHINGE 22 swMateLINEARCOUPLER 18 swMateLOCK 16 swMateLOCKTOSKETCH 12 swMateMAGNETIC 25 swMateMAXMATES 14 swMatePARALLEL 3 swMatePATH 15 swMatePERPENDICULAR 2 swMatePROFILECENTER 24 swMateRACKPINION 13 swMateSCREW 17 swMateSLIDER 23 swMateSLOT 21 swMateSYMMETRIC 8 swMateTANGENT 4 swMateUNIVERSALJOINT 19 swMateUNKNOWN 7 swMateWIDTH 11 AlignFromEnum - Type of mate as defined in swMateAlign_e:\nMember Description swAlignAGAINST Obsolete. Do not use. swAlignNONE Obsolete. Do not use. swAlignSAME Obsolete. Do not use. swMateAlignALIGNED 0 swMateAlignANTI_ALIGNED 1 swMateAlignCLOSEST 2 Flip - True to flip the mate entities, False to not; valid only if MateTypeFromEnum is swMatetype_e.swMateDISTANCE.\nDistance - Distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nDistanceAbsUpperLimit - Absolute maximum distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nDistanceAbsLowerLimit - Absolute minimum distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nGearRatioNumerator - Gear ratio numerator value; valid only if MateTypeFromEnum is swMateType_e.swMateGEAR.\nGearRatioDenominator - Gear ratio denominator value; valid only if MateTypeFromEnum is swMateType_e.swMateGEAR.\nAngle - Angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nAngleAbsUpperLimit - Absolute maximum angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nAngleAbsLowerLimit - Absolute minimum angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nForPositioningOnly - True to only position the components according to the mating relationship and not return a mate, False to return a mate.\nLockRotation - True to lock component rotation, False to not.\nWidthMateOption - Width mate options as defined in swMateWidthOptions_e; valid only if MateTypeFromEnum is swMateType_e.swMateWIDTH.\nMember Description swMateWidth_Centered 0 swMateWidth_Dimension 2 swMateWidth_Free 1 swMateWidth_Percent 3 ErrorStatus - Success or error as defined by swAddMateError_e as follows.\nMember Description swAddMateError_ErrorUknown 0 swAddMateError_IncorrectAlignment 3 swAddMateError_IncorrectGearRatios 6 swAddMateError_IncorrectMateType 2 swAddMateError_IncorrectSelections 4 swAddMateError_NoError 1 swAddMateError_OverDefinedAssembly 5 Return Value : This AddMate5 method return üëâ Mate2 data object.\nIn our code, I have used following values:\nParameter Name Value Used MateTypeFromEnum swMateCONCENTRIC AlignFromEnum swMateAlignALIGNED Flip false Distance 0 DistanceAbsUpperLimit 0 DistanceAbsLowerLimit 0 GearRatioNumerator 0 GearRatioDenominator 0 Angle 0 AngleAbsUpperLimit 0 AngleAbsLowerLimit 0 ForPositioningOnly False LockRotation False WidthMateOption 0 ErrorStatus swAddMateError_ErrorUknown Reference: For more details about\nSolidworks AssemblyDoc details: üöÄ online Solidworks API Help for Solidworks Feature Manager. AddMate5 Method: üöÄ online Solidworks API Help for AddMate5 Method. \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully added Concentric Mate or not. We use üöÄ IF statement for checking. Condition: swMateFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: *Failed to Add Mate. After that we clear the selection. Then we stop our macro here. Now we run the macro and after running macro we get Concentric Mate as shown in below image.\nFinal work In this section, after adding Concentric Mate, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True\rIn above line, we Rebuild assembly. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Concentric Mate with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":165,"permalink":"/solidworks-vba-macros/assembly-concentric-mate/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of adding \u003cstrong\u003eConcentric Mate\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e of \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Add Concentric Mate"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of adding Distance Mate in Assembly document of SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to add Distance Mate quickly.\nResults We Can Get After running our macro, we successfully add Distance Mate a Component in an Assembly as a result.\nBelow image shows the result we get.\nWe add Distance Mate in following steps in general.\nloop through each component in current assembly. Loop through each face. Get desired face from user confirmation. Select required faces for mate. Get distance from user. Add Distance Mate. Final Work To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Adding Distance Mate from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Distance Mate.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Variable for Solidworks Body Dim swBody As SldWorks.Body2 \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature \u0026#39; Variable for Solidworks Face Dim swFace As SldWorks.Face2 \u0026#39; Variable for Solidworks Face List Dim vFaces(1 To 2) As SldWorks.Face2 \u0026#39; Program to add Distance Mate Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Variable for List of elements Dim vArray As Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True) \u0026#39; Variable for component Index Dim componentIndex As Integer \u0026#39; Loop Components List For componentIndex = 0 To UBound(vArray) \u0026#39; Set Solidworks Component variable Set swComponent = vArray(componentIndex) \u0026#39; Calling this function SelectFace swComponent, componentIndex Next \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData \u0026#39; Set value of Solidworks Select Data variable Set swSelData = swDoc.SelectionManager.CreateSelectData \u0026#39; Set Mark of Solidworks Select Data swSelData.Mark = 1 \u0026#39; Boolean variable Dim boolStatus As Boolean \u0026#39; Select faces for Concentric mate boolStatus = swDoc.Extension.MultiSelect2(vFaces, False, swSelData) \u0026#39; Check if faces are selected If boolStatus = False Then MsgBox \u0026#34;Failed to select faces.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39; Variable to hold user input Dim response As String \u0026#39; Getting Distance from user. response = InputBox(\u0026#34;Please Enter [Distance]:\u0026#34;) \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Variable for Distance Dim distance As Double \u0026#39; Set Distance distance = CDbl(response) * LengthConversionFactor \u0026#39; This will handle case for 0 Distance If distance = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Add Distance Mate Set swMateFeature = swAssembly.AddMate5(swMateDISTANCE, swMateAlignANTI_ALIGNED, False, distance, 0, 0, 0, 0, 0, 0, 0, False, False, 0, swAddMateError_ErrorUknown) \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Clear all selection swDoc.ClearSelection2 True \u0026#39; Zoom view to fit swDoc.ViewZoomtofit2 \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True End Sub \u0026#39; Function to select required face for Distance mate Function SelectFace(component As SldWorks.Component2, componentIndex As Integer) \u0026#39; Get body of current component Set swBody = component.GetBody \u0026#39; Get First face Set swFace = swBody.GetFirstFace \u0026#39; Variable to store Message Box result Dim resp As VbMsgBoxResult \u0026#39; Loop through all Faces Do While Not swFace Is Nothing \u0026#39; Clear selection swDoc.ClearSelection2 True \u0026#39; Select current face swFace.Select True \u0026#39; Ask user to confirm this selection resp = MsgBox(\u0026#34;Is this correct Face?\u0026#34;, vbYesNo, \u0026#34;Select Face\u0026#34;) \u0026#39; Check if user response if Yes If resp = vbYes Then \u0026#39; Add current face to List of Faces Set vFaces(componentIndex + 1) = swFace Exit Function End If \u0026#39; Get next face Set swFace = swFace.GetNextFace Loop End Function\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired.\nWe use existing parts in Assembly document.\nOne component is fully constraint and other component is Float as shown in below image.\nWe will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate and Initialize required variables Get Components and Loop through them Get desired face Select faces Get unit conversion factors Get distance and Validations Add Distance Mate Final Work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate and Initialize required variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Body Dim swBody As SldWorks.Body2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swBody Type: SldWorks.Body2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Mate Feature. Variable Name: swMateFeature Type: SldWorks.Feature. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Face Dim swFace As SldWorks.Face2\rPurpose: In above line, we create a variable for Solidworks Face. Variable Name: swFace Type: SldWorks.Face2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Face List Dim vFaces(1 To 2) As SldWorks.Face2\rPurpose: Define üöÄ Array of Face2. Variable Name: vFaces Type: Face2 Length of Array: (1 To 2) Reference: Please visit For Arrays in VBA : üöÄ Array on this website. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to add Distance Mate Sub main() End Sub\rIn above line, we create main Program to add Distance Mate in assembly. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Get Components and Loop through them In this section, we Get Components and Loop through them.\n\u0026#39; Variable for List of elements Dim vArray As Variant\rPurpose: In above line, we create a variable for List of elements. Variable Name: vArray Type: Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True)\rIn above line, we set the value of vArray variable. We set value by GetComponents method of swAssembly variable. \u0026#39; Variable for component Index Dim componentIndex As Integer\rIn above line, we create a variable for component Index as a counter. Variable Name: componentIndex Type: Integer \u0026#39; Loop Components List For componentIndex = 0 To UBound(vArray) Next\rIn above line, we create a For loop. This loops start from i = 0 to maximum number of items in vArray we select. \u0026#39; Set Solidworks Component variable Set swComponent = vArray(componentIndex)\rIn above line, we set value of swComponent variable. This value is current value of array vArray. Get desired face In this section we get desired face for Distance mate.\n\u0026#39; Calling this function SelectFace swComponent, componentIndex\rIn above line, we call a function. Function Name: SelectFace Function Parameters: They are swComponent componentIndex \u0026#39; Function to select required face for Tangent mate Function SelectFace(component As SldWorks.Component2, componentIndex As Integer) End Function\rIn above line, we create a Function to select required face for Tangent mate. This is a Function procedure which has name of SelectFace. This procedure hold all the statements (instructions) for select required face for Tangent mate. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. This function has 2 parameters as follows:\ncomponent As SldWorks.Component2 componentIndex As Integer \u0026#39; Get body of current component Set swBody = component.GetBody\rIn above line, we set value of swBody variable. Value of swBody variable is set by GetBody method of component variable. \u0026#39; Get First face Set swFace = swBody.GetFirstFace\rIn above line, we set value of swFace variable. Value of swFace variable is set by GetFirstFace, which is part of swBody variable. \u0026#39; Variable to store Message Box result Dim resp As VbMsgBoxResult\rPurpose: In above line, we create a variable to store Message Box result. Variable Name: resp Type: VbMsgBoxResult \u0026#39; Loop through all Faces Do While Not swFace Is Nothing Loop\rIn above line, we loop through all Faces. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Select current face swFace.Select True\rIn above line, we select current face. This function is not available in üöÄ Solidworks Face object.\nSince üöÄ Solidworks Face object is also an üöÄ Solidworks Entity object, we can use methods from üöÄ Solidworks Entity object. {: .notice\u0026ndash;information}\n\u0026#39; Ask user to confirm this selection resp = MsgBox(\u0026#34;Is this correct Face?\u0026#34;, vbYesNo, \u0026#34;Select Face\u0026#34;)\rIn above line, we ask user to confirm this selection.\nWe do this in following steps.\nShow a Message Box to user as shown below. Store user response in resp variable. \u0026#39; Check if user response if Yes If resp = vbYes Then End If\rIn above code block, we check if user response if Yes. We use üöÄ IF statement for checking. Condition: resp = vbYes \u0026#39; Add current face to List of Faces Set vFaces(componentIndex + 1) = swFace Exit Function\rWhen user response if Yes, then above code execute. In above line, 1st we add current face to List of Faces. 2nd, we exit this SelectFace function. \u0026#39; Get next face Set swFace = swFace.GetNextFace\rIn above line, we set the value of swFace variable. This is done by GetNextFace method of swFace variable. Select Faces In this section, we Select Faces.\n\u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData\rPurpose: In above line, we create a variable for Solidworks Select Data. Variable Name: swSelData Type: SldWorks.SelectData Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Set value of Solidworks Select Data variable Set swSelData = swDoc.SelectionManager.CreateSelectData\rIn above line, we set value of swSelData variable. Value of swSelData variable is set by CreateSelectData, which is part of SelectionManager. This SelectionManager is part of swDoc variable. \u0026#39; Set Mark of Solidworks Select Data swSelData.Mark = 1\rIn above line, we set Mark of swSelData variable to 1. \u0026#39; Boolean variable Dim boolStatus As Boolean\rPurpose: In above line, we create a Boolean variable. Variable Name: boolStatus Type: Boolean \u0026#39; Select faces for Distance mate boolStatus = swDoc.Extension.MultiSelect2(vFaces, False, swSelData)\rIn above line, we select Faces by MultiSelect2 method. This MultiSelect2 method takes following parameter. Objects: Array of selectable objects. AppendFlag: True to append the objects to the selection list, False to replace the current selection list with these objects. Data: üöÄ ISelectData object, Nothing, or null \u0026#39; Check if faces are selected If boolStatus = False Then MsgBox \u0026#34;Failed to select faces.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully selected the faces. We use üöÄ IF statement for checking. Condition: boolStatus = False When this condition is True, We show and üöÄ message window to user. Message: Failed to select faces. Then we stop our macro here. Get unit Conversion factors Now we need to get unit Conversion factors as shown in below code.\n\u0026#39;-----------------------Unit Conversion Factors---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;----------------------------------------------------------------\rI have already explained about this in previous üëâ Solidworks Macro - Fix Unit Issue article in this website.\nPlease visit üëâ Solidworks Macro - Fix Unit Issue article for more details.\nGet Distance And Validations In this section, we get get the required Distance from user and apply some validation on Distance.\n\u0026#39; Variable to hold user input Dim response As String\rIn above line, we create a variable as a counter. Variable Name: response Type: String \u0026#39; Getting Distance from user. response = InputBox(\u0026#34;Please Enter [Distance]:\u0026#34;)\rIn above line of code we are doing 2 steps in one line.\nThose 2 steps are explained below.\nStep 1 - Getting Distance from user. Below image shows the message for Distance to the user.\nStep 2 - Assigned input value to response variable. \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; Exit Sub End If\rIn above code block, we check the length of input value. This check will handle case for empty value or cancel operation case. We use üöÄ IF statement for checking. Condition: Len(response) = 0 Len() is pre-build VBA function which check the length of a object. In above cases, we will get 0 value. When this condition is True, We show and üöÄ message window to user. Message: Empty or no value. Please try again. Then we stop our macro here. \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; Exit Sub End If\rIn above code block, we check if the input value is Non-numeric. This check will handle case for Non-numeric values. We use üöÄ IF statement for checking. Condition: IsNumeric(response) = False IsNumeric() is pre-build VBA function which check if passing object is Numeric or not. In above cases, we will get False value. When this condition is True, We show and üöÄ message window to user. Message: Entered value is Non-numeric. Please try again. Then we stop our macro here. \u0026#39; Variable for Distance Dim distance As Double\rIn above line, we create a variable to store Rib Thickness. Variable Name: distance Type: Double distance = CDbl(response) * LengthConversionFactor\rIn above line of code we are doing 3 steps in one line.\nThose 3 steps are explained below.\nStep 1 - Converting distance from user to Double type. Step 2 - Updating converted distance as per document unit system. Step 3 - Assigned input value to distance variable. \u0026#39; This will handle case for 0 distance If distance = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; Exit Sub End If\rIn above code block, we check if the input value is zero (0). This check will handle case for 0 thickness. We use üöÄ IF statement for checking. Condition: RibThickness = 0 When this condition is True, We show and üöÄ message window to user. Message: Entered value must be greater than 0. Please try again. Then we stop our macro here. Add Distance Mate In this section, we add Distance Mate.\n\u0026#39; Add Distance Mate Set swMateFeature = swAssembly.AddMate5(swMateDISTANCE, swMateAlignANTI_ALIGNED, False, distance, 0, 0, 0, 0, 0, 0, 0, False, False, 0, swAddMateError_ErrorUknown)\rIn above line, we set the value of variable swMateFeature by AddMate5 method.\nThis AddMate5 method takes following parameters as explained:\nMateTypeFromEnum - Type of mate as defined in swMateType_e:\nMember Description swMateANGLE 6 swMateCAMFOLLOWER 9 swMateCOINCIDENT 0 swMateCONCENTRIC 1 swMateCOORDINATE 20 swMateDISTANCE 5 swMateGEAR 10 swMateHINGE 22 swMateLINEARCOUPLER 18 swMateLOCK 16 swMateLOCKTOSKETCH 12 swMateMAGNETIC 25 swMateMAXMATES 14 swMatePARALLEL 3 swMatePATH 15 swMatePERPENDICULAR 2 swMatePROFILECENTER 24 swMateRACKPINION 13 swMateSCREW 17 swMateSLIDER 23 swMateSLOT 21 swMateSYMMETRIC 8 swMateTANGENT 4 swMateUNIVERSALJOINT 19 swMateUNKNOWN 7 swMateWIDTH 11 AlignFromEnum - Type of mate as defined in swMateAlign_e:\nMember Description swAlignAGAINST Obsolete. Do not use. swAlignNONE Obsolete. Do not use. swAlignSAME Obsolete. Do not use. swMateAlignALIGNED 0 swMateAlignANTI_ALIGNED 1 swMateAlignCLOSEST 2 Flip - True to flip the mate entities, False to not; valid only if MateTypeFromEnum is swMatetype_e.swMateDISTANCE.\nDistance - Distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nDistanceAbsUpperLimit - Absolute maximum distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nDistanceAbsLowerLimit - Absolute minimum distance value; valid only if MateTypeFromEnum is swMateType_e.swMateDISTANCE.\nGearRatioNumerator - Gear ratio numerator value; valid only if MateTypeFromEnum is swMateType_e.swMateGEAR.\nGearRatioDenominator - Gear ratio denominator value; valid only if MateTypeFromEnum is swMateType_e.swMateGEAR.\nAngle - Angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nAngleAbsUpperLimit - Absolute maximum angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nAngleAbsLowerLimit - Absolute minimum angle value; valid only if MateTypeFromEnum is swMateType_e.swMateANGLE.\nForPositioningOnly - True to only position the components according to the mating relationship and not return a mate, False to return a mate.\nLockRotation - True to lock component rotation, False to not.\nWidthMateOption - Width mate options as defined in swMateWidthOptions_e; valid only if MateTypeFromEnum is swMateType_e.swMateWIDTH.\nMember Description swMateWidth_Centered 0 swMateWidth_Dimension 2 swMateWidth_Free 1 swMateWidth_Percent 3 ErrorStatus - Success or error as defined by swAddMateError_e as follows.\nMember Description swAddMateError_ErrorUknown 0 swAddMateError_IncorrectAlignment 3 swAddMateError_IncorrectGearRatios 6 swAddMateError_IncorrectMateType 2 swAddMateError_IncorrectSelections 4 swAddMateError_NoError 1 swAddMateError_OverDefinedAssembly 5 Return Value : This AddMate5 method return üëâ Mate2 data object.\nIn our code, I have used following values:\nParameter Name Value Used MateTypeFromEnum swMateDISTANCE AlignFromEnum swMateAlignANTI_ALIGNED Flip false Distance distance DistanceAbsUpperLimit 0 DistanceAbsLowerLimit 0 GearRatioNumerator 0 GearRatioDenominator 0 Angle 0 AngleAbsUpperLimit 0 AngleAbsLowerLimit 0 ForPositioningOnly False LockRotation False WidthMateOption 0 ErrorStatus swAddMateError_ErrorUknown Reference: For more details about\nSolidworks AssemblyDoc details: üöÄ online Solidworks API Help for Solidworks Feature Manager. AddMate5 Method: üöÄ online Solidworks API Help for AddMate5 Method. \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully added Distance Mate or not. We use üöÄ IF statement for checking. Condition: swMateFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: *Failed to Add Mate. After that we clear the selection. Then we stop our macro here. Now we run the macro and after running macro we get Distance Mate as shown in below image.\nFinal work In this section, after adding Distance Mate, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True\rIn above line, we Rebuild assembly. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Distance Mate with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":166,"permalink":"/solidworks-vba-macros/assembly-distance-mate/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of adding \u003cstrong\u003eDistance Mate\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e of \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Add Distance Mate"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of adding Angle Mate in Assembly document of SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to add Angle Mate quickly.\nResults We Can Get After running our macro, we successfully add Angle Mate a Component in an Assembly as a result.\nBelow image shows the result we get.\nWe add Angle Mate in following steps in general.\nloop through each component in current assembly. Loop through each face. Get desired face from user confirmation. Select required faces for mate. Get Angle from user. Add Angle Mate. Final Work To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Adding Angle Mate from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Angle Mate.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Variable for Solidworks Body Dim swBody As SldWorks.Body2 \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature \u0026#39; Variable for Solidworks Face Dim swFace As SldWorks.Face2 \u0026#39; Variable for Solidworks Face List Dim vFaces(1 To 2) As SldWorks.Face2 \u0026#39; Variable for Solidworks Mate Feature Data Dim swMateData As SldWorks.MateFeatureData \u0026#39; Variable for Solidworks Angle Mate Feature Data Dim swAngleMateData As SldWorks.AngleMateFeatureData \u0026#39; Program to add Angle Mate Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Create Assembly Mate Data Set swMateData = swAssembly.CreateMateData(swMateType_e.swMateANGLE) \u0026#39; Set Angle Mate data to Assembly Mate Data Set swAngleMateData = swMateData \u0026#39; Set Mate Alignment swAngleMateData.MateAlignment = SwConst.swMateAlign_e.swMateAlignANTI_ALIGNED \u0026#39; Set Mate Flip Dimension swAngleMateData.FlipDimension = True \u0026#39; Variable for List of elements Dim vArray As Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True) \u0026#39; Variable for component Index Dim componentIndex As Integer \u0026#39; Loop Components List For componentIndex = 0 To UBound(vArray) \u0026#39; Set Solidworks Component variable Set swComponent = vArray(componentIndex) \u0026#39; Calling this function SelectFace swComponent, componentIndex Next \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData \u0026#39; Set value of Solidworks Select Data variable Set swSelData = swDoc.SelectionManager.CreateSelectData \u0026#39; Set Mark of Solidworks Select Data swSelData.Mark = 1 \u0026#39; Boolean variable Dim boolStatus As Boolean \u0026#39; Select faces for Concentric mate boolStatus = swDoc.Extension.MultiSelect2(vFaces, False, swSelData) \u0026#39; Check if faces are selected If boolStatus = False Then MsgBox \u0026#34;Failed to select faces.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Set Angle Mate Entities to Mate swAngleMateData.EntitiesToMate = vFaces \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39; Variable to hold user input Dim response As String \u0026#39; Getting Angle from user. response = InputBox(\u0026#34;Please Enter [Angle]:\u0026#34;) \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Variable for Angle Dim angle As Double \u0026#39; Set Angle angle = CDbl(response) * AngleConversionFactor \u0026#39; This will handle case for 0 Distance If angle = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Set Angle swAngleMateData.angle = angle \u0026#39; Add Angle Mate Set swMateFeature = swAssembly.CreateMate(swAngleMateData) \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Clear all selection swDoc.ClearSelection2 True \u0026#39; Zoom view to fit swDoc.ViewZoomtofit2 \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True End Sub \u0026#39; Function to select required face for Angle mate Function SelectFace(component As SldWorks.Component2, componentIndex As Integer) \u0026#39; Get body of current component Set swBody = component.GetBody \u0026#39; Get First face Set swFace = swBody.GetFirstFace \u0026#39; Variable to store Message Box result Dim resp As VbMsgBoxResult \u0026#39; Loop through all Faces Do While Not swFace Is Nothing \u0026#39; Clear selection swDoc.ClearSelection2 True \u0026#39; Select current face swFace.Select True \u0026#39; Ask user to confirm this selection resp = MsgBox(\u0026#34;Is this correct Face?\u0026#34;, vbYesNo, \u0026#34;Select Face\u0026#34;) \u0026#39; Check if user response if Yes If resp = vbYes Then \u0026#39; Add current face to List of Faces Set vFaces(componentIndex + 1) = swFace Exit Function End If \u0026#39; Get next face Set swFace = swFace.GetNextFace Loop End Function\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired.\nWe use existing parts in Assembly document.\nOne component is fully constraint and other component is Float as shown in below image.\nWe will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate and Initialize required variables Get Components and Loop through them Get desired face Select faces Get unit conversion factors Get angle and Validations Add angular Mate Final Work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate and Initialize required variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Body Dim swBody As SldWorks.Body2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swBody Type: SldWorks.Body2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Mate Feature. Variable Name: swMateFeature Type: SldWorks.Feature. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Face Dim swFace As SldWorks.Face2\rPurpose: In above line, we create a variable for Solidworks Face. Variable Name: swFace Type: SldWorks.Face2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Face List Dim vFaces(1 To 2) As SldWorks.Face2\rPurpose: Define üöÄ Array of Face2. Variable Name: vFaces Type: Face2 Length of Array: (1 To 2) Reference: Please visit For Arrays in VBA : üöÄ Array on this website. \u0026#39; Variable for Solidworks Mate Feature Data Dim swMateData As SldWorks.MateFeatureData\rPurpose: In above line, we create a variable for Solidworks Mate Feature Data. Variable Name: swMateData Type: SldWorks.MateFeatureData. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Angle Mate Feature Data Dim swAngleMateData As SldWorks.AngleMateFeatureData\rPurpose: In above line, we create a variable for Solidworks Angle Mate Feature Data. Variable Name: swAngleMateData Type: SldWorks.AngleMateFeatureData. Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to add Angle Mate Sub main() End Sub\rIn above line, we create main Program to add Angle Mate in assembly. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. \u0026#39; Create Assembly Mate Data Set swMateData = swAssembly.CreateMateData(swMateType_e.swMateANGLE)\rIn above line, we set the value of swMateData variable.\nWe set value by CreateMateData() method.\nThis CreateMateData() method is part of swAssembly variable.\nThis CreateMateData() method takes following parameter.\nType: Type of mate to create as defined in swMateType_e in below table. Member Description swMateANGLE 6 swMateCAMFOLLOWER 9 swMateCOINCIDENT 0 swMateCONCENTRIC 1 swMateCOORDINATE 20 swMateDISTANCE 5 swMateGEAR 10 swMateHINGE 22 swMateLINEARCOUPLER 18 swMateLOCK 16 swMateLOCKTOSKETCH 12 swMateMAGNETIC 25 swMateMAXMATES 14 swMatePARALLEL 3 swMatePATH 15 swMatePERPENDICULAR 2 swMatePROFILECENTER 24 swMateRACKPINION 13 swMateSCREW 17 swMateSLIDER 23 swMateSLOT 21 swMateSYMMETRIC 8 swMateTANGENT 4 swMateUNIVERSALJOINT 19 swMateUNKNOWN 7 swMateWIDTH 11 Since we want to add Angle mate, hence we use value swMateANGLE as type.\nReference: Please visit üöÄ online SOLIDWORKS API Help.\n\u0026#39; Set Angle Mate data to Assembly Mate Data Set swAngleMateData = swMateData\rIn above line, we set Angle Mate data to previously created Assembly Mate data. We set value of variable swAngleMateData to variable swMateData. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Set Mate Alignment swAngleMateData.MateAlignment = SwConst.swMateAlign_e.swMateAlignANTI_ALIGNED\rIn above line, set the Mate Alignment =\u0026gt; \u0026ldquo;ANTI ALIGNED\u0026rdquo;. \u0026#39; Set Mate Flip Dimension swAngleMateData.FlipDimension = True\rIn above line, we set value of Mate Flip Dimension =\u0026gt; True. Get Components and Loop through them In this section, we Get Components and Loop through them.\n\u0026#39; Variable for List of elements Dim vArray As Variant\rPurpose: In above line, we create a variable for List of elements. Variable Name: vArray Type: Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True)\rIn above line, we set the value of vArray variable. We set value by GetComponents method of swAssembly variable. \u0026#39; Variable for component Index Dim componentIndex As Integer\rIn above line, we create a variable for component Index as a counter. Variable Name: componentIndex Type: Integer \u0026#39; Loop Components List For componentIndex = 0 To UBound(vArray) Next\rIn above line, we create a For loop. This loops start from i = 0 to maximum number of items in vArray we select. \u0026#39; Set Solidworks Component variable Set swComponent = vArray(componentIndex)\rIn above line, we set value of swComponent variable. This value is current value of array vArray. Get desired face In this section we get desired face for Angular mate.\n\u0026#39; Calling this function SelectFace swComponent, componentIndex\rIn above line, we call a function. Function Name: SelectFace Function Parameters: They are swComponent componentIndex \u0026#39; Function to select required face for Tangent mate Function SelectFace(component As SldWorks.Component2, componentIndex As Integer) End Function\rIn above line, we create a Function to select required face for Tangent mate. This is a Function procedure which has name of SelectFace. This procedure hold all the statements (instructions) for select required face for Tangent mate. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. This function has 2 parameters as follows:\ncomponent As SldWorks.Component2 componentIndex As Integer \u0026#39; Get body of current component Set swBody = component.GetBody\rIn above line, we set value of swBody variable. Value of swBody variable is set by GetBody method of component variable. \u0026#39; Get First face Set swFace = swBody.GetFirstFace\rIn above line, we set value of swFace variable. Value of swFace variable is set by GetFirstFace, which is part of swBody variable. \u0026#39; Variable to store Message Box result Dim resp As VbMsgBoxResult\rPurpose: In above line, we create a variable to store Message Box result. Variable Name: resp Type: VbMsgBoxResult \u0026#39; Loop through all Faces Do While Not swFace Is Nothing Loop\rIn above line, we loop through all Faces. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Select current face swFace.Select True\rIn above line, we select current face. This function is not available in üöÄ Solidworks Face object.\nSince üöÄ Solidworks Face object is also an üöÄ Solidworks Entity object, we can use methods from üöÄ Solidworks Entity object. {: .notice\u0026ndash;information}\n\u0026#39; Ask user to confirm this selection resp = MsgBox(\u0026#34;Is this correct Face?\u0026#34;, vbYesNo, \u0026#34;Select Face\u0026#34;)\rIn above line, we ask user to confirm this selection.\nWe do this in following steps.\nShow a Message Box to user as shown below. Store user response in resp variable. \u0026#39; Check if user response if Yes If resp = vbYes Then End If\rIn above code block, we check if user response if Yes. We use üöÄ IF statement for checking. Condition: resp = vbYes \u0026#39; Add current face to List of Faces Set vFaces(componentIndex + 1) = swFace Exit Function\rWhen user response if Yes, then above code execute. In above line, 1st we add current face to List of Faces. 2nd, we exit this SelectFace function. \u0026#39; Get next face Set swFace = swFace.GetNextFace\rIn above line, we set the value of swFace variable. This is done by GetNextFace method of swFace variable. Select Faces In this section, we Select Faces.\n\u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData\rPurpose: In above line, we create a variable for Solidworks Select Data. Variable Name: swSelData Type: SldWorks.SelectData Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Set value of Solidworks Select Data variable Set swSelData = swDoc.SelectionManager.CreateSelectData\rIn above line, we set value of swSelData variable. Value of swSelData variable is set by CreateSelectData, which is part of SelectionManager. This SelectionManager is part of swDoc variable. \u0026#39; Set Mark of Solidworks Select Data swSelData.Mark = 1\rIn above line, we set Mark of swSelData variable to 1. \u0026#39; Boolean variable Dim boolStatus As Boolean\rPurpose: In above line, we create a Boolean variable. Variable Name: boolStatus Type: Boolean \u0026#39; Select faces for Angular mate boolStatus = swDoc.Extension.MultiSelect2(vFaces, False, swSelData)\rIn above line, we select Faces by MultiSelect2 method. This MultiSelect2 method takes following parameter. Objects: Array of selectable objects. AppendFlag: True to append the objects to the selection list, False to replace the current selection list with these objects. Data: üöÄ ISelectData object, Nothing, or null \u0026#39; Check if faces are selected If boolStatus = False Then MsgBox \u0026#34;Failed to select faces.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully selected the faces. We use üöÄ IF statement for checking. Condition: boolStatus = False When this condition is True, We show and üöÄ message window to user. Message: Failed to select faces. Then we stop our macro here. Get unit Conversion factors Now we need to get unit Conversion factors as shown in below code.\n\u0026#39;-----------------------Unit Conversion Factors---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;----------------------------------------------------------------\rI have already explained about this in previous üëâ Solidworks Macro - Fix Unit Issue article in this website.\nPlease visit üëâ Solidworks Macro - Fix Unit Issue article for more details.\nGet Angle And Validations In this section, we get get the required Angle from user and apply some validation on Input Angle.\n\u0026#39; Variable to hold user input Dim response As String\rIn above line, we create a variable as a counter. Variable Name: response Type: String \u0026#39; Getting Angle from user. response = InputBox(\u0026#34;Please Enter [Angle]:\u0026#34;)\rIn above line of code we are doing 2 steps in one line.\nThose 2 steps are explained below.\nStep 1 - Getting Angle from user. Below image shows the message for Angle to the user.\nStep 2 - Assigned input value to response variable. \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; Exit Sub End If\rIn above code block, we check the length of input value. This check will handle case for empty value or cancel operation case. We use üöÄ IF statement for checking. Condition: Len(response) = 0 Len() is pre-build VBA function which check the length of a object. In above cases, we will get 0 value. When this condition is True, We show and üöÄ message window to user. Message: Empty or no value. Please try again. Then we stop our macro here. \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; Exit Sub End If\rIn above code block, we check if the input value is Non-numeric. This check will handle case for Non-numeric values. We use üöÄ IF statement for checking. Condition: IsNumeric(response) = False IsNumeric() is pre-build VBA function which check if passing object is Numeric or not. In above cases, we will get False value. When this condition is True, We show and üöÄ message window to user. Message: Entered value is Non-numeric. Please try again. Then we stop our macro here. \u0026#39; Variable for angle Dim angle As Double\rIn above line, we create a variable to store Rib Thickness. Variable Name: angle Type: Double angle = CDbl(response) * AngleConversionFactor\rIn above line of code we are doing 3 steps in one line.\nThose 3 steps are explained below.\nStep 1 - Converting angle from user to Double type. Step 2 - Updating converted distance as per document unit system. Step 3 - Assigned input value to angle variable. \u0026#39; This will handle case for 0 distance If distance = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; Exit Sub End If\rIn above code block, we check if the input value is zero (0). This check will handle case for 0 thickness. We use üöÄ IF statement for checking. Condition: RibThickness = 0 When this condition is True, We show and üöÄ message window to user. Message: Entered value must be greater than 0. Please try again. Then we stop our macro here. Add Angle Mate In this section, we add Angle Mate.\n\u0026#39; Set Angle swAngleMateData.angle = angle\rIn above line, Mate Angle of swAngleMateData =\u0026gt; angle variable. \u0026#39; Add Angle Mate Set swMateFeature = swAssembly.CreateMate(swAngleMateData)\rIn above line, we set the value of variable swMateFeature by CreateMate() method.\nThis CreateMate() method takes following parameters as explained:\nMateData - Mate-specific object: Mate-specific object IAngleMateFeatureData ICamFollowerMateFeatureData ICoincidentMateFeatureData IConcentricMateFeatureData IDistanceMateFeatureData IGearMateFeatureData IHingeMateFeatureData ILinearCouplerMateFeatureData ILockMateFeatureData IParallelMateFeatureData IPerpendicularMateFeatureData IProfileCenterMateFeatureData IRackPinionMateFeatureData IScrewMateFeatureData ISlotMateFeatureData ISymmetricMateFeatureData ITangentMateFeatureData IUniversalJointMateFeatureData IWidthMateFeatureData Return Value : This CreateMate() method return üëâ Mate2 data object.\nIn our code, I have used following values:\nParameter Name Value Used MateData swAngleMateData Reference: For more details about\nSolidworks AssemblyDoc details: üöÄ online Solidworks API Help for Solidworks Feature Manager. CreateMate Method: üöÄ online Solidworks API Help for CreateMate Method. \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully added Angle Mate or not. We use üöÄ IF statement for checking. Condition: swMateFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: *Failed to Add Mate. After that we clear the selection. Then we stop our macro here. Now we run the macro and after running macro we get Angle Mate as shown in below image.\nFinal work In this section, after adding Angle Mate, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True\rIn above line, we Rebuild assembly. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Angle Mate with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":167,"permalink":"/solidworks-vba-macros/assembly-angle-mate/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of adding \u003cstrong\u003eAngle Mate\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e of \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Add Angle Mate"},{"content":"{% include article-notes/advance-note.html %}\nObjective In this article we create and understand VBA macro of adding Width Mate in Assembly document of SOLIDWORKS CAD Software.\nThis method is most updated method, so use this method if you want to add Width Mate quickly.\nResults We Can Get After running our macro, we successfully add Width Mate a Component in our Assembly as a result.\nBelow image shows the result we get.\nWe add Width Mate in following steps in general.\nloop through each component in current assembly. Loop through each face. Get desired face from user confirmation. Select required faces for mate. Add Width Mate. Final Work To get the correct result please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Adding Width Mate from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there are no explanation.\nI have explained each and every line in this article.\nIt is advisable to watch video, since it help you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Width Mate.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Variable for Solidworks Body Dim swBody As SldWorks.Body2 \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature \u0026#39; Variable for Solidworks Face Dim swFace As SldWorks.Face2 \u0026#39; Variable for Solidworks Tab Face List Dim vTabFaces(1 To 2) As SldWorks.Face2 \u0026#39; Variable for Solidworks Width Face List Dim vWidthFaces(1 To 2) As SldWorks.Face2 \u0026#39; Variable for Solidworks Mate Feature Data Dim swMateData As SldWorks.MateFeatureData \u0026#39; Variable for Solidworks Width Mate Feature Data Dim swWidthMateData As SldWorks.WidthMateFeatureData \u0026#39; Program to add Width Mate Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Create Assembly Mate Data Set swMateData = swAssembly.CreateMateData(swMateType_e.swMateWIDTH) \u0026#39; Set Width Mate data to Assembly Mate Data Set swWidthMateData = swMateData \u0026#39; Set Mate Type swWidthMateData.ConstraintType = swMateWidthOptions_e.swMateWidth_Centered \u0026#39; Variable for List of elements Dim vArray As Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True) \u0026#39; Variable for component Index Dim componentIndex As Integer \u0026#39; Loop Components List For componentIndex = 0 To UBound(vArray) \u0026#39; Set Solidworks Component variable Set swComponent = vArray(componentIndex) \u0026#39; Calling this function GetFaces swComponent, componentIndex Next \u0026#39; Select Faces for Width Mate If SelectFaces() = False Then \u0026#39; On failed select, return from here. Exit Sub End If \u0026#39; Set Width Mate Tab faces swWidthMateData.TabSelection = vTabFaces \u0026#39; Set Width Mate Width faces swWidthMateData.WidthSelection = vWidthFaces \u0026#39; Add Width Mate Set swMateFeature = swAssembly.CreateMate(swWidthMateData) \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Clear all selection swDoc.ClearSelection2 True \u0026#39; Zoom view to fit swDoc.ViewZoomtofit2 \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True End Sub \u0026#39; Function to get required face for Width mate Function GetFaces(component As SldWorks.Component2, componentIndex As Integer) \u0026#39; Get body of current component Set swBody = component.GetBody \u0026#39; Get First face Set swFace = swBody.GetFirstFace \u0026#39; Variable to store Message Box result Dim resp As VbMsgBoxResult \u0026#39; Variable to count added faces Dim faceNumber As Integer: faceNumber = 0 \u0026#39; Loop through all Faces Do While Not swFace Is Nothing \u0026#39; Clear selection swDoc.ClearSelection2 True \u0026#39; Select current face swFace.Select True \u0026#39; Ask user to confirm this selection resp = MsgBox(\u0026#34;Is this correct Face?\u0026#34;, vbYesNo, \u0026#34;Select Face\u0026#34;) \u0026#39; Check if user response if Yes If resp = vbYes Then \u0026#39; Calling function for adding faces AddFaces faceNumber, componentIndex \u0026#39; Increment face count faceNumber = faceNumber + 1 End If \u0026#39; When both faces are added If faceNumber = 2 Then Exit Function End If \u0026#39; Get next face Set swFace = swFace.GetNextFace Loop End Function \u0026#39; Function to add Faces for Width mate Function AddFaces(faceNumber As Integer, componentIndex As Integer) If componentIndex = 1 Then \u0026#39; Add current face to List of Faces Set vWidthFaces(faceNumber + 1) = swFace Exit Function End If \u0026#39; Add current face to List of Faces Set vTabFaces(faceNumber + 1) = swFace End Function \u0026#39; Function to select faces for Width mate Function SelectFaces() As Boolean \u0026#39; Clear any previous selection swDoc.ClearSelection2 True \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData \u0026#39; Set value of Solidworks Select Data variable Set swSelData = swDoc.SelectionManager.CreateSelectData \u0026#39; Variable to hold return value of SelectFaceArrays function Dim returnValue As Boolean \u0026#39; Calling function to select Tab faces returnValue = SelectFaceArrays(swSelData, 1) \u0026#39; Calling function to select Width faces returnValue = SelectFaceArrays(swSelData, 16) \u0026#39; Send this return value SelectFaces = returnValue End Function \u0026#39; Function to Select Required Face Arrays Function SelectFaceArrays(swSelData As SldWorks.SelectData, selectMark As Integer) As Boolean \u0026#39; Set Mark of Solidworks Select Data swSelData.mark = selectMark \u0026#39; Boolean variable Dim boolStatus As Boolean \u0026#39; Error Message Dim errorMessage As String If selectMark = 1 Then \u0026#39; Select Tab faces boolStatus = swDoc.Extension.MultiSelect2(vTabFaces, False, swSelData) errorMessage = \u0026#34;Failed to select Tab faces.\u0026#34; Else \u0026#39; Select Width faces boolStatus = swDoc.Extension.MultiSelect2(vWidthFaces, False, swSelData) errorMessage = \u0026#34;Failed to select Width faces.\u0026#34; End If \u0026#39; Check if faces are selected If boolStatus = False Then MsgBox errorMessage swDoc.ClearSelection2 True SelectFaceArrays = boolStatus Exit Function End If SelectFaceArrays = True End Function\rPrerequisite There are some prerequisite for this article.\nKnowledge of VBA programming language is ‚ùórequired.\nWe use existing parts in Assembly document.\nOne component is fully constraint and other component is Float as shown in below image.\nWe will apply checks in this article, so the code we write should be error free most of the time. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate and Initialize required variables Get Components and Loop through them Get faces Select faces Add Width Mate Final Work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate and Initialize required variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Body Dim swBody As SldWorks.Body2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swBody Type: SldWorks.Body2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Mate Feature. Variable Name: swMateFeature Type: SldWorks.Feature. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Face Dim swFace As SldWorks.Face2\rPurpose: In above line, we create a variable for Solidworks Face. Variable Name: swFace Type: SldWorks.Face2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Tab Face List Dim vTabFaces(1 To 2) As SldWorks.Face2\rPurpose: Define üöÄ Array of Face2. Variable Name: vTabFaces Type: Face2 Length of Array: (1 To 2) Reference: Please visit For Arrays in VBA : üöÄ Array on this website. \u0026#39; Variable for Solidworks Width Face List Dim vWidthFaces(1 To 2) As SldWorks.Face2\rPurpose: Define üöÄ Array of Face2. Variable Name: vWidthFaces Type: Face2 Length of Array: (1 To 2) Reference: Please visit For Arrays in VBA : üöÄ Array on this website. \u0026#39; Variable for Solidworks Mate Feature Data Dim swMateData As SldWorks.MateFeatureData\rPurpose: In above line, we create a variable for Solidworks Mate Feature Data. Variable Name: swMateData Type: SldWorks.MateFeatureData. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Width Mate Feature Data Dim swWidthMateData As SldWorks.WidthMateFeatureData\rPurpose: In above line, we create a variable for Solidworks Width Mate Feature Data. Variable Name: swWidthMateData Type: SldWorks.WidthMateFeatureData. Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to add Width Mate Sub main() End Sub\rIn above line, we create main Program to add Width Mate in assembly. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. \u0026#39; Create Assembly Mate Data Set swMateData = swAssembly.CreateMateData(swMateType_e.swMateWIDTH)\rIn above line, we set the value of swMateData variable.\nWe set value by CreateMateData() method.\nThis CreateMateData() method is part of swAssembly variable.\nThis CreateMateData() method takes following parameter.\nType: Type of mate to create as defined in swMateType_e in below table. Member Description swMateANGLE 6 swMateCAMFOLLOWER 9 swMateCOINCIDENT 0 swMateCONCENTRIC 1 swMateCOORDINATE 20 swMateDISTANCE 5 swMateGEAR 10 swMateHINGE 22 swMateLINEARCOUPLER 18 swMateLOCK 16 swMateLOCKTOSKETCH 12 swMateMAGNETIC 25 swMateMAXMATES 14 swMatePARALLEL 3 swMatePATH 15 swMatePERPENDICULAR 2 swMatePROFILECENTER 24 swMateRACKPINION 13 swMateSCREW 17 swMateSLIDER 23 swMateSLOT 21 swMateSYMMETRIC 8 swMateTANGENT 4 swMateUNIVERSALJOINT 19 swMateUNKNOWN 7 swMateWIDTH 11 Since we want to add Width mate, hence we use value swMateWIDTH as type.\nReference: Please visit üöÄ online SOLIDWORKS API Help.\n\u0026#39; Set Width Mate data to Assembly Mate Data Set swWidthMateData = swMateData\rIn above line, we set Width Mate data to previously created Assembly Mate data. We set value of variable swWidthMateData to variable swMateData. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Set Mate Type swWidthMateData.ConstraintType = swMateWidthOptions_e.swMateWidth_Centered\rIn above line, set the \u0026ldquo;Mate Type\u0026rdquo; ‚û° \u0026ldquo;Centered\u0026rdquo; Type as shown in below image. Get Components and Loop through them In this section, we Get Components and Loop through them.\n\u0026#39; Variable for List of elements Dim vArray As Variant\rPurpose: In above line, we create a variable for List of elements. Variable Name: vArray Type: Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True)\rIn above line, we set the value of vArray variable. We set value by GetComponents method of swAssembly variable. \u0026#39; Variable for component Index Dim componentIndex As Integer\rIn above line, we create a variable for component Index as a counter. Variable Name: componentIndex Type: Integer \u0026#39; Loop Components List For componentIndex = 0 To UBound(vArray) Next\rIn above line, we create a For loop. This loops start from i = 0 to maximum number of items in vArray we select. \u0026#39; Set Solidworks Component variable Set swComponent = vArray(componentIndex)\rIn above line, we set value of swComponent variable. This value is current value of array vArray. Get Faces In this section we get desired face for Width mate.\n\u0026#39; Calling this function GetFaces swComponent, componentIndex\rIn above line, we call a function. Function Name: GetFaces Function Parameters: They are swComponent componentIndex \u0026#39; Function to get required face for Tangent mate Function GetFaces(component As SldWorks.Component2, componentIndex As Integer) End Function\rIn above line, we create a Function to select required face for Tangent mate. This is a Function procedure which has name of SelectFace. This procedure hold all the statements (instructions) for select required face for Tangent mate. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. This function has 2 parameters as follows:\ncomponent As SldWorks.Component2 componentIndex As Integer \u0026#39; Get body of current component Set swBody = component.GetBody\rIn above line, we set value of swBody variable. Value of swBody variable is set by GetBody method of component variable. \u0026#39; Get First face Set swFace = swBody.GetFirstFace\rIn above line, we set value of swFace variable. Value of swFace variable is set by GetFirstFace, which is part of swBody variable. \u0026#39; Variable to store Message Box result Dim resp As VbMsgBoxResult\rPurpose: In above line, we create a variable to store Message Box result. Variable Name: resp Type: VbMsgBoxResult \u0026#39; Variable to count added faces Dim faceNumber As Integer: faceNumber = 0\rPurpose: In above line, we create a variable to count number of faces added. At the same time we set the value of this variable faceNumber to 0 i.e. faceNumber = 0 Variable Name: faceNumber Type: Integer \u0026#39; Loop through all Faces Do While Not swFace Is Nothing Loop\rIn above line, we loop through all üöÄ Faces of current component. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Select current face swFace.Select True\rIn above line, we select current face. This function is not available in üöÄ Solidworks Face object.\nSince üöÄ Solidworks Face object is also an üöÄ Solidworks Entity object, we can use methods from üöÄ Solidworks Entity object.\n{: .notice\u0026ndash;warning}\n\u0026#39; Ask user to confirm this selection resp = MsgBox(\u0026#34;Is this correct Face?\u0026#34;, vbYesNo, \u0026#34;Select Face\u0026#34;)\rIn above line, we ask user to confirm this selection.\nWe do this in following steps.\nShow a Message Box to user as shown below. Store user response in resp variable. \u0026#39; Check if user response if Yes If resp = vbYes Then End If\rIn above code block, we check if user response if Yes. We use üöÄ IF statement for checking. Condition: resp = vbYes \u0026#39; Calling function for adding faces AddFaces faceNumber, componentIndex\rIn above line, we call a function. Function Name: AddFaces Function Parameters: They are faceNumber componentIndex \u0026#39; Function to add Faces for Width mate Function AddFaces(faceNumber As Integer, componentIndex As Integer) End Function\rIn above line, we create a üöÄ Function to add required face for Width mate. Name of üöÄ Function is AddFaces. This procedure hold all the statements (instructions) for adding required faces for Width mate. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. This function has 2 parameters as follows:\nfaceNumber As Integer componentIndex As Integer If componentIndex = 1 Then End If\rIn above code block, we check if componentIndex is 1. We use üöÄ IF statement for checking. Condition: componentIndex = 1 \u0026#39; Add current face to List of Width Faces Set vWidthFaces(faceNumber + 1) = swFace Exit Function\rWhen componentIndex is 1, then above code execute. In above line, 1st we add current face to List of Width Faces. 2nd, we exit this AddFaces function. \u0026#39; Add current face to List of Faces Set vTabFaces(faceNumber + 1) = swFace\rWhen componentIndex is not 1, then above code execute. In above line, 1st we add current face to List of Tab Faces. 2nd, we exit this AddFaces function. \u0026#39; Increment face count faceNumber = faceNumber + 1\rIn above line, we Increment face count variable i.e. faceNumber by 1. \u0026#39; When both faces are added If faceNumber = 2 Then Exit Function End If\rIn above code block, we check if faceNumber is 2. We use üöÄ IF statement for checking. Condition: faceNumber = 2 When this condition is True, then we exit GetFaces function. \u0026#39; Get next face Set swFace = swFace.GetNextFace\rIn above line, we set the value of swFace variable. This is done by GetNextFace method of swFace variable. Select Faces In this section, we Select Faces.\n\u0026#39; Select Faces for Width Mate If SelectFaces() = False Then \u0026#39; On failed select, return from here. Exit Sub End If\rIn above code block, we check the returning value of function SelectFaces(). We use üöÄ IF statement for checking. Condition: SelectFaces() = False When this condition is True, then we exit main procedure. In above condition, we call a SelectFaces() function. Function Name: SelectFaces Function Parameters: This function did not take any parameters. Return Value: This function return True or False. \u0026#39; Function to select faces for Width mate Function SelectFaces() As Boolean End Function\rIn above line, we create a üöÄ Function to select required face for Width mate. Name of üöÄ Function is SelectFaces. This procedure hold all the statements (instructions) for Selecting required faces for Width mate. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Function Parameters: This function did not take any parameters. Return Value: This function return True or False. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all previous selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Variable for Solidworks Select Data Dim swSelData As SldWorks.SelectData\rPurpose: In above line, we create a variable for Solidworks Select Data. Variable Name: swSelData Type: SldWorks.SelectData Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Set value of Solidworks Select Data variable Set swSelData = swDoc.SelectionManager.CreateSelectData\rIn above line, we set value of swSelData variable. Value of swSelData variable is set by CreateSelectData, which is part of SelectionManager. This SelectionManager is part of swDoc variable. \u0026#39; Variable to hold return value of SelectFaceArrays function Dim returnValue As Boolean\rPurpose: In above line, we create a variable to hold return value of SelectFaceArrays function. Variable Name: returnValue Type: Boolean \u0026#39; Calling function to select Tab faces returnValue = SelectFaceArrays(swSelData, 1)\rIn above line, we are doing 2 things at same time. Calling SelectFaceArrays function. Function Name: SelectFaceArrays Function Parameters: They are swSelData 1 Setting value of returnValue variable. This value is return value of SelectFaceArrays function. \u0026#39; Function to Select Required Face Arrays Function SelectFaceArrays(swSelData As SldWorks.SelectData, selectMark As Integer) As Boolean End Function\rIn above line, we create a üöÄ Function to select required Face Arrays. Name of üöÄ Function is SelectFaceArrays. This procedure hold all the statements (instructions) for Selecting Required Face Arrays. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Function Parameters: They are swSelData As SldWorks.SelectData selectMark As Integer Return Value: This function return True or False. \u0026#39; Set Mark of Solidworks Select Data swSelData.Mark = selectMark\rIn above line, we set Mark of swSelData variable to 1. \u0026#39; Boolean variable Dim boolStatus As Boolean\rPurpose: In above line, we create a Boolean variable. Variable Name: boolStatus Type: Boolean \u0026#39; Error Message Dim errorMessage As String\rPurpose: In above line, we create a variable for Error Message. Variable Name: errorMessage Type: String If selectMark = 1 Then \u0026#39; Select Tab faces boolStatus = swDoc.Extension.MultiSelect2(vTabFaces, False, swSelData) errorMessage = \u0026#34;Failed to select Tab faces.\u0026#34; Else \u0026#39; Select Width faces boolStatus = swDoc.Extension.MultiSelect2(vWidthFaces, False, swSelData) errorMessage = \u0026#34;Failed to select Width faces.\u0026#34; End If\rIn above code block, we check the returning value of selectMark variable. We use üöÄ IF statement for checking this condition. Condition: selectMark = 1 When above condition is True, then below code executes and select Tab Faces. \u0026#39; Select Tab faces boolStatus = swDoc.Extension.MultiSelect2(vTabFaces, False, swSelData) errorMessage = \u0026#34;Failed to select Tab faces.\u0026#34;\rIn above line, we select Faces by MultiSelect2 method.\nThis MultiSelect2 method takes following parameter.\nObjects: Array of selectable objects. AppendFlag: True to append the objects to the selection list, False to replace the current selection list with these objects. Data: üöÄ ISelectData object, Nothing, or null When condition selectMark = 1 is False, then below code executes and select Width Faces.\n\u0026#39; Select Width faces boolStatus = swDoc.Extension.MultiSelect2(vWidthFaces, False, swSelData) errorMessage = \u0026#34;Failed to select Width faces.\u0026#34;\rIn above line, we select Faces by MultiSelect2 method. This MultiSelect2 method takes following parameter. Objects: Array of selectable objects. AppendFlag: True to append the objects to the selection list, False to replace the current selection list with these objects. Data: üöÄ ISelectData object, Nothing, or null \u0026#39; Check if faces are selected If boolStatus = False Then MsgBox errorMessage swDoc.ClearSelection2 True SelectFaceArrays = boolStatus Exit Function End If\rIn above code block, we check if we successfully selected the faces. We use üöÄ IF statement for checking. Condition: boolStatus = False When this condition is True, We show and üöÄ message window to user. Message: errorMessage variable contains the message. Clear all previous selection. Then we set the value of this SelectFaceArrays() function to boolStatus variable. Then we Exit this SelectFaceArrays() function. SelectFaceArrays = True\rIf there are no errors then in above line, we set the value of this SelectFaceArrays() function to True and then exit the function.\n\u0026#39; Calling function to select Width faces returnValue = SelectFaceArrays(swSelData, 16)\rIn above line, we are doing 2 things at same time. Calling SelectFaceArrays function. Function Name: SelectFaceArrays Function Parameters: They are swSelData 16 Setting value of returnValue variable. This value is return value of SelectFaceArrays function. \u0026#39; Send this return value SelectFaces = returnValue\rIn above line, we return the value of returnValue variable for this function.\nAdd Width Mate In this section, we add Width Mate.\n\u0026#39; Set Width Mate Tab faces swWidthMateData.TabSelection = vTabFaces\rIn above line we set TabSelection of swWidthMateData =\u0026gt; vTabFaces variable. \u0026#39; Set Width Mate Width faces swWidthMateData.WidthSelection = vWidthFaces\rIn above line we set WidthSelection of swWidthMateData =\u0026gt; vWidthFaces variable. \u0026#39; Add Width Mate Set swMateFeature = swAssembly.CreateMate(swWidthMateData)\rIn above line, we set the value of variable swMateFeature by CreateMate() method.\nThis CreateMate() method takes following parameters as explained:\nMateData - Mate-specific object: Mate-specific object IAngleMateFeatureData ICamFollowerMateFeatureData ICoincidentMateFeatureData IConcentricMateFeatureData IDistanceMateFeatureData IGearMateFeatureData IHingeMateFeatureData ILinearCouplerMateFeatureData ILockMateFeatureData IParallelMateFeatureData IPerpendicularMateFeatureData IProfileCenterMateFeatureData IRackPinionMateFeatureData IScrewMateFeatureData ISlotMateFeatureData ISymmetricMateFeatureData ITangentMateFeatureData IUniversalJointMateFeatureData IWidthMateFeatureData Return Value : This CreateMate() method return üëâ Mate2 data object.\nIn our code, I have used following values:\nParameter Name Value Used MateData swWidthMateData Reference: For more details about\nSolidworks AssemblyDoc details: üöÄ online Solidworks API Help for Solidworks Feature Manager. CreateMate Method: üöÄ online Solidworks API Help for CreateMate Method. \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully added Width Mate or not. We use üöÄ IF statement for checking. Condition: swMateFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: *Failed to Add Mate. After that we clear the selection. Then we stop our macro here. Now we run the macro and after running macro we get Width Mate as shown in below image.\nFinal work In this section, after adding Width Mate, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True\rIn above line, we Rebuild assembly. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Width Mate with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":168,"permalink":"/solidworks-vba-macros/assembly-width-mate/","summary":"\u003cp\u003e{% include article-notes/advance-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of adding \u003cstrong\u003eWidth Mate\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e of \u003cem\u003eSOLIDWORKS CAD Software\u003c/em\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Add Width Mate"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article we create and understand VBA macro of adding Symmetric Mate in Assembly document.\nThis method is most updated method, so use this method if you want to add Symmetric Mate.\nResults We Can Get After running our macro, we successfully add Symmetric Mate as a result.\nBelow image shows the result we get.\nWe add Symmetric Mate in following steps.\nloop through each component in current assembly. Loop through each face. Get desired face. Add Symmetric Mate. Final Work To get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows Adding Symmetric Mate from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Symmetric Mate.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Variable for Solidworks Body Dim swBody As SldWorks.Body2 \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature \u0026#39; Variable for Solidworks Face Dim swFace As SldWorks.Face2 \u0026#39; Variable for Solidworks Face List Dim vFaces(1 To 2) As SldWorks.Face2 \u0026#39; Variable for Solidworks Mate Feature Data Dim swMateData As SldWorks.MateFeatureData \u0026#39; Variable for Solidworks Symmetric Mate Feature Data Dim swSymmetricMateData As SldWorks.SymmetricMateFeatureData \u0026#39; Program to add Symmetric Mate Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Variable for List of elements Dim vArray As Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True) \u0026#39; Variable for component Index Dim componentIndex As Integer \u0026#39; Loop Components List For componentIndex = 0 To UBound(vArray) \u0026#39; Set Solidworks Component variable Set swComponent = vArray(componentIndex) \u0026#39; Calling this function GetFaces swComponent, componentIndex \u0026#39; If we already seleted our faces If Not vFaces(2) Is Nothing Then Exit For \u0026#39; Break the loop End If Next \u0026#39; Create Assembly Mate Data Set swMateData = swAssembly.CreateMateData(swMateType_e.swMateSYMMETRIC) \u0026#39; Set Symmetric Mate data to Assembly Mate Data Set swSymmetricMateData = swMateData \u0026#39; Set Entities to Mate swSymmetricMateData.EntitiesToMate = vFaces \u0026#39; Set Symmetric Mate faces swSymmetricMateData.SymmetryPlane = swAssembly.FeatureByName(\u0026#34;SYMMETRY PLANE\u0026#34;) \u0026#39; Add Symmetric Mate Set swMateFeature = swAssembly.CreateMate(swSymmetricMateData) \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Empty Face Array Set vFaces(1) = Nothing Set vFaces(2) = Nothing \u0026#39; Clear all selection swDoc.ClearSelection2 True \u0026#39; Zoom view to fit swDoc.ViewZoomtofit2 \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True End Sub \u0026#39; Function to get required face for Symmetric mate Function GetFaces(component As SldWorks.Component2, componentIndex As Integer) \u0026#39; Get body of current component Set swBody = component.GetBody \u0026#39; Get First face Set swFace = swBody.GetFirstFace \u0026#39; Variable to store Message Box result Dim resp As VbMsgBoxResult \u0026#39; Variable to count added faces Dim faceNumber As Integer: faceNumber = 0 \u0026#39; Loop through all Faces Do While Not swFace Is Nothing \u0026#39; Clear selection swDoc.ClearSelection2 True \u0026#39; Select current face swFace.Select True \u0026#39; Ask user to confirm this selection resp = MsgBox(\u0026#34;Is this correct Face?\u0026#34;, vbYesNo, \u0026#34;Select Face\u0026#34;) \u0026#39; Check if user response if Yes If resp = vbYes Then \u0026#39; Add current face to List of Faces Set vFaces(faceNumber + 1) = swFace \u0026#39; Increment face count faceNumber = faceNumber + 1 End If \u0026#39; When both faces are added If faceNumber = 2 Then Exit Function End If \u0026#39; Get next face Set swFace = swFace.GetNextFace Loop End Function\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired.\nWe use existing parts in Assembly document.\nOne component is fully constraint and other component is Float as shown in below image.\nWe will apply checks in this article, so the code we write, should be error free. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate and initialize required variables Get components and Loop through them Get desired faces Add Symmetric Mate Final Work Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate and Initialize required variables Option Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Body Dim swBody As SldWorks.Body2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swBody Type: SldWorks.Body2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Mate Feature. Variable Name: swMateFeature Type: SldWorks.Feature. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Face Dim swFace As SldWorks.Face2\rPurpose: In above line, we create a variable for Solidworks Face. Variable Name: swFace Type: SldWorks.Face2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Face List Dim vFaces(1 To 2) As SldWorks.Face2\rPurpose: Define üöÄ Array of Face2. Variable Name: vFaces Type: Face2 Length of Array: (1 To 2) Reference: Please visit For Arrays in VBA : üöÄ Array on this website. \u0026#39; Variable for Solidworks Mate Feature Data Dim swMateData As SldWorks.MateFeatureData\rPurpose: In above line, we create a variable for Solidworks Mate Feature Data. Variable Name: swMateData Type: SldWorks.MateFeatureData. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Symmetric Mate Feature Data Dim swSymmetricMateData As SldWorks.SymmetricMateFeatureData\rPurpose: In above line, we create a variable for Solidworks Symmetric Mate Feature Data. Variable Name: swAngleMateData Type: SldWorks.AngleMateFeatureData. Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to add Symmetric Mate Sub main() End Sub\rIn above line, we create main Program to add Symmetric Mate in assembly. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Get Components and Loop through them In this section, we Get Components and Loop through them.\n\u0026#39; Variable for List of elements Dim vArray As Variant\rPurpose: In above line, we create a variable for List of elements. Variable Name: vArray Type: Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True)\rIn above line, we set the value of vArray variable. We set value by GetComponents method of swAssembly variable. \u0026#39; Variable for component Index Dim componentIndex As Integer\rIn above line, we create a variable for component Index as a counter. Variable Name: componentIndex Type: Integer \u0026#39; Loop Components List For componentIndex = 0 To UBound(vArray) Next\rIn above line, we create a For loop. This loops start from i = 0 to maximum number of items in vArray we select. \u0026#39; Set Solidworks Component variable Set swComponent = vArray(componentIndex)\rIn above line, we set value of swComponent variable. This value is current value of array vArray. Get desired face In this section we get desired face for Symmetric mate.\n\u0026#39; Calling this function GetFaces swComponent, componentIndex\rIn above line, we call a function. Function Name: GetFaces Function Parameters: They are swComponent componentIndex \u0026#39; Function to select required face for Symmetric mate Function GetFaces(component As SldWorks.Component2, componentIndex As Integer) End Function\rIn above line, we create a Function to select required face for Symmetric mate. This is a Function procedure which has name of GetFaces. This procedure hold all the statements (instructions) for select required face for Symmetric mate. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. This function has 2 parameters as follows:\ncomponent As SldWorks.Component2 componentIndex As Integer \u0026#39; Get body of current component Set swBody = component.GetBody\rIn above line, we set value of swBody variable. Value of swBody variable is set by GetBody method of component variable. \u0026#39; Get First face Set swFace = swBody.GetFirstFace\rIn above line, we set value of swFace variable. Value of swFace variable is set by GetFirstFace, which is part of swBody variable. \u0026#39; Variable to store Message Box result Dim resp As VbMsgBoxResult\rPurpose: In above line, we create a variable to store Message Box result. Variable Name: resp Type: VbMsgBoxResult \u0026#39; Variable to count added faces Dim faceNumber As Integer: faceNumber = 0\rPurpose: In above line, we create a variable to count number of faces added. At the same time we set the value of this variable faceNumber to 0 i.e. faceNumber = 0 Variable Name: faceNumber Type: Integer \u0026#39; Loop through all Faces Do While Not swFace Is Nothing Loop\rIn above line, we loop through all Faces. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Select current face swFace.Select True\rIn above line, we select current face. This function is not available in üöÄ Solidworks Face object.\nSince üöÄ Solidworks Face object is also an üöÄ Solidworks Entity object, we can use methods from üöÄ Solidworks Entity object. {: .notice\u0026ndash;information}\n\u0026#39; Ask user to confirm this selection resp = MsgBox(\u0026#34;Is this correct Face?\u0026#34;, vbYesNo, \u0026#34;Select Face\u0026#34;)\rIn above line, we ask user to confirm this selection.\nWe do this in following steps.\nShow a Message Box to user as shown below. Store user response in resp variable. \u0026#39; Check if user response if Yes If resp = vbYes Then End If\rIn above code block, we check if user response if Yes. We use üöÄ IF statement for checking. Condition: resp = vbYes \u0026#39; Add current face to List of Faces Set vFaces(componentIndex + 1) = swFace\rWhen user response if Yes, then above code execute. In above line, we add current face to List of Faces. \u0026#39; Increment face count faceNumber = faceNumber + 1\rIn above line, we Increment face count variable i.e. faceNumber by 1. \u0026#39; When both faces are added If faceNumber = 2 Then Exit Function End If\rIn above code block, we check if faceNumber is 2. We use üöÄ IF statement for checking. Condition: faceNumber = 2 When this condition is True, then we exit GetFaces function. \u0026#39; Get next face Set swFace = swFace.GetNextFace\rIn above line, we set the value of swFace variable. This is done by GetNextFace method of swFace variable. Add Symmetric Mate In this section, we add Symmetric Mate.\n\u0026#39; Create Assembly Mate Data Set swMateData = swAssembly.CreateMateData(swMateType_e.swMateSYMMETRIC)\rIn above line, we set the value of swMateData variable.\nWe set value by CreateMateData() method.\nThis CreateMateData() method is part of swAssembly variable.\nThis CreateMateData() method takes following parameter.\nType: Type of mate to create as defined in swMateType_e in below table. Member Description swMateANGLE 6 swMateCAMFOLLOWER 9 swMateCOINCIDENT 0 swMateCONCENTRIC 1 swMateCOORDINATE 20 swMateDISTANCE 5 swMateGEAR 10 swMateHINGE 22 swMateLINEARCOUPLER 18 swMateLOCK 16 swMateLOCKTOSKETCH 12 swMateMAGNETIC 25 swMateMAXMATES 14 swMatePARALLEL 3 swMatePATH 15 swMatePERPENDICULAR 2 swMatePROFILECENTER 24 swMateRACKPINION 13 swMateSCREW 17 swMateSLIDER 23 swMateSLOT 21 swMateSYMMETRIC 8 swMateTANGENT 4 swMateUNIVERSALJOINT 19 swMateUNKNOWN 7 swMateWIDTH 11 Since we want to add Symmetric mate, hence we use value swMateSYMMETRIC as type.\nReference: Please visit üöÄ online SOLIDWORKS API Help.\n\u0026#39; Set Symmetric Mate data to Assembly Mate Data Set swSymmetricMateData = swMateData\rIn above line, we set Symmetric Mate data to previously created Assembly Mate data. We set value of variable swSymmetricMateData to variable swMateData. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Set Entities to Mate swSymmetricMateData.EntitiesToMate = vFaces\rIn above line, we set Enitites in this Symmetric mate. In our case, we want faces in vFaces variable to mate. \u0026#39; Set Symmetric Mate faces swSymmetricMateData.SymmetryPlane = swAssembly.FeatureByName(\u0026#34;SYMMETRY PLANE\u0026#34;)\rIn above line, we set the Symmetry plane of this Symmetry mate. For this we select a plane we created in assembly. Plane name: SYMMETRY PLANE We use FeatureByName() method to select the plane. This method is part of swAssembly variable. This method takes one parameter i.e. Name of the feature. This method return selected object. \u0026#39; Add Symmetric Mate Set swMateFeature = swAssembly.CreateMate(swSymmetricMateData)\rIn above line, we set the value of variable swMateFeature by CreateMate() method.\nThis CreateMate() method takes following parameters as explained:\nMateData - Mate-specific object: Mate-specific object IAngleMateFeatureData ICamFollowerMateFeatureData ICoincidentMateFeatureData IConcentricMateFeatureData IDistanceMateFeatureData IGearMateFeatureData IHingeMateFeatureData ILinearCouplerMateFeatureData ILockMateFeatureData IParallelMateFeatureData IPerpendicularMateFeatureData IProfileCenterMateFeatureData IRackPinionMateFeatureData IScrewMateFeatureData ISlotMateFeatureData ISymmetricMateFeatureData ITangentMateFeatureData IUniversalJointMateFeatureData IWidthMateFeatureData Return Value : This CreateMate() method return üëâ Mate2 data object.\nIn our code, I have used following values:\nParameter Name Value Used MateData swSymmetricMateData Reference: For more details about\nSolidworks AssemblyDoc details: üöÄ online Solidworks API Help for Solidworks Feature Manager. CreateMate Method: üöÄ online Solidworks API Help for CreateMate Method. \u0026#39; Check if Mate is added or not If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Add Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully added Symmetric Mate or not. We use üöÄ IF statement for checking. Condition: swMateFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: *Failed to Add Mate. After that we clear the selection. Then we stop our macro here. Now we run the macro and after running macro we get Symmetric Mate as shown in below image.\nFinal work In this section, after adding Symmetric Mate, we have to do some cleaning work so that we can use this macro frequently.\n\u0026#39; Empty Face Array Set vFaces(1) = Nothing Set vFaces(2) = Nothing\rIn above line, we empty our face array i.e. vFaces variable. We set value of every instance to Nothing. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; View zoom to fit swDoc.ViewZoomtofit2\rIn above line, we make our view zoom to fit the model. For this we use ViewZoomtofit2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True\rIn above line, we Rebuild assembly. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. This is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Symmetric Mate with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":169,"permalink":"/solidworks-vba-macros/assembly-symmetric-mate/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article we \u003cstrong\u003ecreate and understand\u003c/strong\u003e VBA macro of adding \u003cstrong\u003eSymmetric Mate\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Add Symmetric Mate"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article, we understand \u0026ldquo;how to\u0026rdquo; Rename a Mate in Assembly document from VBA macro.\nYou can use this method to rename any feature.\nIn my example, I am renaming last added mate.\nResults We Can Get Below image shows the result we get.\nWe add Rename Mate in following steps.\nAsk a name from user. Rename Mate. To get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Rename Mate from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Rename Mate.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature \u0026#39; Program to Rename Mate Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Get mate feature Set swMateFeature = swDoc.Extension.GetLastFeatureAdded \u0026#39; Check if successfully Get mate If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Get Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Select the mate swMateFeature.Select True \u0026#39; Start editing mate feature swDoc.FeatEdit \u0026#39; Variable for mate\u0026#39;s new name Dim newName As String \u0026#39; Get mate\u0026#39;s new name newName = InputBox(\u0026#34;New Name:\u0026#34;, \u0026#34;Edit Mate\u0026#34;) \u0026#39; This will handle empty value or cancel case If Len(newName) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Update mate\u0026#39;s new name swMateFeature.Name = newName \u0026#39; Clear all selection swDoc.ClearSelection2 True \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired.\nWe use existing parts in Assembly document.\nOne component is fully constraint and other component is Float as shown in below image.\nWe will apply checks in this article, so the code we write, should be mostly error free. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate global variables Initialize global variables Rename Mate Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate global variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Mate Feature. Variable Name: swMateFeature Type: SldWorks.Feature. Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Rename Mate Sub main() End Sub\rIn above line, we create main Program to Rename Mate in assembly. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize global variables In this section, we initialize global variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Add Rename Mate In this section, we Rename Mate.\n\u0026#39; Get mate feature Set swMateFeature = swDoc.Extension.GetLastFeatureAdded\rIn above line, we set the value of variable swMateFeature by GetLastFeatureAdded method. This GetLastFeatureAdded method is part of Extension object. This Extension object is then part of swDoc object. GetLastFeatureAdded method gives us last added mate. \u0026#39; Check if successfully Get mate If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Get Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully get Last Mate or not. We use üöÄ IF statement for checking. Condition: swMateFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to Get Mate. After that we clear the selection. Then we stop our macro here. \u0026#39; Select the mate swMateFeature.Select True\rIn above line we select the mate by Select method. This Select method take either True or False. True: Appends the feature to the current selection list. False: Replaces the current selection list. \u0026#39; Start editing mate feature swDoc.FeatEdit\rIn above line we start editing mate feature by FeatEdit method. This FeatEdit method puts the current feature into edit mode. \u0026#39; Variable for mate\u0026#39;s new name Dim newName As String\rPurpose: In above line, we create a variable to store new name. Variable Name: newName Type: String \u0026#39; Get mate\u0026#39;s new name newName = InputBox(\u0026#34;New Name:\u0026#34;, \u0026#34;Edit Mate\u0026#34;)\rIn above line of code we are doing 2 steps in one line.\nThose 2 steps are explained below.\nStep 1 - Getting New Name from user. Below image shows the message for New Name to the user.\nStep 2 - Assigned input value to newName variable. \u0026#39; This will handle empty value or cancel case If Len(newName) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check the length of input value. This check will handle case for empty value or cancel operation case. We use üöÄ IF statement for checking. Condition: Len(newName) = 0 Len() is pre-build VBA function which check the length of a object. In above cases, we will get 0 value. When this condition is True, We show and üöÄ message window to user. Message: Empty or no value. Please try again. Then we clear all selection and stop our macro here. \u0026#39; Update mate\u0026#39;s name swMateFeature.Name = newName\rIn above code block, we update selected mate\u0026rsquo;s name. For this we set the value Name property of swMateFeature variable. Reference: Please visit üöÄ online SOLIDWORKS API Help for more help. \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True\rIn above line, we Rebuild assembly. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. Now we run the macro and after running macro we get Rename Mate as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Rename Mate or any Feature with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":170,"permalink":"/solidworks-vba-macros/assembly-rename-mate/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eRename a Mate\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e from VBA macro.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Rename Mate"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article, we understand \u0026ldquo;how to\u0026rdquo; Edit Distance Mate in Assembly document from VBA macro.\nYou can use this method to Edit any Mate.\nIn my example, I am editing Distance mate.\nResults We Can Get Below image shows the result we get.\nWe Edit Distance Mate in following steps.\nAsk Distance from user. Update distance in Mate. To get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to edit Distance Mate from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for editing Distance mate.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature \u0026#39; Variable for Solidworks Mate Feature data Dim swMateFeatureData As SldWorks.MateFeatureData \u0026#39; Variable for Solidworks Distance Mate feature data Dim swDistanceMateFeatureData As SldWorks.DistanceMateFeatureData \u0026#39; Program to update Distance Mate Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Get updated unit conversion factors Call GetUnitConversionFactors(LengthConversionFactor, AngleConversionFactor) \u0026#39; Variable to hold user input Dim response As String \u0026#39; Getting Distance from user. response = InputBox(\u0026#34;Please Enter [Distance]:\u0026#34;) \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Variable for Distance Dim newDistance As Double \u0026#39; Set Distance newDistance = CDbl(response) * LengthConversionFactor \u0026#39; This will handle case for 0 Distance If newDistance = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Get mate feature Set swMateFeature = swDoc.Extension.GetLastFeatureAdded \u0026#39; Check if successfully Get mate If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Get Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Select the mate swMateFeature.Select True \u0026#39; Start editing mate feature swDoc.FeatEdit \u0026#39; Get feature definition of mate Set swMateFeatureData = swMateFeature.GetDefinition \u0026#39; Set Distance mate feature data Set swDistanceMateFeatureData = swMateFeatureData \u0026#39; Update distance to new value swDistanceMateFeatureData.distance = newDistance \u0026#39; Modify the definition swMateFeature.ModifyDefinition swDistanceMateFeatureData, swDoc, Nothing \u0026#39; Clear all selection swDoc.ClearSelection2 True \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True End Sub \u0026#39; Function to update Unit conversion factors Function GetUnitConversionFactors(ByRef LengthConversionFactor As Double, ByRef AngleConversionFactor As Double) \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select End Function\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired.\nWe use existing parts in Assembly document.\nBoth components are fully constraint as shown in below image.\nWe will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate global variables Initialize global variables Get unit conversion factors Get distance and Validations Edit distance Mate Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate global variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Mate Feature. Variable Name: swMateFeature Type: SldWorks.Feature. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Mate Feature data Dim swMateFeatureData As SldWorks.MateFeatureData\rPurpose: In above line, we create a variable for Solidworks Mate Feature Data. Variable Name: swMateFeatureData Type: SldWorks.MateFeatureData. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Distance Mate feature data Dim swDistanceMateFeatureData As SldWorks.DistanceMateFeatureData\rPurpose: In above line, we create a variable for Solidworks Symmetric Mate Feature Data. Variable Name: swDistanceMateFeatureData Type: SldWorks.DistanceMateFeatureData . Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to update Distance Mate Sub main() End Sub\rIn above line, we create main Program to update Distance Mate in assembly. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize global variables In this section, we initialize global variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Get Unit Conversion Factors In this section we get Unit conversion factors for new distance.\n\u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double\rPurpose: In above line, we create a variables to store Unit Conversion Factors. Variable Name: LengthConversionFactor and AngleConversionFactor Type: Double \u0026#39; Get updated unit conversion factors Call GetUnitConversionFactors(LengthConversionFactor, AngleConversionFactor)\rIn above line, we call a function. Function Name: GetUnitConversionFactors Function Parameters: They are LengthConversionFactor AngleConversionFactor \u0026#39; Function to update Unit conversion factors Function GetUnitConversionFactors(ByRef LengthConversionFactor As Double, ByRef AngleConversionFactor As Double) End Function\rIn above line, we create a Function to update Unit conversion factors for editing Distance mate. Function Name: GetUnitConversionFactors Purpose: Hold all the statements (instructions) for getting Unit conversion factors. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. This function has 2 parameters as follows:\nByRef LengthConversionFactor As Double\nByRef AngleConversionFactor As Double\nAbove parameters, passed as ByRef.\nThese parameters get the values in this function.\nBut we are not using them in this function, but we use them in main procedure.\nByRef provides us the ability to use the updated variables in main procedure.\nReference: For more details please visit üöÄ this link.\n\u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select\rI have already explained about this in previous üöÄSolidworks Macro - Fix Unit Issue article in this website.\nPlease visit üöÄSolidworks Macro - Fix Unit Issue article for more details.\nGet Distance And Validations In this section, we get get the required Distance from user and apply some validation on Distance.\n\u0026#39; Variable to hold user input Dim response As String\rIn above line, we create a variable as a counter. Variable Name: response Type: String \u0026#39; Getting Distance from user. response = InputBox(\u0026#34;Please Enter [Distance]:\u0026#34;)\rIn above line of code we are doing 2 steps in one line.\nThose 2 steps are explained below.\nStep 1 - Getting Distance from user. Below image shows the message for Distance to the user.\nStep 2 - Assigned input value to response variable. \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; Exit Sub End If\rIn above code block, we check the length of input value. This check will handle case for empty value or cancel operation case. We use üöÄ IF statement for checking. Condition: Len(response) = 0 Len() is pre-build VBA function which check the length of a object. In above cases, we will get 0 value. When this condition is True, We show and üöÄ message window to user. Message: Empty or no value. Please try again. Then we stop our macro here. \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; Exit Sub End If\rIn above code block, we check if the input value is Non-numeric. This check will handle case for Non-numeric values. We use üöÄ IF statement for checking. Condition: IsNumeric(response) = False IsNumeric() is pre-build VBA function which check if passing object is Numeric or not. In above cases, we will get False value. When this condition is True, We show and üöÄ message window to user. Message: Entered value is Non-numeric. Please try again. Then we stop our macro here. \u0026#39; Variable for Distance Dim newDistance As Double\rIn above line, we create a variable to store new distance. Variable Name: newDistance Type: Double newDistance = CDbl(response) * LengthConversionFactor\rIn above line of code we are doing 3 steps in one line.\nThose 3 steps are explained below.\nStep 1 - Converting newDistance from user to Double type. Step 2 - Updating converted distance as per document unit system. Step 3 - Assigned input value to newDistance variable. \u0026#39; This will handle case for 0 distance If newDistance = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; Exit Sub End If\rIn above code block, we check if the input value is zero (0). This check will handle case for 0 thickness. We use üöÄ IF statement for checking. Condition: newDistance = 0 When this condition is True, We show and üöÄ message window to user. Message: Entered value must be greater than 0. Please try again. Then we stop our macro here. Edit Distance Mate In this section, we Edit Distance Mate.\n\u0026#39; Get mate feature Set swMateFeature = swDoc.Extension.GetLastFeatureAdded\rIn above line, we set the value of variable swMateFeature by GetLastFeatureAdded method. This GetLastFeatureAdded method is part of Extension object. This Extension object is then part of swDoc object. GetLastFeatureAdded method gives us last added mate. \u0026#39; Check if successfully Get mate If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Get Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully get Last Mate or not. We use üöÄ IF statement for checking. Condition: swMateFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to Get Mate. After that we clear the selection. Then we stop our macro here. \u0026#39; Select the mate swMateFeature.Select True\rIn above line we select the mate by Select method. This Select method take either True or False. True: Appends the feature to the current selection list. False: Replaces the current selection list. \u0026#39; Start editing mate feature swDoc.FeatEdit\rIn above line we start editing mate feature by FeatEdit method. This FeatEdit method puts the current feature into edit mode. \u0026#39; Get feature definition of mate Set swMateFeatureData = swMateFeature.GetDefinition\rIn above line, we get the feature definition of select distance mate. We get this feature definition by GetDefinition method. This GetDefinition method is part of SldWorks.Feature object. \u0026#39; Set Distance mate feature data Set swDistanceMateFeatureData = swMateFeatureData\rIn above line, we set Distance mate feature data to feature definition of distance mate. We set value of variable swDistanceMateFeatureData to variable swMateFeatureData. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Update distance to new value swDistanceMateFeatureData.distance = newDistance\rIn above code block, we selected mate\u0026rsquo;s distance. For this we set the value distance property of swDistanceMateFeatureData variable. We set the value of distance property to newDistance variable, which we asked from user. \u0026#39; Modify the definition swMateFeature.ModifyDefinition swDistanceMateFeatureData, swDoc, Nothing\rIn above line, we modify the definition of selected distance mate.\nWe use ModifyDefinition method to update definition.\nThis ModifyDefinition method is part of SldWorks.Feature object.\nThis ModifyDefinition method takes 3 parameters as follows:\nData: Feature data object TopDoc: Top-level document Component: Component for the feature Reference: For more details please visit üöÄ online SOLIDWORKS API Help.\nReturn Value : This ModifyDefinition method return True if the feature definition modified successfully, False if not.\nIn our code, I have used following values:\nParameter Name Value Used Data swDistanceMateFeatureData TopDoc swDoc Component Nothing \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True\rIn above line, we Rebuild assembly. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. Now we run the macro and after running macro we get Modified Distance Mate as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Rename Mate or any Feature with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":171,"permalink":"/solidworks-vba-macros/assembly-edit-distance-mate/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eEdit Distance Mate\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e from VBA macro.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Edit Distance Mate"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article, we understand \u0026ldquo;how to\u0026rdquo; Toggle Mate Alignment in Assembly document from VBA macro.\nYou can use this method to Toggle Mate Alignment of any Mate.\nResults We Can Get Below image shows the result we get.\nWe Toggle Mate Alignment in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Toggle Mate Alignment from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Toggle Mate Alignment.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature \u0026#39; Variable for Solidworks Mate Feature data Dim swMateFeatureData As SldWorks.MateFeatureData \u0026#39; Variable for Solidworks Distance Mate feature data Dim swDistanceMateFeatureData As SldWorks.DistanceMateFeatureData \u0026#39; Program to Toggle distance Mate Alignment Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Get mate feature Set swMateFeature = swDoc.Extension.GetLastFeatureAdded \u0026#39; Check if successfully Get mate If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Get Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Select the mate swMateFeature.Select True \u0026#39; Start editing mate feature swDoc.FeatEdit \u0026#39; Get feature definition of mate Set swMateFeatureData = swMateFeature.GetDefinition \u0026#39; Set Distance mate feature data Set swDistanceMateFeatureData = swMateFeatureData \u0026#39; Print Mate Alignment Debug.Print swDistanceMateFeatureData.MateAlignment \u0026#39; Toggle distance Mate Alignment If swDistanceMateFeatureData.MateAlignment = 1 Then swDistanceMateFeatureData.MateAlignment = 2 Else swDistanceMateFeatureData.MateAlignment = 1 End If \u0026#39; Print updated Mate Alignment Debug.Print swDistanceMateFeatureData.MateAlignment \u0026#39; Modify the definition swMateFeature.ModifyDefinition swDistanceMateFeatureData, swDoc, Nothing \u0026#39; Clear all selection swDoc.ClearSelection2 True \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired.\nWe use existing parts in Assembly document.\nBoth components are fully constraint as shown in below image.\nWe will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Global Variables Get Feature Data Toggle Mate Alignment Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Mate Feature. Variable Name: swMateFeature Type: SldWorks.Feature. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Mate Feature data Dim swMateFeatureData As SldWorks.MateFeatureData\rPurpose: In above line, we create a variable for Solidworks Mate Feature Data. Variable Name: swMateFeatureData Type: SldWorks.MateFeatureData. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Distance Mate feature data Dim swDistanceMateFeatureData As SldWorks.DistanceMateFeatureData\rPurpose: In above line, we create a variable for Solidworks Symmetric Mate Feature Data. Variable Name: swDistanceMateFeatureData Type: SldWorks.DistanceMateFeatureData . Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Toggle distance Mate Alignment Sub main() End Sub\rIn above line, we create main Program to Toggle Distance Mate in assembly. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Global Variables In this section, we initialize global variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Get Feature Data In this section, we Get Feature Data.\n\u0026#39; Get mate feature Set swMateFeature = swDoc.Extension.GetLastFeatureAdded\rIn above line, we set the value of variable swMateFeature by GetLastFeatureAdded method. This GetLastFeatureAdded method is part of Extension object. This Extension object is then part of swDoc object. GetLastFeatureAdded method gives us last added mate. \u0026#39; Check if successfully Get mate If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Get Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully get Last Mate or not. We use üöÄ IF statement for checking. Condition: swMateFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to Get Mate. After that we clear the selection. Then we stop our macro here. \u0026#39; Select the mate swMateFeature.Select True\rIn above line we select the mate by Select method. This Select method take either True or False. True: Appends the feature to the current selection list. False: Replaces the current selection list. \u0026#39; Start editing mate feature swDoc.FeatEdit\rIn above line we start editing mate feature by FeatEdit method. This FeatEdit method puts the current feature into edit mode. \u0026#39; Get feature definition of mate Set swMateFeatureData = swMateFeature.GetDefinition\rIn above line, we get the feature definition of select distance mate. We get this feature definition by GetDefinition method. This GetDefinition method is part of SldWorks.Feature object. \u0026#39; Set Distance mate feature data Set swDistanceMateFeatureData = swMateFeatureData\rIn above line, we set Distance mate feature data to feature definition of distance mate. We set value of variable swDistanceMateFeatureData to variable swMateFeatureData. Reference: Please visit üöÄ online SOLIDWORKS API Help. Toggle Mate Alignment In this section, we Toggle Mate Alignment.\n\u0026#39; Print Mate Alignment Debug.Print swDistanceMateFeatureData.MateAlignment\rIn above code block, we print selected mate\u0026rsquo;s current Alignment. For this we set the value MateAlignment property of swDistanceMateFeatureData variable. We get the value of MateAlignment property to newDistance variable. \u0026#39; Toggle distance Mate Alignment If swDistanceMateFeatureData.MateAlignment = 1 Then swDistanceMateFeatureData.MateAlignment = 2 Else swDistanceMateFeatureData.MateAlignment = 1 End If\rIn above code block, we check Mate Alignment. We use üöÄ IF statement for checking. Condition: swDistanceMateFeatureData.MateAlignment = 1 When this condition is True, We set the Mate Alignment value to 2. When this condition is False, We set the Mate Alignment value to 1. \u0026#39; Print updated Mate Alignment Debug.Print swDistanceMateFeatureData.MateAlignment\rIn above code block, we print selected mate\u0026rsquo;s current Alignment. For this we set the value MateAlignment property of swDistanceMateFeatureData variable. We get the value of MateAlignment property to newDistance variable. \u0026#39; Modify the definition swMateFeature.ModifyDefinition swDistanceMateFeatureData, swDoc, Nothing\rIn above line, we modify the definition of selected distance mate.\nWe use ModifyDefinition method to update definition.\nThis ModifyDefinition method is part of SldWorks.Feature object.\nThis ModifyDefinition method takes 3 parameters as follows:\nData: Feature data object TopDoc: Top-level document Component: Component for the feature Reference: For more details please visit üöÄ online SOLIDWORKS API Help.\nReturn Value : This ModifyDefinition method return True if the feature definition modified successfully, False if not.\nIn our code, I have used following values:\nParameter Name Value Used Data swDistanceMateFeatureData TopDoc swDoc Component Nothing \u0026#39; Clear all selection swDoc.ClearSelection2 True\rIn above line, we clear all selection. For this we use ClearSelection2 method which is part of SOLIDWORKS Document variable i.e swDoc variable. \u0026#39; Rebuild assembly swDoc.ForceRebuild3 True\rIn above line, we Rebuild assembly. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. Now we run the macro and after running macro we get Modified Distance Mate as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Rename Mate or any Feature with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":172,"permalink":"/solidworks-vba-macros/assembly-toggle-mate-alignment/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eToggle Mate Alignment\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e from VBA macro.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Toggle Mate Alignment"},{"content":"{% include article-notes/intermediate-note.html %}\nObjective In this article, we understand \u0026ldquo;how to\u0026rdquo; Delete Mate in Assembly document from VBA macro.\nYou can use this method to Delete any feature, I just use it for deleting selected mate.\nResults We Can Get Below image shows the result we get.\nWe Delete Mate in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Delete Mate from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Delete Mate.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature \u0026#39; Program to Delete selected feature Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Get mate feature Set swMateFeature = swDoc.Extension.GetLastFeatureAdded \u0026#39; Check if successfully Get feature If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Get feature.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Select the mate swMateFeature.Select True \u0026#39; Delete selected item swDoc.EditDelete End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired.\nWe use existing parts in Assembly document.\nBoth components are fully constraint as shown in below image.\nWe will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Global Variables Get Feature Data Delete Mate Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Mate Feature Dim swMateFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Mate Feature. Variable Name: swMateFeature Type: SldWorks.Feature. Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Delete selected feature Sub main() End Sub\rIn above line, we create main Program to Delete selected feature. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Global Variables In this section, we initialize global variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Get Feature Data In this section, we Get Feature Data.\n\u0026#39; Get mate feature Set swMateFeature = swDoc.Extension.GetLastFeatureAdded\rIn above line, we set the value of variable swMateFeature by GetLastFeatureAdded method. This GetLastFeatureAdded method is part of Extension object. This Extension object is then part of swDoc object. GetLastFeatureAdded method gives us last added mate. \u0026#39; Check if successfully Get mate If swMateFeature Is Nothing Then MsgBox \u0026#34;Failed to Get Mate.\u0026#34; swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if we successfully get Last Mate or not. We use üöÄ IF statement for checking. Condition: swMateFeature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to Get Mate. After that we clear the selection. Then we stop our macro here. \u0026#39; Select the mate swMateFeature.Select True\rIn above line we select the mate by Select method. This Select method take either True or False. True: Appends the feature to the current selection list. False: Replaces the current selection list. Delete Mate In this section, we Delete Mate.\n\u0026#39; Delete selected item swDoc.EditDelete\rIn above code block, we Delete Selected item i.e. selected mate.\nFor this we set the value EditDelete method of swDoc variable.\nReference: For more details please visit üöÄ online SOLIDWORKS API Help.\nReturn Value : This EditDelete method did not return anything.\nNow we run the macro and after running macro we get Modified Distance Mate as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Delete Mate or any Feature with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":173,"permalink":"/solidworks-vba-macros/assembly-delete-mate/","summary":"\u003cp\u003e{% include article-notes/intermediate-note.html %}\u003c/p\u003e\n\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eDelete Mate\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e from VBA macro.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Delete Mate"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Insert Virtual Part in Assembly document from VBA macro.\nThis is most updated method of inserting Virtual part in as assembly document.\nResults We Can Get Below image shows the result we get.\nWe Insert Virtual Part in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Insert Virtual Part from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Insert Virtual Part.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Variable for Solidworks Face Dim swFace As SldWorks.Face2 \u0026#39; Program to Insert virtual part Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Get the selected face and set it to the Solidworks Face variable Set swFace = swDoc.SelectionManager.GetSelectedObject6(1, -1) \u0026#39; Insert Virtual part swAssembly.InsertNewVirtualPart swFace, swComponent \u0026#39; If there are error If swComponent Is Nothing Then \u0026#39; Inform user and exit function. MsgBox \u0026#34;Failed to add Virtual part.\u0026#34; Exit Sub End If End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We use existing parts in Assembly document. Both components are fully constraint as shown in below image. One face is selected, in which we want to insert virtual component. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Global Variables Insert Virtual Part Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Face Dim swFace As SldWorks.Face2\rPurpose: In above line, we create a variable for Solidworks Face. Variable Name: swFace Type: SldWorks.Face2. Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Insert virtual part Sub main() End Sub\rIn above line, we create main Program to Insert virtual part. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Global Variables In this section, we initialize global variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Insert Virtual Part In this section, we Insert Virtual Part.\n\u0026#39; Get the selected face and set it to the Solidworks Face variable Set swFace = swDoc.SelectionManager.GetSelectedObject6(1, -1)\rIn above code block, we get set the value of swFace variable. We use GetSelectedObject6 method of swDoc.SelectionManager object. \u0026#39; Insert Virtual part swAssembly.InsertNewVirtualPart swFace, swComponent\rIn above code, we Insert Virtual part into assemly.\nFor this, we use InsertNewVirtualPart method.\nThis InsertNewVirtualPart method is part of swAssembly variable.\nThis method takes 2 parameter.\nFaceOrPlaneToSelect: Plane or planar face. InsertedComponent: New part inserted as virtual component. Return Value : This InsertNewVirtualPart method return üëâ Error as defined by swInsertNewPartErrorCode_e.\nIn our code, I have used following values:\nParameter Name Value Used FaceOrPlaneToSelect swFace InsertedComponent swComponent Reference: For more details please visit üöÄ online SOLIDWORKS API Help.\n\u0026#39; If there are error If swComponent Is Nothing Then \u0026#39; Inform user and exit function. MsgBox \u0026#34;Failed to add Virtual part.\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully added Virtual Part or not. We use üöÄ IF statement for checking. Condition: swComponent Is Nothing When this condition is True, We show and üöÄ message window to user. Message: *Failed to add Virtual part. Then we stop our macro here. Now we run the macro and after running macro we get a New Virtual Part as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Insert Virtual Part with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":174,"permalink":"/solidworks-vba-macros/assembly-insert-virtual-part/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eInsert Virtual Part\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eThis is most updated method of \u003cstrong\u003einserting Virtual part\u003c/strong\u003e in as assembly document.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Insert Virtual Part"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Insert Virtual Assembly in Assembly document from VBA macro.\nThis is most updated method of inserting Virtual Assembly in an assembly document.\nResults We Can Get Below image shows the result we get.\nWe Insert Virtual Assembly in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Insert Virtual Assembly from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Insert Virtual Assembly.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Program to Insert virtual Assembly Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Insert Virtual Assembly swAssembly.InsertNewVirtualAssembly swComponent \u0026#39; If there are error If swComponent Is Nothing Then \u0026#39; Inform user and exit function. MsgBox \u0026#34;Failed to add Virtual Assembly.\u0026#34; Exit Sub End If End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We use existing parts in Assembly document. Both components are fully constraint as shown in below image. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Global Variables Insert Virtual Assembly Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Insert virtual Assembly Sub main() End Sub\rIn above line, we create main Program to Insert virtual Assembly. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Global Variables In this section, we initialize global variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Insert Virtual Assembly In this section, we Insert Virtual Assembly.\n\u0026#39; Insert Virtual Assembly swAssembly.InsertNewVirtualAssembly swComponent\rIn above code, we Insert Virtual Assembly into assemly.\nFor this, we use InsertNewVirtualAssembly method.\nThis InsertNewVirtualAssembly method is part of swAssembly variable.\nThis method takes 1 parameter.\nInsertedComponent: New assembly inserted as virtual component. Return Value : This InsertNewVirtualAssembly method return üëâ Error as defined by swInsertNewPartErrorCode_e.\nIn our code, I have used following values:\nParameter Name Value Used InsertedComponent swComponent Reference: For more details please visit üöÄ online SOLIDWORKS API Help.\n\u0026#39; If there are error If swComponent Is Nothing Then \u0026#39; Inform user and exit function. MsgBox \u0026#34;Failed to add Virtual Assembly.\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully added Virtual Assembly or not. We use üöÄ IF statement for checking. Condition: swComponent Is Nothing When this condition is True, We show and üöÄ message window to user. Message: *Failed to add Virtual Assembly. Then we stop our macro here. Now we run the macro and after running macro we get a New Virtual Assembly as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Insert Virtual Assembly with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":175,"permalink":"/solidworks-vba-macros/assembly-insert-virtual-assembly/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eInsert Virtual Assembly\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eThis is most updated method of \u003cstrong\u003einserting Virtual Assembly\u003c/strong\u003e in an assembly document.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Insert Virtual Assembly"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Copy With Mate in Assembly document from VBA macro.\nThis is most updated method of Copy Part/Assembly with Mate in an assembly document.\nResults We Can Get Below image shows the result we get.\nWe Copy With Mate in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Copy With Mate from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Copy With Mate.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Variable for Component array Dim swComponentArray(0) As SldWorks.Component2 \u0026#39; Variable to define if repeat the mate or not Dim repeatArray(2) As Boolean \u0026#39; Set the value of mate if is accept the value Dim valueArray(2) As Double \u0026#39; Boolean variable to check if Opereation is succeed or not Dim status As Boolean \u0026#39; Main program for Copy with Mate Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Get the selected face and set it to the Solidworks Face variable Set swComponent = swDoc.SelectionManager.GetSelectedObject6(1, -1) \u0026#39; If there are error If swComponent Is Nothing Then \u0026#39; Inform user and exit function. MsgBox \u0026#34;Failed to get selected part.\u0026#34; Exit Sub End If \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Get updated unit conversion factors Call GetUnitConversionFactors(LengthConversionFactor, AngleConversionFactor) \u0026#39; Copy component with profile center mate Set swComponentArray(0) = swComponent \u0026#39; Variable for loop Dim i As Integer \u0026#39; Loop for setting values For i = 0 To 2 \u0026#39; Repeat the mate repeatArray(i) = True \u0026#39; Set the value of mate valueArray(i) = 10 * LengthConversionFactor Next \u0026#39; Variables for Copy operation Dim mateReferencesArray(2) As Object Dim flipAlignmentArray(2) As Boolean Dim flipDimensionArray(2) As Boolean Dim lockRotationArray(2) As Boolean Dim orientationArray(2) As Long \u0026#39; Create Copy with mate status = swAssembly.CopyWithMates2(swComponentArray, repeatArray, mateReferencesArray, valueArray, flipAlignmentArray, flipDimensionArray, lockRotationArray, orientationArray) End Sub \u0026#39; Function to update Unit conversion factors Function GetUnitConversionFactors(ByRef LengthConversionFactor As Double, ByRef AngleConversionFactor As Double) \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select End Function\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We use existing parts in Assembly document. Both components are fully constraint as shown in below image. We select the part which we want to copy. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Global Variables Get unit conversion factors Copy With Mate Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Component array Dim swComponentArray(0) As SldWorks.Component2\rPurpose: In above line, we create an array for Solidworks Component. Variable Name: swComponentArray(0) Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable to define if repeat the mate or not Dim repeatArray(2) As Boolean\rPurpose: In above line, we create an array to define if repeat the mate or not. Variable Name: repeatArray(2) Type: Boolean. \u0026#39; Set the value of mate if is accept the value Dim valueArray(2) As Double\rPurpose: In above line, we create an array to set the value of mate if is accept the value. Variable Name: valueArray(2) Type: Double. \u0026#39; Boolean variable to check if Opereation is succeed or not Dim status As Boolean\rPurpose: In above line, we create an variable to check if Opereation is succeed or not. Variable Name: status Type: Boolean. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Main program for Copy with Mate Sub main() End Sub\rIn above line, we create main program for Copy with Mate. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Global Variables In this section, we initialize global variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. \u0026#39; Get the selected face and set it to the Solidworks Face variable Set swComponent = swDoc.SelectionManager.GetSelectedObject6(1, -1)\rIn above line, we set value of swComponent variable. We set the value from GetSelectedObject6 method. This GetSelectedObject6 method is part of SelectionManager object. This SelectionManager object is part of swDoc object. \u0026#39; If there are error If swComponent Is Nothing Then \u0026#39; Inform user and exit function. MsgBox \u0026#34;Failed to get selected part.\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully set the value of swComponent variable. We use üöÄ IF statement for checking. Condition: swComponent Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to get selected part. Then we stop our macro here. Get Unit Conversion Factors In this section we get Unit conversion factors for new distance.\n\u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double\rPurpose: In above line, we create a variables to store Unit Conversion Factors. Variable Name: LengthConversionFactor and AngleConversionFactor Type: Double \u0026#39; Get updated unit conversion factors Call GetUnitConversionFactors(LengthConversionFactor, AngleConversionFactor)\rIn above line, we call a function. Function Name: GetUnitConversionFactors Function Parameters: They are LengthConversionFactor AngleConversionFactor \u0026#39; Function to update Unit conversion factors Function GetUnitConversionFactors(ByRef LengthConversionFactor As Double, ByRef AngleConversionFactor As Double) End Function\rIn above line, we create a Function to update Unit conversion factors for editing Distance mate. Function Name: GetUnitConversionFactors Purpose: Hold all the statements (instructions) for getting Unit conversion factors. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. This function has 2 parameters as follows:\nByRef LengthConversionFactor As Double\nByRef AngleConversionFactor As Double\nAbove parameters, passed as ByRef.\nThese parameters get the values in this function.\nBut we are not using them in this function, but we use them in main procedure.\nByRef provides us the ability to use the updated variables in main procedure.\nReference: For more details please visit üöÄ this link.\n\u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select\rI have already explained about this in previous üöÄSolidworks Macro - Fix Unit Issue article in this website.\nPlease visit üöÄSolidworks Macro - Fix Unit Issue article for more details.\nCopy With Mate In this section, we perform Copy With Mate action.\n\u0026#39; Copy component with profile center mate Set swComponentArray(0) = swComponent\rIn above line, we set the value of swComponentArray variable. Since we want to copy only 1 part. Hence we set only 1 element of array. This value is swComponent variable. \u0026#39; Variable for loop Dim i As Integer\rPurpose: In above line, we create a variable for Loop. Variable Name: i Type: Integer. \u0026#39; Loop for setting values For i = 0 To 2 Next\rIn above line, we create an Loop for setting values. We set the values of variables required for Copy mate. \u0026#39; Repeat the mate repeatArray(i) = True\rIn above line, we set the value of repeatArray array variable. This array tell that we want to repeat the mates in new component or not. Setting the value to True confirms repeat mate. \u0026#39; Set the value of mate valueArray(i) = 10 * LengthConversionFactor\rIn above line, we set the value of valueArray array variable. This array sets the value for distance or angle of each mate. \u0026#39; Variables for Copy operation Dim mateReferencesArray(2) As Object Dim flipAlignmentArray(2) As Boolean Dim flipDimensionArray(2) As Boolean Dim lockRotationArray(2) As Boolean Dim orientationArray(2) As Long\rIn above code, we create some array variables. These arrray variables are of different types i.e. Object, Boolean, Long. We did not set any value for these arrays. We just need them for copy operation. \u0026#39; Create Copy with mate status = swAssembly.CopyWithMates2(swComponentArray, repeatArray, mateReferencesArray, valueArray, flipAlignmentArray, flipDimensionArray, lockRotationArray, orientationArray)\rIn above code, we Copy With Mate into assemly.\nFor this, we use CopyWithMates2 method.\nThis CopyWithMates2 method is part of swAssembly variable.\nThis method takes 1 parameter.\nComponentsToCopy: Array of components to copy. Repeat: Array of boolean values; each value indicates whether to use the existing mate reference for the corresponding component to copy; if True, copies the existing mate reference; if False, uses the corresponding entry in the NewEntityToMateTo array for the new mate reference. NewEnityToMateTo: Array of new mate references that map to the Repeat array; if an entry in the Repeat array is False, then the corresponding entry in this array is the new entity with which to mate the component to copy. Values: Array of distance or angle values for the mate references; specify distance in meters and angle in radians; valid for distance, angle, and profile center mates only. FlipAlignment: Array of booleans that map to the NewEntityToMateTo array; each value indicates the corresponding mate\u0026rsquo;s alignment; True to flip alignment, False to not. FlipDimension: Array of booleans that map to the Values array; each value indicates the corresponding mate\u0026rsquo;s distance; True for a positive distance dimension, False for a negative distance dimension; valid for distance, angle, and profile center mates only. LockRotation: Array of booleans that map to the NewEntityToMateTo array; True to prevent the components from rotating, False to allow the components to rotate; valid for concentric and profile center mates only. Orientation: Array of longs or integers that map to the Values array; each long or integer indicates the number of clicks in the user interface with which to orient the mate; a positive value indicates to orient the mate clockwise, a negative value indicates to orient the mate counterclockwise; valid for profile center mates only. Return Value : True if calling this method succeeded, False if it failed.\nIn our code, I have used following values:\nParameter Name Value Used ComponentsToCopy swComponentArray Repeat repeatArray NewEnityToMateTo mateReferencesArray Values valueArray FlipAlignment flipAlignmentArray FlipDimension flipDimensionArray LockRotation lockRotationArray Orientation orientationArray Reference: For more details please visit üöÄ online SOLIDWORKS API Help.\nNow we run the macro and after running macro we get a new part/assembly from Copy with Mate operation as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Copy With Mate with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":176,"permalink":"/solidworks-vba-macros/assembly-copy-with-mate/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eCopy With Mate\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eThis is most updated method of \u003cstrong\u003eCopy Part/Assembly with Mate\u003c/strong\u003e in an assembly document.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Copy With Mate"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Hide selected Component in Assembly document from VBA macro.\nThis is most updated method of Hiding selected Component in an assembly document.\nResults We Can Get Below image shows the result we get.\nWe Hide selected Component in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Hide selected Component from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Hide selected Component.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Program to Hide Selected Component part Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Get the selected component and set it to the Solidworks Component variable Set swComponent = swDoc.SelectionManager.GetSelectedObject6(1, -1) \u0026#39; If there are error If swComponent Is Nothing Then \u0026#39; Inform user and exit function. MsgBox \u0026#34;Failed to get selected part.\u0026#34; Exit Sub End If \u0026#39; Select the component swComponent.Select False \u0026#39; Hide selected component swDoc.HideComponent2 End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We use existing parts in Assembly document. Both components are fully constraint as shown in below image. We select the part which we want to Hide. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Global Variables Hide selected Component Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Hide Selected Component part Sub main() End Sub\rIn above line, we create Program to Hide Selected Component part. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Global Variables In this section, we initialize global variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. Hide selected Component In this section, we perform Hide selected Component action.\n\u0026#39; Get the selected face and set it to the Solidworks Face variable Set swComponent = swDoc.SelectionManager.GetSelectedObject6(1, -1)\rIn above line, we set value of swComponent variable. We set the value from GetSelectedObject6 method. This GetSelectedObject6 method is part of SelectionManager object. This SelectionManager object is part of swDoc object. \u0026#39; If there are error If swComponent Is Nothing Then \u0026#39; Inform user and exit function. MsgBox \u0026#34;Failed to get selected part.\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully set the value of swComponent variable. We use üöÄ IF statement for checking. Condition: swComponent Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to get selected part. Then we stop our macro here. \u0026#39; Select the component swComponent.Select False\rIn above line, we select the component. We use Select method of swComponent variable. \u0026#39; Hide selected component swDoc.HideComponent2\rIn above line, we Hide selected component. We use HideComponent2 method of swDoc variable. This method return nothing. Now we run the macro and after running macro we hide selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Hide selected Component with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":177,"permalink":"/solidworks-vba-macros/assembly-hide-component/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eHide selected Component\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eThis is most updated method of \u003cstrong\u003eHiding selected Component\u003c/strong\u003e in an assembly document.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Hide Component"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Show Component in Assembly document from VBA macro.\nThis is most updated method of Show Component in an assembly document.\nResults We Can Get Below image shows the result we get.\nWe Show Component in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Show Component from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Show Component.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Program to Show Selected Component Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Variable for List of elements Dim vArray As Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True) \u0026#39; Variable for component Dim component As Variant \u0026#39; Loop Components List For Each component In vArray \u0026#39; Set Solidworks Component variable Set swComponent = component \u0026#39; If current component is hidden If swComponent.IsHidden(False) Then \u0026#39; Select the component swComponent.Select False \u0026#39; Show selected component swDoc.ShowComponent2 End If Next component End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We use existing parts in Assembly document. Both components are fully constraint as shown in below image. We select the part which we want to Show. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Global Variables Show Component Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Show Selected Component Sub main() End Sub\rIn above line, we create Program to Show Selected Component. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Global Variables In this section, we initialize global variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Show Component In this section, we perform Show Component action.\n\u0026#39; Variable for List of elements Dim vArray As Variant\rPurpose: In above line, we create a variable for List of elements. Variable Name: vArray Type: Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True)\rIn above line, we set the value of vArray variable. We set value by GetComponents method of swAssembly variable. \u0026#39; Variable for component Dim component As Variant\rIn above line, we create component variable for looping. Variable Name: component Type: Variant \u0026#39; Loop Components List For Each component In vArray Next\rIn above line, we create a For Each loop. In this loop, component variable loops every item in vArray. \u0026#39; Set Solidworks Component variable Set swComponent = component\rIn above line, we set value of swComponent variable. This value is current value of array vArray. Current value is represented by component variable. \u0026#39; If current component is hidden If swComponent.IsHidden(False) Then End If\rIn above code block, we check if current component is hidden. We use üöÄ IF statement for checking. Condition: swComponent.IsHidden(False) \u0026#39; Select the component swComponent.Select False\rIn above line, we select the component. We use Select method of swComponent variable. \u0026#39; Show selected component swDoc.ShowComponent2\rIn above line, we Show selected component. We use ShowComponent2 method of swDoc variable. This method return nothing. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Show Component with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":178,"permalink":"/solidworks-vba-macros/assembly-show-component/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eShow Component\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eThis is most updated method of \u003cstrong\u003eShow Component\u003c/strong\u003e in an assembly document.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Show Component"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Suppress Component in Assembly document from VBA macro.\nThis is most updated method of Suppress Component in an assembly document.\nResults We Can Get Below image shows the result we get.\nWe Show Component in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Suppress Component from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Show Component.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Boolean Variable Dim boolStatus As Boolean \u0026#39; Program to Suppress Selected Component Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Get the selected component and set it to the Solidworks Component variable Set swComponent = swDoc.SelectionManager.GetSelectedObject6(1, -1) \u0026#39; Suppress selected component boolStatus = swDoc.EditSuppress2 \u0026#39; Check if Solidworks document is opened or not If boolStatus = False Then MsgBox \u0026#34;Failed to Suppress selected component.\u0026#34; Exit Sub End If End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We use existing parts in Assembly document. Both components are fully constraint as shown in below image. We select the part which we want to Show. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Global Variables Suppress Component Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Boolean Variable Dim boolStatus As Boolean\rPurpose: In above line, we create a variable for Boolean selection. Variable Name: boolStatus Type: Boolean These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Suppress Selected Component Sub main() End Sub\rIn above line, we create Program to Suppress Selected Component. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Global Variables In this section, we initialize global variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Suppress Component In this section, we perform Suppress Component action.\n\u0026#39; Get the selected component and set it to the Solidworks Component variable Set swComponent = swDoc.SelectionManager.GetSelectedObject6(1, -1)\rIn above line, we set the value of swComponent variable. We set value by GetSelectedObject6 method of SelectionManager object. SelectionManager object is part of swDoc variable. \u0026#39; Suppress selected component boolStatus = swDoc.EditSuppress2\rIn above line, we Suppress selected component.\nWe use EditSuppress2 method of swDoc variable.\nReturn Value : This EditSuppress2 method return True or False.\n\u0026#39; Check if Solidworks document is Suppress or not If boolStatus = False Then MsgBox \u0026#34;Failed to Suppress selected component.\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully Suppress selected component. We use üöÄ IF statement for checking. Condition: boolStatus = False When this condition is True, We show and üöÄ message window to user. Message: Failed to Suppress selected component. Then we stop our macro here. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Show Component with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":179,"permalink":"/solidworks-vba-macros/assembly-suppress-component/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eSuppress Component\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eThis is most updated method of \u003cstrong\u003eSuppress Component\u003c/strong\u003e in an assembly document.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Suppress Component"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Unsuppress Component in Assembly document from VBA macro.\nThis is most updated method of Unsuppress Component in an assembly document.\nResults We Can Get Below image shows the result we get.\nWe Show Component in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Unsuppress Component from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Show Component.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Program to UnSuppress Selected Component Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Variable for List of elements Dim vArray As Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(False) \u0026#39; Variable for component Dim component As Variant \u0026#39; Loop Components List For Each component In vArray \u0026#39; Set Solidworks Component variable Set swComponent = component \u0026#39; If current component is Suppress If swComponent.IsSuppressed Then \u0026#39; Select the component swComponent.Select False \u0026#39; UnSuppress selected component swDoc.EditUnsuppress2 End If Next component End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We use existing parts in Assembly document. Both components are fully constraint as shown in below image. We select the part which we want to Show. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Global Variables Unsuppress Component Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Unsuppress Selected Component Sub main() End Sub\rIn above line, we create Program to Unsuppress Selected Component. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Global Variables In this section, we initialize global variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Unsuppress Component In this section, we perform UnSuppress Component action.\n\u0026#39; Variable for List of elements Dim vArray As Variant\rPurpose: In above line, we create a variable for List of elements. Variable Name: vArray Type: Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(False)\rIn above line, we set the value of vArray variable. We set value by GetComponents method of swAssembly variable. By passing False to GetComponents method, we get all components from Feature Tree. \u0026#39; Variable for component Dim component As Variant\rIn above line, we create component variable for looping. Variable Name: component Type: Variant \u0026#39; Loop Components List For Each component In vArray \u0026#39; Move to next component Next component\rIn above line, we create a For Each loop. In this loop, component variable loops every item in vArray. \u0026#39; Set Solidworks Component variable Set swComponent = component\rIn above line, we set value of swComponent variable. This value is current value of array vArray. Current value is represented by component variable. \u0026#39; If current component is Suppress If swComponent.IsSuppressed Then End If\rIn above code block, we check if current component is Suppress. We use üöÄ IF statement for checking. Condition: swComponent.IsSuppressed \u0026#39; Select the component swComponent.Select False\rIn above line, we select the component. We use Select method of swComponent variable. \u0026#39; UnSuppress selected component swDoc.EditUnsuppress2\rIn above line, we Show selected component. We use EditUnsuppress2 method of swDoc variable. This method return nothing. Return Value : This EditUnsuppress2 method return True or False. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Show Component with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":180,"permalink":"/solidworks-vba-macros/assembly-unsuppress-component/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eUnsuppress Component\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eThis is most updated method of \u003cstrong\u003eUnsuppress Component\u003c/strong\u003e in an assembly document.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Unsuppress Component"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Insert Folder in Assembly document from VBA macro.\nWe will insert an empty folder in Feature Tree.\nThis is most updated method of Insert Folder in an assembly document.\nResults We Can Get Below image shows the result we get.\nWe Insert Folder in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Insert Folder from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Insert Folder.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Feature Manager Dim swFeatureManager As SldWorks.FeatureManager \u0026#39; Variable for Solidworks Feature Dim feature As SldWorks.feature \u0026#39; Program to Add New Folder Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Feature manager Set swFeatureManager = swDoc.FeatureManager \u0026#39; Insert Folder Set feature = swFeatureManager.InsertFeatureTreeFolder2(swFeatureTreeFolder_EmptyBefore) \u0026#39; Check if Folder is added or not If feature Is Nothing Then MsgBox \u0026#34;Failed to Insert Folder.\u0026#34; Exit Sub End If \u0026#39; Variable to store user response Dim response As String response = InputBox(\u0026#34;Folder Name:\u0026#34;, \u0026#34;Folder\u0026#34;) \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; Exit Sub End If \u0026#39; Update Folder Name feature.Name = response End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We use existing parts in Assembly document. Both components are fully constraint as shown in below image. For inserting folder atleast one part must be selected. Otherwise this method will not work. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Global Variables Insert Folder Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Feature Manager Dim swFeatureManager As SldWorks.FeatureManager\rPurpose: In above line, we create a variable for Solidworks Feature Manager. Variable Name: swFeatureManager Type: SldWorks.FeatureManager Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Feature Dim feature As SldWorks.feature\rPurpose: In above line, we create a variable for Solidworks Feature. Variable Name: feature Type: SldWorks.feature. Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Add New Folder Sub main() End Sub\rIn above line, we create Program to Add New Folder. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Global Variables In this section, we initialize global variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. Insert Folder In this section, we perform UnSuppress Component action.\n\u0026#39; Set Feature manager Set swFeatureManager = swDoc.FeatureManager\rIn above line, we set value of swFeatureManager variable. We set value to FeatureManager property of swDoc variable. \u0026#39; Insert Folder Set feature = swFeatureManager.InsertFeatureTreeFolder2(swFeatureTreeFolder_EmptyBefore)\rIn above line, we \u0026ldquo;Insert Folder\u0026rdquo; by setting the value of feature variable.\nThis InsertFeatureTreeFolder2() method is part of swFeatureManager variable.\nThis InsertFeatureTreeFolder2() method takes following parameter.\nType: Type of folder as defined in swFeatureTreeFolderType_e in below table. Member Description swFeatureTreeFolder_Containing 2 = Create and insert a folder to contain the pre-selected features swFeatureTreeFolder_EmptyBefore 1 = Create and insert an empty folder before the pre-selected features swFeatureTreeFolder_Mold 3 Return Value : This InsertFeatureTreeFolder2() method return üöÄ feature data object.\nIn our code, I have used following values:\nParameter Name Value Used Type swFeatureTreeFolder_EmptyBefore Reference: For more details about\nSolidworks FeatureManager details: üöÄ online Solidworks API Help for Solidworks Feature Manager. InsertFeatureTreeFolder2 Method: üöÄ online Solidworks API Help for InsertFeatureTreeFolder2 Method. \u0026#39; Check if Folder is added or not If feature Is Nothing Then MsgBox \u0026#34;Failed to Insert Folder.\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully added Insert Folder or not. We use üöÄ IF statement for checking. Condition: feature Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to Insert Folder. Then we stop our macro here. \u0026#39; Variable to hold user input Dim response As String\rIn above line, we create a variable as a counter. Variable Name: response Type: String \u0026#39; Getting Folder Name from user. response = InputBox(\u0026#34;Folder Name:\u0026#34;, \u0026#34;Folder\u0026#34;)\rIn above line of code we are doing 2 steps in one line.\nThose 2 steps are explained below.\nStep 1 - Getting Folder Name from user. Below image shows the message for Folder Name to the user.\nStep 2 - Assigned input value to response variable. \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; Exit Sub End If\rIn above code block, we check the length of input value. This check will handle case for empty value or cancel operation case. We use üöÄ IF statement for checking. Condition: Len(response) = 0 Len() is pre-build VBA function which check the length of a object. In above cases, we will get 0 value. When this condition is True, We show and üöÄ message window to user. Message: Empty or no value. Please try again. Then we stop our macro here. \u0026#39; Update Folder Name feature.Name = response\rIn above line, we set value of Name property of feature variable. We set value to response, which we asked from user. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Insert Folder with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":181,"permalink":"/solidworks-vba-macros/assembly-insert-folder/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eInsert Folder\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eWe will insert an empty folder in Feature Tree.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Insert Folder"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Create Standard 3 View [1st Angle] in Drawing document from VBA macro.\nWe will insert Standard 3 View of [1st Angle].\nThis is most updated method of Standard 3 View of [1st Angle] in an drawing document.\nResults We Can Get Below image shows the result we get.\nWe Create Standard 3 View [1st Angle] in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Create Standard 3 View [1st Angle] from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Create Standard 3 View [1st Angle].\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Program to Insert Standard 3 View [1st Angle] Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Get Opened \u0026#34;Demo Assembly\u0026#34; document Set swDoc = swApp.GetOpenDocument(\u0026#34;Demo Assembly\u0026#34;) \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Variable for opened File\u0026#39;s full Path Dim openedFilePath As String \u0026#39; Get opened File\u0026#39;s full Path openedFilePath = swDoc.GetPathName \u0026#39; Open Drawing document Set swDoc = swApp.ActiveDoc \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Boolean variable Dim boolStatus As Boolean \u0026#39; Insert Standard 3 View [1st Angle] boolStatus = swDrawing.Create1stAngleViews2(openedFilePath) \u0026#39; Check if we successfully insert views If boolStatus = False Then MsgBox \u0026#34;Failed to insert Standard 3 View [1st Angle]\u0026#34; Exit Sub End If End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We create drawing from an already opened Assembly document. We will use name of Assembly document name hardcoded. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Get Assembly Full Path Insert Standard Views Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Insert Standard 3 View [1st Angle] Sub main() End Sub\rIn above line, we create Program to Insert Standard 3 View [1st Angle]. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Get Assembly Full Path In this section, we Get Assembly Full Path.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Get Opened \u0026#34;Demo Assembly\u0026#34; document Set swDoc = swApp.GetOpenDocument(\u0026#34;Demo Assembly\u0026#34;)\rIn above line, we set value of swDoc variable. This value is currently Opened \u0026ldquo;Demo Assembly\u0026rdquo; document. We use GetOpenDocument() method from swApp variable. This GetOpenDocument() method takes one parameter. DocName - Name of the document. We pass Opened assembly name i.e. \u0026ldquo;Demo Assembly\u0026rdquo; as parameter. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Variable for opened File\u0026#39;s full Path Dim openedFilePath As String\rIn above line, we create a variable for opened File\u0026rsquo;s full Path. Variable Name: openedFilePath Type: String \u0026#39; Get opened File\u0026#39;s full Path openedFilePath = swDoc.GetPathName\rIn above line, we set value of openedFilePath variable. This value opened File\u0026rsquo;s full Path. We set the value by GetPathName() method of swDoc variable. Insert Standard Views In this section, we Insert Standard Views action.\n\u0026#39; Open Drawing document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Set Solidworks Drawing document Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. \u0026#39; Boolean Variable Dim boolStatus As Boolean\rPurpose: In above line, we create a variable for Boolean selection. Variable Name: boolStatus Type: Boolean \u0026#39; Insert Standard 3 View [1st Angle] boolStatus = swDrawing.Create1stAngleViews2(openedFilePath)\rIn above code, we Insert Standard 3 View into Drawing.\nFor this, we use Create1stAngleViews2 method.\nThis Create1stAngleViews2 method is part of swDrawing variable.\nThis method takes 1 parameter.\nModelName: Name of the document from which to create views. Return Value : This Create1stAngleViews2 method return üöÄ True if successful, False if not.\nIn our code, I have used following values:\nParameter Name Value Used ModelName openedFilePath Reference: For more details please visit üöÄ online SOLIDWORKS API Help.\n\u0026#39; Check if we successfully insert views If boolStatus = False Then MsgBox \u0026#34;Failed to insert Standard 3 View [1st Angle]\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully insert views or not. We use üöÄ IF statement for checking. Condition: boolStatus = False When this condition is True, We show and üöÄ message window to user. Message: *Failed to insert Standard 3 View [1st Angle]. Then we stop our macro here. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Create Standard 3 View [1st Angle] with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":182,"permalink":"/solidworks-vba-macros/drawing-1stangle-standard3views/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eCreate Standard 3 View [1st Angle]\u003c/strong\u003e in \u003cstrong\u003eDrawing document\u003c/strong\u003e from VBA macro.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Create Standard 3 View [1st Angle]"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Traverse Components Sequentially in Assembly document from VBA macro.\nThere are no direct method to Traverse Components in Sequentially manner.\nThere are 2 methods available from which we get Components in an Assembly document.\nGetComponents() method from AssemblyDoc object.\nGetChildren() method from Component2 object.\nBoth methods, return collection of Component2 object but not in the same order as they are in Feature tree.\nTo address this issue, we have this macro.\nResults We Can Get Below image shows the result we get.\nWe Traverse Components Sequentially in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Traverse Components Sequentially from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Traverse Components Sequentially.\nOption Explicit \u0026#39; Variable for Solidworks Application Dim swApp As SldWorks.SldWorks \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2 \u0026#39; Variable for Solidworks Feature Dim swFeature As SldWorks.Feature \u0026#39; Program to sequentially Traversing Assembly document Sub main() \u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc \u0026#39; Variable for List of elements Dim vArray As Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(True) \u0026#39; Variable for component Dim component As Variant \u0026#39; Get first feature in Feature Tree Set swFeature = swDoc.FirstFeature \u0026#39; Loop until Solidworks Feature is nothing Do While Not swFeature Is Nothing \u0026#39; Loop Components List For Each component In vArray \u0026#39; Set Solidworks Component variable Set swComponent = component \u0026#39; Check if current feature name is same as current component If swFeature.Name = swComponent.Name Then \u0026#39; Print Feature name Debug.Print swFeature.Name End If \u0026#39; Move to next component Next component \u0026#39; Get next Feature in Feature tree Set swFeature = swFeature.GetNextFeature Loop End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We use existing parts in Assembly document. All components are fully constraint as shown in below image. Immediate Window needs to open to see result. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Global Variables Traverse Components Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Assembly Dim swAssembly As SldWorks.AssemblyDoc\rPurpose: In above line, we create a variable for Solidworks Assembly. Variable Name: swAssembly Type: SldWorks.AssemblyDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Component Dim swComponent As SldWorks.Component2\rPurpose: In above line, we create a variable for Solidworks Component. Variable Name: swComponent Type: SldWorks.Component2. Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks Feature Dim swFeature As SldWorks.Feature\rPurpose: In above line, we create a variable for Solidworks Feature. Variable Name: swFeature Type: SldWorks.Feature. Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to sequentially Traversing Assembly document Sub main() End Sub\rIn above line, we create Program to sequentially Traversing Assembly document. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Global Variables In this section, we initialize global variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Assembly document Set swAssembly = swDoc\rIn above line, we set value of swAssembly variable. This value is swDoc variable. Traverse Components In this section, we perform Traverse Components action.\n\u0026#39; Variable for List of elements Dim vArray As Variant\rPurpose: In above line, we create a variable for List of elements. Variable Name: vArray Type: Variant \u0026#39; Get Components list in opened assembly vArray = swAssembly.GetComponents(False)\rIn above line, we set the value of vArray variable. We set value by GetComponents method of swAssembly variable. By passing False to GetComponents method, we get all components from Feature Tree. \u0026#39; Variable for component Dim component As Variant\rIn above line, we create component variable for looping. Variable Name: component Type: Variant \u0026#39; Get first feature in Feature Tree Set swFeature = swDoc.FirstFeature\rIn above line, we get the first feature in Feature Tree. We set the value of swFeature variable to FirstFeature property of swDoc variable. \u0026#39; Loop until Solidworks Feature is nothing Do While Not swFeature Is Nothing Loop\rIn above line, we create a Do While loop. We loop Feature tree manager. We loop until Solidworks Feature is nothing. \u0026#39; Loop Components List For Each component In vArray \u0026#39; Move to next component Next component\rIn above line, we create a For Each loop. In this loop, component variable loops every item in vArray. \u0026#39; Set Solidworks Component variable Set swComponent = component\rIn above line, we set value of swComponent variable. This value is current value of array vArray. Current value is represented by component variable. \u0026#39; Check if current feature name is same as current component If swFeature.Name = swComponent.Name Then End If\rIn above code block, we check if current feature name is same as current component. We use üöÄ IF statement for checking. Condition: swFeature.Name = swComponent.Name \u0026#39; Print Feature name Debug.Print swFeature.Name\rIn above code, we print the Feature name in Immediate window. \u0026#39; Get next Feature in Feature tree Set swFeature = swFeature.GetNextFeature\rIn above line of code, we get next Feature in Feature tree. We set the value of swFeature variable. We set the value to GetNextFeature property of swFeature variable. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Traverse Components with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":183,"permalink":"/solidworks-vba-macros/assembly-traverse-sequentially/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eTraverse Components Sequentially\u003c/strong\u003e in \u003cstrong\u003eAssembly document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eThere are no direct method to \u003cstrong\u003eTraverse Components in Sequentially\u003c/strong\u003e manner.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Traverse Components Sequentially"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Create Standard 3 View [3rd Angle] in Drawing document from VBA macro.\nWe will insert Standard 3 View of [3rd Angle].\nThis is most updated method of Standard 3 View of [3rd Angle] in an drawing document.\nResults We Can Get Below image shows the result we get.\nWe Create Standard 3 View [3rd Angle] in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Create Standard 3 View [3rd Angle] from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Create Standard 3 View [3rd Angle].\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Program to Insert Standard 3 View [3rd Angle] Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Get Opened \u0026#34;Demo Assembly\u0026#34; document Set swDoc = swApp.GetOpenDocument(\u0026#34;Demo Assembly\u0026#34;) \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Variable for opened File\u0026#39;s full Path Dim openedFilePath As String \u0026#39; Get opened File\u0026#39;s full Path openedFilePath = swDoc.GetPathName \u0026#39; Open Drawing document Set swDoc = swApp.ActiveDoc \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Boolean variable Dim boolStatus As Boolean \u0026#39; Insert Standard 3 View [3rd Angle] boolStatus = swDrawing.Create3rdAngleViews2(openedFilePath) \u0026#39; Check if we successfully insert views If boolStatus = False Then MsgBox \u0026#34;Failed to insert Standard 3 View [3rd Angle]\u0026#34; Exit Sub End If End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We create drawing from an already opened Assembly document. We will use name of Assembly document name hardcoded. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Get Assembly Full Path Insert Standard Views Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Insert Standard 3 View [3rd Angle] Sub main() End Sub\rIn above line, we create Program to Insert Standard 3 View [3rd Angle]. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Get Assembly Full Path In this section, we Get Assembly Full Path.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Get Opened \u0026#34;Demo Assembly\u0026#34; document Set swDoc = swApp.GetOpenDocument(\u0026#34;Demo Assembly\u0026#34;)\rIn above line, we set value of swDoc variable. This value is currently Opened \u0026ldquo;Demo Assembly\u0026rdquo; document. We use GetOpenDocument() method from swApp variable. This GetOpenDocument() method takes one parameter. DocName - Name of the document. We pass Opened assembly name i.e. \u0026ldquo;Demo Assembly\u0026rdquo; as parameter. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Variable for opened File\u0026#39;s full Path Dim openedFilePath As String\rIn above line, we create a variable for opened File\u0026rsquo;s full Path. Variable Name: openedFilePath Type: String \u0026#39; Get opened File\u0026#39;s full Path openedFilePath = swDoc.GetPathName\rIn above line, we set value of openedFilePath variable. This value opened File\u0026rsquo;s full Path. We set the value by GetPathName() method of swDoc variable. Insert Standard Views In this section, we Insert Standard Views action.\n\u0026#39; Open Drawing document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Set Solidworks Drawing document Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. \u0026#39; Boolean Variable Dim boolStatus As Boolean\rPurpose: In above line, we create a variable for Boolean selection. Variable Name: boolStatus Type: Boolean \u0026#39; Insert Standard 3 View [3rd Angle] boolStatus = swDrawing.Create3rdAngleViews2(openedFilePath)\rIn above code, we Insert Standard 3 View into Drawing.\nFor this, we use Create3rdAngleViews2 method.\nThis Create3rdAngleViews2 method is part of swDrawing variable.\nThis method takes 1 parameter.\nModelName: Name of the document from which to create views. Return Value : This Create3rdAngleViews2 method return üöÄ True if successful, False if not.\nIn our code, I have used following values:\nParameter Name Value Used ModelName openedFilePath Reference: For more details please visit üöÄ online SOLIDWORKS API Help.\n\u0026#39; Check if we successfully insert views If boolStatus = False Then MsgBox \u0026#34;Failed to insert Standard 3 View [3rd Angle]\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully insert views or not. We use üöÄ IF statement for checking. Condition: boolStatus = False When this condition is True, We show and üöÄ message window to user. Message: *Failed to insert Standard 3 View [3rd Angle]. Then we stop our macro here. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Create Standard 3 View [3rd Angle] with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":184,"permalink":"/solidworks-vba-macros/drawing-3rdangle-standard3views/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eCreate Standard 3 View [3rd Angle]\u003c/strong\u003e in \u003cstrong\u003eDrawing document\u003c/strong\u003e from VBA macro.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Create Standard 3 View [3rd Angle]"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Insert Model View in Drawing document from VBA macro.\nWe will insert Insert Model View.\nThis is most updated method of Insert Model View in an drawing document.\nResults We Can Get Below image shows the result we get.\nWe Insert Model View in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Insert Model View from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Insert Model View.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Creating variable for Solidworks View Dim modelView As SldWorks.View \u0026#39; Program to Insert Model View Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Get Opened \u0026#34;Demo Assembly\u0026#34; document Set swDoc = swApp.GetOpenDocument(\u0026#34;Demo Assembly\u0026#34;) \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Variable for opened File\u0026#39;s full Path Dim openedFilePath As String \u0026#39; Get opened File\u0026#39;s full Path openedFilePath = swDoc.GetPathName \u0026#39; Open Drawing document Set swDoc = swApp.ActiveDoc \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Insert Model View [Front View] Set modelView = swDrawing.CreateDrawViewFromModelView3(openedFilePath, \u0026#34;*Front\u0026#34;, 0.1, 0.1, 0) \u0026#39; Check if we successfully insert Model view If modelView Is Nothing Then MsgBox \u0026#34;Failed to Insert Model View.\u0026#34; Exit Sub End If End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We create drawing from an already opened Assembly document. We will use name of Assembly document name hardcoded. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Get Assembly Full Path Insert Model Views Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks View Dim modelView As SldWorks.View\rPurpose: In above line, we create a variable for Solidworks View. Variable Name: modelView Type: SldWorks.View Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Insert Model View Sub main() End Sub\rIn above line, we create Program to Insert Model View. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Get Assembly Full Path In this section, we Get Assembly Full Path.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Get Opened \u0026#34;Demo Assembly\u0026#34; document Set swDoc = swApp.GetOpenDocument(\u0026#34;Demo Assembly\u0026#34;)\rIn above line, we set value of swDoc variable. This value is currently Opened \u0026ldquo;Demo Assembly\u0026rdquo; document. We use GetOpenDocument() method from swApp variable. This GetOpenDocument() method takes one parameter. DocName - Name of the document. We pass Opened assembly name i.e. \u0026ldquo;Demo Assembly\u0026rdquo; as parameter. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Variable for opened File\u0026#39;s full Path Dim openedFilePath As String\rIn above line, we create a variable for opened File\u0026rsquo;s full Path. Variable Name: openedFilePath Type: String \u0026#39; Get opened File\u0026#39;s full Path openedFilePath = swDoc.GetPathName\rIn above line, we set value of openedFilePath variable. This value opened File\u0026rsquo;s full Path. We set the value by GetPathName() method of swDoc variable. Insert Model View In this section, we Insert Model View action.\n\u0026#39; Open Drawing document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Set Solidworks Drawing document Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. \u0026#39; Insert Model View [Front View] Set modelView = swDrawing.CreateDrawViewFromModelView3(openedFilePath, \u0026#34;*Front\u0026#34;, 0.1, 0.1, 0)\rIn above code, we Insert Model View into Drawing.\nFor this, we use CreateDrawViewFromModelView3 method.\nThis CreateDrawViewFromModelView3 method is part of swDrawing variable.\nThis method takes following parameters.\nModelName: Full pathname of the model document for which to create the drawing view. ViewName: *Name of the model view from which to create the drawing view. For example \u0026ldquo;Front\u0026rdquo; for Front view. LocX: X location of drawing view center in meters. LocY: Y location of drawing view center in meters. LocZ: Z location of drawing view center in meters. Return Value : This CreateDrawViewFromModelView3 method return üöÄ View data object.\nIn our code, I have used following values:\nParameter Name Value Used ModelName openedFilePath ViewName *Front LocX 0.1 LocY 0.1 LocZ 0 Reference: For more details please visit üöÄ online SOLIDWORKS API Help.\n\u0026#39; Check if we successfully insert views If modelView Is Nothing Then MsgBox \u0026#34;Failed to Insert Model View\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully insert views or not. We use üöÄ IF statement for checking. Condition: modelView Is Nothing When this condition is True, We show and üöÄ message window to user. Message: *Failed to Insert Model View. Then we stop our macro here. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Insert Model View with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":185,"permalink":"/solidworks-vba-macros/drawing-insert-modelview/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eInsert Model View\u003c/strong\u003e in \u003cstrong\u003eDrawing document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eWe will insert Insert Model View.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Insert Model View"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Insert Projection View in Drawing document from VBA macro.\nWe will insert Projection View.\nThis is most updated method of Insert Projection View in an drawing document.\nResults We Can Get Below image shows the result we get.\nWe Insert Projection View in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Insert Projection View from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Insert Projection View.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Creating variable for Solidworks View Dim modelView As SldWorks.View \u0026#39; Program to Insert Projection View Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Insert Projection View Set modelView = swDrawing.CreateUnfoldedViewAt3(0.2, 0.1, 0, False) \u0026#39; Check if we successfully insert Projection view If modelView Is Nothing Then MsgBox \u0026#34;Failed to Insert Projection View.\u0026#34; Exit Sub End If End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We create Projection view from an existing (Base) view . We already select this existing (Base) view. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Variables Insert Projection Views Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks View Dim modelView As SldWorks.View\rPurpose: In above line, we create a variable for Solidworks View. Variable Name: modelView Type: SldWorks.View Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Insert Projection View Sub main() End Sub\rIn above line, we create Program to Insert Projection View. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Variables In this section, we initialize Variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Drawing document Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. Insert Projection Views In this section, we Insert Projection Views action.\n\u0026#39; Insert Projection View Set modelView = swDrawing.CreateUnfoldedViewAt3(0.2, 0.1, 0, False)\rIn above code, we Insert Projection View into Drawing.\nFor this, we use CreateUnfoldedViewAt3 method.\nThis CreateUnfoldedViewAt3 method is part of swDrawing variable.\nThis method takes following parameters.\nX: X position in the drawing sheet space for the center of the drawing view. Y: Y position in the drawing sheet space for the center of the drawing view. Z: Z position in the drawing sheet space for the center of the drawing view. NotAligned: * True if you want to break the alignment with the parent view, False if you want to keep the view aligned with the parent view.* Return Value : This CreateUnfoldedViewAt3 method return üöÄ View data object.\nIn our code, I have used following values:\nParameter Name Value Used X 0.2 Y 0.1 Z 0 NotAligned False Reference: For more details please visit üöÄ online SOLIDWORKS API Help.\n\u0026#39; Check if we successfully insert view If modelView Is Nothing Then MsgBox \u0026#34;Failed to Insert Projection View\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully insert views or not. We use üöÄ IF statement for checking. Condition: modelView Is Nothing When this condition is True, We show and üöÄ message window to user. Message: *Failed to Insert Projection View. Then we stop our macro here. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Insert Projection View with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":186,"permalink":"/solidworks-vba-macros/drawing-insert-projectionview/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eInsert Projection View\u003c/strong\u003e in \u003cstrong\u003eDrawing document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eWe will insert Projection View.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Insert Projection View"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Insert Auxilary View in Drawing document from VBA macro.\nWe will insert Auxilary View.\nThis is most updated method of Insert Auxilary View in an drawing document.\nResults We Can Get Below image shows the result we get.\nWe Insert Auxilary View in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Insert Auxilary View from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Insert Auxilary View.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Creating variable for Solidworks View Dim modelView As SldWorks.View \u0026#39; Program to Insert Auxiliary View Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Insert Auxiliary View Set modelView = swDrawing.CreateAuxiliaryViewAt2(0.2, 0.1, 0, False, \u0026#34;A\u0026#34;, True, True) \u0026#39; Check if we successfully insert Auxiliary view If modelView Is Nothing Then MsgBox \u0026#34;Failed to Insert Auxiliary View.\u0026#34; Exit Sub End If End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We create Auxiliary view from an existing (Base) view . We already select an edge in this existing (Base) view. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Variables Insert Auxilary Views Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks View Dim modelView As SldWorks.View\rPurpose: In above line, we create a variable for Solidworks View. Variable Name: modelView Type: SldWorks.View Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Insert Auxilary View Sub main() End Sub\rIn above line, we create Program to Insert Auxilary View. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Variables In this section, we initialize Variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Drawing document Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. Insert Auxilary Views In this section, we Insert Auxilary Views action.\n\u0026#39; Insert Auxiliary View Set modelView = swDrawing.CreateAuxiliaryViewAt2(0.2, 0.1, 0, False, \u0026#34;A\u0026#34;, True, True)\rIn above code, we Insert Auxilary View into Drawing.\nFor this, we use CreateAuxiliaryViewAt2 method.\nThis CreateAuxiliaryViewAt2 method is part of swDrawing variable.\nThis method takes following parameters.\nX: X position for the auxiliary view. Y: Y position for the auxiliary view. Z: Z position for the auxiliary view. NotAligned: * True aligns the view from its owner, False does not.* Label: String that holds label of the auxiliary view. Showarrow: * True shows the arrow, False hides the arrow.* Flip: * True flips the side shown in the auxiliary view, False does not.* Return Value : This CreateAuxiliaryViewAt2 method return üöÄ View data object.\nIn our code, I have used following values:\nParameter Name Value Used X 0.2 Y 0.1 Z 0 NotAligned False Label A Showarrow True Flip True Reference: For more details please visit üöÄ online SOLIDWORKS API Help.\n\u0026#39; Check if we successfully insert view If modelView Is Nothing Then MsgBox \u0026#34;Failed to Insert Auxilary View\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully insert views or not. We use üöÄ IF statement for checking. Condition: modelView Is Nothing When this condition is True, We show and üöÄ message window to user. Message: *Failed to Insert Auxilary View. Then we stop our macro here. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Insert Auxilary View with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":187,"permalink":"/solidworks-vba-macros/drawing-insert-auxilaryview/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eInsert Auxilary View\u003c/strong\u003e in \u003cstrong\u003eDrawing document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eWe will insert Auxilary View.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Insert Auxilary View"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Insert Section View in Drawing document from VBA macro.\nWe will insert Section View.\nThis is most updated method of Insert Section View in an drawing document.\nResults We Can Get Below image shows the result we get.\nWe Insert Section View in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Insert Section View from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Insert Section View.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Creating variable for Solidworks View Dim insertView As SldWorks.View \u0026#39; Program to Insert Section View Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Insert Section View Set insertView = swDrawing.CreateSectionViewAt5(0.2, 0.12, 0, \u0026#34;A\u0026#34;, swCreateSectionView_NotAligned, Nothing, 0) \u0026#39; Check if we successfully insert Section view If insertView Is Nothing Then MsgBox \u0026#34;Failed to Insert Section View.\u0026#34; Exit Sub End If \u0026#39; Rebuild document swDoc.ForceRebuild3 False End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We create Section view from an existing (Base) view . We already select a line as \u0026ldquo;Section Line\u0026rdquo; this existing (Base) view. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Variables Insert Section Views Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks View Dim insertView As SldWorks.View\rPurpose: In above line, we create a variable for Solidworks View. Variable Name: insertView Type: SldWorks.View Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Insert Section View Sub main() End Sub\rIn above line, we create Program to Insert Section View. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Variables In this section, we initialize Variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Drawing document Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. Insert Section Views In this section, we Insert Section Views action.\n\u0026#39; Insert Section View Set insertView = swDrawing.CreateSectionViewAt5(0.2, 0.12, 0, \u0026#34;A\u0026#34;, swCreateSectionView_NotAligned, Nothing, 0)\rIn above code, we Insert Section View into Drawing.\nFor this, we use CreateSectionViewAt5 method.\nThis CreateSectionViewAt5 method is part of swDrawing variable.\nThis method takes following parameters.\nX: X position on the drawing sheet for the center of the section view.\nY: Y position on the drawing sheet for the center of the section view.\nZ: Z position on the drawing sheet for the center of the section view.\nSectionLabel: Letter for the label for the section view.\nOptions: Options that affect the section view as defined in swCreateSectionViewAtOptions_e as following.\nParameter Name Description swCreateSectionView_ChangeDirection If set, then the direction of this section view is switched; if not set, then the direction of this section view is not switched. swCreateSectionView_CutSurfaceBodies If set, then shows only the intersecting line of a surface in a section. swCreateSectionView_DisplaySurfaceCut If set, then only the surfaces cut by the section line apear in the section view; if not set, then all model surfaces appear in the section view. swCreateSectionView_ExcludeFasteners If set, then fasteners are not included in the section view; if not set, then fasteners are included in the section view. swCreateSectionView_NotAligned If set, then the section does not snap into alignment with the parent view; if not set, then the section snaps into alignment with the parent view. swCreateSectionView_OffsetSection If set, then an aligned section view is created (two lines at an angle); if not set, a normal projection section view is created. swCreateSectionView_Partial If set, then a partial section view is created; if not set, then a complete section view is created. swCreateSectionView_ScaleWithModel If set, then the section view is scaled with the model; if not set, then the section view is not scaled with the model. ExcludedComponents: Array of components to exclude from the section view.\nSectionDepth: Distance from the selected section line.\nReturn Value : This CreateSectionViewAt5 method return üöÄ View object.\nIn our code, I have used following values:\nParameter Name Value Used X 0.2 Y 0.1 Z 0 SectionLabel A Options swCreateSectionView_NotAligned ExcludedComponents Nothing SectionDepth 0 Reference: For more details please visit üöÄ online SOLIDWORKS API Help.\n\u0026#39; Check if we successfully insert view If insertView Is Nothing Then MsgBox \u0026#34;Failed to Insert Section View\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully insert views or not. We use üöÄ IF statement for checking. Condition: insertView Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to Insert Section View. Then we stop our macro here. \u0026#39; Rebuild drawing swDoc.ForceRebuild3 True\rIn above line, we Rebuild drawing. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Insert Section View with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":188,"permalink":"/solidworks-vba-macros/drawing-insert-sectionview/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eInsert Section View\u003c/strong\u003e in \u003cstrong\u003eDrawing document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eWe will insert Section View.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Insert Section View"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Insert Detail View in Drawing document from VBA macro.\nWe will insert Detail View.\nThis is most updated method of Insert Detail View in an drawing document.\nResults We Can Get Below image shows the result we get.\nWe Insert Detail View in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Insert Detail View from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Insert Detail View.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Creating variable for Solidworks View Dim insertView As SldWorks.View \u0026#39; Program to Insert Detail View Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Insert Detail View Set insertView = swDrawing.CreateDetailViewAt4(0.2, 0.12, 0, swDetViewSTANDARD, 1, 10, \u0026#34;A\u0026#34;, swDetCircleCIRCLE, True, False, False, 5) \u0026#39; Check if we successfully insert Detail view If insertView Is Nothing Then MsgBox \u0026#34;Failed to Insert Detail View.\u0026#34; Exit Sub End If \u0026#39; Rebuild drawing swDoc.ForceRebuild3 False End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We create Detail view from an existing (Base) view. We already select a Circle in this existing (Base) view. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Variables Insert Detail Views Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks View Dim insertView As SldWorks.View\rPurpose: In above line, we create a variable for Solidworks View. Variable Name: insertView Type: SldWorks.View Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Insert Detail View Sub main() End Sub\rIn above line, we create Program to Insert Detail View. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Variables In this section, we initialize Variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Drawing document Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. Insert Detail Views In this section, we Insert Detail Views.\n\u0026#39; Insert Detail View Set insertView = swDrawing.CreateDetailViewAt4(0.2, 0.12, 0, swDetViewSTANDARD, 1, 10, \u0026#34;A\u0026#34;, swDetCircleCIRCLE, True, False, False, 5)\rIn above code, we Insert Detail View into Drawing.\nFor this, we use CreateDetailViewAt4 method.\nThis CreateDetailViewAt4 method is part of swDrawing variable.\nThis method takes following parameters.\nX: X position for the Detail view.\nY: Y position for the Detail view.\nZ: Z position for the Detail view.\nStyle: Style for the detail view as defined in swDetViewStyle_e as following.\nParameter Name Description swDetViewBROKEN 1 = Use broken detail view style. swDetViewCONNECTED 4 = Use connected detail view style. swDetViewLEADER 2 = Use leader detail view style. swDetViewNOLEADER 3 = Use no leader detail view style. swDetViewSTANDARD 0 = Use standard detail view style. Scale1: Scale numerator.\nScale2: Scale denominator.\nLabelIn: Detail view label.\nShowtype: Type of sketch for the detail view as defined in swDetCircleShowType_e as following.\nParameter Name Description swDetCircleCIRCLE 1 = Use sketch circle to create detail view. swDetCircleDONTSHOW 2 = Do not show a sketch profile. swDetCirclePROFILE 0 = Use sketch profile to create detail view. FullOutline: * True to show a full outline, False to not; valid only if NoOutline is False.*\nJaggedOutline: * True to show a jagged outline, False does not; valid only if NoOutline is False.*\nNoOutline: * True to not show an outline, False to show an outline.*\nShapeIntensity: Intensity of jagged outline; valid range is 1 (most) to 5 (least) and only valid if JaggedOutline is True and NoOutline is False.\nReturn Value : This CreateDetailViewAt4 method return üöÄ View data object.\nIn our code, I have used following values:\nParameter Name Value Used X 0.2 Y 0.12 Z 0 Style swDetViewSTANDARD Scale1 1 Scale2 10 LabelIn A Showtype swDetCircleCIRCLE FullOutline True JaggedOutline False NoOutline False ShapeIntensity 5 Reference: For more details please visit üöÄ online SOLIDWORKS API Help.\n\u0026#39; Check if we successfully insert view If insertView Is Nothing Then MsgBox \u0026#34;Failed to Insert Detail View\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully insert views or not. We use üöÄ IF statement for checking. Condition: insertView Is Nothing When this condition is True, We show and üöÄ message window to user. Message: *Failed to Insert Detail View. Then we stop our macro here. \u0026#39; Rebuild drawing swDoc.ForceRebuild3 True\rIn above line, we Rebuild drawing. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Insert Detail View with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":189,"permalink":"/solidworks-vba-macros/drawing-insert-detailview/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eInsert Detail View\u003c/strong\u003e in \u003cstrong\u003eDrawing document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eWe will insert Detail View.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Insert Detail View"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Insert Broken-out View in Drawing document from VBA macro.\nThis is most updated method of Insert Broken-out View in an drawing document.\nResults We Can Get Below image shows the result we get.\nWe Insert Broken-out View in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Insert Broken-out View from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Insert Broken-out View.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Program to Insert Broken-out View Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Boolean variable Dim boolStatus As Boolean \u0026#39; Insert Broken-out View boolStatus = swDrawing.CreateBreakOutSection(0.1) \u0026#39; Check if we successfully insert Broken-out View If boolStatus = False Then MsgBox \u0026#34;Failed to Insert Broken-out View.\u0026#34; Exit Sub End If \u0026#39; Rebuild drawing swDoc.ForceRebuild3 False End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We create Broken-out view from an existing (Base) view. We already select a Circle in this existing (Base) view. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Variables Insert Broken-out Views Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Insert Broken-out View Sub main() End Sub\rIn above line, we create Program to Insert Broken-out View. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Variables In this section, we initialize Variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Drawing document Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. Insert Broken-out Views In this section, we Insert Broken-out Views.\n\u0026#39; Boolean variable Dim boolStatus As Boolean\rPurpose: In above line, we create a Boolean variable. Variable Name: boolStatus Type: Boolean \u0026#39; Insert Broken-out View boolStatus = swDrawing.CreateBreakOutSection(0.1)\rIn above code, we Insert Broken-out View into Drawing.\nFor this, we use CreateBreakOutSection method.\nThis CreateBreakOutSection method is part of swDrawing variable.\nThis method takes following parameters.\nDepth: X position for the Detail view. Return Value : This CreateBreakOutSection method return True if the broken-out section was created, False if not.\nIn our code, I have used following values:\nParameter Name Value Used Depth 0.1 Reference: For more details please visit üöÄ online SOLIDWORKS API Help.\n\u0026#39; Check if we successfully insert Broken-out View If boolStatus = False Then MsgBox \u0026#34;Failed to Insert Broken-out View.\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully insert views or not. We use üöÄ IF statement for checking. Condition: boolStatus = False When this condition is True, We show and üöÄ message window to user. Message: *Failed to Insert Broken-out View. Then we stop our macro here. \u0026#39; Rebuild drawing swDoc.ForceRebuild3 True\rIn above line, we Rebuild drawing. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Insert Broken-out View with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":190,"permalink":"/solidworks-vba-macros/drawing-brokenout-view/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eInsert Broken-out View\u003c/strong\u003e in \u003cstrong\u003eDrawing document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eThis is most updated method of \u003cstrong\u003eInsert Broken-out View\u003c/strong\u003e in an drawing document.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Insert Broken-out View"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Insert Crop View in Drawing document from VBA macro.\nThis is most easiest method of Insert Crop View in an drawing document.\nResults We Can Get Below image shows the result we get.\nWe Insert Crop View in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Insert Crop View from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Insert Crop View.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View \u0026#39; Program to Insert Crop View Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Get activate view Set swView = swDrawing.ActiveDrawingView \u0026#39; Variable for errors Dim error As Integer \u0026#39; Insert Crop view error = swView.Crop() \u0026#39; Check if we successfully insert Crop View If Not error = 1 Then MsgBox \u0026#34;Failed to Insert Crop View.\u0026#34; Exit Sub End If \u0026#39; Rebuild drawing swDoc.ForceRebuild3 False End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We create Crop view from an existing (Base) view. We already select a Circle in this existing (Base) view. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Variables Insert Crop Views Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View\rPurpose: In above line, we create a variable for Solidworks View. Variable Name: swView Type: SldWorks.View Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Insert Crop View Sub main() End Sub\rIn above line, we create Program to Insert Crop View. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Variables In this section, we initialize Variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. Insert Crop Views In this section, we Insert Crop Views.\n\u0026#39; Get activate view Set swView = swDrawing.ActiveDrawingView\rIn above code, we Get activate view from Drawing. For this, we use ActiveDrawingView property. This ActiveDrawingView property is part of swDrawing variable. \u0026#39; Variable for errors Dim error As Integer\rPurpose: In above line, we create a Integer variable. Variable Name: error Type: Integer \u0026#39; Insert Crop View error = swView.Crop()\rIn above code, we Insert Crop View into Drawing.\nFor this, we use Crop() method.\nThis Crop() method is part of swView variable.\nThis method did not take any parameter.\nReturn Value : This Crop() method return status as defined in swCropViewErrors_e as following.\nMember Description swCropViewErrors_CannotCropDetailOrBrokenView 2 = Cannot crop detail or broken view swCropViewErrors_CannotUnfoldView 3 = Cannot unfold view swCropViewErrors_IncorrectProfile 4 = Bad spline swCropViewErrors_NoError 1 swCropViewErrors_Unknown 0 Reference: For more details please visit üöÄ online SOLIDWORKS API Help.\n\u0026#39; Check if we successfully insert Crop View If Not error = 1 Then MsgBox \u0026#34;Failed to Insert Crop View.\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully insert views or not. We use üöÄ IF statement for checking. Condition: Not error = 1 When this condition is True, We show and üöÄ message window to user. Message: *Failed to Insert Crop View. Then we stop our macro here. \u0026#39; Rebuild drawing swDoc.ForceRebuild3 True\rIn above line, we Rebuild drawing. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Insert Crop View with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":191,"permalink":"/solidworks-vba-macros/drawing-crop-view/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eInsert Crop View\u003c/strong\u003e in \u003cstrong\u003eDrawing document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eThis is most \u003cstrong\u003eeasiest\u003c/strong\u003e method of \u003cstrong\u003eInsert Crop View\u003c/strong\u003e in an drawing document.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Insert Crop View"},{"content":"","date":"2023-09-07","id":192,"permalink":"/solidworks-macros/99-sketch---others/","summary":"","tags":[],"title":"Sketch - Others"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Get View Position in Drawing document from VBA macro.\nThis is most updated method of Get View Position in an drawing document.\nResults We Can Get Below image shows the result we get.\nWe Get View Position in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Get View Position from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Get View Position.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View \u0026#39; Program to Get View Position Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Get activate view Set swView = swDrawing.ActiveDrawingView \u0026#39; Print selected View center\u0026#39;s X \u0026amp; Y position Debug.Print \u0026#34;View\u0026#39;s X position: \u0026#34; \u0026amp; swView.position(0) Debug.Print \u0026#34;View\u0026#39;s Y position: \u0026#34; \u0026amp; swView.position(1) End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We get view positions from an existing (Base) view. We already select a Circle in this existing (Base) view. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Variables Get View Position Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View\rPurpose: In above line, we create a variable for Solidworks View. Variable Name: swView Type: SldWorks.View Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Get View Position Sub main() End Sub\rIn above line, we create Program to Get View Position. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Variables In this section, we initialize Variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Drawing document Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. Get View Position In this section, we Get View Position.\n\u0026#39; Get activate view Set swView = swDrawing.ActiveDrawingView\rIn above code, we Get activate view from Drawing. For this, we use ActiveDrawingView property. This ActiveDrawingView property is part of swDrawing variable. \u0026#39; Print selected View center\u0026#39;s X \u0026amp; Y position Debug.Print \u0026#34;View\u0026#39;s X Position: \u0026#34; \u0026amp; swView.position(0) Debug.Print \u0026#34;View\u0026#39;s Y Position: \u0026#34; \u0026amp; swView.position(1)\rIn above line, we Print selected View center\u0026rsquo;s X \u0026amp; Y position in Immediate Window. If Immediate Window is not available then press \u0026ldquo;Ctrl + G\u0026rdquo;. View\u0026rsquo;s X Position: swView.position(0) ‚¨Ö This is 0th index. View\u0026rsquo;s Y Position: swView.position(1) ‚¨Ö This is 1st index. Now we run the macro and after running macro we get view position as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Get View Position with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":193,"permalink":"/solidworks-vba-macros/drawing-get-view-position/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eGet View Position\u003c/strong\u003e in \u003cstrong\u003eDrawing document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eThis is most updated method of \u003cstrong\u003eGet View Position\u003c/strong\u003e in an drawing document.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Get View Position"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Get View Outer Boundary in Drawing document from VBA macro.\nThis is most updated method of Get View Outer Boundary in an drawing document.\nResults We Can Get Below image shows the result we get.\nWe Get View Outer Boundary in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Get View Outer Boundary from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Get View Outer Boundary.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View \u0026#39; Program to Get View Outer Boundary Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Get activate view Set swView = swDrawing.ActiveDrawingView \u0026#39; Variable for view\u0026#39;s outline position Dim viewOutlinePosition() As Double \u0026#39; Get view\u0026#39;s outline position viewOutlinePosition = swView.GetOutline \u0026#39; Print view\u0026#39;s outline position co-ordinates Debug.Print \u0026#34;View\u0026#39;s Left X: \u0026#34; \u0026amp; viewOutlinePosition(0) Debug.Print \u0026#34;View\u0026#39;s Right X: \u0026#34; \u0026amp; viewOutlinePosition(2) Debug.Print \u0026#34;View\u0026#39;s Bottom Y: \u0026#34; \u0026amp; viewOutlinePosition(1) Debug.Print \u0026#34;View\u0026#39;s Top Y: \u0026#34; \u0026amp; viewOutlinePosition(3) End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We get view outer boundary from an existing (Base) view. We already select an existing (Base) view. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Variables Get View Outer Boundary Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View\rPurpose: In above line, we create a variable for Solidworks View. Variable Name: swView Type: SldWorks.View Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Get View Outer Boundary Sub main() End Sub\rIn above line, we create Program to Get View Outer Boundary. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Variables In this section, we initialize Variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Drawing document Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. Get View Outer Boundary In this section, we Get View Outer Boundary.\n\u0026#39; Get activate view Set swView = swDrawing.ActiveDrawingView\rIn above code, we Get activate view from Drawing. For this, we use ActiveDrawingView property. This ActiveDrawingView property is part of swDrawing variable. \u0026#39; Variable for view\u0026#39;s outline position Dim viewOutlinePosition() As Double\rIn above line, we create an Array variable for view\u0026rsquo;s outline position. Variable Name: viewOutlinePosition() Type: Double \u0026#39; Get view\u0026#39;s outline position viewOutlinePosition = swView.GetOutline\rIn above line, we set value of viewOutlinePosition variable. We set the value by GetOutline() method of swView variable. \u0026#39; Print view\u0026#39;s outline position co-ordinates Debug.Print \u0026#34;View\u0026#39;s Left X: \u0026#34; \u0026amp; viewOutlinePosition(0) Debug.Print \u0026#34;View\u0026#39;s Right X: \u0026#34; \u0026amp; viewOutlinePosition(2) Debug.Print \u0026#34;View\u0026#39;s Bottom Y: \u0026#34; \u0026amp; viewOutlinePosition(1) Debug.Print \u0026#34;View\u0026#39;s Top Y: \u0026#34; \u0026amp; viewOutlinePosition(3)\rIn above line, we Print selected View\u0026rsquo;s outline position co-ordinates in Immediate Window. If Immediate Window is not available then press \u0026ldquo;Ctrl + G\u0026rdquo;. View\u0026rsquo;s Left X: viewOutlinePosition(0) ‚¨Ö This is 0th index. View\u0026rsquo;s Right X: viewOutlinePosition(2) ‚¨Ö This is 2nd index. View\u0026rsquo;s Bottom Y: viewOutlinePosition(1) ‚¨Ö This is 1st index. View\u0026rsquo;s Top Y: viewOutlinePosition(3) ‚¨Ö This is 3rd index. Please see below image for more details.\nNow we run the macro and after running macro we Get View Outer Boundary as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Get View Outer Boundary with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":194,"permalink":"/solidworks-vba-macros/drawing-get-view-outer-boundary/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eGet View Outer Boundary\u003c/strong\u003e in \u003cstrong\u003eDrawing document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eThis is most updated method of \u003cstrong\u003eGet View Outer Boundary\u003c/strong\u003e in an drawing document.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Get View Outer Boundary"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; First/Next View In Current Sheet in Drawing document from VBA macro.\nThis is most updated method of First/Next View In Current Sheet in an drawing document.\nResults We Can Get Below image shows the result we get.\nWe First/Next View In Current Sheet in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to First/Next View In Current Sheet from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for First/Next View In Current Sheet.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View \u0026#39; Program to Get First and Next View Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Get Current Sheet\u0026#39;s Name Set swView = swDrawing.GetFirstView() \u0026#39; Print Sheet\u0026#39;s Name Debug.Print swView.Name \u0026#39; Get First View\u0026#39;s Name Set swView = swView.GetNextView() \u0026#39; Print View\u0026#39;s Name Debug.Print swView.Name End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. We create an existing (Base) view. We did not select anything in the drawing. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Variables Get First and Next View Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View\rPurpose: In above line, we create a variable for Solidworks View. Variable Name: swView Type: SldWorks.View Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Get First and Next View Sub main() End Sub\rIn above line, we create Program to Get First and Next View. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Variables In this section, we initialize Variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Drawing document Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. Get First and Next View In this section, we Get First and Next View.\n\u0026#39; Get Sheet as First view Set swView = swDrawing.GetFirstView()\rIn above code, we First View In Current Sheet into Drawing.\nFor this, we use GetFirstView method.\nThis GetFirstView method is part of swDrawing variable.\nThis method did not takes parameters.\nReturn Value : This GetFirstView method return Sheet as First View.\n\u0026#39; Print Sheet\u0026#39;s Name Debug.Print swView.Name\rIn above line, we Print Sheet\u0026rsquo;s Name in Immediate Window. If Immediate Window is not available then press \u0026ldquo;Ctrl + G\u0026rdquo;. \u0026#39; Get First View\u0026#39;s Name Set swView = swView.GetNextView()\rIn above code, we Next View i.e. First View In Current Sheet into Drawing.\nFor this, we use GetNextView method.\nThis GetNextView method is part of swDrawing variable.\nThis method did not takes parameters.\nReturn Value : This GetNextView method return Drawing View.\n\u0026#39; Print View\u0026#39;s Name Debug.Print swView.Name\rIn above line, we Print View\u0026rsquo;s Name in Immediate Window. If Immediate Window is not available then press \u0026ldquo;Ctrl + G\u0026rdquo;. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to First/Next View In Current Sheet with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":195,"permalink":"/solidworks-vba-macros/drawing-first-view-in-current-sheet/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eFirst/Next View In Current Sheet\u003c/strong\u003e in \u003cstrong\u003eDrawing document\u003c/strong\u003e from VBA macro.\u003c/p\u003e\n\u003cp\u003eThis is most updated method of \u003cstrong\u003eFirst/Next View In Current Sheet\u003c/strong\u003e in an drawing document.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - First/Next View In Current Sheet"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Get Total View count in Drawing in Drawing document from VBA macro.\nThis is most updated method of Get Total View count in Drawing in an drawing document.\nResults We Can Get Below image shows the result we get.\nWe Get Total View count in Drawing in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Get Total View count in Drawing from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Get Total View count in Drawing.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Program to Get Total View count in Drawing Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Print View\u0026#39;s Count Debug.Print \u0026#34;Sheet + Views: \u0026#34; \u0026amp; swDrawing.GetViewCount End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. There are 2 sheets in drawing. Each sheet has some views. We did not select anything in the drawing. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Variables Get Total View count in Drawing Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Get Total View count in Drawing Sub main() End Sub\rIn above line, we create Program to Get Total View count in Drawing. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Variables In this section, we initialize Variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Drawing document Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. Get Total View count in Drawing In this section, we Get Total View count in Drawing.\n\u0026#39; Print View\u0026#39;s Count Debug.Print \u0026#34;Sheet + Views: \u0026#34; \u0026amp; swDrawing.GetViewCount\rIn above line, we Print Total View\u0026rsquo;s count in Immediate Window. We get this count by GetViewCount method. This GetViewCount method is part of swDrawing variable. This GetViewCount method did not take any parameters. View count included sheet as first element. If Immediate Window is not available then press \u0026ldquo;Ctrl + G\u0026rdquo;. Now we run the macro and after running macro we get total view count as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Get Total View count in Drawing with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":196,"permalink":"/solidworks-vba-macros/drawing-get-total-view-count-in-drawing/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eGet Total View count in Drawing\u003c/strong\u003e in \u003cstrong\u003eDrawing document\u003c/strong\u003e from VBA macro.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Get Total View count in Drawing"},{"content":"Objective In this article, we understand \u0026ldquo;how to\u0026rdquo; Loop All Sheets \u0026amp; Views in Drawing in Drawing document from VBA macro.\nThis is most updated method of Loop All Sheets \u0026amp; Views in Drawing in an drawing document.\nResults We Can Get Below image shows the result we get.\nWe Loop All Sheets \u0026amp; Views in Drawing in simple manners.\nThere are no extra steps required.\nTo get the correct result, please follow the steps correctly. {: .notice\u0026ndash;warning}\nMacro Video Below üé¨ video shows how to Loop All Sheets \u0026amp; Views in Drawing from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation.\nI have explained every line in this article.\nIt is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Loop All Sheets \u0026amp; Views in Drawing.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View \u0026#39; Creating variable for Solidworks Sheet Dim swSheet As SldWorks.Sheet \u0026#39; Program to Loop All Sheets \u0026amp; Views in Drawing Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Variable for Sheet names Dim vSheetName As Variant \u0026#39; Get the sheets in the drawing document vSheetName = swDrawing.GetSheetNames \u0026#39; Variable for Sheet Index Dim sheetIndex As Integer \u0026#39; Loop through sheet names in drawing For sheetIndex = 0 To UBound(vSheetName) \u0026#39; Set Solidworks Sheet variable Set swSheet = swDrawing.Sheet(vSheetName(sheetIndex)) \u0026#39; Check if we failed to get sheet If swSheet Is Nothing Then MsgBox \u0026#34;Failed to get drawing sheet.\u0026#34; Exit Sub End If \u0026#39; Print current sheet name Debug.Print \u0026#34;Active Sheet Name: \u0026#34; \u0026amp; vSheetName(sheetIndex) \u0026#39; Variable for drawing views Dim views As Variant \u0026#39; Get all views in this sheet views = swSheet.GetViews \u0026#39; Variable for drawing view Dim vView As Variant \u0026#39; Loop all drawing views For Each vView In views \u0026#39; Set Solidworks view variable Set swView = vView \u0026#39; Check if we get the view If swView Is Nothing Then MsgBox \u0026#34;Failed to get current view.\u0026#34; Exit Sub End If \u0026#39; Print View\u0026#39;s Name Debug.Print \u0026#34;View Name: \u0026#34; \u0026amp; swView.Name Next vView Next sheetIndex End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired. There are 2 sheets in drawing. Each sheet has some views. We did not select anything in the drawing. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Variables Loop Through Sheets Loop Through Views Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swView Type: SldWorks.View Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Sheet Dim swSheet As SldWorks.Sheet\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swSheet Type: SldWorks.Sheet Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Loop All Sheets \u0026amp; Views in Drawing Sub main() End Sub\rIn above line, we create Program to Loop All Sheets \u0026amp; Views in Drawing. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Variables In this section, we initialize Variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Drawing document Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. Loop Through Sheets In this section, we Loop Through Sheets.\n\u0026#39; Variable for Sheet names Dim vSheetName As Variant\rPurpose: In above line, we create a Variant variable for Sheet names. Variable Name: vSheetName Type: Variant \u0026#39; Get the sheets in the drawing document vSheetName = swDrawing.GetSheetNames\rIn above code, we Get the sheets in the drawing document.\nFor this, we use GetSheetNames method.\nThis GetSheetNames method is part of swDrawing variable.\nThis method did not takes any parameters.\nReturn Value : This GetSheetNames method return Sheet names in the drawing.\n\u0026#39; Variable for Sheet Index Dim sheetIndex As Integer\rPurpose: In above line, we create a Variant variable for Sheet Index. Variable Name: sheetIndex Type: Variant \u0026#39; Loop through sheet names in drawing For sheetIndex = 0 To UBound(vSheetName) Next sheetIndex\rIn above code block, we create For loop. We loop through sheet names in drawing. Currently there are 2 sheets i.e. Sheet1 and Sheet2. Hence sheetIndex range from 0 to 1. For more details: üöÄ VBA Looping \u0026#39; Set Solidworks Sheet variable Set swSheet = swDrawing.Sheet(vSheetName(sheetIndex))\rIn above line, we set Solidworks Sheet variable. We are doing following: Get current sheet name. Sheet1: vSheetName(sheetIndex) [When sheetIndex = 0] Sheet2: vSheetName(sheetIndex) [When sheetIndex = 1] Get drawing sheet obect. Method Used: Sheet() Method Parameter: Sheet Name Return Value: Solidwork Sheet Object Set Solidworks Sheet object by Sheet() method. \u0026#39; Check if we failed to get sheet If swSheet Is Nothing Then MsgBox \u0026#34;Failed to get drawing sheet.\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully set the value of swSheet variable. We use üöÄ IF statement for checking. Condition: swSheet Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to get drawing sheet. Then we stop our macro here. \u0026#39; Print current sheet name Debug.Print \u0026#34;Active Sheet Name: \u0026#34; \u0026amp; vSheetName(sheetIndex)\rIn above line, we Print Active Sheet Name in Immediate Window. We get Sheet Name by vSheetName(sheetIndex) method. This vSheetName method take sheetIndex parameter. If Immediate Window is not available then press \u0026ldquo;Ctrl + G\u0026rdquo;. Loop Through Views In this section, we Loop Through Views.\n\u0026#39; Variable for drawing views Dim views As Variant\rPurpose: In above line, we create a Variant variable for drawing views. Variable Name: views Type: Variant \u0026#39; Get all views in this sheet views = swSheet.GetViews\rIn above code, we Get all views in this sheet.\nFor this, we use GetViews method.\nThis GetViews method is part of swSheet variable.\nThis method did not takes any parameters.\nReturn Value : This GetViews method return all views in this sheet.\n\u0026#39; Variable for drawing view Dim vView As Variant\rPurpose: In above line, we create a Variant Variable for drawing view. Variable Name: vView Type: Variant \u0026#39; Loop all drawing views For Each vView In views Next vView\rIn above code block, we create For Each loop. We loop through drawing views in current sheet. For more details: üöÄ VBA Looping \u0026#39; Set Solidworks view variable Set swView = vView\rIn above line, we set Solidworks view variable. We set value to vView. \u0026#39; Check if we get the view If swView Is Nothing Then MsgBox \u0026#34;Failed to get current view.\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully set the value of swView variable. We use üöÄ IF statement for checking. Condition: swView Is Nothing When this condition is True, We show and üöÄ message window to user. Message: Failed to get current view. Then we stop our macro here. \u0026#39; Print View\u0026#39;s Name Debug.Print \u0026#34;View Name: \u0026#34; \u0026amp; swView.Name\rIn above line, we Print View\u0026rsquo;s Name in Immediate Window. We get Sheet Name by swView.Name property. If Immediate Window is not available then press \u0026ldquo;Ctrl + G\u0026rdquo;. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Loop All Sheets \u0026amp; Views in Drawing with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":197,"permalink":"/solidworks-vba-macros/drawing-loop-all-views-in-drawing/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eIn this article, we understand \u0026ldquo;how to\u0026rdquo; \u003cstrong\u003eLoop All Sheets \u0026amp; Views in Drawing\u003c/strong\u003e in \u003cstrong\u003eDrawing document\u003c/strong\u003e from VBA macro.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Loop All Sheets \u0026 Views in Drawing"},{"content":"Objective Objective of this article is simple, answer the below question.\nQuestion I have: How to add a Break view in a drawing from Solidworks VBA macro.\nFinal Result Final result as shown below üëáüèª\nMacro Video Below üé¨ video shows how to Insert a Break view from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation. It is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Insert a Break View.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 s \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View \u0026#39; Program to Insert Vertical Break View Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Get activate view Set swView = swDrawing.ActiveDrawingView \u0026#39; Check if Solidworks document is opened or not If swView Is Nothing Then MsgBox \u0026#34;No view selected.\u0026#34; Exit Sub End If \u0026#39; Insert Vertical Break Line swDrawing.InsertBreakVertical \u0026#39; Insert Break view swDoc.BreakView \u0026#39; Rebuild document swDoc.ForceRebuild3 True End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired.\nWe create Break view from an existing (Base) view.\nWe already select this existing (Base) view.\nWe will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Variables Insert Break Views Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View\rPurpose: In above line, we create a variable for Solidworks View. Variable Name: swView Type: SldWorks.View Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Insert Vertical Break View Sub main() End Sub\rIn above line, we create Program to Insert Vertical Break View. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Variables In this section, we initialize Variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Drawing document Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. Insert Break View In this section, we Insert Break View.\n\u0026#39; Get activate view Set swView = swDrawing.ActiveDrawingView\rIn above line, we set value of swView variable. This value is currently selected view. We get value by ActiveDrawingView method. This ActiveDrawingView method is part of swDrawing variable. \u0026#39; Check if Solidworks document is opened or not If swView Is Nothing Then MsgBox \u0026#34;No view selected.\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully get the value of swView variable. We use üöÄ IF statement for checking. Condition: swView Is Nothing When this condition is True, We show and üöÄ message window to user. Message: No view selected. Then we stop our macro here. \u0026#39; Insert Vertical Break Line swDrawing.InsertBreakVertical\rIn above code, we Insert Vertical Break Line into active drawing view.\nFor this, we use InsertBreakVertical method.\nThis InsertBreakVertical method is part of swDrawing variable.\nThis method did not take any parameter.\nReturn Value : This InsertBreakVertical method does not return any value.\nReference: For more details please visit üöÄ online SOLIDWORKS API Help.\n\u0026#39; Insert Break view swDoc.BreakView\rIn above code, we Insert Break view into active drawing view.\nFor this, we use BreakView method.\nThis BreakView method is part of swDrawing variable.\nThis method did not take any parameter.\nReturn Value : This BreakView method does not return any value.\n\u0026#39; Rebuild drawing swDoc.ForceRebuild3 True\rIn above line, we Rebuild drawing. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Insert Break View with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":198,"permalink":"/solidworks-vba-macros/drawing-insert-break-view/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eObjective of this article is simple, answer the below question.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eQuestion I have\u003c/strong\u003e: How to add a \u003cem\u003e\u003cstrong\u003eBreak view\u003c/strong\u003e\u003c/em\u003e in a drawing from \u003cstrong\u003eSolidworks VBA macro\u003c/strong\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Insert Break view"},{"content":"Objective Objective of this article is simple, answer the below question.\nQuestion: How to add a Update Break line position in a drawing from Solidworks VBA macro.\nFinal Result Final result as shown below üëáüèª\nMacro Video Below üé¨ video shows how to Update Break line position from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation. It is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Update Break line position.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View \u0026#39; Creating variable for Solidworks Breakline Dim swBreakLine As SldWorks.BreakLine \u0026#39; Program to Update Break line position Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Get activate view Set swView = swDrawing.ActiveDrawingView \u0026#39; Variable for Break lines Dim breaks As Variant \u0026#39; Get Break lines in current view breaks = swView.GetBreakLines \u0026#39; Get first break line and set Solidworks Breakline variable Set swBreakLine = breaks(0) \u0026#39; Variable for position Dim vPoints As Variant \u0026#39; Get position of first break line vPoints = swBreakLine.GetPosition(0) \u0026#39; Update Break line position swBreakLine.SetPosition vPoints + 0.01, vPoints + 0.003 \u0026#39; Rebuild document swDoc.ForceRebuild3 True End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is ‚ùórequired.\nWe arleady selected view.\nWe already have a break view created in üöÄ SOLIDWORKS Macros - Insert Break view article. .\nWe will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Variables Update Break line position Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View\rPurpose: In above line, we create a variable for Solidworks View. Variable Name: swView Type: SldWorks.View Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Breakline Dim swBreakLine As SldWorks.BreakLine\rPurpose: In above line, we create a variable for Solidworks Breakline. Variable Name: swBreakLine Type: SldWorks.BreakLine Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Update Break line position Sub main() End Sub\rIn above line, we create Program to Update Break line position. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Variables In this section, we initialize Variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Drawing document Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. \u0026#39; Get activate view Set swView = swDrawing.ActiveDrawingView\rIn above line, we set value of swView variable. This value is currently selected view. We get value by ActiveDrawingView method. This ActiveDrawingView method is part of swDrawing variable. \u0026#39; Check if Solidworks document is opened or not If swView Is Nothing Then MsgBox \u0026#34;No view selected.\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully get the value of swView variable. We use üöÄ IF statement for checking. Condition: swView Is Nothing When this condition is True, We show and üöÄ message window to user. Message: No view selected. Then we stop our macro here. Update Break line position In this section, we Update Break line position.\n\u0026#39; Variable for Break lines Dim breaks As Variant\rPurpose: In above line, we create a variable for getting Break lines from current views. Variable Name: breaks Type: Variant \u0026#39; Get Break lines in current view breaks = swView.GetBreakLines\rIn above code, we get Break lines in current view. Then we set the value of breaks variable. For this, we use GetBreakLines method. This GetBreakLines method is part of swView variable. This method did not take any parameter. Return Value : This GetBreakLines method returns Solidworks Break line. Reference: For more details please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Get first break line and set Solidworks Breakline variable Set swBreakLine = breaks(0)\rIn above line, we get first break line. Then we set the value of Solidworks Breakline variable swBreakLine. \u0026#39; Variable for position Dim vPoints As Variant\rPurpose: In above line, we create a variable for getting Break lines position from break line. Variable Name: vPoints Type: Variant \u0026#39; Get position of first break line vPoints = swBreakLine.GetPosition(0)\rIn above line, we get the first position of break line. For this, we use GetPosition method. This GetPosition method is part of swBreakLine variable. We store the value of Solidworks Breakline variable swBreakLine in vPoints variable. Return Value : This GetPosition method returns array of position of break line. \u0026#39; Update Break line position swBreakLine.SetPosition vPoints + 0.01, vPoints + 0.003\rIn above code, we Update Break line position.\nFor this, we use SetPosition method.\nThis SetPosition method is part of swBreakLine variable.\nThis method following parameter.\nPosition1 - Location of the first break line. Position2 - Location of the second break line. Return Value : This BreakView method does not return True if the break lines are positioned, False if not.\n\u0026#39; Rebuild drawing swDoc.ForceRebuild3 True\rIn above line, we Rebuild drawing. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Update Break line position with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":199,"permalink":"/solidworks-vba-macros/drawing-update-breakline-position/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eObjective of this article is simple, answer the below question.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eQuestion\u003c/strong\u003e: How to add a \u003cem\u003e\u003cstrong\u003eUpdate Break line position\u003c/strong\u003e\u003c/em\u003e in a drawing from \u003cstrong\u003eSolidworks VBA macro\u003c/strong\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Update Break line position"},{"content":"Objective Objective of this article is simple, answer the below question.\nQuestion: How to Update Break line gap in a drawing from Solidworks VBA macro.\nFinal Result Final result as shown below üëáüèª\nMacro Video Below üé¨ video shows how to Update Break Line Gap from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation. It is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Update Break Line Gap.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View \u0026#39; Program to Update Break line Gap Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Get activate view Set swView = swDrawing.ActiveDrawingView \u0026#39; Check if view is selected or not If swView Is Nothing Then MsgBox \u0026#34;No view selected.\u0026#34; Exit Sub End If \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39; Variable to hold user input Dim response As String \u0026#39; Get Gap width value from user response = InputBox(\u0026#34;Please Enter [Gap Width]: \u0026#34;) \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; \u0026#39; Clear all selection swDoc.ClearSelection2 True Exit Sub End If \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; \u0026#39; Clear all selection swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Variable for Break line Gap Dim breakLineGap As Double \u0026#39; Set the value of variable for Break line Gap breakLineGap = CDbl(response) * LengthConversionFactor \u0026#39; This will handle case for 0 Break line Gap If breakLineGap = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; \u0026#39; Clear all selection swDoc.ClearSelection2 True Exit Sub End If \u0026#39; Set Gap value to input value swView.breakLineGap = breakLineGap \u0026#39; Rebuild document swDoc.ForceRebuild3 True End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is‚ùórequired. As shown in above üëÜüèª image:\nWe arleady selected view. Current Gap Size: 0.1 inch If you want to Insert Break view in a drawing programmatically then please refer to below article.\nüöÄ SOLIDWORKS Macros - Insert Break view. Additionally, if you want to Update Break Line Position in a drawing programmatically then please refer to below article.\nüöÄ SOLIDWORKS Macros - Update Break line position. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Variables Get unit Conversion factors Get Wrap thickness And Validation Update Break line gap Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View\rPurpose: In above line, we create a variable for Solidworks View. Variable Name: swView Type: SldWorks.View Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Update Break line gap Sub main() End Sub\rIn above line, we create Program to Update Break line gap. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Variables In this section, we initialize Variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Drawing document Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. \u0026#39; Get activate view Set swView = swDrawing.ActiveDrawingView\rIn above line, we set value of swView variable. This value is currently selected view. We get value by ActiveDrawingView method. This ActiveDrawingView method is part of swDrawing variable. \u0026#39; Check if view is selected or not If swView Is Nothing Then MsgBox \u0026#34;No view selected.\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully get the value of swView variable. We use üöÄ IF statement for checking. Condition: swView Is Nothing When this condition is True, We show and üöÄ message window to user. Message: No view selected. Then we stop our macro here. Get unit Conversion factors In this section we get unit Conversion factors.\n\u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select\rI have already explained about this in previous üöÄ Solidworks Macro - Fix Unit Issue article in this website. Please visit üöÄ Solidworks Macro - Fix Unit Issue article for more details. Get Break Line Gap And Validation In this section, we get get the Break Line Gap from user and apply some validation on Break Line Gap.\n\u0026#39; Variable to hold user input Dim response As String\rIn above line, we create a variable hold user input. Variable Name: response Type: String \u0026#39; Get Gap width value from user response = InputBox(\u0026#34;Please Enter [Gap Width]: \u0026#34;)\rIn above line of code we are doing 2 steps in one line.\nStep 1 - Getting Gap width from user. Below image shows the message for Gap width to the user.\nStep 2 - Assigned input value to response variable. \u0026#39; This will handle empty value or cancel case If Len(response) = 0 Then MsgBox \u0026#34;Empty or no value. Please try again.\u0026#34; \u0026#39; Clear all selection swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check the length of input value. This check will handle case for empty value or cancel operation case. We use üöÄ IF statement for checking.\nCondition: Len(response) = 0\nLen() is pre-build VBA function which check the length of a object. In above cases, we will get 0 value. When this condition is True,\nWe show and üöÄ message window to user. Message: Empty or no value. Please try again. Then we stop our macro here. \u0026#39; This will handle case for Non-numeric values If IsNumeric(response) = False Then MsgBox \u0026#34;Entered value is Non-numeric. Please try again.\u0026#34; \u0026#39; Clear all selection swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if the input value is Non-numeric.\nThis check will handle case for Non-numeric values.\nWe use üöÄ IF statement for checking.\nCondition: IsNumeric(response) = False\nIsNumeric() is pre-build VBA function which check if passing object is Numeric or not. In above cases, we will get False value. When this condition is True,\nWe show and üöÄ message window to user. Message: Entered value is Non-numeric. Please try again. Then we stop our macro here. \u0026#39; Variable for Break line Gap Dim breakLineGap As Double\rIn above line, we create a variable to store Wrap thickness. Variable Name: breakLineGap Type: Double \u0026#39; Set the value of variable for Break line Gap breakLineGap = CDbl(response) * LengthConversionFactor\rIn above line of code we are doing 3 steps in one line.\nThose 3 steps are explained below.\nStep 1 - Converting Break line Gap from user to Double type. Step 2 - Updating converted Break line Gap as per document unit system. Step 3 - Assigned input value to breakLineGap variable. \u0026#39; This will handle case for 0 Break line Gap If breakLineGap = 0 Then MsgBox \u0026#34;Entered value must be greater than 0. Please try again.\u0026#34; \u0026#39; Clear all selection swDoc.ClearSelection2 True Exit Sub End If\rIn above code block, we check if the input value is zero (0). This check will handle case for 0 Break line Gap. We use üöÄ IF statement for checking. Condition: breakLineGap = 0 When this condition is True,\nWe show and üöÄ message window to user. Message: Entered value must be greater than 0. Please try again. Then we stop our macro here. Update Break line gap In this section, we Update Break line gap.\n\u0026#39; Set Gap value to input value swView.breakLineGap = breakLineGap\rIn above code, we Set Gap value to input value. For this, we use breakLineGap property. This breakLineGap property is part of swView variable. We set the value of this breakLineGap property to value of breakLineGap variable. \u0026#39; Rebuild drawing swDoc.ForceRebuild3 True\rIn above line, we Rebuild drawing. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Update Break Line Gap with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":200,"permalink":"/solidworks-vba-macros/drawing-update-breakline-gap/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eObjective of this article is simple, answer the below question.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eQuestion\u003c/strong\u003e: How to \u003cem\u003e\u003cstrong\u003eUpdate Break line gap\u003c/strong\u003e\u003c/em\u003e in a drawing from \u003cstrong\u003eSolidworks VBA macro\u003c/strong\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Update Break Line Gap"},{"content":"Objective Objective of this article is simple, answer the below question.\nHow to Update Break line Type in a drawing from Solidworks VBA macro.\nFinal Result Final result as shown below üëáüèª\nMacro Video Below üé¨ video shows how to Update Break Line Type from SOLIDWORKS VBA Macros.\nAbove video is just for visualization and there is no explanation. It is advisable to watch video, since it helps you to better understand the process. {: .notice\u0026ndash;warning}\nVBA Macro Below is the VBA macro for Update Break Line Type.\nOption Explicit \u0026#39; Creating variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Creating variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View \u0026#39; Creating variable for Solidworks Breakline Dim swBreakLine As SldWorks.BreakLine \u0026#39; Program to Update Break line Type Sub main() \u0026#39; Setting Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox \u0026#34;Solidworks document is not opened.\u0026#34; Exit Sub End If \u0026#39; Set Solidworks Drawing document variable Set swDrawing = swDoc \u0026#39; Get activate view Set swView = swDrawing.ActiveDrawingView \u0026#39; Variable for Break lines Dim breaks As Variant \u0026#39; Get Break lines in current view breaks = swView.GetBreakLines \u0026#39; Get first break line and set Solidworks Breakline variable Set swBreakLine = breaks(0) \u0026#39; Set Straight Line style swBreakLine.Style = swBreakLineStyle_e.swBreakLine_Straight \u0026#39; Rebuild document swDoc.ForceRebuild3 True End Sub\rPrerequisite There are some prerequisites for this article.\nKnowledge of VBA programming language is‚ùórequired. As shown in above üëÜüèª image:\nWe arleady selected view. Current Line Style: Zig Zag Cut If you want to Insert Break view in a drawing programmatically then please refer to below article.\nüöÄ SOLIDWORKS Macros - Insert Break view. Additionally, if you want to Update Break Line Position in a drawing programmatically then please refer to below article.\nüöÄ SOLIDWORKS Macros - Update Break line position. We will apply checks in this article, so the code we write, should be error free mostly. {: .notice}\nSteps To Follow This VBA macro can be divided into following sections:\nCreate Global Variables Initialize Variables Update Break line Type Every section with each line is explained below.\nI also give some links (see icon üöÄ) so that you can go through them if there are anything I explained in previous articles. {: .notice}\nCreate Global Variables In this section, we create global variables.\nOption Explicit\rPurpose: Above line forces us to define every variable we are going to use. Reference: üöÄ SOLIDWORKS Macros - Open new Part document article. \u0026#39; Variable for Solidworks application Dim swApp As SldWorks.SldWorks\rPurpose: In above line, we create a variable for Solidworks application. Variable Name: swApp Type: SldWorks.SldWorks Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rPurpose: In above line, we create a variable for Solidworks document. Variable Name: swDoc Type: SldWorks.ModelDoc2 Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Drawing Dim swDrawing As SldWorks.DrawingDoc\rPurpose: In above line, we create a variable for Solidworks Drawing. Variable Name: swDrawing Type: SldWorks.DrawingDoc Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks View Dim swView As SldWorks.View\rPurpose: In above line, we create a variable for Solidworks View. Variable Name: swView Type: SldWorks.View Reference: Please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Creating variable for Solidworks Breakline Dim swBreakLine As SldWorks.BreakLine\rPurpose: In above line, we create a variable for Solidworks Breakline. Variable Name: swBreakLine Type: SldWorks.BreakLine Reference: Please visit üöÄ online SOLIDWORKS API Help. These all are our global variables.\nThey are SOLIDWORKS API Objects.\n\u0026#39; Program to Update Break line type Sub main() End Sub\rIn above line, we create Program to Update Break line type. This is a Sub procedure which has name of main. This procedure hold all the statements (instructions) we give to computer. Reference: Detailed information üöÄ VBA Sub and Function Procedures article of this website. Initialize Variables In this section, we initialize Variables.\n\u0026#39; Set Solidworks Application variable to current application Set swApp = Application.SldWorks\rIn above line, we set value of swApp variable. This value is currently opened Solidworks application. \u0026#39; Set Solidworks document variable to currently opened document Set swDoc = swApp.ActiveDoc\rIn above line, we set value of swDoc variable. This value is currently opened part document. \u0026#39; Check if Solidworks document is opened or not If swDoc Is Nothing Then MsgBox (\u0026#34;Solidworks document is not opened.\u0026#34;) Exit Sub End If\rIn above code block, we check if we successfully set the value of swDoc variable. We use üöÄ IF statement for checking. Condition: swDoc Is Nothing When this condition is True, We show and üöÄ message window to user. Message: SOLIDWORKS document is not opened. Then we stop our macro here. \u0026#39; Set Solidworks Drawing document Set swDrawing = swDoc\rIn above line, we set value of swDrawing variable. This value is swDoc variable. \u0026#39; Get activate view Set swView = swDrawing.ActiveDrawingView\rIn above line, we set value of swView variable. This value is currently selected view. We get value by ActiveDrawingView method. This ActiveDrawingView method is part of swDrawing variable. \u0026#39; Check if view is selected or not If swView Is Nothing Then MsgBox \u0026#34;No view selected.\u0026#34; Exit Sub End If\rIn above code block, we check if we successfully get the value of swView variable. We use üöÄ IF statement for checking. Condition: swView Is Nothing When this condition is True, We show and üöÄ message window to user. Message: No view selected. Then we stop our macro here. Update Break line position In this section, we Update Break line position.\n\u0026#39; Variable for Break lines Dim breaks As Variant\rPurpose: In above line, we create a variable for getting Break lines from current views. Variable Name: breaks Type: Variant \u0026#39; Get Break lines in current view breaks = swView.GetBreakLines\rIn above code, we get Break lines in current view. Then we set the value of breaks variable. For this, we use GetBreakLines method. This GetBreakLines method is part of swView variable. This method did not take any parameter. Return Value : This GetBreakLines method returns Solidworks Break line. Reference: For more details please visit üöÄ online SOLIDWORKS API Help. \u0026#39; Get first break line and set Solidworks Breakline variable Set swBreakLine = breaks(0)\rIn above line, we get first break line. Then we set the value of Solidworks Breakline variable swBreakLine. \u0026#39; Set Straight Line style swBreakLine.Style = swBreakLineStyle_e.swBreakLine_Straight\rIn above code, we Set Straight Line style.\nFor this, we use Style property.\nThis Style property is part of swBreakLine variable.\nWe set the value of this Style property to value of swBreakLineStyle_e.swBreakLine_Straight variable.\nswBreakLineStyle_e has multiple values for different styles as explained below.\nType - Type of Styles are defined in swBreakLineStyle_e: Member Description swBreakLine_Curve 3 swBreakLine_Jagged 5 swBreakLine_SmallZigZag 4 swBreakLine_Straight 1 swBreakLine_ZigZag 2 You can select type of style from above values as per requirement.\n\u0026#39; Rebuild drawing swDoc.ForceRebuild3 True\rIn above line, we Rebuild drawing. For this we use ForceRebuild3 method which is part of SOLIDWORKS Document variable i.e swDoc variable. Now we run the macro and after running macro we show selected component as shown in below image.\nThis is it !!!\nI hope my efforts will helpful to someone! üòä\nIf you found anything to add or update, please let me know on my e-mail üìß.\nHope this post helps you to Update Break Line Type with SOLIDWORKS VBA Macros.\nFor more such tutorials on SOLIDWORKS VBA Macro, do come to this website after sometime.\nIf you like the post then please share it with your friends also. üôèüèª\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":201,"permalink":"/solidworks-vba-macros/drawing-update-breakline-type/","summary":"\u003ch2 id=\"objective\"\u003eObjective\u003c/h2\u003e\n\u003cp\u003eObjective of this article is simple, answer the below question.\u003c/p\u003e\n\u003cp\u003eHow to \u003cem\u003e\u003cstrong\u003eUpdate Break line Type\u003c/strong\u003e\u003c/em\u003e in a drawing from \u003cstrong\u003eSolidworks VBA macro\u003c/strong\u003e.\u003c/p\u003e","tags":[],"title":"Solidworks VBA Macro - Update Break Line Type"},{"content":"Guides lead a user through a specific task they want to accomplish, often with a sequence of steps. Writing a good guide requires thinking about what your users are trying to do.\nFurther reading Read about how-to guides in the Di√°taxis framework ","date":"2023-09-07","id":202,"permalink":"/docs/example-guide/","summary":"\u003cp\u003eGuides lead a user through a specific task they want to accomplish, often with a sequence of steps. Writing a good guide requires thinking about what your users are trying to do.\u003c/p\u003e","tags":[],"title":"Example Guide"},{"content":"In this post, I tell you about Convert to Construction Sketch in a Sketch.\nIn this post, I explain about CreateConstructionGeometry method from Solidworks\u0026rsquo;s SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nThis post will utilize the methods explained in earlier posts, hence knowledge to those is required but it is not mandatory.\nAn absolute beginner can follow what is written here.\nCode Sample Below is the code sample to Convert Sketch Segment to Construction Sketch.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Set Solidworks document to active part document Set swDoc = swApp.ActiveDoc \u0026#39; Select Circle BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Convert to construction circle swDoc.SketchManager.CreateConstructionGeometry \u0026#39; De-select the Sketch Segment after Convert to construction swDoc.ClearSelection2 True \u0026#39; Show Front View swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding the Code Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Set Solidworks document to active part document Set swDoc = swApp.ActiveDoc\rIn this line, we set the value of our Solidworks variable swDoc to currently opened part document as shown below in our post.\n\u0026#39; Select Circle we want to Pattern BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Arc1\u0026#34;, \u0026#34;SKETCHSEGMENT\u0026#34;, 0, 0, 0, True, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line of code, we select the Circle i.e. Arc 1 and add it to selection list.\n\u0026#39; Convert to construction circle swDoc.SketchManager.CreateConstructionGeometry\rIn above line, we convert the selected Solidworks Sketch Segment i.e. our circle CreateConstructionGeometry method from Solidworks Sketch Manager.\nPlease note that here we did not create another variable for Sketch Manger like I have done previously.\nThis CreateConstructionGeometry method takes NO parameter and did not return any value.\nBefore Convert Circle\nAfter Convert Circle\n\u0026#39; De-select the Sketch after creation swDoc.ClearSelection2 True\rIn the above line of code, we deselect the Sketch after the Circular Sketch Pattern operation.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Show Front View swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView\rIn the above line of code, we update the view orientation to Front View.\nIn my machine, after inserting a sketch view orientation does not changed.\nBecause of this I have to update the view to Front view.\nFor showing Front View we used ShowNamedView2 method from our Solidworks document name swDoc.\nThis method takes 2 parameter described as follows:\nVName : Name of the view to display or an empty string to use ViewId instead\nViewId : ID of the view to display as defined by swStandardViews_e or -1 to use the VName argument instead.\nNOTE: If you specify both VName and ViewId, then ViewId takes precedence if the two arguments do not resolve to the same view.\nswStandardViews_e has following Standard View Types:\nswBackView\nswBottomView\nswDimetricView\nswFrontView\nswIsometricView\nswLeftView\nswRightView\nswTopView\nswExtendetricView\nIn our code, we did not use VName instead I used empty string in form of \u0026quot;\u0026quot; symbol.\nI used ViewId value to specify view and used swStandardViews_e.swFrontView value to use Standard Front View.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Convert to Construction Sketch with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":203,"permalink":"/solidworks-macros/convert-to-construction-sketch-segment/","summary":"\u003cp\u003eIn this post, I tell you about \u003cstrong\u003eConvert to Construction Sketch\u003c/strong\u003e in a Sketch.\u003c/p\u003e\n\u003cp\u003eIn this post, I explain about \u003ccode\u003eCreateConstructionGeometry\u003c/code\u003e method from \u003cstrong\u003eSolidworks\u003c/strong\u003e\u0026rsquo;s \u003ccode\u003eSketchManager\u003c/code\u003e object.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Convert to Construction Sketch"},{"content":"Introduction In this post, I tell you about how to Split Open/Closed Sketch Entities using Solidworks VBA Macros in a Sketch.\nIn this post, I explain about SplitOpenSegment and SplitClosedSegment method from Solidworks SketchManager object.\nThis method is most updated method, I found in Solidworks API Help.\nSo use this method if you want to Split Open/Closed Sketch Entities.\nCASE 1 : Split Closed Sketch Entities Below is the code sample to Split Closed Sketch Entities.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Create Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39;-----------------------UNIT CONVERSION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;---------------------------------------------------------------- \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Create a circle of diameter 10 Set swSketchSegment = swSketchManager.CreateCircle(0, 0, 0, 10 * LengthConversionFactor, 0, 0) \u0026#39; Local variant type variable to hold return array of sketch segments Dim swSketchSegmentArray As Variant \u0026#39; Spliting the circle created and store the return array into local variable swSketchSegmentArray = swSketchManager.SplitClosedSegment(-10 * LengthConversionFactor, 0, 0, 10 * LengthConversionFactor, 0, 0) \u0026#39; De-select all after creation swDoc.ClearSelection2 True \u0026#39; Show Front View after Circular Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding Split Closed Sketch Segment the Code Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Create variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment\rIn this line, we Create a variable which we named as swSketchSegment and the type of this swSketchSegment variable is SldWorks.SketchSegment.\nWe create variable swSketchSegment for Solidworks Sketch Segments.\nTo see methods and properties related to swSketchSegment object, please visit this page of Solidworks API Help\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis GetUserPreferenceStringValue() method is a part of our main Solidworks variable swApp.\n\u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout that post if you want to understand above code in more detail.\n\u0026#39;-----------------------UNIT CONVERSION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;----------------------------------------------------------------\rAbove code sample shows how to fix Solidworks API Unit issue.\nWe 1st get the current unit of the part and apply the switch statements to update our Length and Angle Conversion factors.\nI have already explained in detail about Fixing Solidworks API Unit Issue in General - Fix Unit Issue blog post.\nDo checkout above post for Fixing Solidworks API Issue.\n\u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Create a circle of diameter 10 Set swSketchSegment = swSketchManager.CreateCircle(0, 0, 0, 10 * LengthConversionFactor, 0, 0)\rIn above line, we set the value of Solidworks Sketch Segment variable swSketchSegment by CreateCircle method from Solidworks Sketch Manager.\nThis CreateCircle method creates a Circle between \u0026ldquo;2 given point distance as diameter\u0026rdquo;.\nFor more information about CreateCircle method, you can read my Solidworks Macro - Create Circle post.\nThat post describe all the parameters we need for this CreateCircle method in details.\nIn above line, we create a Circle with:\nCircle Centerpoint : At origin i.e. (0, 0, 0)\nCircle Diameter : 10 unit length\n\u0026#39; Local variant type variable to hold return array of sketch segments Dim swSketchSegmentArray As Variant\rIn above line of code, we create a variant type variable to hold return array of sketch segments.\n\u0026#39; Spliting the circle created and store the return array into local variable swSketchSegmentArray = swSketchManager.SplitClosedSegment(-10 * LengthConversionFactor, 0, 0, 10 * LengthConversionFactor, 0, 0)\rFor \u0026ldquo;Spliting\u0026rdquo; an closed sketch entity, we need SplitClosedSegment method from Solidworks SketchManager object.\nThis SplitClosedSegment method takes following parameters as explained:\nX1 : X coordinate of first point.\nY1 : y coordinate of first point.\nZ1 : z coordinate of first point.\nX2 : X coordinate of second point.\nY2 : Y coordinate of second point.\nZ2 : Z coordinate of second point.\nAfter the function complete following are the results:\nReturn Value:\nArray Sketch Segments: Array of sketch segments of the now split formerly closed sketch skegment. In our code, I have used following values:\nX1 : X coordinate of first point = -10 * LengthConversionFactor.\nY1 : y coordinate of first point = 0.\nZ1 : z coordinate of first point = 0.\nX2 : X coordinate of second point = 10 * LengthConversionFactor.\nY2 : Y coordinate of second point = 0.\nZ2 : Z coordinate of second point = 0.\nBelow image shows before and after Circular Sketch Pattern.\nBefore Circular Sketch Pattern\nAfter Circular Sketch Pattern\n\u0026#39; De-select the Sketch after creation swDoc.ClearSelection2 True\rIn the above line of code, we deselect the Sketch after the Linear Sketch Pattern operation.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Show Front View after Linear Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView\rIn the above line of code, we update the view orientation to Front View.\nIn my machine, after inserting a sketch view orientation does not changed.\nBecause of this I have to update the view to Front view.\nFor showing Front View we used ShowNamedView2 method from our Solidworks document name swDoc.\nThis method takes 2 parameter described as follows:\nVName : Name of the view to display or an empty string to use ViewId instead\nViewId : ID of the view to display as defined by swStandardViews_e or -1 to use the VName argument instead.\nNOTE: If you specify both VName and ViewId, then ViewId takes precedence if the two arguments do not resolve to the same view.\nswStandardViews_e has following Standard View Types:\nswBackView\nswBottomView\nswDimetricView\nswFrontView\nswIsometricView\nswLeftView\nswRightView\nswTopView\nswExtendetricView\nIn our code, we did not use VName instead I used empty string in form of \u0026quot;\u0026quot; symbol.\nI used ViewId value to specify view and used swStandardViews_e.swFrontView value to use Standard Front View.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nCASE 2 : Split Open Sketch Entities Below is the code sample to Split Open Sketch Entities.\nOption Explicit \u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks \u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2 \u0026#39; Boolean Variable Dim BoolStatus As Boolean \u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager \u0026#39; Create Variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment \u0026#39; Main function of our VBA program Sub main() \u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks \u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart) \u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0) \u0026#39;-----------------------UNIT CONVERSION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;---------------------------------------------------------------- \u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault) \u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager \u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True \u0026#39; Create a line of distance 10 Set swSketchSegment = swSketchManager.CreateLine(0, 0, 0, 10 * LengthConversionFactor, 0, 0) \u0026#39; Local variant type variable to hold return array of sketch segments Dim swSketchSegmentArray As Variant \u0026#39; Spliting the line at distance of 5 and store the return array into local variable swSketchSegmentArray = swSketchManager.SplitOpenSegment(5 * LengthConversionFactor, 0, 0) \u0026#39; De-select all after creation swDoc.ClearSelection2 True \u0026#39; Show Front View after Circular Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView \u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit2 End Sub\rUnderstanding Split Open Sketch Segment the Code Now let us walk through each line in the above code, and understand the meaning and purpose of every line.\nI also give some link so that you can go through them if there are anything I explained in previous posts.\nOption Explicit\rThis line forces us to define every variable we are going to use.\nFor more information please visit Solidworks Macros - Open new Part document post.\n\u0026#39; Create variable for Solidworks application Dim swApp As SldWorks.SldWorks\rIn this line, we create a variable which we named as swApp and the type of this swApp variable is SldWorks.SldWorks.\n\u0026#39; Create variable for Solidworks document Dim swDoc As SldWorks.ModelDoc2\rIn this line, we create a variable which we named as swDoc and the type of this swDoc variable is SldWorks.ModelDoc2.\n\u0026#39; Boolean Variable Dim BoolStatus As Boolean\rIn this line, we create a variable named BoolStatus as Boolean object type.\n\u0026#39; Create variable for Solidworks Sketch Manager Dim swSketchManager As SldWorks.SketchManager\rIn above line, we create variable swSketchManager for Solidworks Sketch Manager.\nAs the name suggested, a Sketch Manager holds variours methods and properties to manage Sketches.\nTo see methods and properties related to SketchManager object, please visit this page of Solidworks API Help\n\u0026#39; Create variable for Solidworks Sketch Segment Dim swSketchSegment As SldWorks.SketchSegment\rIn this line, we Create a variable which we named as swSketchSegment and the type of this swSketchSegment variable is SldWorks.SketchSegment.\nWe create variable swSketchSegment for Solidworks Sketch Segments.\nTo see methods and properties related to swSketchSegment object, please visit this page of Solidworks API Help\nThese all are our global variables.\nAs you can see in code sample, they are Solidworks API Objects.\nSo basically I group all the Solidworks API Objects in one place.\nI have also place boolean type object at top also, because after certain point we will need this variable frequently.\nThus, I have started placing it here.\nNext is our Sub procedure which has name of main.\nThis procedure hold all the statements (instructions) we give to computer.\n\u0026#39; Set Solidworks variable to Solidworks application Set swApp = Application.SldWorks\rIn this line, we set the value of our Solidworks variable swApp; which we define earlier; to Solidworks application.\n\u0026#39; Create string type variable for storing default part location Dim defaultTemplate As String \u0026#39; Set value of this string type variable to \u0026#34;Default part template\u0026#34; defaultTemplate = swApp.GetUserPreferenceStringValue(swUserPreferenceStringValue_e.swDefaultTemplatePart)\rIn 1st statement of above example, we are defining a variable of string type and named it as defaultTemplate.\nThis variable defaultTemplate, hold the location the location of Default Part Template.\nIn 2nd line of above example. we assign value to our newly define defaultTemplate variable.\nWe assign the value by using a Method named GetUserPreferenceStringValue().\nThis GetUserPreferenceStringValue() method is a part of our main Solidworks variable swApp.\n\u0026#39; Set Solidworks document to new part document Set swDoc = swApp.NewDocument(defaultTemplate, 0, 0, 0)\rIn this line, we set the value of our swDoc variable to new document.\nFor detailed information about these lines please visit Solidworks Macros - Open new Part document post.\nI have discussed them thoroghly in Solidworks Macros - Open new Part document post, so do checkout that post if you want to understand above code in more detail.\n\u0026#39;-----------------------UNIT CONVERSION---------------------------------------- \u0026#39; Local variables used as Conversion Factors Dim LengthConversionFactor As Double Dim AngleConversionFactor As Double \u0026#39; Use a Select Case, to get the length of active Unit and set the different factors Select Case swDoc.GetUnits(0) \u0026#39; GetUnits function gives us, active unit Case swMETER \u0026#39; If length is in Meter LengthConversionFactor = 1 AngleConversionFactor = 1 Case swMM \u0026#39; If length is in MM LengthConversionFactor = 1 / 1000 AngleConversionFactor = 1 * 0.01745329 Case swCM \u0026#39; If length is in CM LengthConversionFactor = 1 / 100 AngleConversionFactor = 1 * 0.01745329 Case swINCHES \u0026#39; If length is in INCHES LengthConversionFactor = 1 * 0.0254 AngleConversionFactor = 1 * 0.01745329 Case swFEET \u0026#39; If length is in FEET LengthConversionFactor = 1 * (0.0254 * 12) AngleConversionFactor = 1 * 0.01745329 Case swFEETINCHES \u0026#39; If length is in FEET \u0026amp; INCHES LengthConversionFactor = 1 * 0.0254 \u0026#39; For length we use sama as Inch AngleConversionFactor = 1 * 0.01745329 Case swANGSTROM \u0026#39; If length is in ANGSTROM LengthConversionFactor = 1 / 10000000000# AngleConversionFactor = 1 * 0.01745329 Case swNANOMETER \u0026#39; If length is in NANOMETER LengthConversionFactor = 1 / 1000000000 AngleConversionFactor = 1 * 0.01745329 Case swMICRON \u0026#39; If length is in MICRON LengthConversionFactor = 1 / 1000000 AngleConversionFactor = 1 * 0.01745329 End Select \u0026#39;----------------------------------------------------------------\rAbove code sample shows how to fix Solidworks API Unit issue.\nWe 1st get the current unit of the part and apply the switch statements to update our Length and Angle Conversion factors.\nI have already explained in detail about Fixing Solidworks API Unit Issue in General - Fix Unit Issue blog post.\nDo checkout above post for Fixing Solidworks API Issue.\n\u0026#39; Select Front Plane BoolStatus = swDoc.Extension.SelectByID2(\u0026#34;Front Plane\u0026#34;, \u0026#34;PLANE\u0026#34;, 0, 0, 0, False, 0, Nothing, swSelectOption_e.swSelectOptionDefault)\rIn above line, we select the front plane by using SelectByID2 method from Extension object.\nFor more information about selection method please visit Solidworks Macros - Selection Methods post.\n\u0026#39; Set Sketch manager for our sketch Set swSketchManager = swDoc.SketchManager\rIn above line, we set the Sketch manager variable to current document\u0026rsquo;s sketch manager.\n\u0026#39; Insert a sketch into selected plane swSketchManager.InsertSketch True\rIn above line, we use InsertSketch method of SketchManager and give True value.\nThis method allows us to insert a sketch in selected plane.\n\u0026#39; Create a line of distance 10 Set swSketchSegment = swSketchManager.CreateLine(0, 0, 0, 10 * LengthConversionFactor, 0, 0)\rIn above line, we set the value of Solidworks Sketch Segment variable swSketchSegment by CreateLine method from Solidworks Sketch Manager.\nThis CreateLine method creates a line between \u0026ldquo;2 given point\u0026rdquo;.\nFor more information about CreateLine method, you can read my Solidworks Sketch Macro - Create Line post.\nThat post describe all the parameters we need for this CreateLine method in details.\nIn above line, we create a line of 10 unit in X-direction.\n\u0026#39; Local variant type variable to hold return array of sketch segments Dim swSketchSegmentArray As Variant\rIn above line of code, we create a variant type variable to hold return array of sketch segments.\n\u0026#39; Spliting the line at distance of 5 and store the return array into local variable swSketchSegmentArray = swSketchManager.SplitOpenSegment(5 * LengthConversionFactor, 0, 0)\rFor \u0026ldquo;Spliting\u0026rdquo; an closed sketch entity, we need SplitOpenSegment method from Solidworks SketchManager object.\nThis SplitOpenSegment method takes following parameters as explained:\nX : X coordinate of the point that splits the sketch segment in two.\nY : y coordinate of the point that splits the sketch segment in two.\nZ : z coordinate of the point that splits the sketch segment in two.\nAfter the function complete following are the results:\nReturn Value:\nArray Sketch Segments: Array of sketch segments of the now split formerly closed sketch skegment. In our code, I have used following values:\nX : X coordinate of the point that splits the sketch segment in two = 5 * LengthConversionFactor.\nY : y coordinate of the point that splits the sketch segment in twot = 0.\nZ : z coordinate of the point that splits the sketch segment in two = 0.\nBelow image shows before and after Circular Sketch Pattern.\nBefore Circular Sketch Pattern\nAfter Circular Sketch Pattern\n\u0026#39; De-select the Sketch after creation swDoc.ClearSelection2 True\rIn the above line of code, we deselect the Sketch after the Linear Sketch Pattern operation.\nFor de-selecting, we use ClearSelection2 method from our Solidworks document name swDoc.\n\u0026#39; Show Front View after Linear Sketch Pattern swDoc.ShowNamedView2 \u0026#34;\u0026#34;, swStandardViews_e.swFrontView\rIn the above line of code, we update the view orientation to Front View.\nIn my machine, after inserting a sketch view orientation does not changed.\nBecause of this I have to update the view to Front view.\nFor showing Front View we used ShowNamedView2 method from our Solidworks document name swDoc.\nThis method takes 2 parameter described as follows:\nVName : Name of the view to display or an empty string to use ViewId instead\nViewId : ID of the view to display as defined by swStandardViews_e or -1 to use the VName argument instead.\nNOTE: If you specify both VName and ViewId, then ViewId takes precedence if the two arguments do not resolve to the same view.\nswStandardViews_e has following Standard View Types:\nswBackView\nswBottomView\nswDimetricView\nswFrontView\nswIsometricView\nswLeftView\nswRightView\nswTopView\nswExtendetricView\nIn our code, we did not use VName instead I used empty string in form of \u0026quot;\u0026quot; symbol.\nI used ViewId value to specify view and used swStandardViews_e.swFrontView value to use Standard Front View.\n\u0026#39; Zoom to fit screen in Solidworks Window swDoc.ViewZoomtofit\rIn this last line we use zoom to fit command.\nFor Zoom to fit, we use ViewZoomtofit method from our Solidworks document variable swDoc.\nThis is it !!!\nI hope my efforts will helpful to someone!\nIf you found anything to add or update, please let me know on my e-mail.\nHope this post helps you to Split Open/Closed Sketch Entities with Solidworks VBA Macros.\nFor more such tutorials on Solidworks VBA Macro, do come to this blog after sometime.\nIf you like the post then please share it with your friends also.\nDo let me know by you like this post or not!\nTill then, Happy learning!!!\nüéÅ Download 5 Free SolidWorks Macros ‚Üí ","date":"0001-01-01","id":204,"permalink":"/solidworks-macros/split-sketch-segments/","summary":"\u003ch2 id=\"introduction\"\u003eIntroduction\u003c/h2\u003e\n\u003cp\u003eIn this post, I tell you about \u003cstrong\u003ehow to Split Open/Closed Sketch Entities using Solidworks VBA Macros\u003c/strong\u003e in a Sketch.\u003c/p\u003e","tags":[],"title":"Solidworks Macro - Split Open/Closed Sketch Entities"},{"content":"Reference pages are ideal for outlining how things work in terse and clear terms. Less concerned with telling a story or addressing a specific use case, they should give a comprehensive outline of what your documenting.\nFurther reading Read about reference in the Di√°taxis framework ","date":"2023-09-07","id":205,"permalink":"/docs/example-reference/","summary":"\u003cp\u003eReference pages are ideal for outlining how things work in terse and clear terms. Less concerned with telling a story or addressing a specific use case, they should give a comprehensive outline of what your documenting.\u003c/p\u003e","tags":[],"title":"Example Reference"},{"content":"Link to valuable, relevant resources.\n","date":"2024-02-27","id":206,"permalink":"/docs/resources/","summary":"\u003cp\u003eLink to valuable, relevant resources.\u003c/p\u003e","tags":[],"title":"Resources"},{"content":"","date":"2023-09-07","id":207,"permalink":"/docs/","summary":"","tags":[],"title":"Docs"},{"content":"","date":"2025-07-09","id":208,"permalink":"/about/","summary":"","tags":[],"title":"Abouts"},{"content":"","date":"2025-07-09","id":209,"permalink":"/resource/","summary":"","tags":[],"title":"Resources"},{"content":"","date":"2023-09-07","id":210,"permalink":"/","summary":"","tags":[],"title":"The CAD Coder"},{"content":"","date":"2023-09-07","id":211,"permalink":"/solidworks-macros/","summary":"","tags":[],"title":"Solidworks-Macros"},{"content":"","date":"2023-09-07","id":212,"permalink":"/vba/","summary":"","tags":[],"title":"Vbas"},{"content":"","date":"2023-09-07","id":213,"permalink":"/wix-tutorials/","summary":"","tags":[],"title":"Wix-Tutorials"},{"content":"","date":"2023-09-07","id":214,"permalink":"/wpf-tutorials/","summary":"","tags":[],"title":"Wpf-Tutorials"},{"content":"Welcome to the CAD Coder Knowledge Base ‚Äî a curated collection of my technical learnings, experiments, and solutions.\nAs a CAD Engineer turned Automation Developer, I‚Äôve faced many struggles: lack of beginner-friendly material, poor documentation, and scattered knowledge across forums.\nThis section of the site aims to fix that.\nüéØ Purpose of This Knowledge Base This is not a traditional blog.\nHere, I document the core technical knowledge I‚Äôve gained, in a structured and reusable format.\nYou‚Äôll find:\nConcept breakdowns XML/WiX and SolidWorks macro examples Practical insights from my own projects Minimal fluff ‚Äî only what actually works in real-world CAD automation üë§ Who This Is For This is built for:\nMechanical Engineers transitioning into programming Developers working with SolidWorks, WPF, or WiX Engineers trying to automate daily tasks using VBA or C# Anyone tired of copy-pasting macros and wants to understand how things work If you‚Äôre one of them ‚Äî welcome home.\nüß± How It‚Äôs Structured The knowledge base is divided into sections based on tools and platforms I use daily:\nüìÇ SolidWorks VBA Macros Step-by-step automation with Visual Basic for Applications (VBA) for SolidWorks.\nüëâ Start Learning VBA Macros ‚Üí\nüíª C# + SolidWorks API Modern automation using the SolidWorks API with C# and .NET. This includes macro development, standalone apps, and more.\nüëâ Browse SolidWorks C# Articles ‚Üí\n‚öôÔ∏è WiX Installer Projects How to build professional Windows installers using WiX Toolset ‚Äî with XML configurations, desktop icons, program entries, and more.\nüëâ WiX Tutorials Start Here ‚Üí\nüõ†Ô∏è Programming Essentials for Engineers Lessons I‚Äôve learned about how to think like a programmer, debug, and write code as a non-CS-background engineer.\nüëâ Coming Soon‚Ä¶\nüîÑ This Page Will Evolve Like engineering itself, this page is iterative.\nAs I learn, build, and test more things, I‚Äôll update this section with:\nNew sections Updated code samples Deeper guides based on reader feedback üì¨ Want More? If you want updates when I publish something new, join the mailing list (coming soon) or just bookmark this page.\nLet‚Äôs build tools that work ‚Äî and understand how they‚Äôre built.\nüß† Stay curious. Stay building.\n","date":"0001-01-01","id":215,"permalink":"/knowledge-base/","summary":"\u003cp\u003eWelcome to the \u003cstrong\u003eCAD Coder Knowledge Base\u003c/strong\u003e ‚Äî a curated collection of my technical learnings, experiments, and solutions.\u003cbr\u003e\nAs a CAD Engineer turned Automation Developer, I‚Äôve faced many struggles: lack of beginner-friendly material, poor documentation, and scattered knowledge across forums.\u003c/p\u003e","tags":[],"title":"üìò Introduction to the Knowledge Base"},{"content":"","date":"0001-01-01","id":216,"permalink":"/categories/","summary":"","tags":[],"title":"Categories"},{"content":"","date":"0001-01-01","id":217,"permalink":"/contributors/","summary":"","tags":[],"title":"Contributors"},{"content":"","date":"0001-01-01","id":218,"permalink":"/knowledge-base/","summary":"","tags":[],"title":"Knowledge Bases"},{"content":"","date":"0001-01-01","id":219,"permalink":"/tags/","summary":"","tags":[],"title":"Tags"}]